if(typeof jQuery!=="undefined"){MobileFrontend.references=(function(f){var d=function(){},h,b={},c;h=window.location.hash.substr(1).match(/refspeed:([0-9]*)/);b.animationSpeed=h?parseInt(h[1],10):500;h=window.location.hash.substr(1).match(/refanimation:([a-z]*)/);b.animation=h?h[1]:null;function e(){var i={};f("ol.references li").each(function(j,k){i[f(k).attr("id")]={html:f(k).html()}});return i}function a(){var i=navigator.userAgent;return i.match(/AppleWebKit\/(53[4-9]|5[4-9]\d?|[6-9])\d?\d?/)?true:false}if(!a()){d=function(){var i=f("#mf-references").outerHeight();f("#mf-references").css({top:(window.innerHeight+window.pageYOffset)-i,bottom:"auto",position:"absolute"})};f(document).scroll(d)}function g(j,p){var k,s,o,m,n,i,r=e();f("#mf-references").remove();k=f('<div id="mf-references"><div></div></div>').hide().appendTo(document.body)[0];function l(t){t.stopPropagation()}k.ontouchstart=l;s=function(){var t;o=null;if(b.animation==="none"){f("#mf-references").hide()}else{if(b.animation==="fade"){f("#mf-references").fadeOut(b.animationSpeed)}else{t=window.innerHeight+window.pageYOffset;if(!a()){f("#mf-references").show().animate({top:t},{duration:b.animationSpeed,complete:function(){f("#mf-references").hide()}})}else{f("#mf-references").slideUp()}}}};f("<button>close</button>").click(s).appendTo("#mf-references");f(".mw-cite-backlink a").click(s);function q(t){var v,u;i=f(this).attr("href");m=i&&i.charAt(0)==="#"?r[i.substr(1,i.length)]:null;if(!f("#mf-references").is(":visible")||o!==i){o=i;if(m){n="<h3>"+f(this).text()+"</h3>"+m.html}else{n=f("<a />").text(f(this).text()).attr("href",i).appendTo("<div />").parent().html()}f("#mf-references div").html(n);f("#mf-references div sup a").click(q);d();if(b.animation==="none"){f("#mf-references").show()}else{if(b.animation==="fade"){f("#mf-references").fadeIn(b.animationSpeed)}else{if(!a()){v=window.innerHeight+window.pageYOffset;u=f("#mf-references").outerHeight();f("#mf-references").show().css({top:v}).animate({top:v-u},b.animationSpeed)}else{f("#mf-references").slideDown()}}}}else{s()}t.preventDefault();l(t)}f("sup a",j).unbind("click").click(q).each(function(t,u){u.ontouchstart=l});if(p){f(document.body).bind("click",s);f(document.body).bind("touchstart",function(){f("#mf-references").hide()})}}g(f("#content")[0],true);return{init:g}}(jQuery))};