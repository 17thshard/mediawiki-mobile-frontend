this.mfModules=this.mfModules||{},this.mfModules["tests.mobilefrontend"]=(window.webpackJsonp=window.webpackJsonp||[]).push([[2,1],[function(e,t){e.exports={escapeSelector:function(e){return $.escapeSelector(e)},grep:function(){return $.grep.apply($,arguments)},docReady:function(e){return $(e)},when:function(){return $.when.apply($,arguments)},Deferred:function(){var e=$.Deferred(),t="Use Promise compatible methods `then` and `catch` instead.";return mw.log.deprecate(e,"fail",e.fail,t),mw.log.deprecate(e,"always",e.always,t),mw.log.deprecate(e,"done",e.done,t),e},getDocument:function(){return $(document.documentElement)},getWindow:function(){return $(window)},parseHTML:function(e,t){return $($.parseHTML(e,t))},isNumeric:function(){return $.isNumeric.apply($,arguments)},extend:function(){return $.extend.apply($,arguments)},escapeHash:function(e){return e.replace(/(:|\.)/g,"\\$1")},isModifiedEvent:function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},repeatEvent:function(e,t,n,i){return e.on(n,function(e){return t.emit(n,e)},i)}}},function(e,t){e.exports=function(e,t,n){var i;for(i in n?OO.inheritClass(e,t):(OO.initClass(e),n=t),n)e.prototype[i]=n[i]}},function(e,t,n){var i=n(0),a=n(1),s=["events"],o=/^(\S+)\s*(.*)$/,r=0;function l(){var e=this;s.forEach(function(t){void 0!==e[t]&&mw.log.deprecate(e,t,e[t],"Setting `"+t+"` on the View is deprecated. Please use options.")}),this.initialize.apply(this,arguments)}OO.mixinClass(l,OO.EventEmitter),a(l,{tagName:"div",isTemplateMode:!1,template:void 0,templatePartials:{},defaults:{},initialize:function(e){var t=this;OO.EventEmitter.call(this),e=i.extend({},this.defaults,e),this.options=e,this.cid=function(e){var t=(++r).toString();return e?e+t:t}("view"),"string"==typeof this.template&&(this.template=mw.template.compile(this.template)),e.el?this.$el=$(e.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize(e):i.docReady(function(){t.$el=$(e.el),t._postInitialize(e)})},_postInitialize:function(e){var t=e.className;this.$el.addClass(t),!1!==e.isBorderBox&&this.$el.addClass("view-border-box"),this.render({})},preRender:function(){},postRender:function(){},render:function(e){var t,n;return i.extend(this.options,e),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(n=this.template.render(this.options,this.templatePartials),this.isTemplateMode?(t=$(n),this.$el.replaceWith(t),this.$el=t):this.$el.html(n)),this.postRender(),this.delegateEvents(),this},$:function(e){return this.$el.find(e)},delegateEvents:function(e){var t,n,i;if(e=e||this.options.events||this.events)for(n in this.undelegateEvents(),e)"function"!=typeof(i=e[n])&&(i=this[e[n]]),i&&(t=n.match(o),this.delegate(t[1],t[2],i.bind(this)))},delegate:function(e,t,n){this.$el.on(e+".delegateEvents"+this.cid,t,n)},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid)},undelegate:function(e,t,n){this.$el.off(e+".delegateEvents"+this.cid,t,n)},parseHTML:i.parseHTML}),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(e){l.prototype[e]=function(){return this.$el[e].apply(this.$el,arguments),this}}),e.exports=l},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){!function(){e.exports=this.sinon}()},function(e,t,n){var i="object"!=typeof window;e.exports={setUp:function(e,t){i&&(t.$=t.$||void 0,e.stub(t,"$",n(38)))},tearDown:function(){i&&delete n.c[38]}}},function(e,t,n){var i="object"!=typeof window,a=i&&n(49);e.exports={setUp:function(e,t){i&&(t.window=t.window||void 0,t.document=t.document||void 0,e.stub(t,"window",(new a.JSDOM).window),e.stub(t,"document",window.document))}}},function(e,t,n){var i="object"!=typeof window,a=n(50);e.exports={setUp:function(e,t){i&&(t.mw=t.mw||void 0,e.stub(t,"mw",a()))}}},function(e,t,n){var i="object"!=typeof window;e.exports={setUp:function(e,t){i&&(t.OO=t.OO||void 0,e.stub(t,"OO",n(51)))}}},function(e,t,n){var i=n(10),a=n(0);e.exports={CANCEL_GLYPH:"overlay-close",Icon:i,cancel:function(e){var t=e?"overlay-close-"+e:"overlay-close";return new this.Icon({tagName:"button",name:t,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")})},spinner:function(e){return e=e||{},new this.Icon(a.extend(e,{name:"spinner",label:mw.msg("mobile-frontend-loading-message"),additionalClassNames:"spinner loading"}))},watchIcon:function(){return new this.Icon({name:"watch",additionalClassNames:"watch-this-article"})},watchedIcon:function(){return new this.Icon({name:"watched",additionalClassNames:"watch-this-article watched"})}}},function(e,t,n){var i=n(1),a=n(2);function s(e){e.hasText&&(e.modifier="mw-ui-icon-before"),e.href&&(e.tagName="a"),a.call(this,e)}i(s,a,{preRender:function(){this.setRotationClass()},setRotationClass:function(){var e=this.options;if(e.rotation)switch(e.rotation){case-180:case 180:e._rotationClass="mf-mw-ui-icon-rotate-flip";break;case-90:e._rotationClass="mf-mw-ui-icon-rotate-anti-clockwise";break;case 90:e._rotationClass="mf-mw-ui-icon-rotate-clockwise";break;case 0:break;default:throw new Error("Bad value for rotation given. Must be ±90, 0 or ±180.")}},isTemplateMode:!0,defaults:{rotation:0,hasText:!1,href:void 0,glyphPrefix:"mf",tagName:"div",isSmall:!1,base:"mw-ui-icon",name:"",modifier:"mw-ui-icon-element",title:""},getClassName:function(){return this.$el.attr("class")},getGlyphClassName:function(){return this.options.base+"-"+this.options.glyphPrefix+"-"+this.options.name},toHtmlString:function(){return this.parseHTML("<div>").append(this.$el).html()},template:mw.template.get("mobile.startup","icon.hogan")}),e.exports=s},function(e,t,n){var i,a=n(0);function s(e){var t=function(){var n=this["__cache"+t.cacheId]||(this["__cache"+t.cacheId]={}),i=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(n,i)?n[i]:n[i]=e.apply(this,arguments)};return t.cacheId=Date.now().toString()+Math.random().toString(),t}function o(e,t){this.userAgent=e,this.$el=t,this._fixIosLandscapeBug()}o.prototype={_fixIosLandscapeBug:function(){var e=this;this.$el.find('meta[name="viewport"]')[0]&&(this.isIos(4)||this.isIos(5))&&(this.lockViewport(),document.addEventListener("gesturestart",function(){e.lockViewport()},!1))},isIos:s(function(e){var t=this.userAgent,n=/ipad|iphone|ipod/i.test(t);if(!n||!e)return n;switch(e){case 8:return/OS 8_/.test(t)||/Version\/8/.test(t);case 4:return/OS 4_/.test(t);case 5:return/OS 5_/.test(t);default:return!1}}),lockViewport:function(){this.$el&&this.$el.find('meta[name="viewport"]').attr("content","initial-scale=1.0, maximum-scale=1.0, user-scalable=no")},isWideScreen:s(function(){var e=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=e||window.innerHeight>=e}),supportsAnimations:s(function(){var e=document.createElement("foo").style;function t(t){return t in e||"webkit"+t[0].toUpperCase()+t.slice(1)in e}return t("animationName")&&t("transform")&&t("transition")}),supportsTouchEvents:s(function(){return"ontouchstart"in window}),supportsGeoLocation:s(function(){return"geolocation"in window.navigator})},o.getSingleton=function(){var e;return i||(e=a.getDocument(),i=new o(window.navigator.userAgent,e)),i},e.exports=o},function(e,t,n){var i=n(2),a=n(10),s=n(13),o=n(14),r=n(9),l=n(0),c=n(11).getSingleton();function u(e){this.isIos=c.isIos(),this.useVirtualKeyboardHack=c.isIos(4)||c.isIos(5),this.hasLoadError=!1,i.call(this,l.extend({className:"overlay"},e))}n(1)(u,i,{hasFixedHeader:!0,fullScreen:!0,hideOnExitClick:!0,appendToElement:"body",templatePartials:{header:mw.template.get("mobile.startup","header.hogan"),anchor:o.prototype.template,button:s.prototype.template},template:mw.template.get("mobile.startup","Overlay.hogan"),defaults:{saveMsg:mw.msg("mobile-frontend-editor-save"),cancelButton:r.cancel().toHtmlString(),backButton:new a({tagName:"button",name:"back",additionalClassNames:"back",label:mw.msg("mobile-frontend-overlay-close")}).toHtmlString(),headerButtonsListClassName:"",headerChrome:!1,fixedHeader:!0,spinner:r.spinner().toHtmlString()},events:{"click .cancel, .confirm, .initial-header .back":"onExitClick",click:"stopPropagation"},closeOnContentTap:!1,showSpinner:function(){this.$spinner.removeClass("hidden")},hideSpinner:function(){this.$spinner.addClass("hidden")},postRender:function(){this.$overlayContent=this.$(".overlay-content"),this.$spinner=this.$(".spinner"),this.isIos&&this.$el.addClass("overlay-ios"),this.$(".overlay-header h2 span").addClass("truncated-text"),this.setupEmulatedIosOverlayScrolling()},setupEmulatedIosOverlayScrolling:function(){var e=this;this.isIos&&this.hasFixedHeader&&(this.$(".overlay-content").on("touchstart",this.onTouchStart.bind(this)).on("touchmove",this.onTouchMove.bind(this)),setTimeout(function(){e._fixIosHeader(e.$("textarea, input"))},0))},onExitClick:function(e){e.preventDefault(),e.stopPropagation(),this.hideOnExitClick&&this.hide(),this.emit(u.EVENT_EXIT)},onTouchStart:function(e){this.startY=e.originalEvent.touches[0].pageY},onTouchMove:function(e){var t=e.originalEvent.touches[0].pageY,n=this.$overlayContent.outerHeight(),i=this.$overlayContent.prop("scrollHeight")-n;e.stopPropagation(),(0===this.$overlayContent.scrollTop()&&this.startY<t||this.$overlayContent.scrollTop()===i&&this.startY>t)&&e.preventDefault()},stopPropagation:function(e){e.stopPropagation()},show:function(){var e=this,t=l.getDocument(),n=l.getWindow();this.$el.appendTo(this.appendToElement),this.scrollTop=window.pageYOffset,this.fullScreen&&(t.addClass("overlay-enabled"),window.scrollTo(0,1)),this.closeOnContentTap&&t.find("#mw-mf-page-center").one("click",this.hide.bind(this)),this.isIos&&this.hasFixedHeader&&n.on("touchmove.ios",function(e){e.preventDefault()}).on("resize.ios",function(){e._resizeContent(n.height())}),this.$el.addClass("visible")},hide:function(){var e=l.getWindow(),t=l.getDocument();return this.fullScreen&&(t.removeClass("overlay-enabled"),window.scrollTo(window.pageXOffset,this.scrollTop)),this.$el.detach(),this.isIos&&e.off(".ios"),this.emit("hide"),!0},_resizeContent:function(e){this.$overlayContent.height(e-this.$(".overlay-header-container").outerHeight()-this.$(".overlay-footer-container").outerHeight())},_fixIosHeader:function(e){var t=this,n=l.getWindow();this.isIos&&(this._resizeContent(n.height()),e.on("focus",function(){setTimeout(function(){var e=0;t.useVirtualKeyboardHack&&(n.scrollTop(999),e=n.scrollTop(),n.scrollTop(0)),n.height()>e&&t._resizeContent(n.height()-e)},0)}).on("blur",function(){t._resizeContent(n.height()),n.scrollTop(0)}))},showHidden:function(e){this.$(".hideable").addClass("hidden"),this.$(e).removeClass("hidden")}}),u.EVENT_EXIT="Overlay-exit",e.exports=u},function(e,t,n){var i=n(1),a=n(2);function s(e){e.href&&(e.tagName="a"),a.call(this,e)}i(s,a,{isTemplateMode:!0,defaults:{tagName:"a",block:void 0,progressive:void 0,destructive:void 0,quiet:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","button.hogan")}),e.exports=s},function(e,t,n){var i=n(2);function a(){i.apply(this,arguments)}n(1)(a,i,{isTemplateMode:!0,defaults:{progressive:void 0,destructive:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","anchor.hogan")}),e.exports=a},function(e,t,n){var i=mw.html,a=n(1),s=n(18),o=n(0),r=n(19),l=n(25),c=n(2),u=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),d=["noviewer","metadata"];function h(e){o.extend(this,{options:e,title:e.title,displayTitle:e.displayTitle,url:e.url||mw.util.getUrl(e.title),id:e.id,wikidataDescription:e.wikidataDescription,thumbnail:!!Object.prototype.hasOwnProperty.call(e,"thumbnail")&&e.thumbnail,isMissing:void 0!==e.isMissing?e.isMissing:0===e.id}),this.options.isBorderBox=!1,this.options.languageUrl=mw.util.getUrl("Special:MobileLanguages/"+this.title),c.call(this,this.options),this.displayTitle||(this.displayTitle=this.getDisplayTitle()),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}a(h,c,{defaults:{id:0,title:"",displayTitle:"",namespaceNumber:0,protection:{edit:["*"]},sections:[],isMissing:!1,isMainPage:!1,url:void 0,thumbnail:{isLandscape:void 0,source:void 0,width:void 0,height:void 0}},getDisplayTitle:function(){return this.options.displayTitle||i.escape(this.options.title)},inNamespace:function(e){return this.options.namespaceNumber===mw.config.get("wgNamespaceIds")[e]},findSectionHeadingByIndex:function(e){return e<1?this.$():this.$(u).filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(e-1)},findChildInSectionLead:function(e,t){var n,i,a,s,o=u;function r(e){return e.find(t).addBack()}return 0===e?(s=this.getLeadSectionElement())&&s.length?r(s.children(t)):(n=this.findSectionHeadingByIndex(1)).length?r(n.prevAll(t)):this.$(t):(n=this.findSectionHeadingByIndex(e)).hasClass("section-heading")?(i=(a=n.next()).find(o).eq(0)).length?r(i.prevAll(t)):r(a.children(t)):(i=n.eq(0).nextAll(o).eq(0),n.nextUntil(i,t))},getLeadSectionElement:function(){return this.$(".mf-section-0").length?this.$(".mf-section-0"):null},isWikiText:function(){return"wikitext"===mw.config.get("wgPageContentModel")},isMainPage:function(){return this.options.isMainPage},isWatched:function(){return this.options.isWatched},getRevisionId:function(){return this.options.revId},getTitle:function(){return this.options.title},getId:function(){return this.options.id},getNamespaceId:function(){var e=this.options.title.split(":");return e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0},isTalkPage:function(){var e=this.getNamespaceId();return e>0&&e%2==1},preRender:function(){this.sections=[],this._sectionLookup={},this.title=this.options.title,this.options.sections.forEach(function(e){var t=new r(e);this.sections.push(t),this._sectionLookup[t.id]=t}.bind(this))},getThumbnails:function(){var e=this.$el,t="."+d.join(",."),n=[];return this._thumbs||(e.find("a.image, a.thumbimage").not(t).each(function(){var i=e.find(this),a=i.find(".lazy-image-placeholder"),s=0===i.parents(t).length&&0===i.find(t).length,o=i.attr("href").match(/title=([^/&]+)/),r=i.attr("href").match(/[^/]+$/);a.length&&s&&(s=!new RegExp("\\b("+d.join("|")+")\\b").test(a.data("class"))),s&&(o||r)&&n.push(new l({el:i,filename:decodeURIComponent(o?o[1]:r[0])}))}),this._thumbs=n),this._thumbs},getSection:function(e){return this._sectionLookup[e]},getSections:function(){return this.sections},getRedLinks:function(){return this.$(".new")}}),h.newFromJSON=function(e){var t,n,a=e.thumbnail,r=e.pageprops||{displaytitle:i.escape(e.title)},l=e.terms;return(r||l)&&(n=l&&l.label?i.escape(l.label[0]):r.displaytitle),e.wikidataDescription=e.description||void 0,a&&(e.thumbnail.isLandscape=a.width>a.height),e.revisions&&e.revisions[0]&&(t=e.revisions[0],e.lastModified=s.getLastModifiedMessage(new Date(t.timestamp).getTime()/1e3,t.user)),new h(o.extend(e,{id:e.pageid,isMissing:!!e.missing,url:mw.util.getUrl(e.title),displayTitle:n}))},h.HEADING_SELECTOR=u,e.exports=h},function(e,t,n){var i=n(1),a=n(17),s=n(0),o=n(10);function r(e){a.call(this,s.extend({className:"drawer position-fixed"},e))}i(r,a,{defaults:s.extend({},a.prototype.defaults,{collapseIcon:new o({name:"arrow",additionalClassNames:"cancel"}).options}),templatePartials:s.extend({},a.prototype.templatePartials,{icon:o.prototype.template}),appendToElement:"body",closeOnScroll:!0,events:s.extend({},a.prototype.events,{click:"stopPropagation"}),postRender:function(){var e=this;s.docReady(function(){e.appendTo(e.appendToElement),e.$el.parent().addClass("has-drawer")}),this.on("show",this.onShowDrawer.bind(this)),this.on("hide",this.onHideDrawer.bind(this))},stopPropagation:function(e){e.stopPropagation()},onShowDrawer:function(){var e=this;this.$el.parent().addClass("drawer-visible"),setTimeout(function(){var t=s.getWindow();t.one("click.drawer",e.hide.bind(e)),e.closeOnScroll&&t.one("scroll.drawer",e.hide.bind(e))},e.minHideDelay)},onHideDrawer:function(){this.$el.parent().removeClass("drawer-visible"),s.getWindow().off(".drawer")}}),e.exports=r},function(e,t,n){var i=n(1),a=n(0),s=n(2);function o(e){var t=a.extend({},{className:"panel"},e);s.call(this,t)}i(o,s,{minHideDelay:10,events:{"click .cancel":"onCancel"},onCancel:function(e){e.preventDefault(),this.hide()},show:function(){var e=this;e.isVisible()||setTimeout(function(){e.$el.addClass("visible animated"),e.emit("show")},e.minHideDelay)},hide:function(){var e=this;setTimeout(function(){e.$el.removeClass("visible"),e.emit("hide")},e.minHideDelay)},isVisible:function(){return this.$el.hasClass("visible")},toggle:function(){this.isVisible()?this.hide():this.show()}}),e.exports=o},function(e,t,n){var i=["seconds","minutes","hours","days","months","years"],a=n(0),s=[1,60,3600,86400,2592e3,31536e3];function o(e){for(var t=0;t<s.length&&e>s[t+1];)++t;return{value:Math.round(e/s[t]),unit:i[t]}}function r(e){return o(Math.round((new Date).getTime()/1e3)-e)}function l(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,n,i){var s,o,c=[];return n=n||"unknown",l(s=r(e))?c.push("mobile-frontend-last-modified-with-user-just-now",n,t):c.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[s.unit],n,t,mw.language.convertNumber(s.value)),c.push(i||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),o=mw.message.apply(this,c).parse(),i?o:a.parseHTML("<div>").html(o).text()},getRegistrationMessage:function(e,t){var n,i=[];return t=t||"unknown",l(n=r(parseInt(e,10)))?i.push("mobile-frontend-joined-just-now",t):i.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[n.unit],t,mw.language.convertNumber(n.value)),mw.message.apply(this,i).parse()},timeAgo:o,getTimeAgoDelta:r,isNow:l,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},function(e,t,n){var i=n(1),a=n(9),s=n(2);function o(e){var t=this;e.tag="h"+e.level,this.line=e.line,this.text=e.text,this.hasReferences=e.hasReferences||!1,this.id=e.id||null,this.anchor=e.anchor,this.subsections=[],(e.subsections||[]).forEach(function(e){t.subsections.push(new o(e))}),s.call(this,e)}i(o,s,{template:mw.template.get("mobile.startup","Section.hogan"),defaults:{line:void 0,text:"",spinner:a.spinner().toHtmlString()}}),e.exports=o},function(e,t,n){var i=mw.log,a=n(0);e.exports={getDir:function(e){var t=["aeb","aeb-arab","ar","arc","arq","arz","azb","bcc","bgn","bqi","ckb","dv","fa","glk","he","khw","kk-arab","kk-cn","ks","ks-arab","ku-arab","lki","lrc","luz","mzn","pnb","ps","sd","sdh","skr","skr-arab","ug","ug-arab","ur","yi"].indexOf(e.lang)>-1?"rtl":"ltr";return a.extend({},e,{dir:t})},getStructuredLanguages:function(e,t,n,a){var s=Object.prototype.hasOwnProperty,o=0,r=0,l=0,c=[],u=[],d=this;function h(e){return e.dir?e:(l++,d.getDir(e))}return(a=function(e,t){var n,i,a=Object.prototype.hasOwnProperty,s={};if(t)return-1!==(i=t.indexOf("-"))&&(n=t.slice(0,i)),e.forEach(function(e){e.lang!==n&&e.lang!==t||(s[e.lang]=!0)}),a.call(s,t)?t:a.call(s,n)?n:void 0}(e,a))&&(Object.keys(n).forEach(function(e){var t=n[e];o=o<t?t:o,r=r>t?t:r}),n[a]=o+1),e.map(h).forEach(function(e){s.call(n,e.lang)?(e.frequency=n[e.lang],c.push(e)):u.push(e)}),t&&t.map(h).forEach(function(e){s.call(n,e.lang)?e.frequency=n[e.lang]:e.frequency=r-1,c.push(e)}),c=c.sort(function(e,t){return t.frequency-e.frequency}),u=u.sort(function(e,t){return e.autonym.toLocaleLowerCase()<t.autonym.toLocaleLowerCase()?-1:1}),i.warn(0===l?"Direction is provided. Please remove handling in getStructuredLanguages":"`dir` attribute was missing from languages. Is T74153 resolved?"),{suggested:c,all:u}},getFrequentlyUsedLanguages:function(){var e=mw.storage.get("langMap");return e?JSON.parse(e):{}},saveFrequentlyUsedLanguages:function(e){mw.storage.set("langMap",JSON.stringify(e))},saveLanguageUsageCount:function(e,t){var n=t[e]||0;n+=1,t[e]=n>100?100:n,this.saveFrequentlyUsedLanguages(t)}}},function(e,t){function n(){this._cache={}}function i(){}n.prototype.get=function(e){return this._cache[e]},n.prototype.set=function(e,t){this._cache[e]=t},i.prototype.get=function(){},i.prototype.set=function(){},e.exports={MemoryCache:n,NoCache:i}},function(e,t,n){var i=n(1),a=n(16),s=n(0),o=n(13),r=n(14);function l(e){a.call(this,e)}function c(e,t){return s.extend({returnto:t||mw.config.get("wgPageName")},e)}function u(){return[].push.call(arguments,{type:"signup"}),s.extend.apply(s,arguments)}i(l,a,{defaults:s.extend({},a.prototype.defaults,{progressiveButton:new o({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,actionAnchor:new r({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options}),templatePartials:s.extend({},a.prototype.templatePartials,{button:o.prototype.template,anchor:r.prototype.template}),template:mw.template.get("mobile.startup","CtaDrawer.hogan"),preRender:function(){var e=c(this.options.queryParams,this.options.returnTo);this.options.progressiveButton.href||(this.options.progressiveButton.href=mw.util.getUrl("Special:UserLogin",e)),this.options.actionAnchor.href||(this.options.actionAnchor.href=mw.util.getUrl("Special:UserLogin",u(e,this.options.signupQueryParams)))}}),l.prototype.test={redirectParams:c,signUpParams:u},e.exports=l},function(e,t,n){var i=n(0);e.exports=function(e){var t,n,a=mw.config.get("wgMFDisplayWikibaseDescriptions",{});if(!Object.prototype.hasOwnProperty.call(a,e))throw new Error('"'+e+"\" isn't a feature that shows Wikibase descriptions.");return(t=Array.prototype.slice.call(arguments,1)).unshift({prop:[]}),t.push(mw.config.get("wgMFSearchAPIParams")),(n=i.extend.apply({},t)).prop=n.prop.concat(mw.config.get("wgMFQueryPropModules")),a[e]&&-1===n.prop.indexOf("description")&&n.prop.push("description"),n}},function(e,t,n){var i=n(31);i.Template=n(32).Template,e.exports=i},function(e,t,n){var i=n(1),a=n(0),s=n(2);function o(e){s.call(this,a.extend({isBorderBox:!1},e))}i(o,s,{defaults:{filename:void 0},postRender:function(){this.options.description=this.$el.siblings(".thumbcaption").text()},getDescription:function(){return this.options.description},getFileName:function(){return this.options.filename}}),e.exports=o},function(e,t,n){var i=n(9),a=n(12);e.exports=function(){var e=new a({className:"overlay overlay-loading",noHeader:!0});return i.spinner().$el.appendTo(e.$(".overlay-content")),e}},,function(e,t,n){var i=n(12),a=n(0),s=n(20);function o(e){var t;t=s.getStructuredLanguages(e.languages,e.variants,s.getFrequentlyUsedLanguages(),e.deviceLanguage),e.allLanguages=t.all,e.allLanguagesCount=t.all.length,e.suggestedLanguages=t.suggested,e.suggestedLanguagesCount=t.suggested.length,i.call(this,a.extend(e,{className:"overlay language-overlay"}))}n(1)(o,i,{defaults:a.extend({},i.prototype.defaults,{heading:mw.msg("mobile-frontend-language-heading"),inputPlaceholder:mw.msg("mobile-frontend-languages-structured-overlay-search-input-placeholder"),allLanguagesHeader:mw.msg("mobile-frontend-languages-structured-overlay-all-languages-header").toLocaleUpperCase(),suggestedLanguagesHeader:mw.msg("mobile-frontend-languages-structured-overlay-suggested-languages-header").toLocaleUpperCase()}),templatePartials:a.extend({},i.prototype.templatePartials,{content:mw.template.get("mobile.languages.structured","LanguageOverlay.hogan")}),events:a.extend({},i.prototype.events,{"click a":"onLinkClick","input .search":"onSearchInput"}),postRender:function(){i.prototype.postRender.apply(this),this.$siteLinksList=this.$(".site-link-list"),this.$languageItems=this.$siteLinksList.find("a"),this.$subheaders=this.$("h3")},onLinkClick:function(e){var t=this.$(e.currentTarget).attr("lang"),n=this,i=this.$languageItems.filter(":visible");s.saveLanguageUsageCount(t,s.getFrequentlyUsedLanguages()),i.each(function(e,i){if(n.$(i).hasClass(t))return!1})},onSearchInput:function(e){this.filterLanguages(this.$(e.target).val().toLowerCase())},filterLanguages:function(e){var t=[];e?(this.options.languages.forEach(function(n){var i=n.langname;(n.autonym.toLowerCase().indexOf(e)>-1||i&&i.toLowerCase().indexOf(e)>-1||n.lang.toLowerCase().indexOf(e)>-1)&&t.push(n.lang)}),this.options.variants&&this.options.variants.forEach(function(n){(n.autonym.toLowerCase().indexOf(e)>-1||n.lang.toLowerCase().indexOf(e)>-1)&&t.push(n.lang)}),this.$languageItems.addClass("hidden"),t.length&&this.$siteLinksList.find("."+t.join(",.")).removeClass("hidden"),this.$siteLinksList.addClass("filtered"),this.$subheaders.addClass("hidden")):(this.$languageItems.removeClass("hidden"),this.$siteLinksList.removeClass("filtered"),this.$subheaders.removeClass("hidden"))}}),e.exports=o},function(e,t){e.exports={getMode:function(){return mw.config.get("wgMFMode")}}},function(e,t){function n(){this._register={}}n.prototype={require:function(e){var t,n,i=this._register;function a(){if(!Object.hasOwnProperty.call(i,e))throw new Error("MobileFrontend Module not found: "+e);return i[e]}n=e.split("/");try{return(t=mw.loader.require(n[0]))[n[1]]?t[n[1]]:a()}catch(e){return a()}},define:function(e,t){var n=this;if(Object.hasOwnProperty.call(this._register,e))throw new Error("Module already exists: "+e);return this._register[e]=t,{deprecate:function(i){n.deprecate(i,t,e)}}},deprecate:function(e,t,n){var i;n&&(i="Use "+n+" instead."),mw.log.deprecate(this._register,e,t,i)}},e.exports=n},function(e,t,n){!function(e){var t=/\S/,n=/\"/g,i=/\n/g,a=/\r/g,s=/\\/g,o={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};function r(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function l(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function c(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var i=1,a=e.length;i<a;i++)if(t.charAt(n+i)!=e.charAt(i))return!1;return!0}function u(e,t){for(var n=0,i=t.length;n<i;n++)if(t[n].o==e.n)return e.tag="#",!0}function d(e,t,n){for(var i=0,a=n.length;i<a;i++)if(n[i].c==e&&n[i].o==t)return!0}function h(e){return e.replace(s,"\\\\").replace(n,'\\"').replace(i,"\\n").replace(a,"\\r")}function p(e){return~e.indexOf(".")?"d":"f"}function g(e){for(var t="",n=0,i=e.length;n<i;n++){var a=e[n].tag;"#"==a?t+=f(e[n].nodes,e[n].n,p(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag):"^"==a?t+=m(e[n].nodes,e[n].n,p(e[n].n)):"<"==a||">"==a?t+=v(e[n]):"{"==a||"&"==a?t+=w(e[n].n,p(e[n].n)):"\n"==a?t+=y('"\\n"'+(e.length-1==n?"":" + i")):"_v"==a?t+=b(e[n].n,p(e[n].n)):void 0===a&&(t+=y('"'+h(e[n])+'"'))}return t}function f(e,t,n,i,a,s){return"if(_.s(_."+n+'("'+h(t)+'",c,p,1),c,p,0,'+i+","+a+',"'+s+'")){_.rs(c,p,function(c,p,_){'+g(e)+"});c.pop();}"}function m(e,t,n){return"if(!_.s(_."+n+'("'+h(t)+'",c,p,1),c,p,1,0,0,"")){'+g(e)+"};"}function v(e){return'_.b(_.rp("'+h(e.n)+'",c,p,"'+(e.indent||"")+'"));'}function w(e,t){return"_.b(_.t(_."+t+'("'+h(e)+'",c,p,0)));'}function b(e,t){return"_.b(_.v(_."+t+'("'+h(e)+'",c,p,0)));'}function y(e){return"_.b("+e+");"}e.scan=function(e,n){var i=e.length,a=0,s=null,u=null,d="",h=[],p=!1,g=0,f=0,m="{{",v="}}";function w(){d.length>0&&(h.push(new String(d)),d="")}function b(e,n){if(w(),e&&function(){for(var e=!0,n=f;n<h.length;n++)if(!(e=h[n].tag&&o[h[n].tag]<o._v||!h[n].tag&&null===h[n].match(t)))return!1;return e}())for(var i,a=f;a<h.length;a++)h[a].tag||((i=h[a+1])&&">"==i.tag&&(i.indent=h[a].toString()),h.splice(a,1));else n||h.push({tag:"\n"});p=!1,f=h.length}function y(e,t){var n="="+v,i=e.indexOf(n,t),a=l(e.substring(e.indexOf("=",t)+1,i)).split(" ");return m=a[0],v=a[1],i+n.length-1}for(n&&(n=n.split(" "),m=n[0],v=n[1]),g=0;g<i;g++)0==a?c(m,e,g)?(--g,w(),a=1):"\n"==e.charAt(g)?b(p):d+=e.charAt(g):1==a?(g+=m.length-1,"="==(s=(u=o[e.charAt(g+1)])?e.charAt(g+1):"_v")?(g=y(e,g),a=0):(u&&g++,a=2),p=g):c(v,e,g)?(h.push({tag:s,n:l(d),otag:m,ctag:v,i:"/"==s?p-v.length:g+m.length}),d="",g+=v.length-1,a=0,"{"==s&&("}}"==v?g++:r(h[h.length-1]))):d+=e.charAt(g);return b(p,!0),h},e.generate=function(t,n,i){var a='var _=this;_.b(i=i||"");'+g(t)+"return _.fl();";return i.asString?"function(c,p,i){"+a+";}":new e.Template(new Function("c","p","i",a),n,e,i)},e.parse=function(e,t,n){return function e(t,n,i,a){for(var s=[],o=null,r=null;t.length>0;)if("#"==(r=t.shift()).tag||"^"==r.tag||u(r,a))i.push(r),r.nodes=e(t,r.tag,i,a),s.push(r);else{if("/"==r.tag){if(0===i.length)throw new Error("Closing tag without opener: /"+r.n);if(o=i.pop(),r.n!=o.n&&!d(r.n,o.n,a))throw new Error("Nesting error: "+o.n+" vs. "+r.n);return o.end=r.i,s}s.push(r)}if(i.length>0)throw new Error("missing closing tag: "+i.pop().n);return s}(e,0,[],(n=n||{}).sectionTags||[])},e.cache={},e.compile=function(e,t){var n=e+"||"+!!(t=t||{}).asString,i=this.cache[n];return i||(i=this.generate(this.parse(this.scan(e,t.delimiters),e,t),e,t),this.cache[n]=i)}}(t)},function(e,t,n){!function(e,t){e.Template=function(e,t,n,i){this.r=e||this.r,this.c=n,this.options=i,this.text=t||"",this.buf=""},e.Template.prototype={r:function(e,t,n){return""},v:function(e){return e=l(e),r.test(e)?e.replace(n,"&amp;").replace(i,"&lt;").replace(a,"&gt;").replace(s,"&#39;").replace(o,"&quot;"):e},t:l,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,i){var a=n[e];return a?(this.c&&"string"==typeof a&&(a=this.c.compile(a,this.options)),a.ri(t,n,i)):""},rs:function(e,t,n){var i=e[e.length-1];if(c(i))for(var a=0;a<i.length;a++)e.push(i[a]),n(e,t,this),e.pop();else n(e,t,this)},s:function(e,t,n,i,a,s,o){var r;return(!c(e)||0!==e.length)&&("function"==typeof e&&(e=this.ls(e,t,n,i,a,s,o)),r=""===e||!!e,!i&&r&&t&&t.push("object"==typeof e?e:t[t.length-1]),r)},d:function(e,t,n,i){var a=e.split("."),s=this.f(a[0],t,n,i),o=null;if("."===e&&c(t[t.length-2]))return t[t.length-1];for(var r=1;r<a.length;r++)s&&"object"==typeof s&&a[r]in s?(o=s,s=s[a[r]]):s="";return!(i&&!s)&&(i||"function"!=typeof s||(t.push(o),s=this.lv(s,t,n),t.pop()),s)},f:function(e,t,n,i){for(var a=!1,s=null,o=!1,r=t.length-1;r>=0;r--)if((s=t[r])&&"object"==typeof s&&e in s){a=s[e],o=!0;break}return o?(i||"function"!=typeof a||(a=this.lv(a,t,n)),a):!i&&""},ho:function(e,t,n,i,a){var s=this.c,o=this.options;return o.delimiters=a,i=null==(i=e.call(t,i))?String(i):i.toString(),this.b(s.compile(i,o).render(t,n)),!1},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,n,i,a,s,o){var r,l=t[t.length-1];if(!i&&this.c&&e.length>0)return this.ho(e,l,n,this.text.substring(a,s),o);if("function"==typeof(r=e.call(l))){if(i)return!0;if(this.c)return this.ho(r,l,n,this.text.substring(a,s),o)}return r},lv:function(e,t,n){var i=t[t.length-1],a=e.call(i);return"function"==typeof a&&(a=l(a.call(i)),this.c&&~a.indexOf("{{"))?this.c.compile(a,this.options).render(i,n):l(a)}};var n=/&/g,i=/</g,a=/>/g,s=/\'/g,o=/\"/g,r=/[&<>\"\']/;function l(e){return String(null===e||void 0===e?"":e)}var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}(t)},function(e,t,n){var i=n(0),a=null;function s(e){e.on("route",this._checkRoute.bind(this)),this.router=e,this.entries={},this.stack=[],this.hideCurrent=!0}n(1)(s,{_onHideOverlay:function(){this.hideCurrent=!1,this.router.back()},_showOverlay:function(e){e.once("_om_hide",this._onHideOverlay.bind(this)),e.show()},_hideOverlay:function(e){var t;return e.off("_om_hide"),(t=e.hide(this.stack.length>1))||e.once("_om_hide",this._onHideOverlay.bind(this)),t},_processMatch:function(e){var t,n=this;function i(e){e.on("hide",function(){e.emit("_om_hide")})}e&&(e.overlay?n._showOverlay(e.overlay):"function"==typeof(t=e.factoryResult).promise?t.then(function(t){e.overlay=t,i(t),n._showOverlay(t)}):(e.overlay=t,i(e.overlay),n._showOverlay(t)))},_checkRoute:function(e){var t,n=this.stack[0];n||(this.scrollTop=window.pageYOffset),t=Object.keys(this.entries).reduce(function(t,n){return t||this._matchRoute(e.path,this.entries[n])}.bind(this),null),n&&void 0!==n.overlay&&this.hideCurrent&&!this._hideOverlay(n.overlay)?e.preventDefault():t||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(t)},_matchRoute:function(e,t){var n,i=e.match(t.route),a=this.stack[1],s=this;function o(){return{path:e,factoryResult:t.factory.apply(s,i.slice(1))}}return i?a&&a.path===e?a.overlay&&a.overlay.hasLoadError?(s.stack.shift(),s.stack[0]=o(),s.stack[0]):(s.stack.shift(),a):(n=o(),this.stack[0]&&n.path===this.stack[0].path?s.stack[0]=n:s.stack.unshift(n),n):null},add:function(e,t){var n=this,a={route:e,factory:t};this.entries[e]=a,i.docReady(function(){n._processMatch(n._matchRoute(n.router.getPath(),a))})},replaceCurrent:function(e){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");this._hideOverlay(this.stack[0].overlay),this.stack[0].overlay=e,this._showOverlay(e)}}),s.getSingleton=function(){return a||(a=new s(mw.loader.require("mediawiki.router"))),a},e.exports=s},function(e,t,n){var i=mw.template.get("mobile.startup","Section.hogan"),a=n(0),s={};function o(e){var t,n=e.map(function(e){return e.level}).filter(function(e){return!!e}),a=Math.min.apply(this,n).toString(),s=[];return e.forEach(function(e){void 0!==e.line&&(e.line=e.line.replace(/<\/?a\b[^>]*>/g,"")),e.subsections=[],!t||!e.level||e.level===a||t.subsections.length&&t.subsections[0].level>e.level||t.level&&t.level>=e.level?(s.push(e),t=e):(!function e(t,n){var i;0===t.length?t.push(n):(i=t[t.length-1],parseInt(i.level,10)===parseInt(n.level,10)?t.push(n):e(i.subsections,n))}(t.subsections,e),t.text+=i.render(e))}),s}function r(e){this.api=e}r.prototype={getPage:function(e,t,n){var i,r=a.Deferred(),l=t?{url:t,dataType:"jsonp"}:{},c={edit:["*"]};return s[e]||(s[e]=this.api.get({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:n?0:"all"},l).then(function(t){var n,s,l,u;return t.error?r.reject(t.error):t.mobileview.sections?(n=o((u=t.mobileview).sections),i=new Date(u.lastmodified).getTime()/1e3,s=u.lastmodifiedby,c=Array.isArray(u.protection)?c:a.extend(c,u.protection),l={title:e,id:u.id,revId:u.revId,protection:c,lead:n[0].text,sections:n.slice(1),isMainPage:void 0!==u.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:i,languageCount:u.languagecount,hasVariants:void 0!==u.hasvariants,displayTitle:u.displaytitle},s&&a.extend(l,{lastModifiedUserName:s.name,lastModifiedUserGender:s.gender}),l):r.reject("No sections")},function(e){return r.reject(e)})),s[e]},invalidatePage:function(e){delete s[e]},_getLanguageVariantsFromApiResponse:function(e,t){var n=t.query.general,i=n.variantarticlepath,a=[];return!!n.variants&&(Object.keys(n.variants).forEach(function(t){var s=n.variants[t],o={autonym:s.name,lang:s.code};o.url=i?i.replace("$1",e).replace("$2",s.code):mw.util.getUrl(e,{variant:s.code}),a.push(o)}),a)},getPageLanguages:function(e,t){var n=this,i={action:"query",meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e,formatversion:2};return t?(i.llprop="url|autonym|langname",i.llinlanguagecode=t):i.llprop="url|autonym",this.api.get(i).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:n._getLanguageVariantsFromApiResponse(e,t)}},function(){return a.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var n=this.tagName.substr(1),i=e.find(this).find(".mw-headline");i.length&&t.push({level:n,line:i.html(),anchor:i.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return o(this._getAPIResponseFromHTML(e))}},e.exports=r},function(e,t,n){var i=n(26),a=n(0);e.exports={newLoadingOverlay:function(){return i()},loadModule:function(e,t,n){var i=this.newLoadingOverlay();function s(){!t&&n&&i.hide()}return(n=void 0===n||n)&&i.show(),mw.loader.using(e).then(function(){return s(),i},function(){return s(),a.Deferred().reject().promise()})}}},function(e,t,n){var i=n(11).getSingleton(),a=n(2),s=n(0),o=n(15),r=s.Deferred,l=s.when,c=n(9),u=mw.viewport,d=c.spinner();function h(e){var t,n=o.HEADING_SELECTOR,i=e.parent(),a=e.prevAll(n).eq(0);return a.length&&(t=a.find(".mw-headline").attr("id"))?t:i.length?h(i):null}function p(e){var t=this,n=s.extend({},e);this.page=n.page,this.name=n.name,n.mainMenu&&(this.mainMenu=n.mainMenu,mw.log.warn("Skin: Use of mainMenu is deprecated.")),this.eventBus=n.eventBus,n.isBorderBox=!1,a.call(this,n),this.referencesGateway=n.referencesGateway,mw.config.get("wgMFLazyLoadImages")&&s.docReady(function(){t.setupImageLoading()}),mw.config.get("wgMFLazyLoadReferences")&&this.eventBus.on("before-section-toggled",this.lazyLoadReferences.bind(this))}n(1)(p,a,{defaults:{page:void 0},events:{},postRender:function(){var e=this.$el;i.supportsAnimations()&&e.addClass("animations"),i.supportsTouchEvents()&&e.addClass("touch-events"),s.parseHTML('<div class="transparent-shield cloaked-element">').appendTo(e.find("#mw-mf-page-center")),this.emit("changed"),this.$("#mw-mf-page-center").on("click",this.emit.bind(this,"click"))},getUnloadedImages:function(e){return(e=e||this.$("#content")).find(".lazy-image-placeholder").toArray()},setupImageLoading:function(e){var t=this,n=1.5*s.getWindow().height(),i=this.loadImagesList.bind(this),a=this.getUnloadedImages(e);function o(){var e=[];return(a=s.grep(a,function(i){var a=t.$(i);return!a.length||!function(e){return u.isElementCloseToViewport(e[0],n)&&(e.is(":visible")||0===e.height())}(a)||(e.push(i),!1)})).length||(t.eventBus.off("scroll:throttled",o),t.eventBus.off("resize:throttled",o),t.eventBus.off("section-toggled",o),t.off("changed",o)),i(e)}return this.eventBus.on("scroll:throttled",o),this.eventBus.on("resize:throttled",o),this.eventBus.on("section-toggled",o),this.on("changed",o),o()},loadImagesList:function(e){var t,n=this.$.bind(this),i=this.loadImage.bind(this);return t=(e=e||this.getUnloadedImages()).map(function(e){return i(n(e))}),l.apply(null,t)},loadImage:function(e){var t=r(),n=e.attr("data-width"),i=e.attr("data-height"),a=s.parseHTML("<img>",this.$el[0].ownerDocument);return a.on("load",function(){a.addClass("image-lazy-loaded"),e.replaceWith(a),t.resolve()}),a.on("error",function(){t.reject()}),a.attr({class:e.attr("data-class"),width:n,height:i,src:e.attr("data-src"),alt:e.attr("data-alt"),style:e.attr("style"),srcset:e.attr("data-srcset")}),t},lazyLoadReferences:function(e){var t,n,i=this.referencesGateway,a=this.getUnloadedImages.bind(this),s=this.loadImagesList.bind(this),o=this;if(!e.wasExpanded&&e.isReferenceSection)return(t=e.$heading.next()).data("are-references-loaded")?r().reject().promise():(t.children().addClass("hidden"),n=d.$el.prependTo(t),i.getReferencesLists(e.page).then(function(){var a;t.find(".mf-lazy-references-placeholder").each(function(){var n=0,s=t.find(this),o=h(s);a!==o?(n=0,a=o):n++,o&&i.getReferencesList(e.page,o).then(function(e){e&&e[n]&&s.replaceWith(e[n])})}),n.remove(),t.children().removeClass("hidden"),o.emit("references-loaded",o.page),l()},function(){n.remove(),t.children().removeClass("hidden"),l()}));function l(){s(a(t)),t.data("are-references-loaded",1)}},getLicenseMsg:function(){var e,t=mw.config.get("wgMFLicense"),n=mw.language.convertNumber(t.plural);return t.link&&(e=this.$("#footer-places-terms-use").length>0?mw.msg("mobile-frontend-editor-licensing-with-terms",mw.message("mobile-frontend-editor-terms-link",this.$("#footer-places-terms-use a").attr("href")).parse(),t.link,n):mw.msg("mobile-frontend-editor-licensing",t.link,n)),e}}),p.getSectionId=h,e.exports=p},function(e,t,n){var i=n(11).getSingleton(),a=n(0),s=a.escapeHash,o={name:"arrow",additionalClassNames:"indicator"},r=n(10);function l(e){this.eventBus=e.eventBus,this._enable(e.$container,e.prefix,e.page,e.isClosed)}function c(e){var t=JSON.parse(mw.storage.get("expandedSections")||"{}");return t[e.title]=t[e.title]||{},t}function u(e){mw.storage.set("expandedSections",JSON.stringify(e))}function d(e,t,n){var i,a,s=c(n);t.find(".section-heading span").each(function(){a=t.find(this),i=a.parents(".section-heading"),s[n.title][a.attr("id")]&&!i.hasClass("open-block")&&e.toggle(i,n)})}function h(e){var t=(new Date).getTime(),n=c(e);Object.keys(n).forEach(function(e){var i=n[e];Object.keys(i).forEach(function(a){var s=i[a];Math.floor((t-s)/1e3/60/60/24)>=1&&delete n[e][a]})}),u(n)}l.prototype.toggle=function(e){var t,n=e.is(".open-block"),a=e.data("page"),s=e.data("section-number"),l=e.next();e.toggleClass("open-block"),e.data("indicator").remove(),o.rotation=n?0:180,t=new r(o).prependTo(e),e.data("indicator",t),this.eventBus.emit("before-section-toggled",{page:a,wasExpanded:n,$heading:e,isReferenceSection:Boolean(l.attr("data-is-reference-section"))}),l.toggleClass("open-block").attr({"aria-pressed":!n,"aria-expanded":!n}),this.eventBus.emit("section-toggled",n,s),i.isWideScreen()||function(e,t){var n=e.find("span").attr("id"),i=e.hasClass("open-block"),a=c(t);n&&(i?a[t.title][n]=(new Date).getTime():delete a[t.title][n],u(a))}(e,a)},l.prototype.reveal=function(e,t){var n,i;try{(i=(n=t.find(s(e))).parents(".collapsible-heading")).length||(i=n.parents(".collapsible-block").prev(".collapsible-heading")),i.length&&!i.hasClass("open-block")&&this.toggle(i),i.length&&window.scrollTo(0,n.offset().top)}catch(e){}},l.prototype._enable=function(e,t,n,s){var l,c,u,p,g,f=this,m=mw.config.get("wgMFCollapseSectionsByDefault");function v(){var t=window.location.hash;0===t.indexOf("#")&&f.reveal(t,e)}l=e.find("> h1,> h2,> h3,> h4,> h5,> h6,.section-heading").eq(0).prop("tagName")||"H1",void 0===m&&(m=!0),c=!m||mw.config.get("wgMFExpandAllSectionsUserOption")&&"true"===mw.storage.get("expandSections"),e.children(l).each(function(a){var l,d=e.find(this),h=d.find(".indicator"),g=t+"collapsible-block-"+a;d.next().is("div")&&(p=d.next("div"),l=Boolean(p.attr("data-is-reference-section")),d.addClass("collapsible-heading ").data("section-number",a).data("page",n).attr({tabindex:0,"aria-haspopup":"true","aria-controls":g}).on("click",function(e){e.target.href||(e.preventDefault(),f.toggle(d))}),o.rotation=c?180:0,u=new r(o),h.length?h.replaceWith(u.$el):u.prependTo(d),d.data("indicator",u.$el),p.addClass("collapsible-block").eq(0).attr({id:g,"aria-pressed":"false","aria-expanded":"false"}),function(e,t){t.on("keypress",function(n){13!==n.which&&32!==n.which||e.toggle(t)}).find("a").on("keypress mouseup",function(e){e.stopPropagation()})}(f,d),!l&&(!s&&i.isWideScreen()||c)&&f.toggle(d))}),function(){var t=mw.config.get("wgInternalRedirectTargetUrl"),n=!!t&&t.split("#")[1];n&&(window.location.hash=n,f.reveal(n,e))}(),v(),(g=e.find("a:not(.reference a)")).on("click",function(){void 0!==g.attr("href")&&g.attr("href").indexOf("#")>-1&&v()}),a.getWindow().on("hashchange",function(){v()}),!i.isWideScreen()&&n&&(d(this,e,n),h(n))},l._getExpandedSections=c,l._expandStoredSections=d,l._cleanObsoleteStoredSections=h,e.exports=l},function(e,t){!function(){e.exports=this.jquery}()},function(e,t){e.exports={defaultURLs:'\n\t\t<div class=" drawer position-fixed view-border-box ">\n\t\t\t<div\n\t\t\t\tclass=" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel "\n\t\t\t\ttitle=""\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=" logIn " class=" mw-ui-button mw-ui-progressive ">\n\t\t\t\tLog in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=" signUp " class=" mw-ui-anchor mw-ui-progressive ">\n\t\t\t\t\tSign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t',overrideURLs:'\n\t\t<div class=" drawer position-fixed view-border-box ">\n\t\t\t<div\n\t\t\t\tclass=" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel "\n\t\t\t\ttitle=""\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=" customLogIn " class=" mw-ui-button mw-ui-progressive ">\n\t\t\t\tcustom log in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=" customSignUp " class=" mw-ui-anchor mw-ui-progressive ">\n\t\t\t\t\tcustom sign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t'}},function(e,t){var n,i,a,s,o;n='<div>\n\t<h1><span class="mw-headline" id="1.0">A1</span></h1>\n\t<h2><span class="mw-headline">A2.1</span></h2>\n\t<h2><span class="mw-headline">A2.2</span></h2>\n\t<h1><span class="mw-headline">A2</span></h1>\n\t<h2><span class="mw-headline">A2.1</span><span>[<a href="#">edit</a>]</span></h2>\n\t<h1>Not to be shown in the TOC<span class="placeholder"></span></h1>\n</div>',i='<div>\n<h2><span class="mw-headline" id="1.0">A1</span></h2>\n<h3><span class="mw-headline">A2.1</span></h3>\n<h2><span class="mw-headline">A2.2</span></h2>\n<h1><span class="mw-headline">A2</span></h1>\n<h2><span class="mw-headline">A2.1</span></h2>\n</div>',a='<div id="mw-content-text">\n\t<h2 class="section-heading collapsible-heading open-block">\n\t\t<span class="mw-headline" id="Notes_and_references">Notes and references</span>\n\t</h2>\n\t<div class="mf-section-2 collapsible-block open-block" data-is-reference-section="1">\n\t\t<p>Text</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<h3><span class="mw-headline" id="Notes">Notes</span></h3>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<h4 class="in-block"><span class="mw-headline" id="Refs">Refs</span></h4>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>no forget</p>\n\t\t<h5 class="in-block"><span class="mw-headline" id="More_refs">More refs</span></h5>\n\t\t<p>1</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>2</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>3</p>\n\t</div>\n</div>',s='<div id="mfe-test-references">\n<sup id="cite_ref-1" class="reference">\n\t<a href="#cite_note-1">[1]</a>\n</sup>\n<p>\n\tsup with encoded href attribute\n\t<sup id="cite_ref-Obama_1995,_2004,_pp._9–10_11-0" class="reference">\n\t\t<a href="#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11">[11]</a>\n\t</sup>\n</p>\n<ol class="references">\n\t<li id="cite_note-1">\n\t\t<span class="mw-cite-backlink">\n\t\t\t<a href="#cite_ref-1">↑</a>\n\t\t</span> <span class="reference-text">hello</span>\n\t</li>\n\t<li id="cite_note-Obama_1995,_2004,_pp._9–10-11">\n\t\t<span class="mw-cite-backlink">\n\t\t\t<a href="#cite_ref-1">↑</a>\n\t\t</span> <span class="reference-text">found</span>\n\t</li>\n</ol>\n</div>',o='<div>\n<h2><span class="mw-headline" id="1.0">A1</span></h1>\n<div>text</div>\n<h2>references</h2>\n<div>\n\t<a class="mf-lazy-references-placeholder">View citations</a>\n</div>\n</div>',e.exports={lazyLoadedReferencesPage:o,referencesPage:s,skinPage:a,page:n,page2:i}},,,,,,,function(e,t,n){n(48),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63),n(64),n(65),n(66),n(68),n(69),n(70),n(71),n(72),n(73),n(74),e.exports=n(75)},function(e,t,n){(function(e){var t,i,a=n(5),s=n(6),o=n(7),r=n(8),l=n(4),c=[{lang:"ar",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7",title:"باراك أوباما",autonym:"العربية"},{lang:"be",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",autonym:"беларуская"},{lang:"be-x-old",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",autonym:"беларуская (тарашкевіца)"},{lang:"ko",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88",title:"버락 오바마",autonym:"한국어"},{lang:"ru",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA",title:"Обама, Барак",autonym:"русский"},{lang:"uz",url:"https://uz.wikipedia.org/wiki/Barak_Obama",title:"Barak Obama",autonym:"oʻzbekcha/ўзбекча"},{lang:"zh",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC",title:"贝拉克·奥巴马",autonym:"中文"},{lang:"zh-min-nan",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",langname:"Chinese",autonym:"Bân-lâm-gú"},{lang:"zh-yue",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC",title:"奧巴馬",autonym:"粵語"},{lang:"zu",url:"https://zu.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",autonym:"isiZulu"}],u={"zh-min-nan":1,zh:2,en:10,ko:1};QUnit.module("MobileFrontend LanguageOverlay.js",{beforeEach:function(){i=l.sandbox.create(),s.setUp(i,e),a.setUp(i,e),r.setUp(i,e),o.setUp(i,e),t=n(28),i.stub(mw.storage,"get").withArgs("langMap").returns(JSON.stringify(u)),this.languageOverlay=new t({currentLanguage:"en",languages:c,variants:[],deviceLanguage:"en-us"})},afterEach:function(){a.tearDown(),i.restore()}}),QUnit.test("render output",function(e){e.strictEqual(this.languageOverlay.$(".site-link-list.suggested-languages a").length,3,"There are 3 suggested languages."),e.strictEqual(this.languageOverlay.$(".site-link-list.all-languages a").length,7,"Seven languages are non-suggested.")}),QUnit.test("filterLanguages()",function(e){this.languageOverlay.filterLanguages("zh"),e.strictEqual(this.languageOverlay.$(".site-link-list a:not(.hidden)").length,3,'Three languages match "zh" and only those languages are visible.'),this.languageOverlay.filterLanguages("ol"),e.ok(1===this.languageOverlay.$(".site-link-list a:not(.hidden)").length&&this.languageOverlay.$(".site-link-list a:not(.hidden)").hasClass("be-x-old"),'One language (be-x-old) matches "ol" and only that language is visible.'),this.languageOverlay.filterLanguages("chin"),e.ok(1===this.languageOverlay.$(".site-link-list a:not(.hidden)").length&&this.languageOverlay.$(".site-link-list a:not(.hidden)").hasClass("zh-min-nan"),'One language (zh-min-nan) matches "Chin" (langname) and only that language is visible.'),this.languageOverlay.filterLanguages(""),e.strictEqual(this.languageOverlay.$(".site-link-list a:not(.hidden)").length,10,"The search filter has been cleared. All 10 languages (including variants) are visible."),this.languageOverlay.filterLanguages("ўз"),e.strictEqual(this.languageOverlay.$(".site-link-list a:not(.hidden)").length,1,'One language matches "ўз" and only that language is visible.')})}).call(this,n(3))},function(e,t){!function(){e.exports=this.jsdom}()},function(e){e.exports={}},function(e,t){!function(){e.exports=this.oojs}()},function(e,t,n){(function(e){var t,i,a=n(5),s=n(6),o=n(7),r=n(4);QUnit.module("MobileFrontend mobile.languages.structured/util.test.js",{beforeEach:function(){this.apiLanguages=[{lang:"ar",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7",title:"باراك أوباما",dir:"rtl",autonym:"العربية"},{lang:"be",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",dir:"ltr",autonym:"беларуская"},{lang:"be-x-old",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:"Барак Абама",autonym:"беларуская (тарашкевіца)"},{lang:"es",url:"https://en.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"Spanish"},{lang:"ko",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88",title:"버락 오바마",dir:"ltr",autonym:"한국어"},{lang:"ru",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA",title:"Обама, Барак",dir:"ltr",autonym:"русский"},{lang:"uz",url:"https://uz.wikipedia.org/wiki/Barak_Obama",title:"Barak Obama",dir:"ltr",autonym:"oʻzbekcha/ўзбекча"},{lang:"zh",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC",title:"贝拉克·奥巴马",dir:"ltr",autonym:"中文"},{lang:"zh-min-nan",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"Bân-lâm-gú"},{lang:"zh-yue",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC",title:"奧巴馬",dir:"ltr",autonym:"粵語"},{lang:"zu",url:"https://zu.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"isiZulu"}],this.apiVariants=[{autonym:"不转换",lang:"zh",url:"/~bmansurov/mediawiki/index.php/3?variant=zh"},{autonym:"简体",lang:"zh-hans",url:"/~bmansurov/mediawiki/index.php/3?variant=zh-hans"}],this.deviceLanguage="en-us",this.frequentlyUsedLanguages={zh:2,ko:1},this.structuredLanguages={all:[{lang:"zh-min-nan",autonym:"Bân-lâm-gú",title:"Barack Obama",dir:"ltr",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama"},{lang:"zu",autonym:"isiZulu",title:"Barack Obama",dir:"ltr",url:"https://zu.wikipedia.org/wiki/Barack_Obama"},{lang:"uz",autonym:"oʻzbekcha/ўзбекча",title:"Barak Obama",dir:"ltr",url:"https://uz.wikipedia.org/wiki/Barak_Obama"},{lang:"es",autonym:"Spanish",title:"Barack Obama",dir:"ltr",url:"https://en.wikipedia.org/wiki/Barack_Obama"},{lang:"be",autonym:"беларуская",title:"Барак Абама",dir:"ltr",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0"},{lang:"be-x-old",autonym:"беларуская (тарашкевіца)",title:"Барак Абама",dir:"ltr",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0"},{lang:"ru",autonym:"русский",title:"Обама, Барак",dir:"ltr",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA"},{lang:"ar",autonym:"العربية",title:"باراك أوباما",dir:"rtl",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7"},{lang:"zh-yue",autonym:"粵語",title:"奧巴馬",dir:"ltr",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC"}],suggested:[{frequency:2,lang:"zh",autonym:"中文",title:"贝拉克·奥巴马",dir:"ltr",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC"},{frequency:1,lang:"ko",autonym:"한국어",title:"버락 오바마",dir:"ltr",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88"}]},i=r.sandbox.create(),s.setUp(i,e),a.setUp(i,e),o.setUp(i,e),i.stub(mw.storage,"get").withArgs("langMap").returns(JSON.stringify(this.frequentlyUsedLanguages)),t=n(20),this.saveSpy=i.stub(t,"saveFrequentlyUsedLanguages")},afterEach:function(){a.tearDown(),i.restore()}}),QUnit.test("#getFrequentlyUsedLanguages",function(e){e.deepEqual(t.getFrequentlyUsedLanguages(),this.frequentlyUsedLanguages,"Frequently used languages is correct.")}),QUnit.test("#saveLanguageUsageCount",function(e){t.saveLanguageUsageCount("ko",t.getFrequentlyUsedLanguages()),e.ok(this.saveSpy.calledWith({zh:2,ko:2}),"Frequently used language is correctly saved.")}),QUnit.test("#getStructuredLanguages",function(e){var n=t.getStructuredLanguages(this.apiLanguages,!1,this.frequentlyUsedLanguages,this.deviceLanguage);e.deepEqual(n,this.structuredLanguages,"Structured languages are correct, including sort order.")}),QUnit.test("#getStructuredLanguages device language",function(e){var n=t.getStructuredLanguages(this.apiLanguages,!1,{},"es-lx").suggested[0].lang;e.strictEqual(n,"es",'"es" is correctly selected as a suggested language even though the device language is "es-lx".')}),QUnit.test("#getStructuredLanguages variants",function(e){var n,i={};n=t.getStructuredLanguages(this.apiLanguages,this.apiVariants,{},this.deviceLanguage).suggested,this.apiVariants.forEach(function(e){i[e.lang]=e}),n.forEach(function(t){e.ok(Object.prototype.hasOwnProperty.call(i,t.lang),'Variant "'+t.lang+'" is in the list of suggested languages.')})})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(11),s=n(6),o=n(5),r=n(4),l=n(7);QUnit.module("MobileFrontend Browser.js",{beforeEach:function(){var n;i=r.sandbox.create(),s.setUp(i,e),o.setUp(i,e),l.setUp(i,e),n=window.document.implementation.createHTMLDocument("Test"),t=$(n)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("isIos()",function(e){var n=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),i=new a("Mozilla/5.0 (iPad; CPU OS 4_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),s=new a("Mozilla/5.0 (iPad; CPU OS 5_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=new a("Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53",t);e.strictEqual(n.isIos(),!0),e.strictEqual(n.isIos(8),!1),e.strictEqual(n.isIos(4),!1),e.strictEqual(n.isIos(5),!1),e.strictEqual(o.isIos(),!0),e.strictEqual(o.isIos(8),!0),e.strictEqual(i.isIos(4),!0),e.strictEqual(s.isIos(5),!0)}),QUnit.test("Methods are cached",function(e){var n=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),i=new a("Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53",t),s=new a("Android 2",t);function o(e,t){return e["__cache"+e[t].cacheId]}e.strictEqual(n.isIos(),!0),e.strictEqual(n.isIos(8),!1),e.strictEqual(s.isIos(8),!1),e.strictEqual(i.isIos(),!0),e.strictEqual(i.isIos(8),!0),e.strictEqual(Object.keys(o(n,"isIos")).length,2,"isIos on ipad cached as expected"),e.strictEqual(Object.keys(o(s,"isIos")).length,1,"isIos on android cached as expected"),e.strictEqual(Object.keys(o(i,"isIos")).length,2,"isIos on iphone cached as expected")}),QUnit.test("lockViewport()",function(e){var n,i=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);i.$el.find("head").append('<meta name="viewport"/>'),i.lockViewport(),n=i.$el.find('meta[name="viewport"]').attr("content"),e.strictEqual(n,"initial-scale=1.0, maximum-scale=1.0, user-scalable=no")}),QUnit.test("isWideScreen()",function(e){var n=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);i.stub(mw.config,"get",function(){return"720px"}),e.strictEqual(n.isWideScreen(),!0)}),QUnit.test("supportsAnimations() - true",function(e){var n,s=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=i.stub(document,"createElement",function(){return{style:{animationName:"",transform:"",transition:""}}});n=s.supportsAnimations(),o.restore(),e.strictEqual(n,!0)}),QUnit.test("supportsAnimations() - false",function(e){var n,s=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=i.stub(document,"createElement",function(){return{style:{}}});n=s.supportsAnimations(),o.restore(),e.strictEqual(n,!1)}),QUnit.test("supportsTouchEvents()",function(e){var n=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);window.ontouchstart=window.ontouchstart||void 0,e.strictEqual(n.supportsTouchEvents(),!0)}),QUnit.test("supportsGeoLocation()",function(e){var n=new a("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);window.navigator.geolocation=window.navigator.geolocation||void 0,e.strictEqual(n.supportsGeoLocation(),!0)})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(4),s=n(6),o=n(5),r=n(8),l=n(7);QUnit.module("MobileFrontend Button.js",{beforeEach:function(){i=a.sandbox.create(),s.setUp(i,e),o.setUp(i,e),r.setUp(i,e),l.setUp(i,e),t=n(13)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("creates a link if passed href option",function(e){var n=new t({href:"https://www.foo.com"});e.strictEqual(n.$el[0].tagName,"A"),e.strictEqual(n.$el[0].getAttribute("href"),"https://www.foo.com")}),QUnit.test("does not add href attribute when not a link",function(e){var n=new t({tagName:"div"});e.strictEqual(n.$el[0].tagName,"DIV"),e.strictEqual(n.$el[0].href,void 0)})}).call(this,n(3))},function(e,t,n){var i=new(0,n(21).MemoryCache);QUnit.module("MobileFrontend cache.js"),QUnit.test("cache set() and get()",function(e){i.set("key","value"),e.strictEqual(i.get("key"),"value")})},function(e,t,n){(function(e){var t,i=n(4),a=n(7),s=n(29);QUnit.module("MobileFrontend context.js",{beforeEach:function(){t=i.sandbox.create(),a.setUp(t,e)},afterEach:function(){t.restore()}}),QUnit.test("getMode()",function(e){t.stub(mw.config,"get").withArgs("wgMFMode").returns("stable"),e.strictEqual(s.getMode(),"stable","Value comes straight from config")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a,s,o,r,l=n(6),c=n(5),u=n(7),d=n(8),h=n(4);QUnit.module("MobileFrontend CtaDrawer.js",{beforeEach:function(){o=h.sandbox.create(),l.setUp(o,e),c.setUp(o,e),d.setUp(o,e),u.setUp(o,e),o.stub(e.mw,"msg",function(e){switch(e){case"mobile-frontend-watchlist-cta-button-login":return"Log in";case"mobile-frontend-watchlist-cta-button-signup":return"Sign up"}return e}),o.stub(e.mw.util,"getUrl",function(e,t){return t.type?"signUp":"logIn"}),i=n(14),a=n(13),s=n(16),t=n(22),o.stub(s.prototype,"appendToElement","#ctaDrawerParent"),(r=document.createElement("div")).id="ctaDrawerParent",document.documentElement.appendChild(r)},afterEach:function(){document.documentElement.removeChild(r),r=void 0,t=void 0,s=void 0,a=void 0,i=void 0,c.tearDown(),o.restore()}},function(){QUnit.module("redirectParams()",function(){QUnit.test("empty props, default URL",function(n){var i=t.prototype.test.redirectParams;o.stub(e.mw.config,"get",function(){return"pageName"}),n.propEqual(i({}),{returnto:"pageName"})}),QUnit.test("empty props, nondefault URL",function(e){var n=t.prototype.test.redirectParams;e.propEqual(n({},"url"),{returnto:"url"})}),QUnit.test("nonempty props",function(e){var n=t.prototype.test.redirectParams;e.propEqual(n({key:"val"},"url"),{key:"val",returnto:"url"})})}),QUnit.module("signUpParams()",function(){QUnit.test("empty props",function(e){var n=t.prototype.test.signUpParams;e.propEqual(n({}),{type:"signup"})}),QUnit.test("nonempty props",function(e){var n=t.prototype.test.signUpParams;e.propEqual(n({key:"val"}),{key:"val",type:"signup"})})}),QUnit.module("HTML",function(){QUnit.test("defaults",function(e){var i=new t,a=new RegExp(n(39).defaultURLs.replace(/\s+/g,"\\s*"));h.assert.match(i.$el.get(0).outerHTML,a),e.ok(!0)}),QUnit.test("overrides",function(e){var s=new t({progressiveButton:new a({progressive:!0,label:"custom log in",href:"customLogIn"}).options,actionAnchor:new i({progressive:!0,label:"custom sign up",href:"customSignUp"}).options}),o=new RegExp(n(39).overrideURLs.replace(/\s+/g,"\\s*"));h.assert.match(s.$el.get(0).outerHTML,o),e.ok(!0)})})})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a,s=n(6),o=n(5),r=n(7),l=n(8),c=n(4),u=n(0);function d(e,t){e.on("show",function(){setTimeout(t,e.minHideDelay)})}function h(){c.assert.match(a.className,/^((?!\bdrawer-visible\b).)*$/)}QUnit.module("MobileFrontend Drawer.js",{beforeEach:function(){i=c.sandbox.create(),s.setUp(i,e),o.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n(16),i.stub(t.prototype,"appendToElement","#drawerParent"),(a=document.createElement("div")).id="drawerParent",document.documentElement.appendChild(a)},afterEach:function(){document.documentElement.removeChild(a),a=void 0,t=void 0,o.tearDown(),i.restore()}}),QUnit.test("appends self to parent when DOM is loaded",function(e){var n=e.async(),i=new t;u.docReady(function(){e.strictEqual(i.$el.parent().get(0),a),n()})}),QUnit.test("adds class to parent when DOM is loaded",function(e){var n=e.async();new t,u.docReady(function(){e.strictEqual(a.className,"has-drawer"),n()})}),QUnit.test("consumes clicks",function(e){var n=e.async(),i=new window.Event("click"),a=new t;i.stopPropagation=function(){e.ok(!0),n()},a.$el.get(0).dispatchEvent(i)}),QUnit.test("visible on show()",function(e){var n=e.async(),i=new t;i.on("show",function(){c.assert.match(a.className,/.*\bdrawer-visible\b.*/),e.ok(!0),n()}),i.show()}),QUnit.test("hidden on hide()",function(e){var n=e.async(),i=new t;i.on("hide",function(){h(),e.ok(!0),n()}),i.hide()}),QUnit.test("hidden on click once presented",function(e){var n=e.async(),i=new t;i.on("hide",function(){h(),e.ok(!0),n()}),d(i,function(){a.click()}),i.show()}),QUnit.test("hidden on scroll once presented",function(e){var n=e.async(),i=new t;i.on("hide",function(){h(),e.ok(!0),n()}),d(i,function(){var e=new window.Event("scroll",{bubbles:!0});a.dispatchEvent(e)}),i.show()}),QUnit.test("HTML is valid",function(e){var n=new t;e.strictEqual(n.$el.get(0).outerHTML,'<div class="drawer position-fixed view-border-box"></div>')})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(5),s=n(7),o=n(6),r=n(4);QUnit.module("MobileFrontend extendSearchParams.js",{beforeEach:function(){t=r.sandbox.create(),s.setUp(t,e),o.setUp(t,e),a.setUp(t,e),t.stub(mw.config,"get").withArgs("wgMFSearchAPIParams").returns({foo:"bar"}).withArgs("wgMFDisplayWikibaseDescriptions").returns({search:!0,nearby:!1}).withArgs("wgMFQueryPropModules").returns(["baz"]),i=n(23)},afterEach:function(){a.tearDown(),t.restore()}}),QUnit.test("it throws if the feature is invalid",function(e){var t=new Error('"foo" isn\'t a feature that shows Wikibase descriptions.');e.throws(function(){i("foo",{})},t)}),QUnit.test("it extends the parameters",function(e){var t=i("search",{qux:"quux",prop:["corge"]});e.deepEqual(t,{qux:"quux",foo:"bar",prop:["corge","baz","description"]})}),QUnit.test("it doesn't include Wikibase-specific parameters if the feature is disabled",function(e){var t=i("nearby",{qux:"quux"});e.strictEqual(t.prop.indexOf("description"),-1),e.strictEqual(t.wbptterms,void 0)}),QUnit.test("it adds the MobileFrontend configuration to given terms types",function(e){var t=i("search",{wbptterms:"grault"});e.strictEqual(t.wbptterms,"grault",'The given "wbptterms" is added to the default.')}),QUnit.test("it prioritizes MobileFrontend configuration",function(e){var t=i("search",{foo:"quux"});e.deepEqual(t,{foo:"bar",prop:["baz","description"]},'The value of "foo" is overridden by the configuration.')}),QUnit.test("it is variadic",function(e){var t=i("search",{baz:"qux"},{quux:"corge"});e.deepEqual(t,{foo:"bar",baz:"qux",quux:"corge",prop:["baz","description"]})})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a,s=n(4),o=n(6),r=n(5),l=n(7),c=n(8);QUnit.module("MobileFrontend icons.js",{beforeEach:function(){t=s.sandbox.create(),o.setUp(t,e),r.setUp(t,e),c.setUp(t,e),l.setUp(t,e),i=n(9),a=t.spy(i,"Icon")},afterEach:function(){t.restore(),r.tearDown()}}),QUnit.test("#cancel()",function(e){i.cancel(),e.deepEqual(a.getCall(0).args[0],{tagName:"button",name:i.CANCEL_GLYPH,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},"Options are passed down")}),QUnit.test("#cancel(variant)",function(e){i.cancel("gray"),e.deepEqual(a.getCall(0).args[0],{tagName:"button",name:i.CANCEL_GLYPH+"-gray",additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},"Options are passed down")}),QUnit.test("#spinner()",function(e){i.spinner({foo:"will be passed down",additionalClassNames:"will-be-ignored"}),e.deepEqual(a.getCall(0).args[0],{foo:"will be passed down",additionalClassNames:"spinner loading",name:"spinner",label:mw.msg("mobile-frontend-loading-message")},"Options are passed down")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(4),s=n(8);QUnit.module("MobileFrontend mfExtend.test.js",{beforeEach:function(){i=a.sandbox.create(),s.setUp(i,e),t=n(1)},afterEach:function(){i.restore()}}),QUnit.test("mfExtend() - extending from constructor",function(e){function n(){}function i(){}t(n,i,{}),e.strictEqual(n.prototype instanceof i,!0)}),QUnit.test("mfExtend() - extending from object",function(e){var n,i=new function(){this.protoMethod=function(){return!0}};function a(){}t(a,i),n=new a,e.strictEqual(n.protoMethod(),!0)}),QUnit.test("mfExtend() - extending from constructor with overrides",function(e){var n;function i(){}t(i,function(){this.protoMethod=function(){return!0}},{protoMethod:function(){return!1}}),n=new i,e.strictEqual(n.protoMethod(),!1)})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(8),s=n(4);QUnit.module("MobileFrontend ModuleLoader",{beforeEach:function(){i=s.sandbox.create(),a.setUp(i,e),t=n(30),this.loader=new t},afterEach:function(){i.restore()}}),QUnit.test("#require",function(e){this.loader.define("foo",1),this.loader.define("bar",5),e.strictEqual(this.loader.require("foo"),1,"Returns appropriate module"),e.strictEqual(this.loader.require("bar"),5,"Returns appropriate module"),e.throws(function(){this.loader.require("undefinedmodule")},"Cannot require an undefined module."),e.throws(function(){this.loader.require("mobile.modules/Foo")},"Cannot require an undefined export on a known module.")}),QUnit.test("#define",function(e){var t=this.loader;t.define("foo",1),t.define("bar",5),e.throws(function(){t.define("bar",50)},"Cannot define two modules with the same name"),e.strictEqual(this.loader.require("bar"),5,"Returns first definition of module.")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(4),s=n(5),o=n(1),r=n(6),l=n(7),c=n(8),u=n(0),d=n(24);QUnit.module("MobileFrontend: Overlay.js",{beforeEach:function(){i=a.sandbox.create(),r.setUp(i,e),s.setUp(i,e),c.setUp(i,e),l.setUp(i,e),t=n(12),i.stub(e.window,"scrollTo"),u.getDocument().find("#mw-mf-viewport").length||(this.$viewport=u.parseHTML("<div>").attr("id","mw-mf-viewport").appendTo("body"))},afterEach:function(){this.$viewport&&this.$viewport.remove(),s.tearDown(),i.restore()}}),QUnit.test("Simple overlay",function(e){var n,i=new t({heading:"<h2>Title</h2>",content:"Text"});i.show(),n=i.$el[0].parentNode,i.hide(),e.ok(n,"In DOM")}),QUnit.test("HTML overlay",function(e){var n;function i(){t.apply(this,arguments)}o(i,t,{templatePartials:u.extend(t.prototype.templatePartials,{content:d.compile('<div class="content">YO</div>')})}),n=new i({heading:"Awesome"}),e.strictEqual(n.$el.find("h2").html(),"Awesome"),e.strictEqual(n.$el.find(".content").text(),"YO")}),QUnit.test("Close overlay",function(e){var n=new t({heading:"<h2>Title</h2>",content:"Text"});n.show(),n.hide(),e.strictEqual(n.$el[0].parentNode,null,"No longer in DOM")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a,s,o=n(4),r=n(6),l=n(5),c=n(8),u=n(0),d=n(7);QUnit.module("MobileFrontend mobile.startup/OverlayManager",{beforeEach:function(){s=o.sandbox.create(),r.setUp(s,e),c.setUp(s,e),l.setUp(s,e),d.setUp(s,e),s.stub(e.window,"scrollTo"),t=n(33),this.createFakeOverlay=function(e){var t=new OO.EventEmitter;return t.hasLoadError=!1,t.show=s.spy(),t.hide=function(){return this.emit("hide"),!0},s.spy(t,"hide"),u.extend(t,e),t},(i=new OO.EventEmitter).getPath=s.stub().returns(""),i.back=s.spy(),s.stub(mw.loader,"require").withArgs("mediawiki.router").returns(i),a=new t(i)},afterEach:function(){l.tearDown(),s.restore()}}),QUnit.test("#getSingleton",function(e){var n=t.getSingleton();e.ok(n instanceof t,"singleton exists"),e.strictEqual(n,t.getSingleton(),"same object returned each time")}),QUnit.test("#add",function(e){var t=this.createFakeOverlay();a.add(/^test$/,function(){return t}),i.emit("route",{path:"test"}),e.strictEqual(t.show.callCount,1,"show registered overlay")}),QUnit.test("#add, with $.Deferred factory",function(e){var t=u.Deferred(),n=this.createFakeOverlay();return t.show=s.spy(),a.add(/^foo$/,function(){return t}),i.emit("route",{path:"foo"}),t.resolve(n),t.then(function(){e.notOk(t.show.called,"don't call show on Deferred"),e.strictEqual(n.show.callCount,1,"show registered overlay")})}),QUnit.test("#add, with current path",function(e){var t=this.createFakeOverlay(),n=u.Deferred();return i.getPath=s.stub().returns("baha"),a.add(/^baha$/,function(){return t}),u.docReady(function(){n.resolve()}),n.then(function(){e.strictEqual(t.show.callCount,1,"show registered overlay")})}),QUnit.test("#replaceCurrent",function(e){var t=this.createFakeOverlay(),n=this.createFakeOverlay();a.add(/^test$/,function(){return t}),i.emit("route",{path:"test"}),a.replaceCurrent(n),e.strictEqual(t.hide.callCount,1,"hide overlay"),e.strictEqual(n.show.callCount,1,"show another overlay"),i.emit("route",{path:""}),e.strictEqual(n.hide.callCount,1,"hide another overlay")}),QUnit.test("route with params",function(e){var t=this.createFakeOverlay(),n=s.stub().returns(t);a.add(/^sam\/(\d+)$/,n),i.emit("route",{path:"sam/123"}),e.ok(n.calledWith("123"),"pass params from the route")}),QUnit.test("hide when route changes",function(e){var t=this.createFakeOverlay(),n=s.stub().returns(t);a.add(/^jon$/,n),i.emit("route",{path:"jon"}),i.emit("route",{path:""}),i.emit("route",{path:"jon"}),i.emit("route",{path:"other"}),e.strictEqual(t.hide.callCount,2,"hide overlay"),e.ok(t.hide.getCall(0).notCalledWith(!0),"don't force hide (first)"),e.ok(t.hide.getCall(1).notCalledWith(!0),"don't force hide (second)")}),QUnit.test("go back (change route) if overlay hidden but not by route change",function(e){var t=this.createFakeOverlay(),n=s.stub().returns(t);a.add(/^joakino$/,n),i.emit("route",{path:"joakino"}),t.hide(),e.strictEqual(i.back.callCount,1,"route back")}),QUnit.test("stacked overlays",function(e){var t=this.createFakeOverlay(),n=s.stub().returns(t),o=this.createFakeOverlay(),r=s.stub().returns(o);a.add(/^parent$/,r),a.add(/^child$/,n),i.emit("route",{path:"parent"}),e.strictEqual(o.show.callCount,1,"show parent"),i.emit("route",{path:"child"}),e.strictEqual(o.hide.callCount,1,"hide parent"),e.ok(o.hide.calledWith(!0),"hide parent forcefully (no confirmation)"),e.strictEqual(t.show.callCount,1,"show child"),i.emit("route",{path:"parent"}),e.strictEqual(t.hide.callCount,1,"hide child"),e.strictEqual(o.show.callCount,2,"show parent again"),e.strictEqual(r.callCount,1,"create parent only once")}),QUnit.test("prevent route change",function(e){var t=this.createFakeOverlay({hide:s.stub().returns(!1)}),n=s.stub().returns(t),o={path:"",preventDefault:s.spy()};a.add(/^rob$/,n),i.emit("route",{path:"rob"}),i.emit("route",o),e.ok(o.preventDefault.calledOnce,"prevent route change")}),QUnit.test("reload failed overlay when navigating to it again from another overlay",function(e){var t,n,o=this.createFakeOverlay(),r=this.createFakeOverlay();o.hasLoadError=!0,(n=s.stub()).onCall(0).returns(o),n.onCall(1).returns(r),t=function(e){return"0"===e?n():r},a.add(/^test\/(\d+)$/,t),i.emit("route",{path:"test/0"}),e.strictEqual(a.stack.length,1,"stack is correct size"),e.ok(a.stack[0].overlay.hasLoadError,"first overlay has load error"),i.emit("route",{path:"test/1"}),e.strictEqual(a.stack.length,2,"stack is correct size"),e.notOk(a.stack[0].overlay.hasLoadError,"second overlay loads successfully"),i.emit("route",{path:"test/0"}),e.strictEqual(a.stack.length,1,"stack decreases when going back to already visited overlay"),e.notOk(a.stack[0].overlay.hasLoadError,"Failed attempt is not cached and new overlay is loaded")}),QUnit.test("replace overlay when route event path is equal to current path",function(e){var t,n=this.createFakeOverlay(),o=this.createFakeOverlay();n.hasLoadError=!0,(t=s.stub()).onCall(0).returns(n),t.onCall(1).returns(o),a.add(/^test\/(\d+)$/,t),i.emit("route",{path:"test/0"}),e.strictEqual(a.stack.length,1,"stack is correct size"),e.ok(a.stack[0].overlay.hasLoadError,"overlay has load error"),i.emit("route",{path:"test/0"}),e.strictEqual(a.stack.length,1,"stack is correct size (did not increase upon reload)"),e.notOk(a.stack[0].overlay.hasLoadError,"overlay retry loads successfully")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a,s,o,r,l,c=n(6),u=n(5),d=n(7),h=n(8),p=n(4),g='<div class="mw-parser-output">';QUnit.module("MobileFrontend Page",{beforeEach:function(){var f=function(e){return'<div class="ambox">'+e+"</div>"},m=function(e){return'<h2 class="section-heading">'+e+"</h2>"},v=function(e,t){var n=t||"h3";return"<"+n+">"+e+"</"+n+">"},w=function(e,t){return'<div class="mf-section-'+e+'">'+t+"</div>"};a=p.sandbox.create(),c.setUp(a,e),d.setUp(a,e),u.setUp(a,e),h.setUp(a,e),t=n(15),i=n(0),s=new t({el:i.parseHTML(g).html("<p>lead</p>"+f("a0"))}),o=new t({el:i.parseHTML(g).html(w(0,f("a0")+'<p>lead</p><div class="toc-mobile view-border-box"><h2></h2><div></div></div>')+m("1")+w(1,f("a1")+v("1.1")+f("a1.1")))}),r=new t({el:i.parseHTML(g).html("<p>lead</p>"+f("a0")+v("1","h2")+f("a1")+v("1.1")+f("a1.1"))}),l=new t({el:i.parseHTML(g).html(w(0,"<p>lead</p>"+f("a0"))+m("1")+w(1,f("a1")+v("1.1")+f("a1.1")+v("1.1.1","h4")+f("a1.1.1")+v("1.1.2","h4")+f("a1.1.2")+v("1.2")+f("a1.1"))+m("2")+w(6,f("a2"))+m("3")+w(7,f("a3"))+m("Section with nested Ambox")+w(8,f("<p>nested-ambox-parent,</p>"+f("nested-ambox-1,")+f("nested-ambox-2")))+m("Sub-section with nested Ambox")+w(9,f("<p>nested-ambox-parent,</p>"+f("nested-ambox-1,")+f("nested-ambox-2"))+v("subsection heading")+v("Another subsection heading")))})},afterEach:function(){u.tearDown(),a.restore()}}),QUnit.test("#findInSectionLead",function(e){[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[3,"","h4","selector does not match",".foo"],[111,"","Non-existent section"]].forEach(function(t,n){var i=t[0],a=t[1],s=t[2],o=t[3]||".ambox";e.strictEqual(r.findChildInSectionLead(i,o).text(),a,"Found correct text in desktop test "+n+" case: "+s)}),[[0,"a0","lead section"],[3,"","h4","selector does not match",".foo"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(s.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Stub: Found correct text in desktop test case:"+t[2])}),[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[3,"a1.1.1","h4"],[3,"","h4","selector does not match",".foo"],[7,"a3","h2 later"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(l.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Mobile: Found correct text in test case:"+t[2])}),[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(o.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Mobile with table of contents: Found correct text in test case:"+t[2])}),[[8,".ambox","nested-ambox-parent,nested-ambox-1,nested-ambox-2","Nested elements in section"],[9,".ambox","nested-ambox-parent,nested-ambox-1,nested-ambox-2","Nested elements in subsection"]].forEach(function(t){var n=l.findChildInSectionLead(t[0],t[1]);e.strictEqual(n.not(n.children()).text(),t[2],"Mobile: Found correct text in test case:"+t[3])})}),QUnit.test("#isMainPage",function(e){var n=new t({title:"Main Page",isMainPage:!0}),i=new t({title:"Foo"});e.strictEqual(n.isMainPage(),!0,"check main page flag is updated"),e.strictEqual(i.isMainPage(),!1,"check not marked as main page")}),QUnit.test("#getThumbnails",function(e){var n,a,s,o,r,l,c,u,d,h;n=new t({el:i.parseHTML('<div><a href="/wiki/File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),a=new t({el:i.parseHTML("<div></div>")}),s=new t({el:i.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),o=n.getThumbnails(),r=new t({el:i.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box noviewer"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),l=new t({el:i.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" class="metadata" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),h=new t({el:i.parseHTML('<div class="noviewer"><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),c=new t({el:i.parseHTML('<div><a href="/wiki/File:Design_portal_logo.jpg" class="image"><span class="lazy-image-placeholder" style="width: 28px;height: 28px;" data-src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg" data-alt="icon" data-width="28" data-height="28" data-class="noviewer">&nbsp;</span></a></div>')}),d=new t({el:i.parseHTML('<div><a href="/wiki/File:Design_portal_logo.jpg" class="image"><span class="lazy-image-placeholder" style="width: 28px;height: 28px;" data-src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg" data-alt="icon" data-width="28" data-height="28" data-class="wot noviewerz bar">&nbsp;</span></a></div>')}),u=new t({el:i.parseHTML('<div><table class="plainlinks metadata ambox ambox-content ambox-Unreferenced" role="presentation"><tr><td class="mbox-image"><div style="width:52px"><a href="/wiki/File:Question_book-new.svg" class="image"><span class="lazy-image-placeholder" style="width: 50px;height: 39px;" data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/50px-Question_book-new.svg.png" data-alt="" data-width="50" data-height="39" data-srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/75px-Question_book-new.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/100px-Question_book-new.svg.png 2x"> </span></a></div></td></tr></table>')}),e.strictEqual(o.length,1,"Found expected number of thumbnails."),e.strictEqual(o[0].getFileName(),"File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg","Found expected filename."),o=a.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=s.getThumbnails(),e.strictEqual(o.length,1,"Found expected number of thumbnails."),e.strictEqual(o[0].getFileName(),"File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg","Found expected filename."),o=r.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=l.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=h.getThumbnails(),e.strictEqual(o.length,0,"Images inside a container with the class are not included. Images inside tables for example."),o=c.getThumbnails(),e.strictEqual(o.length,0,"Consider whether the class is on an image which has not been lazy loaded."),o=u.getThumbnails(),e.strictEqual(o.length,0,"Consider whether the lazy loaded image is inside a .metadata container."),o=d.getThumbnails(),e.strictEqual(o.length,1,"Thumbnail found if there is a typo.")}),QUnit.test("#getNamespaceId",function(e){[["Main Page",0],["San Francisco",0],["San Francisco: Talk:2",0],["San Francisco: The Sequel",0],["Talk:Foo",1],["Project:Bar",4],["User talk:Jon",3],["Special:Nearby",-1]].forEach(function(n){var i=new t({title:n[0]});e.strictEqual(i.getNamespaceId(),n[1],"Check namespace is as expected")})}),QUnit.test("#isTalkPage",function(e){[["Main Page",!1],["San Francisco",!1],["San Francisco: Talk:2",!1],["San Francisco: The Sequel",!1],["Talk:Foo",!0],["Project talk:Bar",!0],["User talk:Jon",!0],["Special:Nearby",!1]].forEach(function(n){var i=new t({title:n[0]});e.strictEqual(i.isTalkPage(),n[1],"Check test is as expected")})}),QUnit.test("#isMissing",function(e){var n,i;n=[new t({title:"Hello",id:0}),new t({title:"Hello",id:5,isMissing:!0}),new t({title:"Hello",isMissing:!0})],i=[new t({title:"Hello",id:4}),new t({title:"Hello",id:4,isMissing:!1}),new t({title:"Hello",isMissing:!1}),new t({title:"Hello",id:0,isMissing:!1})],n.forEach(function(t,n){e.strictEqual(t.isMissing,!0,"page "+n+" is missing")}),i.forEach(function(t,n){e.strictEqual(t.isMissing,!1,"page "+n+" is not missing")})}),QUnit.test("#allowsXSS",function(e){var n=new t({title:'<script>alert("oops, XSS possible!");<\/script>'});e.strictEqual(n.getDisplayTitle(),"&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;","Check against XSS in Page.js constructor displaytitle (when title set)"),[{thumbnail:!1,title:'<script>alert("oops, XSS possible!");<\/script>',terms:!1,testDesc:"Check against XSS in Page.newFromJSON displaytitle (when title set)"},{thumbnail:!1,pageprops:[],terms:{label:['<script>alert("oops, XSS possible!");<\/script>']},testDesc:"Check against XSS in Page.newFromJSON displaytitle (when Wikibase label set)"}].forEach(function(i){n=t.newFromJSON(i),e.strictEqual(n.getDisplayTitle(),"&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;",i.testDesc)})})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a,s,o=n(4),r=n(6),l=n(7),c=n(5),u=n(40),d=u.page,h=u.page2,p=n(67);QUnit.module("MobileFrontend PageGateway",{beforeEach:function(){s=o.sandbox.create(),r.setUp(s,e),c.setUp(s,e),l.setUp(s,e),t=n(0),i=n(34),this.api=new mw.Api,a=new i(this.api)},afterEach:function(){c.tearDown(),s.restore()}}),QUnit.test("#getPage (h1s)",function(e){return s.stub(this.api,"get").returns(t.Deferred().resolve(p.getPageHeadings.input)),a.invalidatePage("Test"),s.stub(mw.util,"getUrl").returns("Test:History"),a.getPage("Test").then(function(t){e.propEqual(t,p.getPageHeadings.output,"return lead and sections test 1")})}),QUnit.test("#getPage",function(e){var n=s.stub(this.api,"get").returns(t.Deferred().resolve(p.getPage.input));return s.stub(mw.util,"getUrl").returns("Test:History"),a.invalidatePage("Test"),a.getPage("Test").then(function(t){return e.deepEqual(t,p.getPage.output,"return lead and sections test 2"),a.getPage("Test")}).then(function(){e.strictEqual(n.callCount,1,"cache page")})}),QUnit.test("#getPageLanguages (response)",function(e){return s.stub(this.api,"get").returns(t.Deferred().resolve(p.getPageLanguagesResponse.input)),a.getPageLanguages("Test").then(function(t){e.deepEqual(t.languages,p.getPageLanguagesResponse.output.languages,"return augmented language links"),e.deepEqual(t.variants,p.getPageLanguagesResponse.output.variants,"return augmented language variant links")})}),QUnit.test("#getPageLanguages (call)",function(e){var n=s.stub(this.api,"get").returns(t.Deferred().reject());s.stub($,"ajax").returns(t.Deferred().resolve()),a.getPageLanguages("Title","fr"),e.ok(n.calledWith(p.getPageLanguagesCall.output))}),QUnit.test("#_getAPIResponseFromHTML",function(e){var n=a._getAPIResponseFromHTML(t.parseHTML(d));e.deepEqual(p.getAPIResponseFromHTML.input,n)}),QUnit.test("#getSectionsFromHTML malformed (h2 before h1)",function(e){var n=a.getSectionsFromHTML(t.parseHTML(h));e.propEqual(n,[{line:"A1",level:"2",anchor:"1.0",text:'<h3 id="">A2.1</h3>\n\n',subsections:[{line:"A2.1",level:"3",anchor:"",text:"",subsections:[]}]},{line:"A2.2",level:"2",anchor:"",text:"",subsections:[]},{line:"A2",level:"1",anchor:"",text:'<h2 id="">A2.1</h2>\n\n',subsections:[{line:"A2.1",level:"2",anchor:"",text:"",subsections:[]}]}])}),QUnit.test("#getPage (forwards api errors)",function(e){return s.stub(this.api,"get").returns(t.Deferred().reject("missingtitle")),a.getPage("Err").catch(function(t){e.strictEqual(t,"missingtitle")})}),QUnit.test("#getPage (move protected page)",function(e){var n={edit:["*"],move:["sysop"]};return s.stub(this.api,"get").returns(t.Deferred().resolve({mobileview:{id:-1,displaytitle:"Test",revId:42,lastmodifiedby:{name:"bob",gender:"unknown"},protection:{move:["sysop"]},lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:""}]}})),a.invalidatePage("Test"),a.getPage("Test").then(function(t){e.deepEqual(t.protection,n)})})}).call(this,n(3))},function(e,t){e.exports={getPageHeadings:{input:{mobileview:{id:-1,displaytitle:"Test",revId:42,lastmodifiedby:{name:"bob",gender:"unknown"},protection:[],lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:""},{level:"1",line:"1",anchor:"1",id:1,text:"<p>Text of 1\n</p>"},{level:"2",line:"<i>1.1</i>",anchor:"1.1",id:2,text:"<p>Text of 1.1\n</p>"},{level:"1",line:"2",anchor:"2",id:3,text:"<p>Text of 2\n</p>"},{level:"2",line:"2.1",anchor:"2.1",id:4,text:"<p>Text of 2.1\n</p>"}]}},output:{historyUrl:"Test:History",lastModifiedUserName:"bob",lastModifiedUserGender:"unknown",lastModifiedTimestamp:1382986196,title:"Test",revId:42,displayTitle:"Test",id:-1,protection:{edit:["*"]},isMainPage:!1,languageCount:10,hasVariants:!1,lead:"",sections:[{level:"1",line:"1",anchor:"1",id:1,text:'<p>Text of 1\n</p><h2 id="1.1"><i>1.1</i></h2>\n<p>Text of 1.1\n</p>\n',subsections:[{level:"2",line:"<i>1.1</i>",anchor:"1.1",id:2,text:"<p>Text of 1.1\n</p>",subsections:[]}]},{level:"1",line:"2",anchor:"2",id:3,text:'<p>Text of 2\n</p><h2 id="2.1">2.1</h2>\n<p>Text of 2.1\n</p>\n',subsections:[{level:"2",line:"2.1",anchor:"2.1",id:4,text:"<p>Text of 2.1\n</p>",subsections:[]}]}]}},getPage:{input:{mobileview:{id:-1,protection:{edit:["sysop"]},lastmodifiedby:{name:"Melissa",gender:"female"},revId:42,displaytitle:"Test",lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:"lead content"},{level:"2",line:"Aaa section",anchor:"Aaa_section",id:1,text:"aaa content"},{level:"3",line:"Subaaa section",anchor:"Subaaa_section",id:2,text:"subaaa content"},{level:"2",line:"Bbb section",anchor:"Bbb_section",id:3,text:"bbb content"},{level:"2",line:"References",references:"",anchor:"References",id:4,text:"references"}]}},output:{historyUrl:"Test:History",lastModifiedUserName:"Melissa",lastModifiedUserGender:"female",lastModifiedTimestamp:1382986196,protection:{edit:["sysop"]},title:"Test",displayTitle:"Test",id:-1,isMainPage:!1,revId:42,languageCount:10,hasVariants:!1,lead:"lead content",sections:[{level:"2",line:"Aaa section",anchor:"Aaa_section",id:1,text:'aaa content<h3 id="Subaaa_section">Subaaa section</h3>\nsubaaa content\n',subsections:[{level:"3",line:"Subaaa section",anchor:"Subaaa_section",id:2,text:"subaaa content",subsections:[]}]},{level:"2",line:"Bbb section",anchor:"Bbb_section",id:3,text:"bbb content",subsections:[]},{level:"2",line:"References",references:"",anchor:"References",id:4,text:"references",subsections:[]}]}},getPageLanguagesResponse:{input:{query:{pages:[{pageid:94,ns:0,title:"San Francisco",langlinks:[{lang:"es",url:"http://es.wikipedia.org/wiki/San_Francisco_(California)",title:"San Francisco (California)",autonym:"español"},{lang:"pl",url:"http://pl.wikipedia.org/wiki/San_Francisco",title:"San Francisco",autonym:"polski"},{lang:"sr",url:"http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE",title:"Сан Франциско",autonym:"српски / srpski"}]}],general:{variants:[{code:"sr",name:"sr"},{code:"sr-ec",name:"Ћирилица"},{code:"sr-el",name:"Latinica"}],variantarticlepath:"/$2/$1"},languages:[{code:"sr",name:"српски / srpski"},{code:"sr-ec",name:"српски (ћирилица)"},{code:"sr-el",name:"srpski (latinica)‎"},{code:"es",name:"español"},{code:"pl",name:"polski"}]},limits:{langlinks:500}},output:{languages:[{lang:"es",url:"http://es.wikipedia.org/wiki/San_Francisco_(California)",title:"San Francisco (California)",autonym:"español"},{lang:"pl",url:"http://pl.wikipedia.org/wiki/San_Francisco",title:"San Francisco",autonym:"polski"},{lang:"sr",url:"http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE",title:"Сан Франциско",autonym:"српски / srpski"}],variants:[{lang:"sr",autonym:"sr",url:"/sr/Test"},{lang:"sr-ec",autonym:"Ћирилица",url:"/sr-ec/Test"},{lang:"sr-el",autonym:"Latinica",url:"/sr-el/Test"}]}},getPageLanguagesCall:{output:{action:"query",meta:"siteinfo",siprop:"general",prop:"langlinks",llprop:"url|autonym|langname",llinlanguagecode:"fr",lllimit:"max",titles:"Title",formatversion:2}},getAPIResponseFromHTML:{input:[{line:"A1",level:"1",anchor:"1.0",text:""},{line:"A2.1",level:"2",anchor:"",text:""},{line:"A2.2",level:"2",anchor:"",text:""},{line:"A2",level:"1",anchor:"",text:""},{line:"A2.1",level:"2",anchor:"",text:""}]}}},function(e,t,n){(function(e){var t,i,a=n(4),s=n(6),o=n(5),r=n(7),l=n(8);QUnit.module("MobileFrontend Panel.js",{beforeEach:function(){i=a.sandbox.create(),s.setUp(i,e),o.setUp(i,e),l.setUp(i,e),r.setUp(i,e),t=n(17)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("show() when not visible",function(e){var n=e.async(),i=new t;i.on("show",function(){e.ok(i.$el.hasClass("visible"),"Visible class is set"),e.ok(i.$el.hasClass("animated"),"Animated class is set"),n()}),i.show()}),QUnit.test("hide() when visible",function(e){var n=e.async(),i=new t;i.on("hide",function(){e.notOk(i.$el.hasClass("visible","Visible class is removed")),n()}),i.show(),i.hide()}),QUnit.test("isVisible() when visible",function(e){var n=e.async(),i=new t;i.on("show",function(){e.ok(i.isVisible(),"Returns true when visible"),n()}),i.show()}),QUnit.test("isVisible() when not visible",function(e){var n=new t;e.notOk(n.isVisible(),"Returns false when not visible")}),QUnit.test("onCancel()",function(e){var n=e.async(),i=new t;i.on("hide",function(){e.notOk(i.$el.hasClass("visible"),"Removes visible class"),n()}),i.show(),i.onCancel({preventDefault:function(){}})}),QUnit.test("toggle()",function(e){var n=e.async(),i=new t;i.on("show",function(){e.ok(i.isVisible(),"Shows panel when not visible"),i.toggle()}),i.on("hide",function(){e.notOk(i.isVisible(),"Hides panel when visible"),n()}),i.toggle()})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(4),s=n(6),o=n(5),r=n(8),l=n(7),c=n(0);function u(e,n,a,s){var o,r=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),o=t.loadModule(n,a,s),e.strictEqual(this.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(this.stub.show.getCall(0).args.length,0,"LoadingOverlay show() called with no args"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide not called"),this.deferred.resolve(),o.then(function(t){e.strictEqual(t,r.stub,"Promise resolves to overlay instance"),e.strictEqual(r.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(r.stub.hide.callCount,1,"LoadingOverlay hide() called once"),e.strictEqual(r.stub.hide.getCall(0).args.length,0,"LoadingOverlay hide() called with no args")})}QUnit.module("MobileFrontend rlModuleLoader.js",{beforeEach:function(){i=a.sandbox.create(),s.setUp(i,e),o.setUp(i,e),r.setUp(i,e),l.setUp(i,e),t=n(35),i.stub(e.window,"scrollTo"),this.stub={show:i.spy(),hide:i.spy()},this.deferred=c.Deferred(),i.stub(mw.loader,"using").withArgs("mobile.mediaViewer").returns(this.deferred)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("#newLoadingOverlay does not blow up",function(e){e.expect(0),t.newLoadingOverlay()}),QUnit.test("#loadModule when instructed to show/hide overlay and successful",function(e){return u.apply(this,[e,"mobile.mediaViewer",!1,!0])}),QUnit.test("#loadModule when instructed to show/hide overlay (default args) and successful",function(e){return u.apply(this,[e,"mobile.mediaViewer",!1])}),QUnit.test("#loadModule when instructed to show/hide overlay and not successful",function(e){var n,a=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!1,!0),this.deferred.reject(),e.rejects(n,"returned promise rejects"),n.catch(function(){e.strictEqual(a.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(a.stub.hide.callCount,1,"LoadingOverlay hide() called once"),e.strictEqual(a.stub.hide.getCall(0).args.length,0,"LoadingOverlay hide() called with no args")})}),QUnit.test("#loadModule when instructed to show/not hide overlay and successful",function(e){var n,a=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!0,!0),e.strictEqual(this.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(this.stub.show.getCall(0).args.length,0,"LoadingOverlay show() called with no args"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide() not called"),this.deferred.resolve(),n.then(function(t){e.strictEqual(t,a.stub,"Promise resolves to overlay instance"),e.strictEqual(a.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(a.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to show/not hide overlay and not successful",function(e){var n,a=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!0,!0),this.deferred.reject(),e.rejects(n,"returned promise rejects"),n.catch(function(){e.strictEqual(a.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(a.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to not show overlay and successful",function(e){var n,a=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!1,!1),e.strictEqual(this.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide() not called"),this.deferred.resolve(),n.then(function(t){e.strictEqual(t,a.stub,"Promise resolves to overlay instance"),e.strictEqual(a.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(a.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to not show overlay and not successful",function(e){var n,a=this;return i.stub(t,"newLoadingOverlay").returns(this.stub),n=t.loadModule("mobile.mediaViewer",!1,!1),this.deferred.reject(),e.rejects(n,"returned promise rejects"),n.catch(function(){e.strictEqual(a.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(a.stub.hide.callCount,0,"LoadingOverlay hide() not called")})})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(4),s=n(6),o=n(5),r=n(8);QUnit.module("MobileFrontend Section.js",{beforeEach:function(){i=a.sandbox.create(),s.setUp(i,e),o.setUp(i,e),r.setUp(i,e),t=n(19)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("initialize with options",function(e){var n=new t({level:"1",line:"Line",text:"Text",hasReferences:!0,id:"ID",anchor:"Anchor"});e.strictEqual(n.line,"Line","line is set"),e.strictEqual(n.text,"Text","text is set"),e.strictEqual(n.hasReferences,!0,"hasReferences is set"),e.strictEqual(n.id,"ID","id is set"),e.strictEqual(n.anchor,"Anchor","anchor is set"),e.strictEqual(n.subsections.length,0,"Subsections are empty")}),QUnit.test("initialize with subsections",function(e){var n=new t({subsections:[{level:"",line:"Line",text:"Text",hasReferences:!0,id:"ID",anchor:"Anchor"}]}),i=n.subsections[0];e.strictEqual(n.subsections.length,1,"Subsection is added to array"),e.ok(i instanceof t,"Subsections are instances of Section"),e.strictEqual(i.line,"Line","line is set"),e.strictEqual(i.text,"Text","text is set"),e.strictEqual(i.hasReferences,!0,"hasReferences is set"),e.strictEqual(i.id,"ID","id is set"),e.strictEqual(i.anchor,"Anchor","anchor is set"),e.strictEqual(i.subsections.length,0,"Subsection children are empty")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(40),s=n(5),o=n(6),r=n(7),l=n(8),c=n(4),u=n(0);QUnit.module("MobileFrontend Skin.js",{beforeEach:function(){var a,d={getReferencesLists:function(){},getReferencesList:function(){}};t=c.sandbox.create(),o.setUp(t,e),s.setUp(t,e),l.setUp(t,e),r.setUp(t,e),i=n(36),a=new(n(15))({title:"Foo"}),t.stub(mw.loader,"using").returns(u.Deferred().resolve()),t.stub(d,"getReferencesLists").returns(u.Deferred().resolve({})),t.stub(d,"getReferencesList").withArgs(a,"Notes_and_references").returns(u.Deferred().resolve(u.parseHTML("<p>").text("P"))).withArgs(a,"Notes").returns(u.Deferred().resolve(u.parseHTML("<p>").text("A"))).withArgs(a,"Refs").returns(u.Deferred().resolve(u.parseHTML("<p>").text("B"))).withArgs(a,"More_refs").returns(u.Deferred().resolve(u.parseHTML("<p>").html("<p>E</p><p>F</p>").children())),this.skin=new i({referencesGateway:d,page:a,eventBus:{on:function(){},off:function(){}}})},afterEach:function(){s.tearDown(),t.restore()}}),QUnit.test("#loadImagesList (success)",function(e){var n=t.stub(this.skin,"loadImage").returns(u.Deferred().resolve());return this.skin.loadImagesList([u.parseHTML("<div>"),u.parseHTML("<div>")]).then(function(){e.strictEqual(n.callCount,2,"Stub was called twice and resolves successfully.")})}),QUnit.test("#loadImagesList (one image fails)",function(e){var n=t.stub(this.skin,"loadImage");return n.onCall(0).returns(u.Deferred().resolve()),n.onCall(1).returns(u.Deferred().reject()),this.skin.loadImagesList([u.parseHTML("<div>"),u.parseHTML("<div>")]).catch(function(){e.strictEqual(n.callCount,2,"Stub was called twice and overall result was failure.")})}),QUnit.test("#loadImagesList (empty list)",function(e){return this.skin.loadImagesList([]).then(function(){e.ok(!0,"An empty list always resolves successfully")})}),QUnit.test("#lazyLoadReferences",function(e){var t=u.parseHTML("<div>").append(a.skinPage);return this.skin.lazyLoadReferences({wasExpanded:!1,page:this.skin.page,isReferenceSection:!0,$heading:t.find("#Notes_and_references").parent()}).then(function(){e.strictEqual(t.find(".mf-section-2").text().replace(/[\t\n]/g,""),"TextPNotesARefsBno forgetMore refs1E2F3","Check all the references section is populated correctly.")})}),QUnit.test("#getSectionId",function(e){var t=u.parseHTML(["<div>",'<h2><span class="mw-headline" id="heading">H</span></h2>',"<div>",'<h3><span class="mw-headline" id="subheading">Subh</span></h3>','<a class="element"></a>',"</div>","</div>"].join("")),n=u.parseHTML(["<div>",'<h2><span class="mw-headline" id="Notes_and_references">Notes and references</span></h2>',"<div>",'<h3 class="in-block"><span class="mw-headline" id="Notes">Notes</span></h3>','<div class="reflist"><a class="element"></a></div>',"</div>","</div>"].join("")),a=u.parseHTML(['<div id="mw-content-text">','<h2><span class="mw-headline" id="heading">Heading</span></h2>','<div><a class="element"></a></div>',"</div>"].join("")),s=u.parseHTML(['<div id="mw-content-text">','<div><a class="element"></a></div>'].join("")),o=u.parseHTML(['<div id="mw-content-text">','<h2><span class="mw-headline" id="Foo">Foo</span></h2>',"<div>","<p>Foo content.</p>","</div>",'<h2><span class="mw-headline" id="Bar">Bar</span></h2>','<div class="reflist"><a class="element"></a></div>',"</div>","</div>"].join(""));e.strictEqual(i.getSectionId(t.find(".element")),"subheading"),e.strictEqual(i.getSectionId(n.find(".element")),"Notes","https://phabricator.wikimedia.org/T146394"),e.strictEqual(i.getSectionId(a.find(".element")),"heading"),e.strictEqual(i.getSectionId(s.find(".element")),null),e.strictEqual(i.getSectionId(o.find(".element")),"Bar")})}).call(this,n(3))},function(e,t,n){var i=n(18);QUnit.module("MobileFrontend time.js"),QUnit.test("timeAgo()",function(e){e.deepEqual(i.timeAgo(40),{value:40,unit:"seconds"}),e.deepEqual(i.timeAgo(149),{value:2,unit:"minutes"}),e.deepEqual(i.timeAgo(150),{value:3,unit:"minutes"}),e.deepEqual(i.timeAgo(7500),{value:2,unit:"hours"}),e.deepEqual(i.timeAgo(9e4),{value:1,unit:"days"}),e.deepEqual(i.timeAgo(9e6),{value:3,unit:"months"}),e.deepEqual(i.timeAgo(32e6),{value:1,unit:"years"}),e.deepEqual(i.timeAgo(102e6),{value:3,unit:"years"})})},function(e,t,n){(function(e){var t,i,a,s=n(4),o=n(6),r=n(5),l=n(8),c=n(7);QUnit.module("MobileFrontend Toggler.js",{beforeEach:function(){t=s.sandbox.create(),o.setUp(t,e),r.setUp(t,e),l.setUp(t,e),c.setUp(t,e),i=n(11).getSingleton(),a=n(37),t.stub(mw.config,"get").withArgs("wgMFCollapseSectionsByDefault").returns(!0),t.stub(i,"isWideScreen").returns(!1),this.page={title:"Toggle test"},this.$container=$("<div>").html('\n\t\t<h2>\n\t\t<span id="First_Section">First Section</span>\n\t\t</h2>\n\t\t<div>\n\t\t\t<p>Text</p>\n\t\t</div>\n\t\t<h2 id="section_1">\n\t\t\t<a href="#foo">Dummy Link</a>\n\t\t</h2>\n\t\t<div></div>\n\t\t<h2>References</h2>\n\t\t<div data-is-reference-section="1">\n\t\t\t<ol class="references">\n\t\t\t\t<li id="cite_note-1">\n\t\t\t\t\t<span class="mw-cite-backlink">\n\t\t\t\t\t\t<a href="#cite_ref-1">↑</a>\n\t\t\t\t\t</span> <span class="reference-text">hello</span>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</div>\n'),this.$section0=this.$container.find("h2").eq(0),this.title=this.page.title,this.headline=this.$section0.find("span").attr("id")},afterEach:function(){mw.storage.remove("expandSections"),mw.storage.remove("expandedSections"),r.tearDown(),t.restore()}}),QUnit.test("Mobile mode - Toggle section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),n=this.$section0,i=this.$container.find(".collapsible-block").eq(0);t.toggle(n),e.strictEqual(n.hasClass("open-block"),!0,"open-block class present"),t.toggle(n),e.strictEqual(i.hasClass("open-block"),!1,"check content gets closed on a toggle"),e.strictEqual(n.hasClass("open-block"),!1,"check section is closed"),t.toggle(n),e.strictEqual(i.hasClass("open-block"),!0,"check content reopened"),e.strictEqual(n.hasClass("open-block"),!0,"check section has reopened")}),QUnit.test("Mobile mode - Clicking a hash link to reveal an already open section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page});t.toggle(this.$section0),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open"),t.reveal("First_Section",this.$container),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is still open")}),QUnit.test("Mobile mode - Reveal element",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page});t.toggle(this.$section0),t.reveal("First_Section"),e.strictEqual(this.$container.find(".collapsible-block").eq(0).hasClass("open-block"),!0,"check content is visible"),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open")}),QUnit.test("Mobile mode - Clicking hash links",function(e){new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}).toggle(this.$section0),this.$container.find('[href="#First_Section"]').trigger("click"),e.strictEqual(this.$container.find(".collapsible-block").eq(0).hasClass("open-block"),!0,"check content is visible"),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open")}),QUnit.test("Mobile mode - Tap event toggles section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),n=this.$container.find(".collapsible-block").eq(1);t.toggle(this.$section0),e.strictEqual(n.hasClass("open-block"),!1,"check content is hidden at start"),this.$container.find("#section_1").trigger("click"),e.strictEqual(n.hasClass("open-block"),!0,"check content is shown on a toggle")}),QUnit.test("Accessibility - Verify aria attributes",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),n=this.$container.find("#section_1"),i=this.$container.find(".collapsible-block").eq(1);t.toggle(this.$section0),e.strictEqual(i.hasClass("open-block"),!1,"check content is hidden at start"),e.strictEqual(i.attr("aria-pressed"),"false","check aria-pressed is false at start"),e.strictEqual(i.attr("aria-expanded"),"false","check aria-expanded is false at start"),n.trigger("click"),e.strictEqual(i.hasClass("open-block"),!0,"check content is visible after toggling"),e.strictEqual(i.attr("aria-pressed"),"true","check aria-pressed is true after toggling"),e.strictEqual(i.attr("aria-expanded"),"true","check aria-expanded is true after toggling"),n.trigger("click"),e.strictEqual(i.hasClass("open-block"),!1,"check content is hidden after toggling"),e.strictEqual(i.attr("aria-pressed"),"false","check aria-pressed is false after toggling"),e.strictEqual(i.attr("aria-expanded"),"false","check aria-expanded is false after toggling")}),QUnit.test("Tablet mode - Open by default",function(e){i.isWideScreen.returns(!0),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(this.$container.find(".collapsible-block").eq(1).hasClass("open-block"),!0,"check section is visible at start"),e.strictEqual(this.$container.find(".collapsible-block").eq(2).hasClass("open-block"),!1,"check reference section is hidden at start")}),QUnit.test("Tablet mode - Open by default 2",function(e){mw.config.get.withArgs("wgMFCollapseSectionsByDefault").returns(!1),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(this.$container.find(".collapsible-block").eq(1).hasClass("open-block"),!0,"check section is visible at start")}),QUnit.test("Accessibility - Pressing space/ enter toggles a heading",function(e){var t,n=this.$container.find("#section_1"),s=$.Event("keypress");i.isWideScreen.returns(!1),mw.config.get.withArgs("wgMFCollapseSectionsByDefault").returns(!0),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),t=this.$container.find(".collapsible-block").eq(1),e.strictEqual(t.hasClass("open-block"),!1,"check content is hidden at start"),s.which=32,n.trigger(s),e.strictEqual(t.hasClass("open-block"),!0,"check content is shown after pressing space"),s.which=13,n.trigger(s),e.strictEqual(t.hasClass("open-block"),!1,"check content is hidden after pressing enter")}),QUnit.test("Clicking a link within a heading isn't triggering a toggle",function(e){var t=$("#section_1"),n=$(".collapsible-block").eq(1);new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(n.hasClass("open-block"),!1,"check content is hidden at start"),t.find("> a").eq(0).trigger("mouseup"),e.strictEqual(n.hasClass("open-block"),!1,"check content is still being hidden after clicking on the link")}),QUnit.test("Toggling a section stores its state.",function(e){var n,i,s=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),o=this.$container.find("h2"),r=a._getExpandedSections(this.page),l=t.spy(mw.storage,"set");e.strictEqual($.isEmptyObject(r[this.title]),!0,"no user setting about an expanded section exists already"),s.toggle(o),n=JSON.parse(l.getCall(0).args[1]),e.strictEqual(typeof n[this.title][this.headline],"number","the just toggled section state has been saved"),s.toggle(o),i=JSON.parse(l.getCall(1).args[1]),e.strictEqual(i[this.title][this.headline],void 0,"the just toggled section state has been removed")}),QUnit.test("Check for and remove obsolete stored sections.",function(e){var n,i,s,o;(s={})[this.title]={},s[this.title][this.headline]=new Date(1990,1,1).getTime(),t.stub(mw.storage,"get",function(){return JSON.stringify(s)}),n=a._getExpandedSections(this.page),e.strictEqual(typeof n[this.title][this.headline],"number","manually created section state has been saved correctly"),i=t.spy(mw.storage,"set"),a._cleanObsoleteStoredSections(this.page),o=JSON.stringify(["expandedSections",'{"Toggle test":{}}']),e.strictEqual(JSON.stringify(i.getCall(0).args),o,"section, whose store time is manually changed to an older date,has been removed from storage correctly")}),QUnit.test("Expanding already expanded section does not toggle it.",function(e){var n,i,s=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),o=this.$container.find("h2"),r=a._getExpandedSections(this.page);e.strictEqual($.isEmptyObject(r[this.title]),!0,"no expanded sections are stored in localStorage yet"),e.strictEqual(o.hasClass("open-block"),!1,"section does not have open-block class"),n=t.spy(mw.storage,"set"),s.toggle(o),e.strictEqual(o.hasClass("open-block"),!0,"revealed section has open-block class"),r=a._getExpandedSections(this.page),i=JSON.parse(n.getCall(0).args[1]),e.strictEqual(typeof i[this.title][this.headline],"number","manually revealed section state has been correctly saved in localStorage"),a._expandStoredSections(s,this.$container,this.page),e.strictEqual(o.hasClass("open-block"),!0,"already revealed section still has open-block class after expanding sections")}),QUnit.test("MobileFrontend toggle.js - Expand stored sections.",function(e){var n,i=this.$container.find("h2").eq(0),s=a._getExpandedSections(this.page);this.$container.find("h2").addClass("section-heading"),e.strictEqual(i.hasClass("open-block"),!1,"Section is collapsed."),e.strictEqual($.isEmptyObject(s[this.title]),!0,"no user setting about an expanded section exists already"),s[this.title][this.headline]=(new Date).getTime(),t.stub(mw.storage,"get",function(){return JSON.stringify(s)}),n=a._getExpandedSections(this.page),e.strictEqual(typeof n[this.title][this.headline],"number","manually created section state has been saved correctly"),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),s=a._getExpandedSections(this.page),e.strictEqual(typeof s[this.title][this.headline],"number","manually created section state is still active after toggle.init()"),e.strictEqual(i.hasClass("open-block"),!0,"Saved section has been auto expanded.")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(6),s=n(7),o=n(5),r=n(8),l=n(4);QUnit.module("MobileFrontend util.js",{beforeEach:function(){i=l.sandbox.create(),a.setUp(i,e),s.setUp(i,e),o.setUp(i,e),r.setUp(i,e),t=n(0)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("escapeSelector()",function(e){e.strictEqual(t.escapeSelector("#selector-starts-with-hash"),"\\#selector-starts-with-hash")}),QUnit.test("grep()",function(e){e.deepEqual(t.grep([1,2],function(e){return e>1}),[2])}),QUnit.test("docReady()",function(e){var n=t.docReady();e.strictEqual(n instanceof $,!0)}),QUnit.test("when()",function(e){return t.when({resolved:!0}).then(function(t){e.strictEqual(t.resolved,!0)})}),QUnit.test("Deferred() - resolve",function(e){var n=new t.Deferred;return n.resolve("response"),n.then(function(t){e.strictEqual(t,"response")})}),QUnit.test("Deferred() - reject",function(e){var n=new t.Deferred;return n.reject("response"),n.catch(function(t){e.strictEqual(t,"response")})}),QUnit.test("getDocument()",function(e){e.strictEqual(t.getDocument().length,1)}),QUnit.test("getWindow()",function(e){e.strictEqual(t.getWindow().length,1)}),QUnit.test("parseHTML()",function(e){var n=t.parseHTML("<p>element content</p>",document);e.strictEqual("object"==typeof n,!0),e.strictEqual(n[0].innerHTML,"element content")}),QUnit.test("isNumeric()",function(e){e.strictEqual(t.isNumeric(123),!0),e.strictEqual(t.isNumeric("123"),!0),e.strictEqual(t.isNumeric("The string 123 is true? I don't like it."),!1),e.strictEqual(t.isNumeric(NaN),!1)}),QUnit.test("extend()",function(e){var n={a:"apple"};t.extend(n,{b:"banana"}),e.strictEqual(JSON.stringify(n),'{"a":"apple","b":"banana"}')}),QUnit.test("escapeHash()",function(e){e.strictEqual(t.escapeHash("#escape:...hash"),"#escape\\:\\.\\.\\.hash")}),QUnit.test("isModifiedEvent() - true",function(e){var n=document.createElement("div");n.addEventListener("click",function(n){e.strictEqual(t.isModifiedEvent(n),!0)}),n.dispatchEvent(new window.MouseEvent("click",{ctrlKey:!0}))}),QUnit.test("isModifiedEvent() - false",function(e){var n=document.createElement("div");n.addEventListener("click",function(n){e.strictEqual(t.isModifiedEvent(n),!1)}),n.dispatchEvent(new window.MouseEvent("click"))}),QUnit.test("repeatEvent",function(e){var n=new OO.EventEmitter,i=new OO.EventEmitter;t.repeatEvent(i,n,"test"),n.on("test",function(t){e.strictEqual(t,"test data","proxy responds to source events correctly")}),i.emit("test","test data")})}).call(this,n(3))},function(e,t,n){(function(e){var t,i,a=n(24),s=n(7),o=n(5),r=n(6),l=n(1),c=n(8),u=n(4);QUnit.module("MobileFrontend mobile.startup/View",{beforeEach:function(){i=u.sandbox.create(),r.setUp(i,e),o.setUp(i,e),c.setUp(i,e),s.setUp(i,e),t=n(2)},afterEach:function(){o.tearDown(),i.restore()}}),QUnit.test("View",function(e){var n=new t({el:"body"});e.ok(n.$el instanceof $,"assign jQuery object to $el"),e.strictEqual(n.$el[0].tagName.toUpperCase(),"BODY","assign proper jQuery object to $el")}),QUnit.test("View, jQuery proxy functions",function(e){var n=new t({el:"body"});["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(t){var a=i.stub(n.$el,t);n[t]("test",1),e.ok(a.calledWith("test",1)),a.restore()})}),QUnit.test("View#preRender",function(e){var n;function i(){t.apply(this,arguments)}l(i,t,{template:a.compile("<p>{{text}}</p>"),preRender:function(){this.options.text="hello"}}),n=new i,e.strictEqual(n.$el.html(),"<p>hello</p>","manipulate template data")}),QUnit.test("View#postRender",function(e){var n=i.spy();function a(){t.apply(this,arguments)}l(a,t,{postRender:function(){n()}}),new a,e.strictEqual(n.callCount,1,"invoke postRender")}),QUnit.test("View#delegateEvents",function(e){var n;function i(){t.apply(this,arguments)}l(i,t,{template:a.compile("<p><span>test</span></p>"),events:{"click p span":function(t){t.preventDefault(),e.ok(!0,"Span was clicked and handled")},"click p":"onParagraphClick",click:"onClick"},onParagraphClick:function(t){t.preventDefault(),e.ok(!0,"Paragraph was clicked and handled")},onClick:function(t){t.preventDefault(),e.ok(!0,"View was clicked and handled")}}),(n=new i).appendTo("body"),n.$el.find("span").trigger("click"),n.$el.find("p").trigger("click"),n.$el.trigger("click"),n.undelegateEvents(),n.$el.find("span").trigger("click"),n.$el.find("p").trigger("click"),n.$el.trigger("click")}),QUnit.test("View#render (with isTemplateMode)",function(e){var n,i,s,o=$("<div>");function r(){t.apply(this,arguments)}function c(){t.call(this,{className:"bar"})}l(r,t,{template:a.compile('<p class="foo"><span>{{text}}</span></p>'),isTemplateMode:!0}),l(c,t,{template:a.compile('<p class="foo"><span>test</span></p>')}),s=(n=new r).$el.text(),i=new c,n.render(),i.render(),n.$el.appendTo(o),n.render({text:"hello"}),e.ok(n.$el.hasClass("foo")),e.ok(i.$el.hasClass("bar")),e.strictEqual(s,"","first run, no text defined"),e.strictEqual(n.$el.text(),"hello","second run, text has been defined"),e.strictEqual(n.$el.parent(o).length,1,"A re-rendered view thats attached to the DOM remains attached to the DOM")}),QUnit.test("View#render events (with isTemplateMode)",function(e){var n;function i(){t.apply(this,arguments)}l(i,t,{events:{"click span":"onClick"},onClick:function(){this.$el.empty().text("hello world")},template:a.compile('<p class="foo"><span>test</span></p>'),isTemplateMode:!0}),(n=new i).$("span").trigger("click"),e.strictEqual(n.$el.text(),"hello world","event was called"),e.strictEqual(n.$("span").length,0,"span disappeared"),(n=new i).render(),n.$("span").trigger("click"),e.strictEqual(n.$el.text(),"hello world","event was called"),e.strictEqual(n.$("span").length,0,"span disappeared")}),QUnit.test("View with className option",function(e){[[new t,"view-border-box","className not defined on a normal View without options and isBorderBox is default"],[new t({}),"view-border-box","className not defined on a normal View with empty options and isBorderBox is default"],[new t({className:"banana"}),"banana view-border-box","option is passed to View (along with default isBorderBox property)"],[new t({isBorderBox:!1}),void 0,"Passing isBorderBox option removes default view-border-box class"],[new t({isBorderBox:!0}),"view-border-box","Passing isBorderBox option as true retains default view-border-box class"]].forEach(function(t){e.strictEqual(t[0].$el.attr("class"),t[1],t[2])})})}).call(this,n(3))}],[[47,0]]]);
//# sourceMappingURL=tests.mobilefrontend.js.map.json