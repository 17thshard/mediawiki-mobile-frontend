{"version":3,"sources":["webpack://mfModules.[name]/./node_modules/hogan.js/lib/compiler.js","webpack://mfModules.[name]/./node_modules/hogan.js/lib/hogan.js","webpack://mfModules.[name]/./node_modules/hogan.js/lib/template.js","webpack://mfModules.[name]/(webpack)/buildin/global.js","webpack://mfModules.[name]/./src/mobile.languages.structured/LanguageOverlay.js","webpack://mfModules.[name]/./src/mobile.languages.structured/rtlLanguages.js","webpack://mfModules.[name]/./src/mobile.languages.structured/util.js","webpack://mfModules.[name]/./src/mobile.mediaViewer/ImageGateway.js","webpack://mfModules.[name]/./src/mobile.mediaViewer/ImageOverlay.js","webpack://mfModules.[name]/./src/mobile.mediaViewer/LoadErrorMessage.js","webpack://mfModules.[name]/./src/mobile.special.watchlist.scripts/WatchList.js","webpack://mfModules.[name]/./src/mobile.special.watchlist.scripts/WatchListGateway.js","webpack://mfModules.[name]/./src/mobile.startup/Anchor.js","webpack://mfModules.[name]/./src/mobile.startup/Browser.js","webpack://mfModules.[name]/./src/mobile.startup/Button.js","webpack://mfModules.[name]/./src/mobile.startup/CtaDrawer.js","webpack://mfModules.[name]/./src/mobile.startup/Drawer.js","webpack://mfModules.[name]/./src/mobile.startup/Icon.js","webpack://mfModules.[name]/./src/mobile.startup/Overlay.js","webpack://mfModules.[name]/./src/mobile.startup/OverlayManager.js","webpack://mfModules.[name]/./src/mobile.startup/Page.js","webpack://mfModules.[name]/./src/mobile.startup/PageGateway.js","webpack://mfModules.[name]/./src/mobile.startup/PageList.js","webpack://mfModules.[name]/./src/mobile.startup/Panel.js","webpack://mfModules.[name]/./src/mobile.startup/ScrollEndEventEmitter.js","webpack://mfModules.[name]/./src/mobile.startup/Section.js","webpack://mfModules.[name]/./src/mobile.startup/Skin.js","webpack://mfModules.[name]/./src/mobile.startup/Thumbnail.js","webpack://mfModules.[name]/./src/mobile.startup/Toggler.js","webpack://mfModules.[name]/./src/mobile.startup/View.js","webpack://mfModules.[name]/./src/mobile.startup/actionParams.js","webpack://mfModules.[name]/./src/mobile.startup/cache.js","webpack://mfModules.[name]/./src/mobile.startup/context.js","webpack://mfModules.[name]/./src/mobile.startup/extendSearchParams.js","webpack://mfModules.[name]/./src/mobile.startup/icons.js","webpack://mfModules.[name]/./src/mobile.startup/lazyImages/lazyImageLoader.js","webpack://mfModules.[name]/./src/mobile.startup/loadingOverlay.js","webpack://mfModules.[name]/./src/mobile.startup/mfExtend.js","webpack://mfModules.[name]/./src/mobile.startup/moduleLoader.js","webpack://mfModules.[name]/./src/mobile.startup/rlModuleLoader.js","webpack://mfModules.[name]/./src/mobile.startup/time.js","webpack://mfModules.[name]/./src/mobile.startup/toast.js","webpack://mfModules.[name]/./src/mobile.startup/util.js","webpack://mfModules.[name]/./src/mobile.startup/watchstar/Watchstar.js","webpack://mfModules.[name]/./src/mobile.startup/watchstar/WatchstarGateway.js","webpack://mfModules.[name]/./src/mobile.startup/watchstar/WatchstarPageList.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.languages.structured/LanguageOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.languages.structured/util.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.mediaViewer/ImageGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.mediaViewer/ImageOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.special.watchlist.scripts/WatchList.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.special.watchlist.scripts/WatchListGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Browser.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Button.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/CtaDrawer.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Drawer.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Overlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/OverlayManager.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Page.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/PageGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Panel.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/ScrollEndEventEmitter.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Section.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Skin.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Toggler.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/View.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/cache.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/context.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/extendSearchParams.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/icons.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/mfExtend.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/moduleLoader.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/rlModuleLoader.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/time.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/util.test.js","webpack://mfModules.[name]/./tests/node-qunit/utils/PageGateway.responses.js","webpack://mfModules.[name]/./tests/node-qunit/utils/PageInputs.html.js","webpack://mfModules.[name]/./tests/node-qunit/utils/dom.js","webpack://mfModules.[name]/./tests/node-qunit/utils/jQuery.js","webpack://mfModules.[name]/./tests/node-qunit/utils/mw.js","webpack://mfModules.[name]/./tests/node-qunit/utils/oo.js","webpack://mfModules.[name]/external \"jquery\"","webpack://mfModules.[name]/external \"jsdom\"","webpack://mfModules.[name]/external \"oojs\"","webpack://mfModules.[name]/external \"sinon\""],"names":["Hogan","rIsWhitespace","rQuot","rNewline","rCr","rSlash","tagTypes","#","^","/","!",">","<","=","_v","{","&","cleanTripleStache","token","n","substr","length","substring","trim","s","replace","tagChange","tag","text","index","charAt","i","l","isOpener","tags","o","isCloser","close","open","c","esc","chooseMethod","indexOf","walk","tree","code","section","nodes","end","otag","ctag","invertedSection","partial","tripleStache","variable","undefined","id","method","start","tok","indent","scan","delimiters","len","state","tagType","buf","tokens","seenTag","lineStart","addBuf","push","String","filterLine","haveSeenTag","noNewLine","isAllWhitespace","j","match","lineIsWhitespace","next","toString","splice","changeDelimiters","closeIndex","split","generate","options","asString","Template","Function","parse","buildTree","kind","stack","customTags","instructions","opener","shift","Error","pop","sectionTags","cache","compile","key","t","this","exports","__webpack_require__","module","useArrayBuffer","renderFunc","compiler","r","prototype","context","partials","v","str","coerceToString","hChars","test","rAmp","rLt","rGt","rApos","render","ri","rp","name","rs","tail","isArray","val","ctx","inverted","pass","ls","d","returnFound","names","f","cx","lv","found","ho","call","b","fl","result","Array","a","Object","g","eval","e","window","Overlay","util","langUtil","LanguageOverlay","languages","getStructuredLanguages","variants","getFrequentlyUsedLanguages","deviceLanguage","allLanguages","all","allLanguagesCount","suggestedLanguages","suggested","suggestedLanguagesCount","extend","className","mfExtend","defaults","heading","mw","msg","inputPlaceholder","allLanguagesHeader","toLocaleUpperCase","suggestedLanguagesHeader","templatePartials","content","template","get","events","click a","input .search","postRender","apply","$siteLinksList","$","$languageItems","find","$subheaders","onLinkClick","ev","lang","currentTarget","attr","self","$visibleLanguageLinks","filter","saveLanguageUsageCount","each","link","hasClass","onSearchInput","filterLanguages","target","toLowerCase","filteredList","forEach","language","langname","autonym","variant","addClass","join","removeClass","log","mfUtils","rtlLanguages","getDir","dir","frequentlyUsedLanguages","hasOwn","hasOwnProperty","maxFrequency","minFrequency","missingDir","addLangDir","parentLanguage","deviceLanguagesWithVariants","slice","getDeviceLanguageOrParent","keys","frequency","map","sort","toLocaleLowerCase","warn","languageMap","storage","JSON","saveFrequentlyUsedLanguages","set","stringify","languageCode","count","sizeBuckets","actionParams","findSizeBucket","size","ImageGateway","_cache","api","getThumb","title","cachedThumb","$window","getWindow","imageSizeMultiplier","devicePixelRatio","prop","titles","iiprop","iiurlwidth","width","iiurlheight","height","then","resp","query","pages","imageinfo","_findSizeBucket","Icon","icons","Button","LoadErrorMessage","router","loader","require","ImageOverlay","gateway","eventBus","hasFixedHeader","hideOnExitClick","cancelButton","cancel","toHtmlString","detailsButton","label","additionalClassNames","progressive","licenseLinkMsg","thumbnails","slideLeftButton","rotation","slideRightButton","click .image-wrapper","click .slider-button","onSlide","nextThumbnail","closest","data","emit","EVENT_SLIDE","preRender","thumbnail","getFileName","caption","getDescription","galleryOffset","_enableArrowImages","thumbs","lastThumb","nextThumb","offset","_disableArrowImages","remove","_handleRetry","$img","removeLoader","hideSpinner","showLoadFailMsg","hasLoadError","hide","retryPath","getPath","on","bind","prependTo","addImageLoadClass","$details","author","url","descriptionurl","thumbWidth","thumbwidth","thumbHeight","thumbheight","imgRatio","parseHTML","document","thumburl","append","_positionImage","extmetadata","LicenseShortName","value","Artist","prepend","adjustDetails","onToggleDetails","toggle","onExitClick","arguments","EVENT_EXIT","show","detailsHeight","windowWidth","windowHeight","windowRatio","is","outerHeight","css","View","isTemplateMode","icon","msgToUser","retryTxt","click .load-fail-msg-link a","onRetry","PageList","WatchstarPageList","ScrollEndEventEmitter","WatchListGateway","WatchList","params","lastTitle","isBorderBox","scrollEndEventEmitter","EVENT_SCROLL_END","_loadPages","el","getLastTitle","disable","setElement","$el","$items","statuses","queryUnitializedItems","parsePagesFromItems","reduce","renderItems","enable","loadWatchlist","page","appendPage","templateOptions","wikidataDescription","item","Page","extendSearchParams","limit","continueParams","continue","gwrcontinue","shouldSkipFirstTitle","canContinue","rvprop","generator","gwrnamespace","gwrlimit","Deferred","resolve","apiUrl","parseData","p1","p2","newFromJSON","Anchor","destructive","href","browser","memoize","memoized","cacheId","Date","now","Math","random","Browser","ua","$container","userAgent","_fixIosLandscapeBug","isIos","lockViewport","addEventListener","version","ios","isWideScreen","parseInt","config","innerWidth","innerHeight","supportsAnimations","elemStyle","createElement","style","supportsProperty","property","toUpperCase","supportsTouchEvents","supportsGeoLocation","navigator","getSingleton","$html","getDocument","tagName","block","quiet","Drawer","CtaDrawer","progressiveButton","actionAnchor","redirectParams","redirectURL","returnto","signUpParams","type","button","anchor","queryParams","returnTo","getUrl","signupQueryParams","Panel","props","collapseIcon","appendToElement","closeOnScroll","click","docReady","appendTo","parent","onShowDrawer","onHideDrawer","stopPropagation","setTimeout","one","minHideDelay","off","hasText","modifier","setRotationClass","_rotationClass","glyphPrefix","isSmall","base","getClassName","getGlyphClassName","html","useVirtualKeyboardHack","fullScreen","header","saveMsg","backButton","headerButtonsListClassName","headerChrome","spinner","click .cancel, .confirm, .initial-header .back","closeOnContentTap","showSpinner","$spinner","$overlayContent","setupEmulatedIosOverlayScrolling","onTouchStart","onTouchMove","_fixIosHeader","preventDefault","startY","originalEvent","touches","pageY","y","contentOuterHeight","contentLength","scrollTop","pageYOffset","scrollTo","_resizeContent","pageXOffset","detach","keyboardHeight","showHidden","overlayManager","OverlayManager","appendToSelector","_checkRoute","entries","hideCurrent","_onHideOverlay","back","_attachOverlay","overlay","parents","_show","once","_hideOverlay","_processMatch","factoryResult","attachHideEvent","promise","current","m","_matchRoute","path","entry","route","previous","getNext","factory","unshift","add","replaceCurrent","HTML","time","Section","Thumbnail","HEADING_SELECTOR","BLACKLISTED_THUMBNAIL_CLASS_SELECTORS","displayTitle","isMissing","languageUrl","getDisplayTitle","isLandscape","namespaceNumber","protection","edit","sections","isMainPage","source","escape","inNamespace","namespace","findSectionHeadingByIndex","sectionIndex","eq","findChildInSectionLead","selector","$heading","$nextHeading","$lead","headingSelector","withNestedChildren","$matchingNodes","addBack","getLeadSectionElement","children","prevAll","nextAll","nextUntil","isWikiText","isWatched","getRevisionId","revId","getTitle","getId","getNamespaceId","args","isTalkPage","ns","_sectionLookup","sectionData","getThumbnails","blacklistSelector","_thumbs","not","$a","$lazyImage","valid","legacyMatch","RegExp","filename","decodeURIComponent","getSection","getSections","getRedLinks","revision","thumb","pageprops","displaytitle","terms","description","revisions","lastModified","getLastModifiedMessage","timestamp","getTime","user","pageid","missing","sectionTemplate","transformSections","lastSection","existingSectionLevels","level","collapseLevel","min","line","subsections","assignToParent","listOfSections","child","PageGateway","getPage","endpoint","leadOnly","dataType","action","redirect","noheadings","sectionprop","resolveObj","mv","error","reject","mobileview","lastmodified","lastmodifiedby","lead","mainpage","historyUrl","lastModifiedTimestamp","languageCount","languagecount","hasVariants","hasvariants","lastModifiedUserName","lastModifiedUserGender","gender","invalidatePage","_getLanguageVariantsFromApiResponse","generalData","general","variantPath","variantarticlepath","getPageLanguages","meta","siprop","lllimit","llprop","llinlanguagecode","langlinks","_getAPIResponseFromHTML","$span","getSectionsFromHTML","renderPageImages","click .cancel","onCancel","isVisible","threshold","OO","EventEmitter","mixinClass","_bindScroll","_scrollHandler","_onScroll","_unbindScroll","enabled","scrollNearEnd","scrollBottom","endPosition","top","hasReferences","lazyImageLoader","viewport","getSectionId","hSelector","$parent","Skin","mainMenu","referencesGateway","setupImageLoading","lazyLoadReferences","getUnloadedImages","toArray","imagePlaceholders","_loadImages","images","grep","placeholder","$placeholder","isElementCloseToViewport","shouldLoadImage","loadImages","loadImagesList","$content","wasExpanded","isReferenceSection","getReferencesLists","lastId","refListIndex","getReferencesList","refListElements","replaceWith","loadImagesAndSetData","getLicenseMsg","licenseMsg","mfLicense","licensePlural","convertNumber","plural","message","siblings","escapeHash","arrowOptions","Toggler","_enable","prefix","isClosed","getExpandedSections","expandedSections","saveExpandedSections","expandStoredSections","toggler","$sectionHeading","$headline","cleanObsoleteStoredSections","floor","indicator","sectionNumber","toggleClass","Boolean","aria-pressed","aria-expanded","headline","isSectionOpen","storeSectionToggleState","reveal","$target","prev","expandSections","$link","collapseSectionsByDefault","checkHash","hash","location","$indicator","tabindex","aria-haspopup","aria-controls","which","enableKeyboardActions","internalRedirect","internalRedirectHash","checkInternalRedirectAndHash","_getExpandedSections","_expandStoredSections","_cleanObsoleteStoredSections","DEPRECATED_PROPERTIES","delegateEventSplitter","idCounter","deprecate","initialize","cid","uniqueId","_postInitialize","undelegateEvents","skipTemplateRender","delegateEvents","delegate","eventName","listener","undelegate","defaultParams","formatversion","otherParams","scriptPath","origin","MemoryCache","NoCache","getMode","feature","displayWikibaseDescriptions","concat","CANCEL_GLYPH","glyph","watchIcon","watchedIcon","when","callbacks","loadImage","$downloadingImage","ownerDocument","class","src","alt","srcset","noHeader","Child","ParentOrPrototype","inheritClass","initClass","ModuleLoader","_register","registry","localRequire","define","obj","deprecatedId","replacement","loadingOverlay","newLoadingOverlay","loadModule","delegateHide","showLoadingOverlay","hideOverlayIfNeeded","body","using","units","limits","timeAgo","timestampDelta","round","unit","getTimeAgoDelta","isNow","delta","ts","username","seconds","minutes","hours","days","months","years","getRegistrationMessage","isRecent","storageKey","Toast","requestIdleCallback","_showPending","notification","notify","notif","showOnPageReload","escapeSelector","fn","warning","fail","always","done","documentElement","isNumeric","isModifiedEvent","altKey","ctrlKey","metaKey","shiftKey","repeatEvent","proxy","event","WatchstarGateway","toast","Watchstar","funnel","ctaDrawerOptions","campaign","returntoquery","_super","_watched","tooltip","unwatchedClass","watchedClass","isAnon","onLinksClick","onStatusToggleAnon","drawer","onStatusToggleUser","checker","postWatched","stopInterval","clearInterval","setInterval","postStatusesByTitle","onStatusToggle","getStatuses","ids","getStatusesByID","getStatusesByTitle","inprop","pageids","rsp","_unmarshalGetResponse","watched","unwatch","postWithToken","wsGateway","getPages","_","$item","_appendWatchstar","watchstar","global","sandbox","jQuery","dom","mediaWiki","oo","sinon","apiLanguages","zh-min-nan","zh","en","ko","QUnit","beforeEach","create","setUp","stub","withArgs","returns","languageOverlay","currentLanguage","afterEach","tearDown","restore","assert","strictEqual","ok","apiVariants","structuredLanguages","saveSpy","deepEqual","calledWith","variantsMap","suggestedLanguage","rejects","err","image","imageGateway","catch","notStrictEqual","trigger","spy","Api","async","pl","watchIconName","notCalled","response","pageimages","picontinue","warnings","*","contentmodel","pagelanguage","touched","lastrevid","new","watchlist","firstCall","response1","watchlistraw","batchcomplete","mediawiki","tmpDOM","implementation","createHTMLDocument","browser4","browser5","browser2","ipad","iphone","android2","viewportTagVal","animationName","transform","transition","ontouchstart","geolocation","getAttribute","defaultURLs","overrideURLs","pageName","appendChild","removeChild","subject","propEqual","outerHTML","callOnPresented","callback","assertHidden","Event","dispatchEvent","bubbles","$viewport","headingNode","TestOverlay","parentNode","fakeRouter","createFakeOverlay","fakeOverlay","singleton","callCount","showSpy","deferred","notOk","called","anotherFakeOverlay","factoryStub","getCall","notCalledWith","parentFakeOverlay","parentFactoryStub","calledOnce","retryOverlayFn","failedOverlay","successfulOverlay","onCall","stubPage","mobileTocPage","desktopPage","sectionPage","PARSER_OUTPUT","ambox","sectionHeading","sectionSubHeading","sectionBody","expect","testcase","p","textPage","pLegacyUrls","pNoViewer","pMetadata","pLazyImages","metadataTable","pLazyImagesTypo","pMetadataNested","tc","notMissing","testDesc","json","pageGateway","examples","page2","testData","getPageHeadings","input","output","getPageLanguagesResponse","getPageLanguagesCall","getAPIResponseFromHTML","expected","move","panel","is2","handler","emitSpy","subsection","skin","skinPage","$elTwo","$elThree","$elFour","$elFive","$section0","$section","mwStorageSetCall","mwStorageSetCall2","mwStorageSetSpy","isEmptyObject","localStorageValue","localStorageRemovalValue","expandedSectionsFromToggle","view","ChildView","EventsView","click p span","click p","onParagraphClick","onClick","view2","textFirstRun","TemplateModeView","ContainerView","click span","empty","memoryCache","foo","search","nearby","expectedError","throws","qux","wbptterms","baz","quux","TestChild","TestPrototype","testChild","testPrototype","protoMethod","rlModuleLoader","assertShowHideWorksWhenSuccessful","firstArg","secondArg","thirdArg","resolved","res","htmlFragment","innerHTML","NaN","testEl","MouseEvent","references","referencesPage","lazyLoadedReferencesPage","headless","jsdom","JSDOM","newMockMediaWiki"],"mappings":"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","file":"tests.mobilefrontend.js","sourcesContent":["/*\n *  Copyright 2011 Twitter, Inc.\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\n(function (Hogan) {\n  // Setup regex  assignments\n  // remove whitespace according to Mustache spec\n  var rIsWhitespace = /\\S/,\n      rQuot = /\\\"/g,\n      rNewline =  /\\n/g,\n      rCr = /\\r/g,\n      rSlash = /\\\\/g,\n      tagTypes = {\n        '#': 1, '^': 2, '/': 3,  '!': 4, '>': 5,\n        '<': 6, '=': 7, '_v': 8, '{': 9, '&': 10\n      };\n\n  Hogan.scan = function scan(text, delimiters) {\n    var len = text.length,\n        IN_TEXT = 0,\n        IN_TAG_TYPE = 1,\n        IN_TAG = 2,\n        state = IN_TEXT,\n        tagType = null,\n        tag = null,\n        buf = '',\n        tokens = [],\n        seenTag = false,\n        i = 0,\n        lineStart = 0,\n        otag = '{{',\n        ctag = '}}';\n\n    function addBuf() {\n      if (buf.length > 0) {\n        tokens.push(new String(buf));\n        buf = '';\n      }\n    }\n\n    function lineIsWhitespace() {\n      var isAllWhitespace = true;\n      for (var j = lineStart; j < tokens.length; j++) {\n        isAllWhitespace =\n          (tokens[j].tag && tagTypes[tokens[j].tag] < tagTypes['_v']) ||\n          (!tokens[j].tag && tokens[j].match(rIsWhitespace) === null);\n        if (!isAllWhitespace) {\n          return false;\n        }\n      }\n\n      return isAllWhitespace;\n    }\n\n    function filterLine(haveSeenTag, noNewLine) {\n      addBuf();\n\n      if (haveSeenTag && lineIsWhitespace()) {\n        for (var j = lineStart, next; j < tokens.length; j++) {\n          if (!tokens[j].tag) {\n            if ((next = tokens[j+1]) && next.tag == '>') {\n              // set indent to token value\n              next.indent = tokens[j].toString()\n            }\n            tokens.splice(j, 1);\n          }\n        }\n      } else if (!noNewLine) {\n        tokens.push({tag:'\\n'});\n      }\n\n      seenTag = false;\n      lineStart = tokens.length;\n    }\n\n    function changeDelimiters(text, index) {\n      var close = '=' + ctag,\n          closeIndex = text.indexOf(close, index),\n          delimiters = trim(\n            text.substring(text.indexOf('=', index) + 1, closeIndex)\n          ).split(' ');\n\n      otag = delimiters[0];\n      ctag = delimiters[1];\n\n      return closeIndex + close.length - 1;\n    }\n\n    if (delimiters) {\n      delimiters = delimiters.split(' ');\n      otag = delimiters[0];\n      ctag = delimiters[1];\n    }\n\n    for (i = 0; i < len; i++) {\n      if (state == IN_TEXT) {\n        if (tagChange(otag, text, i)) {\n          --i;\n          addBuf();\n          state = IN_TAG_TYPE;\n        } else {\n          if (text.charAt(i) == '\\n') {\n            filterLine(seenTag);\n          } else {\n            buf += text.charAt(i);\n          }\n        }\n      } else if (state == IN_TAG_TYPE) {\n        i += otag.length - 1;\n        tag = tagTypes[text.charAt(i + 1)];\n        tagType = tag ? text.charAt(i + 1) : '_v';\n        if (tagType == '=') {\n          i = changeDelimiters(text, i);\n          state = IN_TEXT;\n        } else {\n          if (tag) {\n            i++;\n          }\n          state = IN_TAG;\n        }\n        seenTag = i;\n      } else {\n        if (tagChange(ctag, text, i)) {\n          tokens.push({tag: tagType, n: trim(buf), otag: otag, ctag: ctag,\n                       i: (tagType == '/') ? seenTag - ctag.length : i + otag.length});\n          buf = '';\n          i += ctag.length - 1;\n          state = IN_TEXT;\n          if (tagType == '{') {\n            if (ctag == '}}') {\n              i++;\n            } else {\n              cleanTripleStache(tokens[tokens.length - 1]);\n            }\n          }\n        } else {\n          buf += text.charAt(i);\n        }\n      }\n    }\n\n    filterLine(seenTag, true);\n\n    return tokens;\n  }\n\n  function cleanTripleStache(token) {\n    if (token.n.substr(token.n.length - 1) === '}') {\n      token.n = token.n.substring(0, token.n.length - 1);\n    }\n  }\n\n  function trim(s) {\n    if (s.trim) {\n      return s.trim();\n    }\n\n    return s.replace(/^\\s*|\\s*$/g, '');\n  }\n\n  function tagChange(tag, text, index) {\n    if (text.charAt(index) != tag.charAt(0)) {\n      return false;\n    }\n\n    for (var i = 1, l = tag.length; i < l; i++) {\n      if (text.charAt(index + i) != tag.charAt(i)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function buildTree(tokens, kind, stack, customTags) {\n    var instructions = [],\n        opener = null,\n        token = null;\n\n    while (tokens.length > 0) {\n      token = tokens.shift();\n      if (token.tag == '#' || token.tag == '^' || isOpener(token, customTags)) {\n        stack.push(token);\n        token.nodes = buildTree(tokens, token.tag, stack, customTags);\n        instructions.push(token);\n      } else if (token.tag == '/') {\n        if (stack.length === 0) {\n          throw new Error('Closing tag without opener: /' + token.n);\n        }\n        opener = stack.pop();\n        if (token.n != opener.n && !isCloser(token.n, opener.n, customTags)) {\n          throw new Error('Nesting error: ' + opener.n + ' vs. ' + token.n);\n        }\n        opener.end = token.i;\n        return instructions;\n      } else {\n        instructions.push(token);\n      }\n    }\n\n    if (stack.length > 0) {\n      throw new Error('missing closing tag: ' + stack.pop().n);\n    }\n\n    return instructions;\n  }\n\n  function isOpener(token, tags) {\n    for (var i = 0, l = tags.length; i < l; i++) {\n      if (tags[i].o == token.n) {\n        token.tag = '#';\n        return true;\n      }\n    }\n  }\n\n  function isCloser(close, open, tags) {\n    for (var i = 0, l = tags.length; i < l; i++) {\n      if (tags[i].c == close && tags[i].o == open) {\n        return true;\n      }\n    }\n  }\n\n  Hogan.generate = function (tree, text, options) {\n    var code = 'var _=this;_.b(i=i||\"\");' + walk(tree) + 'return _.fl();';\n    if (options.asString) {\n      return 'function(c,p,i){' + code + ';}';\n    }\n\n    return new Hogan.Template(new Function('c', 'p', 'i', code), text, Hogan, options);\n  }\n\n  function esc(s) {\n    return s.replace(rSlash, '\\\\\\\\')\n            .replace(rQuot, '\\\\\\\"')\n            .replace(rNewline, '\\\\n')\n            .replace(rCr, '\\\\r');\n  }\n\n  function chooseMethod(s) {\n    return (~s.indexOf('.')) ? 'd' : 'f';\n  }\n\n  function walk(tree) {\n    var code = '';\n    for (var i = 0, l = tree.length; i < l; i++) {\n      var tag = tree[i].tag;\n      if (tag == '#') {\n        code += section(tree[i].nodes, tree[i].n, chooseMethod(tree[i].n),\n                        tree[i].i, tree[i].end, tree[i].otag + \" \" + tree[i].ctag);\n      } else if (tag == '^') {\n        code += invertedSection(tree[i].nodes, tree[i].n,\n                                chooseMethod(tree[i].n));\n      } else if (tag == '<' || tag == '>') {\n        code += partial(tree[i]);\n      } else if (tag == '{' || tag == '&') {\n        code += tripleStache(tree[i].n, chooseMethod(tree[i].n));\n      } else if (tag == '\\n') {\n        code += text('\"\\\\n\"' + (tree.length-1 == i ? '' : ' + i'));\n      } else if (tag == '_v') {\n        code += variable(tree[i].n, chooseMethod(tree[i].n));\n      } else if (tag === undefined) {\n        code += text('\"' + esc(tree[i]) + '\"');\n      }\n    }\n    return code;\n  }\n\n  function section(nodes, id, method, start, end, tags) {\n    return 'if(_.s(_.' + method + '(\"' + esc(id) + '\",c,p,1),' +\n           'c,p,0,' + start + ',' + end + ',\"' + tags + '\")){' +\n           '_.rs(c,p,' +\n           'function(c,p,_){' +\n           walk(nodes) +\n           '});c.pop();}';\n  }\n\n  function invertedSection(nodes, id, method) {\n    return 'if(!_.s(_.' + method + '(\"' + esc(id) + '\",c,p,1),c,p,1,0,0,\"\")){' +\n           walk(nodes) +\n           '};';\n  }\n\n  function partial(tok) {\n    return '_.b(_.rp(\"' +  esc(tok.n) + '\",c,p,\"' + (tok.indent || '') + '\"));';\n  }\n\n  function tripleStache(id, method) {\n    return '_.b(_.t(_.' + method + '(\"' + esc(id) + '\",c,p,0)));';\n  }\n\n  function variable(id, method) {\n    return '_.b(_.v(_.' + method + '(\"' + esc(id) + '\",c,p,0)));';\n  }\n\n  function text(id) {\n    return '_.b(' + id + ');';\n  }\n\n  Hogan.parse = function(tokens, text, options) {\n    options = options || {};\n    return buildTree(tokens, '', [], options.sectionTags || []);\n  },\n\n  Hogan.cache = {};\n\n  Hogan.compile = function(text, options) {\n    // options\n    //\n    // asString: false (default)\n    //\n    // sectionTags: [{o: '_foo', c: 'foo'}]\n    // An array of object with o and c fields that indicate names for custom\n    // section tags. The example above allows parsing of {{_foo}}{{/foo}}.\n    //\n    // delimiters: A string that overrides the default delimiters.\n    // Example: \"<% %>\"\n    //\n    options = options || {};\n\n    var key = text + '||' + !!options.asString;\n\n    var t = this.cache[key];\n\n    if (t) {\n      return t;\n    }\n\n    t = this.generate(this.parse(this.scan(text, options.delimiters), text, options), text, options);\n    return this.cache[key] = t;\n  };\n})(typeof exports !== 'undefined' ? exports : Hogan);\n","/*\n *  Copyright 2011 Twitter, Inc.\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\n// This file is for use with Node.js. See dist/ for browser files.\n\nvar Hogan = require('./compiler');\nHogan.Template = require('./template').Template;\nmodule.exports = Hogan; ","/*\n *  Copyright 2011 Twitter, Inc.\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nvar Hogan = {};\n\n(function (Hogan, useArrayBuffer) {\n  Hogan.Template = function (renderFunc, text, compiler, options) {\n    this.r = renderFunc || this.r;\n    this.c = compiler;\n    this.options = options;\n    this.text = text || '';\n    this.buf = (useArrayBuffer) ? [] : '';\n  }\n\n  Hogan.Template.prototype = {\n    // render: replaced by generated code.\n    r: function (context, partials, indent) { return ''; },\n\n    // variable escaping\n    v: hoganEscape,\n\n    // triple stache\n    t: coerceToString,\n\n    render: function render(context, partials, indent) {\n      return this.ri([context], partials || {}, indent);\n    },\n\n    // render internal -- a hook for overrides that catches partials too\n    ri: function (context, partials, indent) {\n      return this.r(context, partials, indent);\n    },\n\n    // tries to find a partial in the curent scope and render it\n    rp: function(name, context, partials, indent) {\n      var partial = partials[name];\n\n      if (!partial) {\n        return '';\n      }\n\n      if (this.c && typeof partial == 'string') {\n        partial = this.c.compile(partial, this.options);\n      }\n\n      return partial.ri(context, partials, indent);\n    },\n\n    // render a section\n    rs: function(context, partials, section) {\n      var tail = context[context.length - 1];\n\n      if (!isArray(tail)) {\n        section(context, partials, this);\n        return;\n      }\n\n      for (var i = 0; i < tail.length; i++) {\n        context.push(tail[i]);\n        section(context, partials, this);\n        context.pop();\n      }\n    },\n\n    // maybe start a section\n    s: function(val, ctx, partials, inverted, start, end, tags) {\n      var pass;\n\n      if (isArray(val) && val.length === 0) {\n        return false;\n      }\n\n      if (typeof val == 'function') {\n        val = this.ls(val, ctx, partials, inverted, start, end, tags);\n      }\n\n      pass = (val === '') || !!val;\n\n      if (!inverted && pass && ctx) {\n        ctx.push((typeof val == 'object') ? val : ctx[ctx.length - 1]);\n      }\n\n      return pass;\n    },\n\n    // find values with dotted names\n    d: function(key, ctx, partials, returnFound) {\n      var names = key.split('.'),\n          val = this.f(names[0], ctx, partials, returnFound),\n          cx = null;\n\n      if (key === '.' && isArray(ctx[ctx.length - 2])) {\n        return ctx[ctx.length - 1];\n      }\n\n      for (var i = 1; i < names.length; i++) {\n        if (val && typeof val == 'object' && names[i] in val) {\n          cx = val;\n          val = val[names[i]];\n        } else {\n          val = '';\n        }\n      }\n\n      if (returnFound && !val) {\n        return false;\n      }\n\n      if (!returnFound && typeof val == 'function') {\n        ctx.push(cx);\n        val = this.lv(val, ctx, partials);\n        ctx.pop();\n      }\n\n      return val;\n    },\n\n    // find values with normal names\n    f: function(key, ctx, partials, returnFound) {\n      var val = false,\n          v = null,\n          found = false;\n\n      for (var i = ctx.length - 1; i >= 0; i--) {\n        v = ctx[i];\n        if (v && typeof v == 'object' && key in v) {\n          val = v[key];\n          found = true;\n          break;\n        }\n      }\n\n      if (!found) {\n        return (returnFound) ? false : \"\";\n      }\n\n      if (!returnFound && typeof val == 'function') {\n        val = this.lv(val, ctx, partials);\n      }\n\n      return val;\n    },\n\n    // higher order templates\n    ho: function(val, cx, partials, text, tags) {\n      var compiler = this.c;\n      var options = this.options;\n      options.delimiters = tags;\n      var text = val.call(cx, text);\n      text = (text == null) ? String(text) : text.toString();\n      this.b(compiler.compile(text, options).render(cx, partials));\n      return false;\n    },\n\n    // template result buffering\n    b: (useArrayBuffer) ? function(s) { this.buf.push(s); } :\n                          function(s) { this.buf += s; },\n    fl: (useArrayBuffer) ? function() { var r = this.buf.join(''); this.buf = []; return r; } :\n                           function() { var r = this.buf; this.buf = ''; return r; },\n\n    // lambda replace section\n    ls: function(val, ctx, partials, inverted, start, end, tags) {\n      var cx = ctx[ctx.length - 1],\n          t = null;\n\n      if (!inverted && this.c && val.length > 0) {\n        return this.ho(val, cx, partials, this.text.substring(start, end), tags);\n      }\n\n      t = val.call(cx);\n\n      if (typeof t == 'function') {\n        if (inverted) {\n          return true;\n        } else if (this.c) {\n          return this.ho(t, cx, partials, this.text.substring(start, end), tags);\n        }\n      }\n\n      return t;\n    },\n\n    // lambda replace variable\n    lv: function(val, ctx, partials) {\n      var cx = ctx[ctx.length - 1];\n      var result = val.call(cx);\n\n      if (typeof result == 'function') {\n        result = coerceToString(result.call(cx));\n        if (this.c && ~result.indexOf(\"{\\u007B\")) {\n          return this.c.compile(result, this.options).render(cx, partials);\n        }\n      }\n\n      return coerceToString(result);\n    }\n\n  };\n\n  var rAmp = /&/g,\n      rLt = /</g,\n      rGt = />/g,\n      rApos =/\\'/g,\n      rQuot = /\\\"/g,\n      hChars =/[&<>\\\"\\']/;\n\n\n  function coerceToString(val) {\n    return String((val === null || val === undefined) ? '' : val);\n  }\n\n  function hoganEscape(str) {\n    str = coerceToString(str);\n    return hChars.test(str) ?\n      str\n        .replace(rAmp,'&amp;')\n        .replace(rLt,'&lt;')\n        .replace(rGt,'&gt;')\n        .replace(rApos,'&#39;')\n        .replace(rQuot, '&quot;') :\n      str;\n  }\n\n  var isArray = Array.isArray || function(a) {\n    return Object.prototype.toString.call(a) === '[object Array]';\n  };\n\n})(typeof exports !== 'undefined' ? exports : Hogan);\n\n","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","var Overlay = require( '../mobile.startup/Overlay' ),\n\tutil = require( '../mobile.startup/util' ),\n\tlangUtil = require( './util' ),\n\tmfExtend = require( '../mobile.startup/mfExtend' );\n\n/**\n * Overlay displaying a structured list of languages for a page\n *\n * @class LanguageOverlay\n * @extends Overlay\n *\n * @param {Object} options Configuration options\n * @param {Object[]} options.languages list of language objects as returned by the API\n * @param {Array|boolean} options.variants language variant objects\n *  or false if no variants exist\n * @param {string} [options.deviceLanguage] the device's primary language\n */\nfunction LanguageOverlay( options ) {\n\tvar languages;\n\n\tlanguages = langUtil.getStructuredLanguages(\n\t\toptions.languages,\n\t\toptions.variants,\n\t\tlangUtil.getFrequentlyUsedLanguages(),\n\t\toptions.deviceLanguage\n\t);\n\toptions.allLanguages = languages.all;\n\toptions.allLanguagesCount = languages.all.length;\n\toptions.suggestedLanguages = languages.suggested;\n\toptions.suggestedLanguagesCount = languages.suggested.length;\n\tOverlay.call( this,\n\t\tutil.extend( options, {\n\t\t\tclassName: 'overlay language-overlay'\n\t\t} )\n\t);\n}\n\nmfExtend( LanguageOverlay, Overlay, {\n\t/**\n\t * @memberof LanguageOverlay\n\t * @instance\n\t * @mixes Overlay#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {Object[]} defaults.languages each object has keys as\n\t *  returned by the langlink API https://www.mediawiki.org/wiki/API:Langlinks\n\t */\n\tdefaults: util.extend( {}, Overlay.prototype.defaults, {\n\t\theading: mw.msg( 'mobile-frontend-language-heading' ),\n\t\tinputPlaceholder: mw.msg( 'mobile-frontend-languages-structured-overlay-search-input-placeholder' ),\n\t\t// we can't rely on CSS only to uppercase the headings. See https://stackoverflow.com/questions/3777443/css-text-transform-not-working-properly-for-turkish-characters\n\t\tallLanguagesHeader: mw.msg( 'mobile-frontend-languages-structured-overlay-all-languages-header' ).toLocaleUpperCase(),\n\t\tsuggestedLanguagesHeader: mw.msg( 'mobile-frontend-languages-structured-overlay-suggested-languages-header' ).toLocaleUpperCase()\n\t} ),\n\t/**\n\t * @inheritdoc\n\t * @memberof LanguageOverlay\n\t * @instance\n\t */\n\ttemplatePartials: util.extend( {}, Overlay.prototype.templatePartials, {\n\t\tcontent: mw.template.get( 'mobile.languages.structured', 'LanguageOverlay.hogan' )\n\t} ),\n\t/**\n\t * @inheritdoc\n\t * @memberof LanguageOverlay\n\t * @instance\n\t */\n\tevents: util.extend( {}, Overlay.prototype.events, {\n\t\t'click a': 'onLinkClick',\n\t\t'input .search': 'onSearchInput'\n\t} ),\n\t/**\n\t * @inheritdoc\n\t * @memberof LanguageOverlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tOverlay.prototype.postRender.apply( this );\n\n\t\t// cache\n\t\tthis.$siteLinksList = this.$( '.site-link-list' );\n\t\tthis.$languageItems = this.$siteLinksList.find( 'a' );\n\t\tthis.$subheaders = this.$( 'h3' );\n\t},\n\t/**\n\t * Article link click event handler\n\t * @memberof LanguageOverlay\n\t * @instance\n\t * @param {jQuery.Event} ev\n\t */\n\tonLinkClick: function ( ev ) {\n\t\tvar $link = this.$( ev.currentTarget ),\n\t\t\tlang = $link.attr( 'lang' ),\n\t\t\tself = this,\n\t\t\t$visibleLanguageLinks = this.$languageItems.filter( ':visible' );\n\n\t\tlangUtil.saveLanguageUsageCount( lang, langUtil.getFrequentlyUsedLanguages() );\n\n\t\t// find the index of the clicked language in the list of visible results\n\t\t$visibleLanguageLinks.each( function ( i, link ) {\n\t\t\tif ( self.$( link ).hasClass( lang ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\t},\n\t/**\n\t * Search input handler\n\t * @memberof LanguageOverlay\n\t * @instance\n\t * @param {jQuery.Event} ev Event object.\n\t */\n\tonSearchInput: function ( ev ) {\n\t\tthis.filterLanguages( this.$( ev.target ).val().toLowerCase() );\n\t},\n\t/**\n\t * Filter the language list to only show languages that match the current search term.\n\t * @memberof LanguageOverlay\n\t * @instance\n\t * @param {string} val of search term (lowercase).\n\t */\n\tfilterLanguages: function ( val ) {\n\t\tvar filteredList = [];\n\n\t\tif ( val ) {\n\t\t\tthis.options.languages.forEach( function ( language ) {\n\t\t\t\tvar langname = language.langname;\n\t\t\t\t// search by language code or language name\n\t\t\t\tif ( language.autonym.toLowerCase().indexOf( val ) > -1 ||\n\t\t\t\t\t\t( langname && langname.toLowerCase().indexOf( val ) > -1 ) ||\n\t\t\t\t\t\tlanguage.lang.toLowerCase().indexOf( val ) > -1\n\t\t\t\t) {\n\t\t\t\t\tfilteredList.push( language.lang );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif ( this.options.variants ) {\n\t\t\t\tthis.options.variants.forEach( function ( variant ) {\n\t\t\t\t\t// search by variant code or variant name\n\t\t\t\t\tif ( variant.autonym.toLowerCase().indexOf( val ) > -1 ||\n\t\t\t\t\t\tvariant.lang.toLowerCase().indexOf( val ) > -1\n\t\t\t\t\t) {\n\t\t\t\t\t\tfilteredList.push( variant.lang );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.$languageItems.addClass( 'hidden' );\n\t\t\tif ( filteredList.length ) {\n\t\t\t\tthis.$siteLinksList.find( '.' + filteredList.join( ',.' ) ).removeClass( 'hidden' );\n\t\t\t}\n\t\t\tthis.$siteLinksList.addClass( 'filtered' );\n\t\t\tthis.$subheaders.addClass( 'hidden' );\n\t\t} else {\n\t\t\tthis.$languageItems.removeClass( 'hidden' );\n\t\t\tthis.$siteLinksList.removeClass( 'filtered' );\n\t\t\tthis.$subheaders.removeClass( 'hidden' );\n\t\t}\n\t}\n} );\n\nmodule.exports = LanguageOverlay;\n","module.exports = [\n\t'aeb',\n\t'aeb-arab',\n\t'ar',\n\t'arc',\n\t'arq',\n\t'arz',\n\t'azb',\n\t'bcc',\n\t'bgn',\n\t'bqi',\n\t'ckb',\n\t'dv',\n\t'fa',\n\t'glk',\n\t'he',\n\t'khw',\n\t'kk-arab',\n\t'kk-cn',\n\t'ks',\n\t'ks-arab',\n\t'ku-arab',\n\t'lki',\n\t'lrc',\n\t'luz',\n\t'mzn',\n\t'pnb',\n\t'ps',\n\t'sd',\n\t'sdh',\n\t'skr',\n\t'skr-arab',\n\t'ug',\n\t'ug-arab',\n\t'ur',\n\t'yi'\n];\n","var\n\tlog = mw.log,\n\tmfUtils = require( '../mobile.startup/util' ),\n\trtlLanguages = require( './rtlLanguages' );\n\n/**\n * Return the device language if it's in the list of article languages.\n * If the language is a variant of a general language, and if the article\n * is not available in that language, then return the general language\n * if article is available in it. For example, if the device language is\n * 'en-gb', and the article is only available in 'en', then return 'en'.\n * @param {Object[]} languages list of language objects as returned by the API\n * @param {string|undefined} deviceLanguage the device's primary language\n * @return {string|undefined} Return undefined if the article is not available in\n *  the (general or variant) device language\n */\nfunction getDeviceLanguageOrParent( languages, deviceLanguage ) {\n\tvar parentLanguage, index,\n\t\thasOwn = Object.prototype.hasOwnProperty,\n\t\tdeviceLanguagesWithVariants = {};\n\n\tif ( !deviceLanguage ) {\n\t\treturn;\n\t}\n\n\t// Are we dealing with a variant?\n\tindex = deviceLanguage.indexOf( '-' );\n\tif ( index !== -1 ) {\n\t\tparentLanguage = deviceLanguage.slice( 0, index );\n\t}\n\n\tlanguages.forEach( function ( language ) {\n\t\tif ( language.lang === parentLanguage || language.lang === deviceLanguage ) {\n\t\t\tdeviceLanguagesWithVariants[ language.lang ] = true;\n\t\t}\n\t} );\n\n\tif ( hasOwn.call( deviceLanguagesWithVariants, deviceLanguage ) ) {\n\t\t// the device language is one of the available languages\n\t\treturn deviceLanguage;\n\t} else if ( hasOwn.call( deviceLanguagesWithVariants, parentLanguage ) ) {\n\t\t// no device language, but the parent language is one of the available languages\n\t\treturn parentLanguage;\n\t}\n}\n\n/**\n * Utility function for the structured language overlay\n *\n * @class util\n * @singleton\n */\nmodule.exports = {\n\t/**\n\t * Determine whether a language is LTR or RTL\n\t * This works around T74153 and T189036\n\t * @memberof util\n\t * @instance\n\t * @param {Object} language with 'lang' key.\n\t * @return {Object} language with 'lang' key and new 'dir' key.\n\t */\n\tgetDir: function ( language ) {\n\t\tvar dir = rtlLanguages.indexOf( language.lang ) > -1 ? 'rtl' : 'ltr';\n\t\treturn mfUtils.extend( {}, language, { dir: dir } );\n\t},\n\n\t/**\n\t * Return two sets of languages: suggested and all (everything else)\n\t *\n\t * Suggested languages are the ones that the user has used before. This also\n\t * includes the user device's primary language. Suggested languages are ordered\n\t * by frequency in descending order. The device's language is always at the top.\n\t * This group also includes the variants.\n\t *\n\t * All languages are the languages that are not suggested.\n\t * Languages in this list are ordered in the lexicographical order of\n\t * their language names.\n\t * @memberof util\n\t * @instance\n\t * @param {Object[]} languages list of language objects as returned by the API\n\t * @param {Array|boolean} variants language variant objects or false if no variants exist\n\t * @param {Object} frequentlyUsedLanguages list of the frequently used languages\n\t * @param {string} [deviceLanguage] the device's primary language\n\t * @return {Object[]}\n\t */\n\tgetStructuredLanguages: function (\n\t\tlanguages, variants, frequentlyUsedLanguages, deviceLanguage\n\t) {\n\t\tvar hasOwn = Object.prototype.hasOwnProperty,\n\t\t\tmaxFrequency = 0,\n\t\t\tminFrequency = 0,\n\t\t\tmissingDir = 0,\n\t\t\tsuggestedLanguages = [],\n\t\t\tallLanguages = [],\n\t\t\tself = this;\n\n\t\t// Is the article available in the user's device language?\n\t\tdeviceLanguage = getDeviceLanguageOrParent( languages, deviceLanguage );\n\t\tif ( deviceLanguage ) {\n\t\t\tObject.keys( frequentlyUsedLanguages ).forEach( function ( language ) {\n\t\t\t\tvar frequency = frequentlyUsedLanguages[ language ];\n\t\t\t\tmaxFrequency = maxFrequency < frequency ? frequency : maxFrequency;\n\t\t\t\tminFrequency = minFrequency > frequency ? frequency : minFrequency;\n\t\t\t} );\n\n\t\t\t// Make the device language the most frequently used one so that\n\t\t\t// it appears at the top of the list when sorted by frequency.\n\t\t\tfrequentlyUsedLanguages[ deviceLanguage ] = maxFrequency + 1;\n\t\t}\n\n\t\t/**\n\t\t * @param {Object} language\n\t\t * @return {Object} which has 'dir' key.\n\t\t */\n\t\tfunction addLangDir( language ) {\n\t\t\tif ( language.dir ) {\n\t\t\t\treturn language;\n\t\t\t} else {\n\t\t\t\tmissingDir++;\n\t\t\t\treturn self.getDir( language );\n\t\t\t}\n\t\t}\n\n\t\t// Separate languages into suggested and all languages.\n\t\tlanguages.map( addLangDir ).forEach( function ( language ) {\n\t\t\tif ( hasOwn.call( frequentlyUsedLanguages, language.lang ) ) {\n\t\t\t\tlanguage.frequency = frequentlyUsedLanguages[ language.lang ];\n\t\t\t\tsuggestedLanguages.push( language );\n\t\t\t} else {\n\t\t\t\tallLanguages.push( language );\n\t\t\t}\n\t\t} );\n\n\t\t// Add variants to the suggested languages list and assign the lowest\n\t\t// frequency because the variant hasn't been clicked on yet.\n\t\t// Note that the variants data doesn't contain the article title, thus\n\t\t// we cannot show it for the variants.\n\t\tif ( variants ) {\n\t\t\tvariants.map( addLangDir ).forEach( function ( variant ) {\n\t\t\t\tif ( hasOwn.call( frequentlyUsedLanguages, variant.lang ) ) {\n\t\t\t\t\tvariant.frequency = frequentlyUsedLanguages[variant.lang];\n\t\t\t\t} else {\n\t\t\t\t\tvariant.frequency = minFrequency - 1;\n\t\t\t\t}\n\t\t\t\tsuggestedLanguages.push( variant );\n\t\t\t} );\n\t\t}\n\n\t\t// sort suggested languages in descending order by frequency\n\t\tsuggestedLanguages = suggestedLanguages.sort( function ( a, b ) {\n\t\t\treturn b.frequency - a.frequency;\n\t\t} );\n\n\t\t/**\n\t\t * Compare language names lexicographically\n\t\t *\n\t\t * @param {Object} a first language\n\t\t * @param {Object} b second language\n\t\t * @return {number} Comparison value, 1 or -1\n\t\t */\n\t\tfunction compareLanguagesByLanguageName( a, b ) {\n\t\t\treturn a.autonym.toLocaleLowerCase() < b.autonym.toLocaleLowerCase() ? -1 : 1;\n\t\t}\n\n\t\tallLanguages = allLanguages.sort( compareLanguagesByLanguageName );\n\n\t\t// This works around T74153\n\t\tlog.warn(\n\t\t\tmissingDir === 0 ? 'Direction is provided. Please remove handling in getStructuredLanguages' :\n\t\t\t\t'`dir` attribute was missing from languages. Is T74153 resolved?'\n\t\t);\n\n\t\treturn {\n\t\t\tsuggested: suggestedLanguages,\n\t\t\tall: allLanguages\n\t\t};\n\t},\n\n\t/**\n\t * Return a map of frequently used languages on the current device.\n\t * @memberof util\n\t * @instance\n\t * @return {Object}\n\t */\n\tgetFrequentlyUsedLanguages: function () {\n\t\tvar languageMap = mw.storage.get( 'langMap' );\n\n\t\treturn languageMap ? JSON.parse( languageMap ) : {};\n\t},\n\n\t/**\n\t * Save the frequently used languages to the user's device\n\t * @memberof util\n\t * @instance\n\t * @param {Object} languageMap\n\t */\n\tsaveFrequentlyUsedLanguages: function ( languageMap ) {\n\t\tmw.storage.set( 'langMap', JSON.stringify( languageMap ) );\n\t},\n\n\t/**\n\t * Increment the current language usage by one and save it to the device.\n\t * Cap the result at 100.\n\t * @memberof util\n\t * @instance\n\t * @param {string} languageCode\n\t * @param {Object} frequentlyUsedLanguages list of the frequently used languages\n\t */\n\tsaveLanguageUsageCount: function ( languageCode, frequentlyUsedLanguages ) {\n\t\tvar count = frequentlyUsedLanguages[ languageCode ] || 0;\n\n\t\tcount += 1;\n\t\t// cap at 100 as this is enough data to work on\n\t\tfrequentlyUsedLanguages[ languageCode ] = count > 100 ? 100 : count;\n\t\tthis.saveFrequentlyUsedLanguages( frequentlyUsedLanguages );\n\t}\n};\n","var sizeBuckets = [ 320, 640, 800, 1024, 1280, 1920, 2560, 2880 ],\n\tactionParams = require( './../mobile.startup/actionParams' ),\n\tutil = require( './../mobile.startup/util' );\n\n/**\n * Gets the first size larger than or equal to the provided size\n * @memberof ImageGateway\n * @param {number} size\n * @return {number}\n */\nfunction findSizeBucket( size ) {\n\tvar i = 0;\n\twhile ( size > sizeBuckets[i] && i < sizeBuckets.length - 1 ) {\n\t\t++i;\n\t}\n\treturn sizeBuckets[i];\n}\n\n/**\n * API for retrieving image thumbnails for a given page\n * @class ImageGateway\n *\n * @param {Object} options Configuration options\n * @property {mw.Api} options.api\n */\nfunction ImageGateway( options ) {\n\tthis._cache = {};\n\tthis.api = options.api;\n}\n/**\n * Get thumbnail via the API and cache it. Return the result from the cache if exists.\n * @param {string} title Url of image\n * @return {jQuery.Deferred} with the image info\n */\nImageGateway.prototype.getThumb = function ( title ) {\n\tvar cachedThumb = this._cache[title],\n\t\t$window = util.getWindow(),\n\t\timageSizeMultiplier = ( window.devicePixelRatio && window.devicePixelRatio > 1 ) ?\n\t\t\twindow.devicePixelRatio : 1;\n\n\tif ( !cachedThumb ) {\n\t\tthis._cache[title] = this.api.get( actionParams( {\n\t\t\tprop: 'imageinfo',\n\t\t\ttitles: title,\n\t\t\tiiprop: [ 'url', 'extmetadata' ],\n\t\t\t// request an image devicePixelRatio times bigger than the reported screen size\n\t\t\t// for retina displays and zooming\n\t\t\tiiurlwidth: findSizeBucket( $window.width() * imageSizeMultiplier ),\n\t\t\tiiurlheight: findSizeBucket( $window.height() * imageSizeMultiplier )\n\t\t} ) ).then( function ( resp ) {\n\t\t\t// imageinfo is undefined for missing pages.\n\t\t\tif ( resp.query && resp.query.pages &&\n\t\t\t\tresp.query.pages[0] && resp.query.pages[0].imageinfo ) {\n\t\t\t\treturn resp.query.pages[0].imageinfo[0];\n\t\t\t}\n\t\t\tthrow new Error( 'The API failed to return any pages matching the titles.' );\n\t\t} );\n\t}\n\n\treturn this._cache[title];\n};\n\nImageGateway._findSizeBucket = findSizeBucket;\nmodule.exports = ImageGateway;\n","var Overlay = require( './../mobile.startup/Overlay' ),\n\tutil = require( './../mobile.startup/util' ),\n\tmfExtend = require( './../mobile.startup/mfExtend' ),\n\tIcon = require( './../mobile.startup/Icon' ),\n\ticons = require( './../mobile.startup/icons' ),\n\tButton = require( './../mobile.startup/Button' ),\n\tLoadErrorMessage = require( './LoadErrorMessage' ),\n\tImageGateway = require( './ImageGateway' ),\n\t// FIXME: mw.loader.require is a private function but there's no other way to get hold of\n\t// this right now using require will cause webpack to resolve it\n\t// Can be rewritten to mw.router when https://gerrit.wikimedia.org/r/#/c/mediawiki/core/+/482732 has been merged\n\trouter = mw.loader.require( 'mediawiki.router' );\n\n/**\n * Displays images in full screen overlay\n * @class ImageOverlay\n * @extends Overlay\n * @uses Icon\n * @uses ImageGateway\n * @uses LoadErrorMessage\n * @uses Router\n * @fires ImageOverlay#ImageOverlay-exit\n * @fires ImageOverlay#ImageOverlay-slide\n * @param {Object} options Configuration options\n * @param {OO.EventEmitter} options.eventBus Object used to listen for resize:throttled events\n */\nfunction ImageOverlay( options ) {\n\tthis.gateway = options.gateway || new ImageGateway( {\n\t\tapi: options.api\n\t} );\n\tthis.router = options.router || router;\n\tthis.eventBus = options.eventBus;\n\n\tOverlay.call( this,\n\t\tutil.extend( {\n\t\t\tclassName: 'overlay media-viewer'\n\t\t}, options )\n\t);\n}\n\nmfExtend( ImageOverlay, Overlay, {\n\t/**\n\t * allow pinch zooming\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\thasFixedHeader: false,\n\t/**\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\thideOnExitClick: false,\n\t/**\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\ttemplate: mw.template.get( 'mobile.mediaViewer', 'Overlay.hogan' ),\n\n\t/**\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @mixes Overlay#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {mw.Api} defaults.api instance of API to use\n\t * @property {string} defaults.cancelButton HTML of the cancel button.\n\t * @property {Object} defaults.detailsButton options for details button\n\t * @property {string} defaults.licenseLinkMsg Link to license information in media viewer.\n\t * @property {Thumbnail[]} defaults.thumbnails a list of thumbnails to browse\n\t */\n\tdefaults: util.extend( {}, Overlay.prototype.defaults, {\n\t\tcancelButton: icons.cancel( 'gray' ).toHtmlString(),\n\t\tdetailsButton: new Button( {\n\t\t\tlabel: mw.msg( 'mobile-frontend-media-details' ),\n\t\t\tadditionalClassNames: 'button',\n\t\t\tprogressive: true\n\t\t} ).options,\n\t\tlicenseLinkMsg: mw.msg( 'mobile-frontend-media-license-link' ),\n\t\tthumbnails: [],\n\t\tslideLeftButton: new Icon( {\n\t\t\trotation: 90,\n\t\t\tname: 'arrow-invert'\n\t\t} ).toHtmlString(),\n\t\tslideRightButton: new Icon( {\n\t\t\trotation: -90,\n\t\t\tname: 'arrow-invert'\n\t\t} ).toHtmlString()\n\t} ),\n\t/**\n\t * @inheritdoc\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\tevents: util.extend( {}, Overlay.prototype.events, {\n\t\t'click .image-wrapper': 'onToggleDetails',\n\t\t// Click tracking for table of contents so we can see if people interact with it\n\t\t'click .slider-button': 'onSlide'\n\t} ),\n\t/**\n\t * Event handler for slide event\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @param {jQuery.Event} ev\n\t */\n\tonSlide: function ( ev ) {\n\t\tvar nextThumbnail = this.$( ev.target ).closest( '.slider-button' ).data( 'thumbnail' );\n\t\tthis.emit( ImageOverlay.EVENT_SLIDE, nextThumbnail );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tvar self = this;\n\t\tthis.options.thumbnails.forEach( function ( thumbnail, i ) {\n\t\t\tif ( thumbnail.getFileName() === self.options.title ) {\n\t\t\t\tself.options.caption = thumbnail.getDescription();\n\t\t\t\tself.galleryOffset = i;\n\t\t\t}\n\t\t} );\n\t},\n\t/**\n\t * Setup the next and previous images to enable the user to arrow through\n\t * all images in the set of images given in thumbs.\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @param {Array} thumbs A set of images, which are available\n\t * @private\n\t */\n\t_enableArrowImages: function ( thumbs ) {\n\t\tvar offset = this.galleryOffset,\n\t\t\tlastThumb, nextThumb;\n\n\t\tif ( this.galleryOffset === undefined ) {\n\t\t\t// couldn't find a suitable matching thumbnail so make\n\t\t\t// next slide start at beginning and previous slide be end\n\t\t\tlastThumb = thumbs[thumbs.length - 1];\n\t\t\tnextThumb = thumbs[0];\n\t\t} else {\n\t\t\t// identify last thumbnail\n\t\t\tlastThumb = thumbs[ offset === 0 ? thumbs.length - 1 : offset - 1 ];\n\t\t\tnextThumb = thumbs[ offset === thumbs.length - 1 ? 0 : offset + 1 ];\n\t\t}\n\n\t\tthis.$( '.prev' ).data( 'thumbnail', lastThumb );\n\t\tthis.$( '.next' ).data( 'thumbnail', nextThumb );\n\t},\n\t/**\n\t * Disables the possibility to arrow through all images of the page.\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @private\n\t */\n\t_disableArrowImages: function () {\n\t\tthis.$( '.prev, .next' ).remove();\n\t},\n\n\t/**\n\t * Handler for retry event which triggers when user tries to reload overlay\n\t * after a loading error.\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @private\n\t */\n\t_handleRetry: function () {\n\t\t// A hacky way to simulate a reload of the overlay\n\t\tthis.router.emit( 'hashchange' );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar $img,\n\t\t\tthumbs = this.options.thumbnails || [],\n\t\t\tself = this;\n\n\t\t/**\n\t\t * Hide the spinner\n\t\t * @method\n\t\t * @ignore\n\t\t */\n\t\tfunction removeLoader() {\n\t\t\tself.hideSpinner();\n\t\t}\n\n\t\t/**\n\t\t * Display media load failure message\n\t\t * @method\n\t\t * @ignore\n\t\t */\n\t\tfunction showLoadFailMsg() {\n\t\t\tself.hasLoadError = true;\n\n\t\t\tremoveLoader();\n\t\t\t// hide broken image if present\n\t\t\tself.$( '.image img' ).hide();\n\n\t\t\t// show error message if not visible already\n\t\t\tif ( self.$( '.load-fail-msg' ).length === 0 ) {\n\t\t\t\tnew LoadErrorMessage( { retryPath: self.router.getPath() } )\n\t\t\t\t\t.on( 'retry', self._handleRetry.bind( self ) )\n\t\t\t\t\t.prependTo( self.$( '.image' ) );\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Start image load transitions\n\t\t * @method\n\t\t * @ignore\n\t\t */\n\t\tfunction addImageLoadClass() {\n\t\t\t$img.addClass( 'image-loaded' );\n\t\t}\n\n\t\tif ( thumbs.length < 2 ) {\n\t\t\tthis._disableArrowImages();\n\t\t} else {\n\t\t\tthis._enableArrowImages( thumbs );\n\t\t}\n\n\t\tthis.$details = this.$( '.details' );\n\n\t\tOverlay.prototype.postRender.apply( this );\n\n\t\tthis.gateway.getThumb( self.options.title ).then( function ( data ) {\n\t\t\tvar author, url = data.descriptionurl + '#mw-jump-to-license';\n\n\t\t\tremoveLoader();\n\n\t\t\tself.thumbWidth = data.thumbwidth;\n\t\t\tself.thumbHeight = data.thumbheight;\n\t\t\tself.imgRatio = data.thumbwidth / data.thumbheight;\n\n\t\t\t// We need to explicitly specify document for context param as jQuery 3\n\t\t\t// will create a new document for the element if the context is\n\t\t\t// undefined. If element is appended to active document, event handlers\n\t\t\t// can fire in both the active document and new document which can cause\n\t\t\t// insidious bugs.\n\t\t\t// (https://api.jquery.com/jquery.parsehtml/#entry-longdesc)\n\t\t\t$img = self.parseHTML( '<img>', document );\n\n\t\t\t// Remove the loader when the image is loaded or display load fail\n\t\t\t// message on failure\n\t\t\t//\n\t\t\t// Error event handler must be attached before error occurs\n\t\t\t// (https://api.jquery.com/error/#entry-longdesc)\n\t\t\t//\n\t\t\t// For the load event, it is more unclear what happens cross-browser when\n\t\t\t// the image is loaded from cache. It seems that a .complete check is\n\t\t\t// needed if attaching the load event after setting the src.\n\t\t\t// (http://stackoverflow.com/questions/910727/jquery-event-for-images-loaded#comment10616132_1110094)\n\t\t\t//\n\t\t\t// However, perhaps .complete check is not needed if attaching load\n\t\t\t// event prior to setting the image src\n\t\t\t// (https://stackoverflow.com/questions/12354865/image-onload-event-and-browser-cache#answer-12355031)\n\t\t\t$img.on( 'load', addImageLoadClass ).on( 'error', showLoadFailMsg );\n\t\t\t$img.attr( 'src', data.thumburl ).attr( 'alt', self.options.caption );\n\t\t\tself.$( '.image' ).append( $img );\n\n\t\t\tself.$details.addClass( 'is-visible' );\n\t\t\tself._positionImage();\n\t\t\tself.$( '.details a' ).attr( 'href', url );\n\t\t\tif ( data.extmetadata ) {\n\t\t\t\t// Add license information\n\t\t\t\tif ( data.extmetadata.LicenseShortName ) {\n\t\t\t\t\tself.$( '.license a' )\n\t\t\t\t\t\t.text( data.extmetadata.LicenseShortName.value )\n\t\t\t\t\t\t.attr( 'href', url );\n\t\t\t\t}\n\t\t\t\t// Add author information\n\t\t\t\tif ( data.extmetadata.Artist ) {\n\t\t\t\t\t// Strip any tags\n\t\t\t\t\tauthor = data.extmetadata.Artist.value.replace( /<.*?>/g, '' );\n\t\t\t\t\tself.$( '.license' ).prepend( author + ' &bull; ' );\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.adjustDetails();\n\t\t}, function () {\n\t\t\t// retrieving image location failed so show load fail msg\n\t\t\tshowLoadFailMsg();\n\t\t} );\n\n\t\tthis.eventBus.on( 'resize:throttled', this._positionImage.bind( this ) );\n\t},\n\n\t/**\n\t * Event handler that toggles the details bar.\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\tonToggleDetails: function () {\n\t\tif ( !this.hasLoadError ) {\n\t\t\tthis.$( '.cancel, .slider-button' ).toggle();\n\t\t\tthis.$details.toggle();\n\t\t\tthis._positionImage();\n\t\t}\n\t},\n\n\t/**\n\t * fixme: remove this redundant function.\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @param {Event} ev\n\t */\n\tonExitClick: function ( ev ) {\n\t\tOverlay.prototype.onExitClick.apply( this, arguments );\n\t\tthis.emit( ImageOverlay.EVENT_EXIT, ev );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\tshow: function () {\n\t\tOverlay.prototype.show.apply( this, arguments );\n\t\tthis._positionImage();\n\t},\n\n\t/**\n\t * Fit the image into the window if its dimensions are bigger than the window dimensions.\n\t * Compare window width to height ratio to that of image width to height when setting\n\t * image width or height.\n\t * @memberof ImageOverlay\n\t * @instance\n\t * @private\n\t */\n\t_positionImage: function () {\n\t\tvar detailsHeight, windowWidth, windowHeight, windowRatio, $img,\n\t\t\t$window = util.getWindow();\n\n\t\tthis.adjustDetails();\n\t\t// with a hidden details box we have a little bit more space, we just need to use it\n\t\tdetailsHeight = !this.$details.is( ':visible' ) ? 0 : this.$details.outerHeight();\n\t\twindowWidth = $window.width();\n\t\twindowHeight = $window.height() - detailsHeight;\n\t\twindowRatio = windowWidth / windowHeight;\n\t\t$img = this.$( 'img' );\n\n\t\tif ( this.imgRatio > windowRatio ) {\n\t\t\tif ( windowWidth < this.thumbWidth ) {\n\t\t\t\t$img.css( {\n\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\theight: 'auto'\n\t\t\t\t} );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( windowHeight < this.thumbHeight ) {\n\t\t\t\t$img.css( {\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t\theight: windowHeight\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t\tthis.$( '.image-wrapper' ).css( 'bottom', detailsHeight );\n\t},\n\n\t/**\n\t * Function to adjust the height of details section to not more than 50% of window height.\n\t * @memberof ImageOverlay\n\t * @instance\n\t */\n\tadjustDetails: function () {\n\t\tvar windowHeight = util.getWindow().height();\n\t\tif ( this.$( '.details' ).height() > windowHeight * 0.50 ) {\n\t\t\tthis.$( '.details' ).css( 'max-height', windowHeight * 0.50 );\n\t\t}\n\t}\n} );\n\n/**\n * fixme: remove this redundant constant.\n * @memberof ImageOverlay\n * @event\n */\nImageOverlay.EVENT_EXIT = 'ImageOverlay-exit';\n/**\n * @memberof ImageOverlay\n * @event\n */\nImageOverlay.EVENT_SLIDE = 'ImageOverlay-slide';\n\nmodule.exports = ImageOverlay;\n","var util = require( './../mobile.startup/util' ),\n\tmfExtend = require( './../mobile.startup/mfExtend' ),\n\tIcon = require( './../mobile.startup/Icon' ),\n\tView = require( './../mobile.startup/View' );\n\n/**\n * Shows the user a load failure message\n * @class LoadErrorMessage\n * @extends View\n * @fires LoadErrorMessage#retry\n *\n * @param {Object} options Configuration options\n */\nfunction LoadErrorMessage( options ) {\n\tif ( !options.retryPath ) {\n\t\tthrow new Error( '\\'retryPath\\' must be set in options param. Received: ' + options.retryPath );\n\t}\n\n\tView.apply( this, arguments );\n}\n\nmfExtend( LoadErrorMessage, View, {\n\ttemplate: mw.template.get( 'mobile.mediaViewer', 'LoadErrorMessage.hogan' ),\n\tisTemplateMode: true,\n\n\t/**\n\t\t* @inheritdoc\n\t\t* @cfg {Object} defaults Default options hash.\n\t\t* @cfg {string} defaults.icon HTML of the alert icon\n\t\t* @cfg {string} defaults.msgToUser Message shown when media load fails\n\t\t* @cfg {string} defaults.retryTxt Text of retry link\n\t\t* @memberof LoadErrorMessage\n\t\t* @instance\n\t\t*/\n\tdefaults: util.extend( {}, LoadErrorMessage.prototype.defaults, {\n\t\ticon: new Icon( {\n\t\t\tname: 'alert-invert',\n\t\t\tadditionalClassNames: 'load-fail-msg-icon'\n\t\t} ).toHtmlString(),\n\t\tmsgToUser: mw.msg( 'mobile-frontend-media-load-fail-message' ),\n\t\tretryTxt: mw.msg( 'mobile-frontend-media-load-fail-retry' )\n\t} ),\n\n\t/**\n\t * @inheritdoc\n\t * @memberof LoadErrorMessage\n\t * @instance\n\t */\n\tevents: {\n\t\t'click .load-fail-msg-link a': 'onRetry'\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof LoadErrorMessage\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.$( '.load-fail-msg-link a' ).attr( 'href', '#' + this.options.retryPath );\n\t},\n\n\t/**\n\t * Event handler for retry event\n\t * @param {jQuery.Event} ev\n\t * @return {boolean} Returns false to prevent default behavior for links and\n\t * stop the event from propagating\n\t * @memberof LoadErrorMessage\n\t * @instance\n\t */\n\tonRetry: function () {\n\t\t/**\n\t\t * Triggered when retry button is clicked.\n\t\t * @event LoadErrorMessage#retry\n\t\t */\n\t\tthis.emit( 'retry' );\n\n\t\treturn false;\n\t}\n} );\n\nmodule.exports = LoadErrorMessage;\n","var\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tPageList = require( '../mobile.startup/PageList' ),\n\tWatchstarPageList = require( '../mobile.startup/watchstar/WatchstarPageList' ),\n\tScrollEndEventEmitter = require( '../mobile.startup/ScrollEndEventEmitter' ),\n\tutil = require( '../mobile.startup/util' ),\n\tWatchListGateway = require( './WatchListGateway' );\n\n/**\n * An extension of the WatchstarPageList which preloads pages as all being\n * watched.\n * @extends WatchstarPageList\n * @class WatchList\n * @uses ScrollEndEventEmitter\n *\n * @fires watched\n * @fires watch\n * @param {Object} params Configuration options\n * @param {OO.EventEmitter} params.eventBus Object used to listen for scroll:throttled events\n */\nfunction WatchList( params ) {\n\tvar lastTitle,\n\t\toptions = util.extend( {}, {\n\t\t\tisBorderBox: false\n\t\t}, params );\n\n\t// Set up infinite scroll helper and listen to events\n\tthis.scrollEndEventEmitter = new ScrollEndEventEmitter( options.eventBus );\n\tthis.scrollEndEventEmitter.on( ScrollEndEventEmitter.EVENT_SCROLL_END,\n\t\tthis._loadPages.bind( this ) );\n\n\tif ( options.el ) {\n\t\tlastTitle = this.getLastTitle( options.el );\n\t}\n\tthis.gateway = new WatchListGateway( options.api, lastTitle );\n\n\tWatchstarPageList.call( this, options );\n}\n\nmfExtend( WatchList, WatchstarPageList, {\n\t/**\n\t * @inheritdoc\n\t * @memberof WatchList\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\t// The DOM will be modified. Prevent any false scroll end events from\n\t\t// being emitted.\n\t\tthis.scrollEndEventEmitter.disable();\n\t\tthis.scrollEndEventEmitter.setElement( this.$el );\n\t},\n\t/**\n\t * Also sets a watch uploads funnel.\n\t * @inheritdoc\n\t * @memberof WatchList\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar\n\t\t\t$items,\n\t\t\tstatuses;\n\n\t\t// Skip a level from WatchstarPageList directly to PageList.\n\t\tPageList.prototype.postRender.apply( this );\n\n\t\t$items = this.queryUnitializedItems();\n\n\t\t// WatchList requests list of watched pages. The list contains only\n\t\t// watched pages so it's safe to transform the title map to a status map\n\t\t// with each entry marked watched (true).\n\t\tstatuses = Object.keys( this.parsePagesFromItems( $items ) )\n\t\t\t.reduce( function ( statuses, title ) {\n\t\t\t\tstatuses[ title ] = true;\n\t\t\t\treturn statuses;\n\t\t\t}, {} );\n\t\tthis.renderItems( $items, statuses );\n\n\t\t// The list has been extended. Re-enable scroll end events.\n\t\tthis.scrollEndEventEmitter.enable();\n\t},\n\n\t/**\n\t * Loads pages from the api and triggers render.\n\t * Infinite scroll is re-enabled in postRender.\n\t * @memberof WatchList\n\t * @instance\n\t */\n\t_loadPages: function () {\n\t\tthis.gateway.loadWatchlist().then( function ( pages ) {\n\t\t\tpages.forEach( function ( page ) {\n\t\t\t\tthis.appendPage( page );\n\t\t\t}.bind( this ) );\n\t\t\tthis.render();\n\t\t}.bind( this ) );\n\t},\n\n\t/**\n\t * Appends a list item\n\t * @memberof WatchList\n\t * @instance\n\t * @param {Page} page\n\t */\n\tappendPage: function ( page ) {\n\t\t// wikidata descriptions should not show in this view.\n\t\tvar templateOptions = util.extend( {}, page.options, {\n\t\t\twikidataDescription: undefined\n\t\t} );\n\t\tthis.$el.append( this.templatePartials.item.render( templateOptions ) );\n\t},\n\n\t/**\n\t * Get the last title from the rendered HTML.\n\t * Used for initializing the API\n\t * @memberof WatchList\n\t * @instance\n\t * @param {jQuery.Object} $el Dom element of the list\n\t * @return {string}\n\t */\n\tgetLastTitle: function ( $el ) {\n\t\treturn $el.find( 'li:last' ).attr( 'title' );\n\t}\n} );\n\nmodule.exports = WatchList;\n","var Page = require( '../mobile.startup/Page' ),\n\tutil = require( '../mobile.startup/util' ),\n\textendSearchParams = require( '../mobile.startup/extendSearchParams' );\n\n/**\n * @class WatchListGateway\n * @param {mw.Api} api\n * @param {string} lastTitle of page listed in Watchlist to be used as a continuation parameter\n */\nfunction WatchListGateway( api, lastTitle ) {\n\tthis.api = api;\n\t// Try to keep it in sync with SpecialMobileWatchlist::LIMIT (php)\n\tthis.limit = 50;\n\n\tif ( lastTitle ) {\n\t\tthis.continueParams = {\n\t\t\tcontinue: 'gwrcontinue||',\n\t\t\tgwrcontinue: '0|' + lastTitle.replace( / /g, '_' )\n\t\t};\n\t\tthis.shouldSkipFirstTitle = true;\n\t} else {\n\t\tthis.continueParams = {\n\t\t\tcontinue: ''\n\t\t};\n\t\tthis.shouldSkipFirstTitle = false;\n\t}\n\n\tthis.canContinue = true;\n}\n\nWatchListGateway.prototype = {\n\t/**\n\t * Load the list of items on the watchlist\n\t * @return {jQuery.Deferred}\n\t */\n\tloadWatchlist: function () {\n\t\tvar self = this,\n\t\t\tparams = extendSearchParams( 'watchlist', {\n\t\t\t\tprop: [ 'info', 'revisions' ],\n\t\t\t\trvprop: 'timestamp|user',\n\t\t\t\tgenerator: 'watchlistraw',\n\t\t\t\tgwrnamespace: '0',\n\t\t\t\tgwrlimit: this.limit\n\t\t\t}, this.continueParams );\n\n\t\tif ( this.canContinue === false ) {\n\t\t\treturn util.Deferred().resolve( [] );\n\t\t}\n\t\treturn this.api.get( params, {\n\t\t\turl: this.apiUrl\n\t\t} ).then( function ( data ) {\n\t\t\tif ( data.continue !== undefined ) {\n\t\t\t\tself.continueParams = data.continue;\n\t\t\t} else {\n\t\t\t\tself.canContinue = false;\n\t\t\t}\n\n\t\t\treturn self.parseData( data );\n\t\t} );\n\t},\n\n\t/**\n\t * Parse api response data into pagelist item format\n\t * @param {Object[]} data\n\t * @return {Page[]}\n\t */\n\tparseData: function ( data ) {\n\t\tvar pages;\n\n\t\tif ( !data.query || !data.query.pages ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tpages = data.query.pages;\n\n\t\t// Sort results alphabetically (the api map doesn't have any order). The\n\t\t// watchlist is ordered alphabetically right now.\n\t\tpages.sort( function ( p1, p2 ) {\n\t\t\treturn p1.title === p2.title ? 0 : ( p1.title < p2.title ? -1 : 1 );\n\t\t} );\n\n\t\t// If we requested from the last item of the previous page, we shall\n\t\t// remove the first result (to avoid it being repeated)\n\t\tif ( this.shouldSkipFirstTitle ) {\n\t\t\tpages = pages.slice( 1 );\n\t\t\tthis.shouldSkipFirstTitle = false;\n\t\t}\n\n\t\t// Transform the items to a sensible format\n\t\treturn pages.map( Page.newFromJSON );\n\t}\n\n};\n\nmodule.exports = WatchListGateway;\n","var\n\tView = require( './View' ),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * A wrapper for creating an anchor.\n * @class Anchor\n * @extends View\n */\nfunction Anchor() {\n\tView.apply( this, arguments );\n}\n\nmfExtend( Anchor, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Anchor\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Anchor\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {boolean} defaults.progressive is progressive action\n\t * @property {boolean} defaults.destructive is destructive action\n\t * @property {string} defaults.additionalClassNames Additional class name(s).\n\t * @property {string} defaults.href url\n\t * @property {string} defaults.label of anchor\n\t */\n\tdefaults: {\n\t\tprogressive: undefined,\n\t\tdestructive: undefined,\n\t\tadditionalClassNames: '',\n\t\thref: undefined,\n\t\tlabel: undefined\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Anchor\n\t * @instance\n\t */\n\ttemplate: mw.template.get( 'mobile.startup', 'anchor.hogan' )\n} );\n\nmodule.exports = Anchor;\n","var\n\tutil = require( './util' ),\n\tbrowser;\n\n/**\n * Memoize a class method. Caches the result of the method based on the\n * arguments. Instances do not share a cache.\n * @param {Function} method Method to be memoized\n * @return {Function}\n */\nfunction memoize( method ) {\n\t/**\n\t * Memoized version of the method\n\t * @return {Function}\n\t */\n\tvar memoized = function () {\n\t\tvar cache = this[ '__cache' + memoized.cacheId ] ||\n\t\t\t( this[ '__cache' + memoized.cacheId ] = {} ),\n\t\t\tkey = [].join.call( arguments, '|' );\n\t\tif ( Object.prototype.hasOwnProperty.call( cache, key ) ) {\n\t\t\treturn cache[ key ];\n\t\t}\n\t\treturn ( cache[ key ] = method.apply( this, arguments ) );\n\t};\n\tmemoized.cacheId = Date.now().toString() + Math.random().toString();\n\treturn memoized;\n}\n\n/**\n * Representation of user's current browser\n * @class Browser\n * @param {string} ua the user agent of the current browser\n * @param {jQuery.Object} $container an element to associate with the Browser object\n */\nfunction Browser( ua, $container ) {\n\tthis.userAgent = ua;\n\tthis.$el = $container;\n\tthis._fixIosLandscapeBug();\n}\n\nBrowser.prototype = {\n\t/**\n\t * When rotating to landscape stop page zooming on ios 4 and 5.\n\t * @memberof Browser\n\t * @instance\n\t * @private\n\t */\n\t_fixIosLandscapeBug: function () {\n\t\tvar self = this,\n\t\t\tviewport = this.$el.find( 'meta[name=\"viewport\"]' )[0];\n\n\t\t// see http://adactio.com/journal/4470/ (fixed in ios 6)\n\t\tif ( viewport && ( this.isIos( 4 ) || this.isIos( 5 ) ) ) {\n\t\t\tthis.lockViewport();\n\t\t\tdocument.addEventListener( 'gesturestart', function () {\n\t\t\t\tself.lockViewport();\n\t\t\t}, false );\n\t\t}\n\t},\n\t/**\n\t * Returns whether the current browser is an ios device.\n\t * FIXME: jquery.client does not support iPad detection so we cannot use it.\n\t * @memberof Browser\n\t * @instance\n\t * @param {number} [version] integer describing a specific version you want to test against.\n\t * @return {boolean}\n\t */\n\tisIos: memoize( function ( version ) {\n\t\tvar ua = this.userAgent,\n\t\t\tios = /ipad|iphone|ipod/i.test( ua );\n\n\t\tif ( ios && version ) {\n\t\t\tswitch ( version ) {\n\t\t\t\tcase 8:\n\t\t\t\t\t// Test UA for iOS8. Or for simulator look for Version 8\n\t\t\t\t\t// In the iOS simulator the OS is the host machine OS version\n\t\t\t\t\t// This makes testing in iOS8 simulator work as expected\n\t\t\t\t\treturn /OS 8_/.test( ua ) || /Version\\/8/.test( ua );\n\t\t\t\tcase 4:\n\t\t\t\t\treturn /OS 4_/.test( ua );\n\t\t\t\tcase 5:\n\t\t\t\t\treturn /OS 5_/.test( ua );\n\t\t\t\tdefault:\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\treturn ios;\n\t\t}\n\t} ),\n\t/**\n\t * Locks the viewport so that pinch zooming is disabled\n\t * @memberof Browser\n\t * @instance\n\t */\n\tlockViewport: function () {\n\t\tif ( this.$el ) {\n\t\t\tthis.$el.find( 'meta[name=\"viewport\"]' )\n\t\t\t\t.attr( 'content', 'initial-scale=1.0, maximum-scale=1.0, user-scalable=no' );\n\t\t}\n\t},\n\t/**\n\t * Determine if a device has a widescreen.\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisWideScreen: memoize( function () {\n\t\tvar val = parseInt( mw.config.get( 'wgMFDeviceWidthTablet' ), 10 );\n\t\t// Check portrait and landscape mode to be consistent\n\t\treturn window.innerWidth >= val || window.innerHeight >= val;\n\t} ),\n\t/**\n\t * Checks browser support for CSS transforms, transitions\n\t * and CSS animation.\n\t * Currently assumes support for the latter 2 in the case of the\n\t * former.\n\t * See http://stackoverflow.com/a/12621264/365238\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tsupportsAnimations: memoize( function () {\n\t\tvar elemStyle = document.createElement( 'foo' ).style;\n\t\tfunction supportsProperty( property ) {\n\t\t\t// We only test \"webkit-\", because that's the only prefix needed for the relevant\n\t\t\t// properties (in supportsAnimations) and supported browsers. If usage is expanded,\n\t\t\t// other prefixes may need to be checked as well.\n\t\t\treturn property in elemStyle ||\n\t\t\t\t( 'webkit' + property[ 0 ].toUpperCase() + property.slice( 1 ) ) in elemStyle;\n\t\t}\n\t\treturn supportsProperty( 'animationName' ) &&\n\t\t\tsupportsProperty( 'transform' ) &&\n\t\t\tsupportsProperty( 'transition' );\n\t} ),\n\t/**\n\t * Whether touchstart and other touch events are supported by the current browser.\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tsupportsTouchEvents: memoize( function () {\n\t\treturn 'ontouchstart' in window;\n\t} ),\n\t/**\n\t * Detect if browser supports geolocation\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tsupportsGeoLocation: memoize( function () {\n\t\treturn 'geolocation' in window.navigator;\n\t} )\n};\n\n/**\n * @memberof Browser\n * @return {Browser}\n */\nBrowser.getSingleton = function () {\n\tvar $html;\n\tif ( !browser ) {\n\t\t$html = util.getDocument();\n\t\tbrowser = new Browser( window.navigator.userAgent, $html );\n\t}\n\treturn browser;\n};\n\nmodule.exports = Browser;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' );\n\n/**\n * A wrapper for creating a button.\n * @class Button\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Button( options ) {\n\tif ( options.href ) {\n\t\toptions.tagName = 'a';\n\t}\n\tView.call( this, options );\n}\n\nmfExtend( Button, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Button\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Button\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.tagName The name of the tag in which the button is wrapped.\n\t * @property {boolean} defaults.block is stacked button\n\t * @property {boolean} defaults.progressive is progressive action\n\t *   This option is deprecated. Please use `progressive`.\n\t * @property {boolean} defaults.quiet is quiet button\n\t * @property {boolean} defaults.destructive is destructive action\n\t * @property {string} defaults.additionalClassNames Additional class name(s).\n\t * @property {string} defaults.href url\n\t * @property {string} defaults.label of button\n\t */\n\tdefaults: {\n\t\ttagName: 'a',\n\t\tblock: undefined,\n\t\tprogressive: undefined,\n\t\tdestructive: undefined,\n\t\tquiet: undefined,\n\t\tadditionalClassNames: '',\n\t\thref: undefined,\n\t\tlabel: undefined\n\t},\n\t/**\n\t * @memberof Button\n\t * @instance\n\t */\n\ttemplate: mw.template.get( 'mobile.startup', 'button.hogan' )\n} );\n\nmodule.exports = Button;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tDrawer = require( './Drawer' ),\n\tutil = require( './util' ),\n\tButton = require( './Button' ),\n\tAnchor = require( './Anchor' );\n\n/**\n * @typedef {string|number|boolean|undefined} QueryVal\n * @typedef {Object.<string, QueryVal|QueryVal[]>} QueryParams\n *\n * @typedef {Object} Options\n * @prop {string} [returnTo]\n * @prop {QueryParams} [queryParams]\n * @prop {QueryParams} [signupQueryParams]\n * @prop {Object} [options.progressiveButton] template options for Button element for signing in\n * @prop {Object} [options.actionAnchor] template options for Anchor element for signing up\n */\n\n/**\n * This creates the drawer at the bottom of the screen that appears when an anonymous\n * user tries to perform an action that requires being logged in. It presents the user\n * with options to log in or sign up for a new account.\n * @class CtaDrawer\n * @extends Drawer\n * @uses Button\n * @uses Icon\n * @uses Anchor\n * @param {Options} options\n */\nfunction CtaDrawer( options ) {\n\tDrawer.call( this,\n\t\tutil.extend( {}, Drawer.prototype.defaults, {\n\t\t\tprogressiveButton: new Button( {\n\t\t\t\tprogressive: true,\n\t\t\t\tlabel: mw.msg( 'mobile-frontend-watchlist-cta-button-login' )\n\t\t\t} ).options,\n\t\t\tactionAnchor: new Anchor( {\n\t\t\t\tprogressive: true,\n\t\t\t\tlabel: mw.msg( 'mobile-frontend-watchlist-cta-button-signup' )\n\t\t\t} ).options\n\t\t}, options )\n\t);\n}\n\nmfExtend( CtaDrawer, Drawer, {\n\t/**\n\t * @memberof CtaDrawer\n\t * @instance\n\t */\n\ttemplatePartials: util.extend( {}, Drawer.prototype.templatePartials, {\n\t\tbutton: Button.prototype.template,\n\t\tanchor: Anchor.prototype.template\n\t} ),\n\t/**\n\t\t * @memberof CtaDrawer\n\t\t * @instance\n\t\t */\n\ttemplate: mw.template.get( 'mobile.startup', 'CtaDrawer.hogan' ),\n\t/**\n\t\t * @inheritdoc\n\t\t * @memberof CtaDrawer\n\t\t * @instance\n\t\t */\n\tpreRender: function () {\n\t\tvar params = redirectParams( this.options.queryParams, this.options.returnTo );\n\n\t\t// Give the button and the anchor a default target, if it isn't set already. Buttons are\n\t\t// customized by Minerva's red link drawer, skins.minerva.scripts/init.js.\n\t\tif ( !this.options.progressiveButton.href ) {\n\t\t\tthis.options.progressiveButton.href = mw.util.getUrl( 'Special:UserLogin', params );\n\t\t}\n\t\tif ( !this.options.actionAnchor.href ) {\n\t\t\tthis.options.actionAnchor.href = mw.util.getUrl(\n\t\t\t\t'Special:UserLogin', signUpParams( params, this.options.signupQueryParams )\n\t\t\t);\n\t\t}\n\t}\n} );\n\n/**\n * Special:UserLogin post-request redirect query parameters.\n * @param {QueryParams} params\n * @param {string} [redirectURL]\n * @return {QueryParams}\n */\nfunction redirectParams( params, redirectURL ) {\n\treturn util.extend( {\n\t\t// use wgPageName as this includes the namespace if outside Main\n\t\treturnto: redirectURL || mw.config.get( 'wgPageName' )\n\t}, params );\n}\n\n/**\n * Special:UserLogin account creation query parameters.\n * @param {...QueryParams} params\n * @return {QueryParams}\n */\nfunction signUpParams() {\n\t[].push.call( arguments, { type: 'signup' } );\n\treturn util.extend.apply( util, arguments );\n}\n\nCtaDrawer.prototype.test = {\n\tredirectParams: redirectParams,\n\tsignUpParams: signUpParams\n};\n\nmodule.exports = CtaDrawer;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tPanel = require( './Panel' ),\n\tutil = require( './util' ),\n\tIcon = require( './Icon' );\n\n/**\n * A {@link View} that pops up from the bottom of the screen.\n * @class Drawer\n * @extends Panel\n * @param {Object} props\n */\nfunction Drawer( props ) {\n\tPanel.call( this,\n\t\tutil.extend( {\n\t\t\tclassName: 'drawer position-fixed'\n\t\t}, props )\n\t);\n}\n\nmfExtend( Drawer, Panel, {\n\t/**\n\t * @memberof Drawer\n\t * @instance\n\t * @mixes Panel#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.cancelButton HTML of the button that closes the drawer.\n\t */\n\tdefaults: util.extend( {}, Panel.prototype.defaults, {\n\t\t// Used by CtaDrawer, BlockMessage.\n\t\tcollapseIcon: new Icon( {\n\t\t\tname: 'arrow',\n\t\t\tadditionalClassNames: 'cancel'\n\t\t} ).options\n\t} ),\n\t/**\n\t * @memberof Drawer\n\t * @instance\n\t */\n\ttemplatePartials: util.extend( {}, Panel.prototype.templatePartials, {\n\t\ticon: Icon.prototype.template\n\t} ),\n\t/**\n\t * Defines an element that the Drawer should automatically be appended to.\n\t * @memberof Drawer\n\t * @instance\n\t * @property {string}\n\t */\n\tappendToElement: 'body',\n\t/**\n\t * Whether the drawer should disappear on a scroll event\n\t * @memberof Drawer\n\t * @instance\n\t * @property {boolean}\n\t */\n\tcloseOnScroll: true,\n\tevents: util.extend( {}, Panel.prototype.events, {\n\t\tclick: 'stopPropagation'\n\t} ),\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Drawer\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar self = this;\n\t\t// This module might be loaded at the top of the page e.g. Special:Uploads\n\t\t// Thus ensure we wait for the DOM to be loaded\n\t\tutil.docReady( function () {\n\t\t\tself.appendTo( self.appendToElement );\n\t\t\tself.$el.parent().addClass( 'has-drawer' );\n\t\t} );\n\t\tthis.on( 'show', this.onShowDrawer.bind( this ) );\n\t\tthis.on( 'hide', this.onHideDrawer.bind( this ) );\n\t},\n\t/**\n\t * Stop Propagation event handler\n\t * @memberof Drawer\n\t * @instance\n\t * @param {Object} ev event object\n\t * Allow the drawer itself to be clickable (e.g. for copying and pasting references\n\t * clicking links in reference)\n\t */\n\tstopPropagation: function ( ev ) {\n\t\tev.stopPropagation();\n\t},\n\n\t/**\n\t * ShowDrawer event handler\n\t * @memberof Drawer\n\t * @instance\n\t */\n\tonShowDrawer: function () {\n\t\tvar self = this;\n\n\t\tthis.$el.parent().addClass( 'drawer-visible' );\n\n\t\tsetTimeout( function () {\n\t\t\tvar $window = util.getWindow();\n\t\t\t$window.one( 'click.drawer', self.hide.bind( self ) );\n\t\t\tif ( self.closeOnScroll ) {\n\t\t\t\t$window.one( 'scroll.drawer', self.hide.bind( self ) );\n\t\t\t}\n\t\t}, self.minHideDelay );\n\t},\n\n\t/**\n\t * HideDrawer event handler\n\t * @memberof Drawer\n\t * @instance\n\t */\n\tonHideDrawer: function () {\n\t\tthis.$el.parent().removeClass( 'drawer-visible' );\n\t\t// .one() registers one callback for scroll and click independently\n\t\t// if one fired, get rid of the other one\n\t\tutil.getWindow().off( '.drawer' );\n\t}\n} );\n\nmodule.exports = Drawer;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' );\n\n/**\n * A wrapper for creating an icon.\n * @class Icon\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Icon( options ) {\n\tif ( options.hasText ) {\n\t\toptions.modifier = 'mw-ui-icon-before';\n\t}\n\tif ( options.href ) {\n\t\toptions.tagName = 'a';\n\t}\n\tView.call( this, options );\n}\n\nmfExtend( Icon, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Icon\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tthis.setRotationClass();\n\t},\n\t/**\n\t * Internal method that sets the correct rotation class for the icon\n\t * based on the value of rotation\n\t * @memberof Icon\n\t * @instance\n\t * @private\n\t */\n\tsetRotationClass: function () {\n\t\tvar options = this.options;\n\t\tif ( options.rotation ) {\n\t\t\tswitch ( options.rotation ) {\n\t\t\t\tcase -180:\n\t\t\t\tcase 180:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-flip';\n\t\t\t\t\tbreak;\n\t\t\t\tcase -90:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-anti-clockwise';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 90:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-clockwise';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Bad value for rotation given. Must be ±90, 0 or ±180.' );\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Icon\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Icon\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {boolean} defaults.hasText Whether the icon has text.\n\t * @property {boolean} defaults.isSmall Whether the icon should be small.\n\t * @property {string} [defaults.href] value of href attribute,\n\t *  when set tagName will default to anchor tag\n\t * @property {string} defaults.tagName The name of the tag in which the icon is wrapped.\n\t *  Defaults to 'a' when href option present.\n\t * @property {string} defaults.base String used as a base for generating class names.\n\t * Defaults to 'mw-ui-icon'.\n\t * @property {string} defaults.name Name of the icon.\n\t * @property {string} defaults.modifier Additional class name.\n\t * Defaults to 'mw-ui-icon-element'.\n\t * @property {string} defaults.title Tooltip text.\n\t * @property {boolean} defaults.rotation will rotate the icon by a certain number\n\t *  of degrees.\n\t *  Must be ±90, 0 or ±180 or will throw exception.\n\t */\n\tdefaults: {\n\t\trotation: 0,\n\t\thasText: false,\n\t\thref: undefined,\n\t\tglyphPrefix: 'mf',\n\t\ttagName: 'div',\n\t\tisSmall: false,\n\t\tbase: 'mw-ui-icon',\n\t\tname: '',\n\t\tmodifier: 'mw-ui-icon-element',\n\t\ttitle: ''\n\t},\n\t/**\n\t * Return the full class name that is required for the icon to render\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\tgetClassName: function () {\n\t\treturn this.$el.attr( 'class' );\n\t},\n\t/**\n\t * Return the class that relates to the icon glyph\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\tgetGlyphClassName: function () {\n\t\treturn this.options.base + '-' + this.options.glyphPrefix + '-' + this.options.name;\n\t},\n\t/**\n\t * Return the HTML representation of this view\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\ttoHtmlString: function () {\n\t\treturn this.parseHTML( '<div>' ).append( this.$el ).html();\n\t},\n\ttemplate: mw.template.get( 'mobile.startup', 'icon.hogan' )\n} );\n\nmodule.exports = Icon;\n","var\n\tView = require( './View' ),\n\tIcon = require( './Icon' ),\n\tButton = require( './Button' ),\n\tAnchor = require( './Anchor' ),\n\ticons = require( './icons' ),\n\tutil = require( './util' ),\n\tbrowser = require( './Browser' ).getSingleton(),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * Mobile modal window\n * @class Overlay\n * @extends View\n * @uses Icon\n * @uses Button\n * @fires Overlay#Overlay-exit\n * @fires Overlay#hide\n * @param {Object} props\n * @param {boolean} props.noHeader renders an overlay without a header\n */\nfunction Overlay( props ) {\n\tthis.isIos = browser.isIos();\n\tthis.useVirtualKeyboardHack = browser.isIos( 4 ) || browser.isIos( 5 );\n\t// Set to true when overlay has failed to load\n\tthis.hasLoadError = false;\n\tView.call( this, util.extend( {\n\t\tclassName: 'overlay'\n\t}, props ) );\n}\n\nmfExtend( Overlay, View, {\n\t/**\n\t * Identify whether the element contains position fixed elements\n\t * @memberof Overlay\n\t * @instance\n\t * @property {boolean}\n\t */\n\thasFixedHeader: true,\n\t/**\n\t * Is overlay fullscreen\n\t * @memberof Overlay\n\t * @instance\n\t * @property {boolean}\n\t */\n\tfullScreen: true,\n\n\t/**\n\t * True if this.hide() should be invoked before firing the Overlay-exit\n\t * event\n\t * @memberof Overlay\n\t * @instance\n\t * @property {boolean}\n\t */\n\thideOnExitClick: true,\n\n\ttemplatePartials: {\n\t\theader: mw.template.get( 'mobile.startup', 'header.hogan' ),\n\t\tanchor: Anchor.prototype.template,\n\t\tbutton: Button.prototype.template\n\t},\n\ttemplate: mw.template.get( 'mobile.startup', 'Overlay.hogan' ),\n\t/**\n\t * @memberof Overlay\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.saveMessage Caption for save button on edit form.\n\t * @property {string} defaults.cancelButton HTML of the cancel button.\n\t * @property {string} defaults.backButton HTML of the back button.\n\t * @property {string} defaults.headerButtonsListClassName A comma separated string of class\n\t * names of the wrapper of the header buttons.\n\t * @property {boolean} defaults.headerChrome Whether the header has chrome.\n\t * @property {string} defaults.spinner HTML of the spinner icon.\n\t * @property {Object} [defaults.footerAnchor] options for an optional Anchor\n\t *  that can appear in the footer\n\t */\n\tdefaults: {\n\t\tsaveMsg: mw.msg( 'mobile-frontend-editor-save' ),\n\t\tcancelButton: icons.cancel().toHtmlString(),\n\t\tbackButton: new Icon( {\n\t\t\ttagName: 'button',\n\t\t\tname: 'back',\n\t\t\tadditionalClassNames: 'back',\n\t\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' )\n\t\t} ).toHtmlString(),\n\t\theaderButtonsListClassName: '',\n\t\theaderChrome: false,\n\t\tspinner: icons.spinner().toHtmlString()\n\t},\n\t/**\n\t * @memberof Overlay\n\t * @instance\n\t */\n\tevents: {\n\t\t// FIXME: Remove .initial-header selector when bug 71203 resolved.\n\t\t'click .cancel, .confirm, .initial-header .back': 'onExitClick',\n\t\tclick: 'stopPropagation'\n\t},\n\t/**\n\t * Flag overlay to close on content tap\n\t * @memberof Overlay\n\t * @instance\n\t * @property {boolean}\n\t */\n\tcloseOnContentTap: false,\n\n\t/**\n\t * Shows the spinner right to the input field.\n\t * @memberof Overlay\n\t * @instance\n\t * @method\n\t */\n\tshowSpinner: function () {\n\t\tthis.$spinner.removeClass( 'hidden' );\n\t},\n\n\t/**\n\t * Hide the spinner near to the input field.\n\t * @memberof Overlay\n\t * @instance\n\t * @method\n\t */\n\thideSpinner: function () {\n\t\tthis.$spinner.addClass( 'hidden' );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Overlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\n\t\tthis.$overlayContent = this.$( '.overlay-content' );\n\t\tthis.$spinner = this.$( '.spinner' );\n\t\tif ( this.isIos ) {\n\t\t\tthis.$el.addClass( 'overlay-ios' );\n\t\t}\n\t\t// Truncate any text inside in the overlay header.\n\t\tthis.$( '.overlay-header h2 span' ).addClass( 'truncated-text' );\n\t\tthis.setupEmulatedIosOverlayScrolling();\n\t},\n\n\t/**\n\t * Setups an emulated scroll behaviour for overlays in ios.\n\t * @memberof Overlay\n\t * @instance\n\t */\n\tsetupEmulatedIosOverlayScrolling: function () {\n\t\tvar self = this;\n\t\tif ( this.isIos && this.hasFixedHeader ) {\n\t\t\tthis.$( '.overlay-content' ).on( 'touchstart', this.onTouchStart.bind( this ) )\n\t\t\t\t.on( 'touchmove', this.onTouchMove.bind( this ) );\n\t\t\t// wait for things to render before doing any calculations\n\t\t\tsetTimeout( function () {\n\t\t\t\tself._fixIosHeader( self.$( 'textarea, input' ) );\n\t\t\t}, 0 );\n\t\t}\n\t},\n\t/**\n\t * ClickBack event handler\n\t * @memberof Overlay\n\t * @instance\n\t * @param {Object} ev event object\n\t */\n\tonExitClick: function ( ev ) {\n\t\tev.preventDefault();\n\t\tev.stopPropagation();\n\t\tif ( this.hideOnExitClick ) {\n\t\t\tthis.hide();\n\t\t}\n\t\tthis.emit( Overlay.EVENT_EXIT );\n\t},\n\t/**\n\t * Event handler for touchstart, for IOS\n\t * @memberof Overlay\n\t * @instance\n\t * @param {Object} ev Event Object\n\t */\n\tonTouchStart: function ( ev ) {\n\t\tthis.startY = ev.originalEvent.touches[0].pageY;\n\t},\n\t/**\n\t * Event handler for touch move, for IOS\n\t * @memberof Overlay\n\t * @instance\n\t * @param {Object} ev Event Object\n\t */\n\tonTouchMove: function ( ev ) {\n\t\tvar\n\t\t\ty = ev.originalEvent.touches[0].pageY,\n\t\t\tcontentOuterHeight = this.$overlayContent.outerHeight(),\n\t\t\tcontentLength = this.$overlayContent.prop( 'scrollHeight' ) - contentOuterHeight;\n\n\t\tev.stopPropagation();\n\t\t// prevent scrolling and bouncing outside of .overlay-content\n\t\tif (\n\t\t\t( this.$overlayContent.scrollTop() === 0 && this.startY < y ) ||\n\t\t\t( this.$overlayContent.scrollTop() === contentLength && this.startY > y )\n\t\t) {\n\t\t\tev.preventDefault();\n\t\t}\n\t},\n\t/**\n\t * Stop clicks in the overlay from propagating to the page\n\t * (prevents non-fullscreen overlays from being closed when they're tapped)\n\t * @memberof Overlay\n\t * @instance\n\t * @param {Object} ev Event Object\n\t */\n\tstopPropagation: function ( ev ) {\n\t\tev.stopPropagation();\n\t},\n\t/**\n\t * Attach overlay to current view and show it.\n\t * @memberof Overlay\n\t * @instance\n\t */\n\tshow: function () {\n\t\tvar self = this,\n\t\t\t$html = util.getDocument(),\n\t\t\t$window = util.getWindow();\n\n\t\tthis.scrollTop = window.pageYOffset;\n\n\t\tif ( this.fullScreen ) {\n\t\t\t$html.addClass( 'overlay-enabled' );\n\t\t\t// skip the URL bar if possible\n\t\t\twindow.scrollTo( 0, 1 );\n\t\t}\n\n\t\tif ( this.closeOnContentTap ) {\n\t\t\t$html.find( '#mw-mf-page-center' ).one( 'click', this.hide.bind( this ) );\n\t\t}\n\n\t\t// prevent scrolling and bouncing outside of .overlay-content\n\t\tif ( this.isIos && this.hasFixedHeader ) {\n\t\t\t$window\n\t\t\t\t.on( 'touchmove.ios', function ( ev ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t} )\n\t\t\t\t.on( 'resize.ios', function () {\n\t\t\t\t\tself._resizeContent( $window.height() );\n\t\t\t\t} );\n\t\t}\n\n\t\tthis.$el.addClass( 'visible' );\n\t},\n\t/**\n\t * Detach the overlay from the current view\n\t * @memberof Overlay\n\t * @instance\n\t * @param {boolean} [force] Whether the overlay should be closed regardless of\n\t * state (see PhotoUploadProgress)\n\t * @return {boolean} Whether the overlay was successfully hidden or not\n\t */\n\thide: function () {\n\t\tvar $window = util.getWindow(),\n\t\t\t$html = util.getDocument();\n\n\t\tif ( this.fullScreen ) {\n\t\t\t$html.removeClass( 'overlay-enabled' );\n\t\t\t// return to last known scroll position\n\t\t\twindow.scrollTo( window.pageXOffset, this.scrollTop );\n\t\t}\n\n\t\tthis.$el.detach();\n\n\t\tif ( this.isIos ) {\n\t\t\t$window.off( '.ios' );\n\t\t}\n\n\t\t/**\n\t\t * Fired when the overlay is closed.\n\t\t * @event Overlay#hide\n\t\t */\n\t\tthis.emit( 'hide' );\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Fit the overlay content height to the window taking overlay header and footer heights\n\t * into consideration.\n\t * @memberof Overlay\n\t * @instance\n\t * @private\n\t * @param {number} windowHeight The height of the window\n\t */\n\t_resizeContent: function ( windowHeight ) {\n\t\tthis.$overlayContent.height(\n\t\t\twindowHeight -\n\t\t\tthis.$( '.overlay-header-container' ).outerHeight() -\n\t\t\tthis.$( '.overlay-footer-container' ).outerHeight()\n\t\t);\n\t},\n\n\t/**\n\t * Resize .overlay-content to occupy 100% of screen space when virtual\n\t * keyboard is shown/hidden on iOS.\n\t *\n\t * This function supplements the custom styles for Overlays on iOS.\n\t * On iOS we scroll the content inside of .overlay-content div instead\n\t * of scrolling the whole page to achieve a consistent sticky header\n\t * effect (position: fixed doesn't work on iOS when the virtual keyboard\n\t * is open).\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t * @private\n\t * @param {jQuery.Object} $el for elements that may trigger virtual\n\t * keyboard (usually inputs, textareas, contenteditables).\n\t */\n\t_fixIosHeader: function ( $el ) {\n\t\tvar self = this,\n\t\t\t$window = util.getWindow();\n\n\t\tif ( this.isIos ) {\n\t\t\tthis._resizeContent( $window.height() );\n\t\t\t$el\n\t\t\t\t.on( 'focus', function () {\n\t\t\t\t\tsetTimeout( function () {\n\t\t\t\t\t\tvar keyboardHeight = 0;\n\n\t\t\t\t\t\t// detect virtual keyboard height\n\t\t\t\t\t\tif ( self.useVirtualKeyboardHack ) {\n\t\t\t\t\t\t\t// this method does not work in iOS 8.02\n\t\t\t\t\t\t\t$window.scrollTop( 999 );\n\t\t\t\t\t\t\tkeyboardHeight = $window.scrollTop();\n\t\t\t\t\t\t\t$window.scrollTop( 0 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( $window.height() > keyboardHeight ) {\n\t\t\t\t\t\t\tself._resizeContent( $window.height() - keyboardHeight );\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0 );\n\t\t\t\t} )\n\t\t\t\t.on( 'blur', function () {\n\t\t\t\t\tself._resizeContent( $window.height() );\n\t\t\t\t\t// restore the fixed header in view.\n\t\t\t\t\t$window.scrollTop( 0 );\n\t\t\t\t} );\n\t\t}\n\t},\n\n\t/**\n\t * Show elements that are selected by the className.\n\t * Also hide .hideable elements\n\t * Can't use jQuery's hide() and show() because show() sets display: block.\n\t * And we want display: table for headers.\n\t * @memberof Overlay\n\t * @instance\n\t * @protected\n\t * @param {string} className CSS selector to show\n\t */\n\tshowHidden: function ( className ) {\n\t\tthis.$( '.hideable' ).addClass( 'hidden' );\n\t\tthis.$( className ).removeClass( 'hidden' );\n\t}\n} );\n\n/*\n * Fires when close button is clicked. Not to be confused with hide event.\n * @memberof Overlay\n * @event Overlay#Overlay-exit\n */\nOverlay.EVENT_EXIT = 'Overlay-exit';\n\nmodule.exports = Overlay;\n","/* global $ */\nvar\n\tutil = require( './util' ),\n\tmfExtend = require( './mfExtend' ),\n\toverlayManager = null;\n\n/**\n * Manages opening and closing overlays when the URL hash changes to one\n * of the registered values (see OverlayManager.add()).\n *\n * This allows overlays to function like real pages, with similar browser back/forward\n * and refresh behavior.\n *\n * @class OverlayManager\n * @param {Router} router\n * @param {string} appendToSelector\n */\nfunction OverlayManager( router, appendToSelector ) {\n\trouter.on( 'route', this._checkRoute.bind( this ) );\n\tthis.router = router;\n\t// use an object instead of an array for entries so that we don't\n\t// duplicate entries that already exist\n\tthis.entries = {};\n\t// stack of all the open overlays, stack[0] is the latest one\n\tthis.stack = [];\n\tthis.hideCurrent = true;\n\t// Set the element that overlays will be appended to\n\tif ( !appendToSelector ) {\n\t\tmw.log.warn( 'appendToSelector will soon be a required parameter to OverlayManager' );\n\t}\n\tthis.appendToSelector = appendToSelector || 'body';\n}\n\nmfExtend( OverlayManager, {\n\t/**\n\t * Don't try to hide the active overlay on a route change event triggered\n\t * by hiding another overlay.\n\t * Called when hiding an overlay.\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t */\n\t_onHideOverlay: function () {\n\t\tthis.hideCurrent = false;\n\n\t\tthis.router.back();\n\t},\n\n\t/** Attach overlay to DOM\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Overlay} overlay to attach\n\t*/\n\t_attachOverlay: function ( overlay ) {\n\t\tif ( !overlay.$el.parents().length ) {\n\t\t\t$( this.appendToSelector ).append( overlay.$el );\n\t\t}\n\t},\n\t/**\n\t * Show the overlay and bind the '_om_hide' event to _onHideOverlay.\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Overlay} overlay to show\n\t */\n\t_show: function ( overlay ) {\n\n\t\t// if hidden using overlay (not hardware) button, update the state\n\t\toverlay.once( '_om_hide', this._onHideOverlay.bind( this ) );\n\n\t\tthis._attachOverlay( overlay );\n\t\toverlay.show();\n\t},\n\n\t/**\n\t * Hide overlay\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Overlay} overlay to hide\n\t * @return {boolean} Whether the overlay has been hidden\n\t */\n\t_hideOverlay: function ( overlay ) {\n\t\tvar result;\n\n\t\t// remove the callback for updating state when overlay closed using\n\t\t// overlay close button\n\t\toverlay.off( '_om_hide' );\n\n\t\tresult = overlay.hide( this.stack.length > 1 );\n\n\t\t// if closing prevented, reattach the callback\n\t\tif ( !result ) {\n\t\t\toverlay.once( '_om_hide', this._onHideOverlay.bind( this ) );\n\t\t}\n\n\t\treturn result;\n\t},\n\n\t/**\n\t * Show match's overlay if match is not null.\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Object|null} match Object with factory function's result. null if no match.\n\t */\n\t_processMatch: function ( match ) {\n\t\tvar factoryResult,\n\t\t\tself = this;\n\n\t\t/**\n\t\t * Attach an event to the overlays hide event\n\t\t * @param {Overlay} overlay\n\t\t */\n\t\tfunction attachHideEvent( overlay ) {\n\t\t\toverlay.on( 'hide', function () {\n\t\t\t\toverlay.emit( '_om_hide' );\n\t\t\t} );\n\t\t}\n\n\t\tif ( match ) {\n\t\t\tif ( match.overlay ) {\n\t\t\t\t// if the match is an overlay that was previously opened, reuse it\n\t\t\t\tself._show( match.overlay );\n\t\t\t} else {\n\t\t\t\t// else create an overlay using the factory function result (either\n\t\t\t\t// a promise or an overlay)\n\t\t\t\tfactoryResult = match.factoryResult;\n\t\t\t\t// http://stackoverflow.com/a/13075985/365238\n\t\t\t\tif ( typeof factoryResult.promise === 'function' ) {\n\t\t\t\t\tfactoryResult.then( function ( overlay ) {\n\t\t\t\t\t\tmatch.overlay = overlay;\n\t\t\t\t\t\tattachHideEvent( overlay );\n\t\t\t\t\t\tself._show( overlay );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tmatch.overlay = factoryResult;\n\t\t\t\t\tattachHideEvent( match.overlay );\n\t\t\t\t\tself._show( factoryResult );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * A callback for Router's `route` event.\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {jQuery.Event} ev Event object.\n\t */\n\t_checkRoute: function ( ev ) {\n\t\tvar\n\t\t\tcurrent = this.stack[0],\n\t\t\tmatch;\n\n\t\t// When entering an overlay for the first time,\n\t\t// the manager should remember the user's scroll position\n\t\t// overlays always open at top of page\n\t\t// and we'll want to restore it later.\n\t\t// This should happen before the call to _matchRoute which will \"show\" the overlay.\n\t\t// The Overlay has similar logic for overlays that are not managed via the overlay.\n\t\tif ( !current ) {\n\t\t\tthis.scrollTop = window.pageYOffset;\n\t\t}\n\n\t\tmatch = Object.keys( this.entries ).reduce( function ( m, id ) {\n\t\t\treturn m || this._matchRoute( ev.path, this.entries[ id ] );\n\t\t}.bind( this ), null );\n\n\t\t// if there is an overlay in the stack and it's opened, try to close it\n\t\tif (\n\t\t\tcurrent &&\n\t\t\tcurrent.overlay !== undefined &&\n\t\t\tthis.hideCurrent &&\n\t\t\t!this._hideOverlay( current.overlay )\n\t\t) {\n\t\t\t// if hide prevented, prevent route change event\n\t\t\tev.preventDefault();\n\t\t} else if ( !match ) {\n\t\t\t// if hidden and no new matches, reset the stack\n\t\t\tthis.stack = [];\n\t\t\t// restore the scroll position.\n\t\t\twindow.scrollTo( window.pageXOffset, this.scrollTop );\n\t\t}\n\n\t\tthis.hideCurrent = true;\n\t\tthis._processMatch( match );\n\t},\n\n\t/**\n\t * Check if a given path matches one of the entries.\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {string} path Path (hash) to check.\n\t * @param {Object} entry Entry object created in OverlayManager#add.\n\t * @return {Object|null} Match object with factory function's result.\n\t *  Returns null if no match.\n\t */\n\t_matchRoute: function ( path, entry ) {\n\t\tvar\n\t\t\tnext,\n\t\t\tmatch = path.match( entry.route ),\n\t\t\tprevious = this.stack[1],\n\t\t\tself = this;\n\n\t\t/**\n\t\t * Returns object to add to stack\n\t\t * @method\n\t\t * @ignore\n\t\t * @return {Object}\n\t\t */\n\t\tfunction getNext() {\n\t\t\treturn {\n\t\t\t\tpath: path,\n\t\t\t\tfactoryResult: entry.factory.apply( self, match.slice( 1 ) )\n\t\t\t};\n\t\t}\n\n\t\tif ( match ) {\n\t\t\t// if previous stacked overlay's path matches, assume we're going back\n\t\t\t// and reuse a previously opened overlay\n\t\t\tif ( previous && previous.path === path ) {\n\t\t\t\tif ( previous.overlay && previous.overlay.hasLoadError ) {\n\t\t\t\t\tself.stack.shift();\n\t\t\t\t\t// Loading of overlay failed so we want to replace it with a new\n\t\t\t\t\t// overlay (which will try to load successfully)\n\t\t\t\t\tself.stack[0] = getNext();\n\t\t\t\t\treturn self.stack[0];\n\t\t\t\t}\n\n\t\t\t\tself.stack.shift();\n\t\t\t\treturn previous;\n\t\t\t} else {\n\t\t\t\tnext = getNext();\n\t\t\t\tif ( this.stack[0] && next.path === this.stack[0].path ) {\n\t\t\t\t\t// current overlay path is same as path to check which means overlay\n\t\t\t\t\t// is attempting to refresh so just replace current overlay with new\n\t\t\t\t\t// overlay\n\t\t\t\t\tself.stack[0] = next;\n\t\t\t\t} else {\n\t\t\t\t\tself.stack.unshift( next );\n\t\t\t\t}\n\t\t\t\treturn next;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Add an overlay that should be shown for a specific fragment identifier.\n\t *\n\t * The following code will display an overlay whenever a user visits a URL that\n\t * end with '#/hi/name'. The value of `name` will be passed to the overlay.\n\t *\n\t *     @example\n\t *     overlayManager.add( /\\/hi\\/(.*)/, function ( name ) {\n\t *       var factoryResult = $.Deferred();\n\t *\n\t *       mw.using( 'mobile.HiOverlay', function () {\n\t *         var HiOverlay = M.require( 'HiOverlay' );\n\t *         factoryResult.resolve( new HiOverlay( { name: name } ) );\n\t *       } );\n\t *\n\t *       return factoryResult;\n\t *     } );\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @param {RegExp} route route regular expression, optionally with parameters.\n\t * @param {Function} factory a function returning an overlay or a $.Deferred\n\t * which resolves to an overlay.\n\t */\n\tadd: function ( route, factory ) {\n\t\tvar self = this,\n\t\t\tentry = {\n\t\t\t\troute: route,\n\t\t\t\tfactory: factory\n\t\t\t};\n\n\t\tthis.entries[route] = entry;\n\t\t// Check if overlay should be shown for the current path.\n\t\t// The DOM must fully load before we can show the overlay because Overlay relies on it.\n\t\tutil.docReady( function () {\n\t\t\tself._processMatch( self._matchRoute( self.router.getPath(), entry ) );\n\t\t} );\n\t},\n\n\t/**\n\t * Replace the currently displayed overlay with a new overlay without changing the\n\t * URL. This is useful for when you want to switch overlays, but don't want to\n\t * change the back button or close box behavior.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @param {Object} overlay The overlay to display\n\t */\n\treplaceCurrent: function ( overlay ) {\n\t\tif ( this.stack.length === 0 ) {\n\t\t\tthrow new Error( 'Trying to replace OverlayManager\\'s current overlay, but stack is empty' );\n\t\t}\n\t\tthis._hideOverlay( this.stack[0].overlay );\n\t\tthis.stack[0].overlay = overlay;\n\t\tthis._show( overlay );\n\t}\n} );\n\n/**\n * Retrieve a singleton instance using 'mediawiki.router'.\n * @memberof OverlayManager\n * @return {OverlayManager}\n */\nOverlayManager.getSingleton = function () {\n\tif ( !overlayManager ) {\n\t\toverlayManager = new OverlayManager( mw.loader.require( 'mediawiki.router' ), 'body' );\n\t}\n\treturn overlayManager;\n};\n\nmodule.exports = OverlayManager;\n","var\n\tHTML = mw.html,\n\tmfExtend = require( './mfExtend' ),\n\ttime = require( './time' ),\n\tutil = require( './util' ),\n\tSection = require( './Section' ),\n\tThumbnail = require( './Thumbnail' ),\n\tView = require( './View' ),\n\tHEADING_SELECTOR = mw.config.get( 'wgMFMobileFormatterHeadings', [ 'h1', 'h2', 'h3', 'h4', 'h5' ] ).join( ',' ),\n\tBLACKLISTED_THUMBNAIL_CLASS_SELECTORS = [ 'noviewer', 'metadata' ];\n\n/**\n * Mobile page view object\n *\n * @class Page\n * @uses Section\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Page( options ) {\n\n\tutil.extend( this, {\n\t\toptions: options,\n\t\ttitle: options.title,\n\t\tdisplayTitle: options.displayTitle,\n\t\turl: options.url || mw.util.getUrl( options.title ),\n\t\tid: options.id,\n\t\twikidataDescription: options.wikidataDescription,\n\t\tthumbnail: ( Object.prototype.hasOwnProperty.call( options, 'thumbnail' ) ) ?\n\t\t\toptions.thumbnail : false,\n\t\tisMissing: ( options.isMissing !== undefined ) ?\n\t\t\toptions.isMissing : options.id === 0\n\t} );\n\n\tthis.options.isBorderBox = false;\n\tthis.options.languageUrl = mw.util.getUrl( 'Special:MobileLanguages/' + this.title );\n\n\tView.call( this, this.options );\n\n\t// Fallback if no displayTitle provided\n\tif ( !this.displayTitle ) {\n\t\tthis.displayTitle = this.getDisplayTitle();\n\t}\n\n\tif ( this.thumbnail && this.thumbnail.width ) {\n\t\tthis.thumbnail.isLandscape = this.thumbnail.width > this.thumbnail.height;\n\t}\n}\n\nmfExtend( Page, View, {\n\t/**\n\t * @memberof Page\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {number} defaults.id Page ID. The default value of 0 represents a\n\t * new or missing page. Be sure to override it to avoid side effects.\n\t * @property {string} defaults.title Title of the page. It includes prefix where needed and\n\t * is human readable, e.g. Talk:The man who lived.\n\t * @property {string} defaults.displayTitle HTML title of the page for display. Falls back\n\t * to defaults.title (escaped) if no value is provided. Must be safe HTML!\n\t * @property {number} defaults.namespaceNumber the number of the\n\t *  namespace the page belongs to\n\t * @property {Object} defaults.protection List of permissions as returned by API,\n\t * e.g. [{ edit: ['*'] }]\n\t * @property {Array} defaults.sections Array of {Section} objects.\n\t * @property {boolean} defaults.isMainPage Whether the page is the Main Page.\n\t * @property {boolean} defaults.isMissing Whether the page exists in the wiki.\n\t * @property {Object} defaults.thumbnail thumbnail definition corresponding to page image\n\t * @property {boolean} defaults.thumbnail.isLandscape whether the image is in\n\t *  landscape format\n\t * @property {number} defaults.thumbnail.width of image in pixels.\n\t * @property {number} defaults.thumbnail.height of image in pixels.\n\t * @property {string} defaults.thumbnail.source url for image\n\t */\n\tdefaults: {\n\t\tid: 0,\n\t\ttitle: '',\n\t\tdisplayTitle: '',\n\t\tnamespaceNumber: 0,\n\t\tprotection: {\n\t\t\tedit: [ '*' ]\n\t\t},\n\t\tsections: [],\n\t\tisMissing: false,\n\t\tisMainPage: false,\n\t\turl: undefined,\n\t\tthumbnail: {\n\t\t\tisLandscape: undefined,\n\t\t\tsource: undefined,\n\t\t\twidth: undefined,\n\t\t\theight: undefined\n\t\t}\n\t},\n\t/**\n\t * Retrieve the title that should be displayed to the user\n\t * @memberof Page\n\t * @instance\n\t * @return {string} HTML\n\t */\n\tgetDisplayTitle: function () {\n\t\treturn this.options.displayTitle || HTML.escape( this.options.title );\n\t},\n\t/**\n\t * Determine if current page is in a specified namespace\n\t * @memberof Page\n\t * @instance\n\t * @param {string} namespace Name of namespace\n\t * @return {boolean}\n\t */\n\tinNamespace: function ( namespace ) {\n\t\treturn this.options.namespaceNumber === mw.config.get( 'wgNamespaceIds' )[namespace];\n\t},\n\n\t/**\n\t * Find the heading in the page.\n\t * This has the benefit of excluding any additional h2s and h3s that may\n\t * have been added programatically.\n\t * @method\n\t * @param {number} sectionIndex as defined by the PHP parser.\n\t *  It should correspond to the section id\n\t *  used in the edit link for the section.\n\t *  Note, confusingly, this is different from section \"ID\" which is\n\t * used in methods\n\t * @return {jQuery.Object}\n\t */\n\tfindSectionHeadingByIndex: function ( sectionIndex ) {\n\t\tif ( sectionIndex < 1 ) {\n\t\t\t// negative indexes will search from the end, which is behaviour we do not want.\n\t\t\t// return an empty set when this happens.\n\t\t\treturn this.$();\n\t\t} else {\n\t\t\treturn this.$( HEADING_SELECTOR )\n\t\t\t\t// Headings must strictly be a child element of a section element\n\t\t\t\t// or the parser-output.\n\t\t\t\t// Not an ancestor!\n\t\t\t\t.filter( '.mw-parser-output > *, [class^=\"mf-section-\"] > *' ).eq( sectionIndex - 1 );\n\t\t}\n\t},\n\t/**\n\t * Finds all child elements that match the selector in a given section or subsection.\n\t * Returns any direct child elements that match the selector,\n\t * (i.e. searches only one level deep)\n\t * as well as any elements that match the selector within those children.\n\t * If the Page has no headings (e.g. a stub),\n\t * then the search will target all nodes within the page.\n\t *\n\t * This code should work on desktop (PHP parser HTML)\n\t * as well as mobile formatted HTML (PHP parser + MobileFormatter)\n\t * @method\n\t * @param {number} sectionIndex as defined by the PHP parser. It should correspond to\n\t *  the section id used in the edit link for the section.\n\t *  Note, confusingly, this is different from section \"ID\" which is\n\t *  used in methods\n\t * @param {string} selector to match\n\t * @return {jQuery.Object}\n\t */\n\tfindChildInSectionLead: function ( sectionIndex, selector ) {\n\t\tvar $heading, $nextHeading, $container, $lead,\n\t\t\theadingSelector = HEADING_SELECTOR;\n\n\t\tfunction withNestedChildren( $matchingNodes ) {\n\t\t\treturn $matchingNodes.find( selector ).addBack();\n\t\t}\n\n\t\tif ( sectionIndex === 0 ) {\n\t\t\t// lead is easy\n\t\t\t$lead = this.getLeadSectionElement();\n\t\t\tif ( $lead && $lead.length ) {\n\t\t\t\treturn withNestedChildren( $lead.children( selector ) );\n\t\t\t} else {\n\t\t\t\t$heading = this.findSectionHeadingByIndex( 1 );\n\t\t\t\treturn $heading.length ? withNestedChildren( $heading.prevAll( selector ) ) :\n\t\t\t\t\t// this page is a stub so search entire page\n\t\t\t\t\tthis.$( selector );\n\t\t\t}\n\t\t}\n\n\t\t// find heading associated with the section by looking at its\n\t\t// index position in the article\n\t\t// section ids relate to the element position in the page and the first heading\n\t\t// lead has been dealt with above, so first heading corresponds to section 1,\n\t\t// the first heading in the article.\n\t\t$heading = this.findSectionHeadingByIndex( sectionIndex );\n\n\t\t// If section-heading is present on the heading,\n\t\t// then we know the page has been MobileFormatted\n\t\t// and that this is a wrapped section\n\t\tif ( $heading.hasClass( 'section-heading' ) ) {\n\t\t\t// get content of section\n\t\t\t$container = $heading.next();\n\t\t\t// inside section find the first heading\n\t\t\t$nextHeading = $container.find( headingSelector ).eq( 0 );\n\t\t\treturn $nextHeading.length ?\n\t\t\t\t// find all amboxes before the next heading\n\t\t\t\twithNestedChildren( $nextHeading.prevAll( selector ) ) :\n\t\t\t\t// There is no subheadings inside\n\t\t\t\t// Grab all issues in section\n\t\t\t\twithNestedChildren( $container.children( selector ) );\n\t\t} else {\n\t\t\t// the heading relates to a subsection (or unwrapped desktop section),\n\t\t\t// so grab elements between this and the next one\n\t\t\t$nextHeading = $heading.eq( 0 ).nextAll( headingSelector ).eq( 0 );\n\t\t\treturn $heading.nextUntil( $nextHeading, selector );\n\t\t}\n\t},\n\n\t/**\n\t * Get the lead section of the page view.\n\t * @memberof Page\n\t * @instance\n\t * @return {jQuery.Object|null}\n\t */\n\tgetLeadSectionElement: function () {\n\t\t/*\n\t\t * The page is formatted as follows:\n\t\t * <div id=\"bodyContent\">\n\t\t *   <!-- content of the page.. -->\n\t\t *   <div id=\"mw-content-text\">\n\t\t *     <div class=\"mf-section-0\">lead section</div>\n\t\t *     <h2></h2>\n\t\t *     <div class=\"mf-section-1\">second section</div>\n\t\t *   </div>\n\t\t * </div>\n\t\t */\n\t\tif ( this.$( '.mf-section-0' ).length ) {\n\t\t\treturn this.$( '.mf-section-0' );\n\t\t}\n\t\t// no lead section found\n\t\treturn null;\n\t},\n\n\t/**\n\t * Determines if content model is wikitext\n\t * @memberof Page\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisWikiText: function () {\n\t\treturn mw.config.get( 'wgPageContentModel' ) === 'wikitext';\n\t},\n\n\t/**\n\t * Checks whether the current page is the main page\n\t * @memberof Page\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisMainPage: function () {\n\t\treturn this.options.isMainPage;\n\t},\n\t/**\n\t * Checks whether the current page is watched\n\t * @memberof Page\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisWatched: function () {\n\t\treturn this.options.isWatched;\n\t},\n\n\t/**\n\t * Return the latest revision id for this page\n\t * @memberof Page\n\t * @instance\n\t * @return {number}\n\t */\n\tgetRevisionId: function () {\n\t\treturn this.options.revId;\n\t},\n\n\t/**\n\t * Return prefixed page title\n\t * @memberof Page\n\t * @instance\n\t * @return {string}\n\t */\n\tgetTitle: function () {\n\t\treturn this.options.title;\n\t},\n\n\t/**\n\t * Return page id\n\t * @memberof Page\n\t * @instance\n\t * @return {number}\n\t */\n\tgetId: function () {\n\t\treturn this.options.id;\n\t},\n\n\t/**\n\t * return namespace id\n\t * @memberof Page\n\t * @instance\n\t * @return {number} namespace Number\n\t */\n\tgetNamespaceId: function () {\n\t\tvar nsId,\n\t\t\targs = this.options.title.split( ':' );\n\n\t\tif ( args[1] ) {\n\t\t\tnsId = mw.config.get( 'wgNamespaceIds' )[ args[0].toLowerCase().replace( ' ', '_' ) ] || 0;\n\t\t} else {\n\t\t\tnsId = 0;\n\t\t}\n\t\treturn nsId;\n\t},\n\n\t/**\n\t * Determines if current page is a talk page\n\t * @memberof Page\n\t * @instance\n\t * @return {boolean} Whether the page is a talk page or not\n\t */\n\tisTalkPage: function () {\n\t\tvar ns = this.getNamespaceId();\n\t\t// all talk pages are odd Numbers (except the case of special pages)\n\t\treturn ns > 0 && ns % 2 === 1;\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Page\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tthis.sections = [];\n\t\tthis._sectionLookup = {};\n\t\tthis.title = this.options.title;\n\n\t\tthis.options.sections.forEach( function ( sectionData ) {\n\t\t\tvar section = new Section( sectionData );\n\t\t\tthis.sections.push( section );\n\t\t\tthis._sectionLookup[section.id] = section;\n\t\t}.bind( this ) );\n\t},\n\n\t/**\n\t * Return all the thumbnails in the article.\n\t * Images which have a class or link container (.image|.thumbimage)\n\t * that matches one of the items of the constant BLACKLISTED_THUMBNAIL_CLASS_SELECTORS\n\t * will be excluded.\n\t * A thumbnail nested inside one of these classes will still be returned.\n\t * e.g. `<div class=\"noviewer\"><a class=\"image\"><img></a></div>` is not a valid thumbnail\n\t * `<a class=\"image noviewer\"><img></a>` is not a valid thumbnail\n\t * `<a class=\"image\"><img class=\"noviewer\"></a>` is not a valid thumbnail\n\t * @memberof Page\n\t * @instance\n\t * @return {Thumbnail[]}\n\t */\n\tgetThumbnails: function () {\n\t\tvar $thumbs,\n\t\t\t$el = this.$el,\n\t\t\tblacklistSelector = '.' + BLACKLISTED_THUMBNAIL_CLASS_SELECTORS.join( ',.' ),\n\t\t\tthumbs = [];\n\n\t\tif ( !this._thumbs ) {\n\t\t\t$thumbs = $el.find( 'a.image, a.thumbimage' )\n\t\t\t\t.not( blacklistSelector );\n\n\t\t\t$thumbs.each( function () {\n\t\t\t\tvar $a = $el.find( this ),\n\t\t\t\t\t$lazyImage = $a.find( '.lazy-image-placeholder' ),\n\t\t\t\t\t// Parents need to be checked as well.\n\t\t\t\t\tvalid = $a.parents( blacklistSelector ).length === 0 &&\n\t\t\t\t\t\t$a.find( blacklistSelector ).length === 0,\n\t\t\t\t\tlegacyMatch = $a.attr( 'href' ).match( /title=([^/&]+)/ ),\n\t\t\t\t\tmatch = $a.attr( 'href' ).match( /[^/]+$/ );\n\n\t\t\t\t// filter out invalid lazy loaded images if so far image is valid\n\t\t\t\tif ( $lazyImage.length && valid ) {\n\t\t\t\t\t// if the regex matches it means the image has one of the classes\n\t\t\t\t\t// thus we must invert the result\n\t\t\t\t\tvalid = !new RegExp( '\\\\b(' + BLACKLISTED_THUMBNAIL_CLASS_SELECTORS.join( '|' ) + ')\\\\b' )\n\t\t\t\t\t\t.test( $lazyImage.data( 'class' ) );\n\t\t\t\t}\n\n\t\t\t\tif ( valid && ( legacyMatch || match ) ) {\n\t\t\t\t\tthumbs.push(\n\t\t\t\t\t\tnew Thumbnail( {\n\t\t\t\t\t\t\tel: $a,\n\t\t\t\t\t\t\tfilename: decodeURIComponent(\n\t\t\t\t\t\t\t\tlegacyMatch ? legacyMatch[1] : match[0]\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} );\n\t\t\tthis._thumbs = thumbs;\n\t\t}\n\t\treturn this._thumbs;\n\t},\n\n\t/**\n\t * FIXME: Change function signature to take the anchor of the heading\n\t * @memberof Page\n\t * @instance\n\t * @param {string} id of the section as defined by MobileFormatter.\n\t * Note, that currently, this is different from\n\t * the PHP parser in that it relates to top-level sections.\n\t * For example, mf-section-1 would relate to section 1. See FIXME.\n\t * @return {Section}\n\t */\n\tgetSection: function ( id ) {\n\t\treturn this._sectionLookup[ id ];\n\t},\n\n\t/**\n\t * Obtain the list of high level (and grouped) sections.\n\t * Note that this list will not include subsections.\n\t * @memberof Page\n\t * @instance\n\t * @return {Array} of Section instances\n\t */\n\tgetSections: function () {\n\t\treturn this.sections;\n\t},\n\n\t/**\n\t * Returns a jQuery object representing all redlinks on the page.\n\t * @memberof Page\n\t * @instance\n\t * @return {jQuery.Object}\n\t */\n\tgetRedLinks: function () {\n\t\treturn this.$( '.new' );\n\t}\n} );\n\n/**\n * Create a Page object from an API response.\n *\n * @memberof Page\n * @param {Object} resp as representing a page in the API\n * @return {Page}\n */\nPage.newFromJSON = function ( resp ) {\n\tvar revision, displayTitle,\n\t\tthumb = resp.thumbnail,\n\t\tpageprops = resp.pageprops || {\n\t\t\tdisplaytitle: HTML.escape( resp.title )\n\t\t},\n\t\tterms = resp.terms;\n\n\tif ( pageprops || terms ) {\n\t\t// The label is either the display title or the label pageprop\n\t\t// (the latter used by Wikidata)\n\t\t// Long term we want to consolidate these.\n\t\t// Note that pageprops.displaytitle is HTML, while\n\t\t// terms.label[0] is plain text.\n\t\tdisplayTitle = terms && terms.label ?\n\t\t\tHTML.escape( terms.label[0] ) : pageprops.displaytitle;\n\t}\n\t// Add Wikidata descriptions if available (T101719)\n\tresp.wikidataDescription = resp.description || undefined;\n\n\tif ( thumb ) {\n\t\tresp.thumbnail.isLandscape = thumb.width > thumb.height;\n\t}\n\n\t// page may or may not exist.\n\tif ( resp.revisions && resp.revisions[0] ) {\n\t\trevision = resp.revisions[0];\n\t\tresp.lastModified = time.getLastModifiedMessage(\n\t\t\tnew Date( revision.timestamp ).getTime() / 1000,\n\t\t\trevision.user\n\t\t);\n\t}\n\n\treturn new Page(\n\t\tutil.extend( resp, {\n\t\t\tid: resp.pageid,\n\t\t\tisMissing: !!resp.missing,\n\t\t\turl: mw.util.getUrl( resp.title ),\n\t\t\tdisplayTitle: displayTitle // this is HTML!\n\t\t} )\n\t);\n};\n\n/**\n * Selector for matching headings\n *\n * @memberof Page\n */\nPage.HEADING_SELECTOR = HEADING_SELECTOR;\n\nmodule.exports = Page;\n","var sectionTemplate = mw.template.get( 'mobile.startup', 'Section.hogan' ),\n\tutil = require( './util.js' ),\n\tactionParams = require( './actionParams' ),\n\tcache = {};\n\n/**\n * Add child to listOfSections if the level of child is the same as the last\n * child of listOfSections, otherwise add it to the children of the last\n * section of listOfSections. If listOfSections is empty, just add child to it.\n * @private\n * @param {Array} listOfSections - Array of section ids\n * @param {Object} child - Section to be added to listOfSections\n */\nfunction assignToParent( listOfSections, child ) {\n\tvar section;\n\tif ( listOfSections.length === 0 ) {\n\t\tlistOfSections.push( child );\n\t} else {\n\t\t// take a look at the last child\n\t\tsection = listOfSections[listOfSections.length - 1];\n\t\t// If the level is the same as another section in this list it is a sibling\n\t\tif ( parseInt( section.level, 10 ) === parseInt( child.level, 10 ) ) {\n\t\t\tlistOfSections.push( child );\n\t\t} else {\n\t\t\t// Otherwise take a look at that sections children recursively\n\t\t\tassignToParent( section.subsections, child );\n\t\t}\n\t}\n}\n\n/**\n * Order sections hierarchically\n * @private\n * @param {Array} sections Array of section objects created from response HTML\n * @return {Array} Ordered array of sections\n */\nfunction transformSections( sections ) {\n\tvar\n\t\tsectionLevels = sections.map( function ( s ) {\n\t\t\treturn s.level;\n\t\t} ),\n\t\texistingSectionLevels = sectionLevels.filter( function ( level ) {\n\t\t\treturn !!level;\n\t\t} ),\n\t\tcollapseLevel = Math.min.apply( this, existingSectionLevels ).toString(),\n\t\tlastSection,\n\t\tresult = [];\n\n\t// if the first section level is not equal to collapseLevel, this first\n\t// section will not have a parent and will be appended to the result.\n\tsections.forEach( function ( section ) {\n\t\tif ( section.line !== undefined ) {\n\t\t\tsection.line = section.line.replace( /<\\/?a\\b[^>]*>/g, '' );\n\t\t}\n\t\tsection.subsections = [];\n\n\t\tif (\n\t\t\t!lastSection ||\n\t\t\t(\n\t\t\t\t!section.level ||\n\t\t\t\tsection.level === collapseLevel\n\t\t\t) ||\n\t\t\t// make sure lastSections first child's level is bigger than section.level\n\t\t\t(\n\t\t\t\tlastSection.subsections.length &&\n\t\t\t\tlastSection.subsections[0].level > section.level\n\t\t\t) ||\n\t\t\t// also make sure section.level is not bigger than the lastSection.level\n\t\t\t(\n\t\t\t\tlastSection.level &&\n\t\t\t\tlastSection.level >= section.level\n\t\t\t)\n\t\t) {\n\t\t\tresult.push( section );\n\t\t\tlastSection = section;\n\t\t} else {\n\t\t\tassignToParent( lastSection.subsections, section );\n\t\t\tlastSection.text += sectionTemplate.render( section );\n\t\t}\n\t} );\n\n\treturn result;\n}\n\n/**\n * API for providing Page data\n * @class PageGateway\n * @param {mw.Api} api\n */\nfunction PageGateway( api ) {\n\tthis.api = api;\n}\n\nPageGateway.prototype = {\n\t/**\n\t * Retrieve a page from the api\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {string} title the title of the page to be retrieved\n\t * @param {string} endpoint an alternative api url to retrieve the page from\n\t * @param {boolean} leadOnly When set only the lead section content is returned\n\t * @return {jQuery.Deferred} with parameter page data that can be passed to a Page view\n\t */\n\tgetPage: function ( title, endpoint, leadOnly ) {\n\t\tvar timestamp,\n\t\t\td = util.Deferred(),\n\t\t\tparams = endpoint ? {\n\t\t\t\turl: endpoint,\n\t\t\t\tdataType: 'jsonp'\n\t\t\t} : {},\n\t\t\tprotection = {\n\t\t\t\tedit: [ '*' ]\n\t\t\t};\n\n\t\tutil.extend( params,\n\t\t\tactionParams( {\n\t\t\t\taction: 'mobileview',\n\t\t\t\tpage: title,\n\t\t\t\tvariant: mw.config.get( 'wgPageContentLanguage' ),\n\t\t\t\tredirect: 'yes',\n\t\t\t\tprop: 'id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision',\n\t\t\t\tnoheadings: 'yes',\n\t\t\t\tsectionprop: 'level|line|anchor',\n\t\t\t\tsections: leadOnly ? 0 : 'all'\n\t\t\t} )\n\t\t);\n\n\t\tif ( !cache[title] ) {\n\t\t\tcache[title] = this.api.get( params ).then( function ( resp ) {\n\t\t\t\tvar sections, lastModified, resolveObj, mv;\n\n\t\t\t\tif ( resp.error ) {\n\t\t\t\t\treturn d.reject( resp.error );\n\t\t\t\t} else if ( !resp.mobileview.sections ) {\n\t\t\t\t\treturn d.reject( 'No sections' );\n\t\t\t\t} else {\n\t\t\t\t\tmv = resp.mobileview;\n\t\t\t\t\tsections = transformSections( mv.sections );\n\t\t\t\t\t// Assume the timestamp is in the form TS_ISO_8601\n\t\t\t\t\t// and we don't care about old browsers\n\t\t\t\t\t// change to seconds to be consistent with PHP\n\t\t\t\t\ttimestamp = new Date( mv.lastmodified ).getTime() / 1000;\n\t\t\t\t\tlastModified = mv.lastmodifiedby;\n\n\t\t\t\t\t// FIXME: [API] the API sometimes returns an object and sometimes an array\n\t\t\t\t\t// There are various quirks with the format of protection level\n\t\t\t\t\t// as returned by api.\n\t\t\t\t\t// Also it is usually incomplete - if something is missing this means\n\t\t\t\t\t// that it has no protection level.\n\t\t\t\t\t// When an array this means there is no protection level set.\n\t\t\t\t\t// To keep the data type consistent either use the predefined\n\t\t\t\t\t// protection level,\n\t\t\t\t\t// or extend it with what is returned by API.\n\t\t\t\t\tprotection = Array.isArray( mv.protection ) ?\n\t\t\t\t\t\tprotection :\n\t\t\t\t\t\tutil.extend( protection, mv.protection );\n\n\t\t\t\t\tresolveObj = {\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\tid: mv.id,\n\t\t\t\t\t\trevId: mv.revId,\n\t\t\t\t\t\tprotection: protection,\n\t\t\t\t\t\tlead: sections[0].text,\n\t\t\t\t\t\tsections: sections.slice( 1 ),\n\t\t\t\t\t\tisMainPage: mv.mainpage !== undefined,\n\t\t\t\t\t\thistoryUrl: mw.util.getUrl( title, {\n\t\t\t\t\t\t\taction: 'history'\n\t\t\t\t\t\t} ),\n\t\t\t\t\t\tlastModifiedTimestamp: timestamp,\n\t\t\t\t\t\tlanguageCount: mv.languagecount,\n\t\t\t\t\t\thasVariants: mv.hasvariants !== undefined,\n\t\t\t\t\t\tdisplayTitle: mv.displaytitle\n\t\t\t\t\t};\n\t\t\t\t\t// Add non-anonymous user information\n\t\t\t\t\tif ( lastModified ) {\n\t\t\t\t\t\tutil.extend( resolveObj, {\n\t\t\t\t\t\t\tlastModifiedUserName: lastModified.name,\n\t\t\t\t\t\t\tlastModifiedUserGender: lastModified.gender\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\t// FIXME: Return a Page class here\n\t\t\t\t\treturn resolveObj;\n\t\t\t\t}\n\t\t\t}, function ( msg ) {\n\t\t\t\treturn d.reject( msg );\n\t\t\t} );\n\t\t}\n\n\t\treturn cache[title];\n\t},\n\n\t/**\n\t * Invalidate the internal cache for a given page\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {string} title the title of the page who's cache you want to invalidate\n\t */\n\tinvalidatePage: function ( title ) {\n\t\tdelete cache[title];\n\t},\n\n\t/**\n\t * Gets language variant list for a page; helper function for getPageLanguages()\n\t * @memberof PageGateway\n\t * @instance\n\t * @private\n\t * @param  {string} title Name of the page to obtain variants for\n\t * @param  {Object} data Data from API\n\t * @return {Array|boolean} List of language variant objects or false if no variants exist\n\t */\n\t_getLanguageVariantsFromApiResponse: function ( title, data ) {\n\t\tvar generalData = data.query.general,\n\t\t\tvariantPath = generalData.variantarticlepath,\n\t\t\tvariants = [];\n\n\t\tif ( !generalData.variants ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Create the data object for each variant and store it\n\t\tObject.keys( generalData.variants ).forEach( function ( index ) {\n\t\t\tvar item = generalData.variants[ index ],\n\t\t\t\tvariant = {\n\t\t\t\t\tautonym: item.name,\n\t\t\t\t\tlang: item.code\n\t\t\t\t};\n\n\t\t\tif ( variantPath ) {\n\t\t\t\tvariant.url = variantPath\n\t\t\t\t\t.replace( '$1', title )\n\t\t\t\t\t.replace( '$2', item.code );\n\t\t\t} else {\n\t\t\t\tvariant.url = mw.util.getUrl( title, {\n\t\t\t\t\tvariant: item.code\n\t\t\t\t} );\n\t\t\t}\n\t\t\tvariants.push( variant );\n\t\t} );\n\n\t\treturn variants;\n\t},\n\n\t/**\n\t * Retrieve available languages for a given title\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {string} title the title of the page languages should be retrieved for\n\t * @param {string} [language] when provided the names of the languages returned\n\t *  will be translated additionally into this language.\n\t * @return {jQuery.Deferred} which is called with an object containing langlinks\n\t * and variant links as defined @ https://en.m.wikipedia.org/w/api.php?action=help&modules=query%2Blanglinks\n\t */\n\tgetPageLanguages: function ( title, language ) {\n\t\tvar self = this,\n\t\t\targs = actionParams( {\n\t\t\t\tmeta: 'siteinfo',\n\t\t\t\tsiprop: 'general',\n\t\t\t\tprop: 'langlinks',\n\t\t\t\tlllimit: 'max',\n\t\t\t\ttitles: title\n\t\t\t} );\n\n\t\tif ( language ) {\n\t\t\targs.llprop = 'url|autonym|langname';\n\t\t\targs.llinlanguagecode = language;\n\t\t} else {\n\t\t\targs.llprop = 'url|autonym';\n\t\t}\n\t\treturn this.api.get( args ).then( function ( resp ) {\n\t\t\treturn {\n\t\t\t\tlanguages: resp.query.pages[0].langlinks || [],\n\t\t\t\tvariants: self._getLanguageVariantsFromApiResponse( title, resp )\n\t\t\t};\n\t\t}, function () {\n\t\t\treturn util.Deferred().reject();\n\t\t} );\n\t},\n\n\t/**\n\t * Extract sections from headings in $el\n\t * @memberof PageGateway\n\t * @instance\n\t * @private\n\t * @param {jQuery.Object} $el object from which sections are extracted\n\t * @return {Array} Array of section objects created from headings in $el\n\t * FIXME: Where's a better place for getSectionsFromHTML and this function to live?\n\t * Answer: Possibly Page.js\n\t */\n\t_getAPIResponseFromHTML: function ( $el ) {\n\t\t// FIXME: use Page.HEADING_SELECTOR\n\t\tvar $headings = $el.find( 'h1,h2,h3,h4,h5,h6' ),\n\t\t\tsections = [];\n\n\t\t$headings.each( function () {\n\t\t\tvar level = this.tagName.substr( 1 ),\n\t\t\t\t$span = $el.find( this ).find( '.mw-headline' );\n\n\t\t\tif ( $span.length ) {\n\t\t\t\tsections.push( {\n\t\t\t\t\tlevel: level,\n\t\t\t\t\tline: $span.html(),\n\t\t\t\t\tanchor: $span.attr( 'id' ) || '',\n\t\t\t\t\ttext: ''\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t\treturn sections;\n\t},\n\n\t/**\n\t * Order sections hierarchically\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {jQuery.Object} $el object from which sections are extracted\n\t * @return {Array} Ordered array of sections\n\t */\n\tgetSectionsFromHTML: function ( $el ) {\n\t\treturn transformSections( this._getAPIResponseFromHTML( $el ) );\n\t}\n};\n\nmodule.exports = PageGateway;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' ),\n\tbrowser = require( './Browser' ).getSingleton();\n\n/**\n * List of items page view\n * @class PageList\n * @extends View\n */\nfunction PageList() {\n\tView.apply( this, arguments );\n}\n\nmfExtend( PageList, View, {\n\t/**\n\t * @memberof PageList\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {Page[]} defaults.pages Array of Page objects. These should match\n\t *                              the Page model and not necessarily the\n\t *                              underlying API format used.\n\t * E.g. [\n\t *   {\n\t *     heading: \"<strong>C</strong>laude Monet\",\n\t *     id: undefined,\n\t *     title: \"Claude Monet\",\n\t *     displayTitle: \"<i>Claude Monet</i>\",\n\t *     url: \"/wiki/Claude_Monet\",\n\t *     thumbnail: {\n\t *       height: 62,\n\t *       source: \"http://127.0.0.1:8080/images/thumb/thumb.jpg\",\n\t *       width: 80,\n\t *       isLandscape: true\n\t *     }\n\t *   }\n\t * ]\n\t */\n\tdefaults: {\n\t\tpages: []\n\t},\n\t/**\n\t * Render page images for the existing page list. Assumes no page images have been loaded.\n\t * @memberof PageList\n\t * @instance\n\t */\n\trenderPageImages: function () {\n\t\tvar self = this;\n\n\t\tsetTimeout( function () {\n\t\t\tself.$( '.list-thumb' ).each( function () {\n\t\t\t\tvar style = self.$( this ).data( 'style' );\n\t\t\t\tself.$( this ).attr( 'style', style );\n\t\t\t} );\n\t\t\t// Delay an unnecessary load of images on mobile (slower?) connections\n\t\t\t// In particular on search results which can be regenerated quickly.\n\t\t}, browser.isWideScreen() ? 0 : 1000 );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof PageList\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.renderPageImages();\n\t},\n\ttemplate: mw.template.get( 'mobile.startup', 'PageList.hogan' ),\n\t/**\n\t * @memberof PageList\n\t * @instance\n\t */\n\ttemplatePartials: {\n\t\t// The server uses a very different structure in\n\t\t// SpecialMobileEditWatchlist.getLineHtml(). Be aware of these differences\n\t\t// when updating server rendered items.\n\t\titem: mw.template.get( 'mobile.startup', 'PageListItem.hogan' )\n\t}\n} );\n\nmodule.exports = PageList;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * An abstract class for a {@link View} that comprises a simple panel.\n * @class Panel\n * @extends View\n *\n * @param {Object} params Configuration options\n */\nfunction Panel( params ) {\n\tvar defaultParams = {\n\t\t\tclassName: 'panel'\n\t\t},\n\t\toptions = util.extend( {}, defaultParams, params );\n\n\tView.call( this, options );\n}\n\nmfExtend( Panel, View, {\n\t// in milliseconds\n\tminHideDelay: 10,\n\tevents: {\n\t\t'click .cancel': 'onCancel'\n\t},\n\n\t/**\n\t * Cancel event handler\n\t * @memberof Panel\n\t * @instance\n\t * @param {Object} ev Event Object\n\t */\n\tonCancel: function ( ev ) {\n\t\tev.preventDefault();\n\t\tthis.hide();\n\t},\n\n\t/**\n\t * Shows panel after a slight delay\n\t * @memberof Panel\n\t * @instance\n\t * @method\n\t */\n\tshow: function () {\n\t\tvar self = this;\n\n\t\tif ( !self.isVisible() ) {\n\t\t\t// use setTimeout to allow the browser to redraw if render() was called\n\t\t\t// just before show(); this is important for animations to work\n\t\t\t// (0ms doesn't work on Firefox, 10ms is enough)\n\t\t\t//\n\t\t\t// FIXME: setTimeout should be reconsidered in T209129\n\t\t\tsetTimeout( function () {\n\t\t\t\tself.$el.addClass( 'visible animated' );\n\t\t\t\tself.emit( 'show' );\n\t\t\t}, self.minHideDelay );\n\t\t}\n\t},\n\n\t/**\n\t * Hides panel\n\t * @memberof Panel\n\t * @instance\n\t */\n\thide: function () {\n\t\tvar self = this;\n\n\t\t// see comment in show()\n\t\tsetTimeout( function () {\n\t\t\tself.$el.removeClass( 'visible' );\n\t\t\tself.emit( 'hide' );\n\t\t}, self.minHideDelay );\n\t},\n\n\t/**\n\t * Determines if panel is visible\n\t * @memberof Panel\n\t * @instance\n\t * @return {boolean} Panel is visible\n\t */\n\tisVisible: function () {\n\t\treturn this.$el.hasClass( 'visible' );\n\t},\n\n\t/**\n\t * Shows or hides panel\n\t * @memberof Panel\n\t * @instance\n\t */\n\ttoggle: function () {\n\t\tif ( this.isVisible() ) {\n\t\t\tthis.hide();\n\t\t} else {\n\t\t\tthis.show();\n\t\t}\n\t}\n} );\n\nmodule.exports = Panel;\n","var util = require( './util' ),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * Class to assist a view in implementing infinite scrolling on some DOM\n * element. This module itself is only responsible for emitting an Event when\n * the bottom of an Element is scrolled to.\n *\n * @class ScrollEndEventEmitter\n * @mixins OO.EventEmitter\n *\n * Use this class in a view to help it do infinite scrolling.\n *\n * 1. Initialize it in the constructor `initialize` and listen to the\n *   EVENT_SCROLL_END event it emits (and call your loading function then)\n * 2. On preRender (once we have the DOM element) set it into the infinite\n *   scrolling object and disable it until we've loaded.\n * 3. Once you have loaded the list and put it in the DOM, enable the\n *   infinite scrolling detection.\n *   * Everytime the scroller detection triggers a load, it auto disables\n *     to not trigger multiple times. After you have loaded, manually\n *     re-enable it.\n *\n * Example:\n *     @example\n *     <code>\n *       var ScrollEndEventEmitter =\n *         require( 'mobile.startup/ScrollEndEventEmitter' ),\n *         eventBus = require( 'mobile.startup/eventBusSingleton' );\n *       OO.mfExtend( PhotoList, View, {\n *         //...\n *         initialize: function ( options ) {\n *           this.gateway = new PhotoListGateway( {\n *             username: options.username\n *           } );\n *           // 1. Set up infinite scroll helper and listen to events\n *           this.scrollEndEventEmitter = new ScrollEndEventEmitter( eventBus, 1000 );\n *           this.scrollEndEventEmitter.on( ScrollEndEventEmitter.EVENT_SCROLL_END,\n *             this._loadPhotos.bind( this ) );\n *           View.prototype.initialize.apply( this, arguments );\n *         },\n *         preRender: function () {\n *           // 2. Disable until we've got the list rendered and set DOM el\n *           this.scrollEndEventEmitter.setElement( this.$el );\n *           this.scrollEndEventEmitter.disable();\n *         },\n *         _loadPhotos: function () {\n *           var self = this;\n *           this.gateway.getPhotos().then( function ( photos ) {\n *             // load photos into the DOM ...\n *             // 3. and (re-)enable infinite scrolling\n *             self.scrollEndEventEmitter.enable();\n *           } );\n *         }\n *       } );\n *     </code>\n *\n * @fires ScrollEndEventEmitter#ScrollEndEventEmitter-scrollEnd\n * @param {Object} eventBus object to listen for scroll:throttled events\n * @param {number} [threshold=100] distance in pixels used to calculate if scroll\n * position is near the end of the $el\n */\nfunction ScrollEndEventEmitter( eventBus, threshold ) {\n\tthis.threshold = threshold || 100;\n\tthis.eventBus = eventBus;\n\tthis.enable();\n\tOO.EventEmitter.call( this );\n}\nOO.mixinClass( ScrollEndEventEmitter, OO.EventEmitter );\n\n/**\n * Fired when scroll bottom has been reached.\n * @event ScrollEndEventEmitter#ScrollEndEventEmitter-scrollEnd\n */\nScrollEndEventEmitter.EVENT_SCROLL_END = 'ScrollEndEventEmitter-scrollEnd';\n\nmfExtend( ScrollEndEventEmitter, {\n\t/**\n\t * Listen to scroll on window and notify this._onScroll\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t */\n\t_bindScroll: function () {\n\t\tif ( !this._scrollHandler ) {\n\t\t\tthis._scrollHandler = this._onScroll.bind( this );\n\t\t\tthis.eventBus.on( 'scroll:throttled', this._scrollHandler );\n\t\t}\n\t},\n\t/**\n\t * Unbind scroll handler\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t */\n\t_unbindScroll: function () {\n\t\tif ( this._scrollHandler ) {\n\t\t\tthis.eventBus.off( 'scroll:throttled', this._scrollHandler );\n\t\t\tthis._scrollHandler = null;\n\t\t}\n\t},\n\t/**\n\t * Scroll handler. Triggers load event when near the end of the container.\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t */\n\t_onScroll: function () {\n\t\tif ( this.$el && this.enabled && this.scrollNearEnd() ) {\n\t\t\t// Disable when triggering an event. Won't trigger again until\n\t\t\t// re-enabled.\n\t\t\tthis.disable();\n\t\t\tthis.emit( ScrollEndEventEmitter.EVENT_SCROLL_END );\n\t\t}\n\t},\n\t/**\n\t * Is the scroll position near the end of the container element?\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t * @return {boolean}\n\t */\n\tscrollNearEnd: function () {\n\t\tvar $window = util.getWindow(),\n\t\t\tscrollBottom = $window.scrollTop() + $window.height(),\n\t\t\tendPosition = this.$el.offset().top + this.$el.outerHeight();\n\t\treturn scrollBottom + this.threshold > endPosition;\n\t},\n\t/**\n\t * Enable the ScrollEndEventEmitter so that it triggers events.\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t */\n\tenable: function () {\n\t\tthis.enabled = true;\n\t\tthis._bindScroll();\n\t},\n\t/**\n\t * Disable the ScrollEndEventEmitter so that it doesn't trigger events.\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t */\n\tdisable: function () {\n\t\tthis.enabled = false;\n\t\tthis._unbindScroll();\n\t},\n\t/**\n\t * Set the element to compare to scroll position to\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @param {jQuery.Object} $el jQuery element where we want to listen for\n\t * scroll end.\n\t */\n\tsetElement: function ( $el ) {\n\t\tthis.$el = $el;\n\t}\n} );\n\nmodule.exports = ScrollEndEventEmitter;\n","var\n\tmfExtend = require( './mfExtend' ),\n\ticons = require( './icons' ),\n\tView = require( './View' );\n\n/**\n * Builds a section of a page\n * @class Section\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Section( options ) {\n\tvar self = this;\n\toptions.tag = 'h' + options.level;\n\tthis.line = options.line;\n\tthis.text = options.text;\n\tthis.hasReferences = options.hasReferences || false;\n\tthis.id = options.id || null;\n\tthis.anchor = options.anchor;\n\tthis.subsections = [];\n\t( options.subsections || [] ).forEach( function ( section ) {\n\t\tself.subsections.push( new Section( section ) );\n\t} );\n\tView.call( this, options );\n}\n\nmfExtend( Section, View, {\n\ttemplate: mw.template.get( 'mobile.startup', 'Section.hogan' ),\n\t/**\n\t * @memberof Section\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.text Section text.\n\t * @property {string} defaults.spinner HTML of the spinner icon.\n\t */\n\tdefaults: {\n\t\tline: undefined,\n\t\ttext: '',\n\t\tspinner: icons.spinner().toHtmlString()\n\t}\n} );\n\nmodule.exports = Section;\n","var\n\tbrowser = require( './Browser' ).getSingleton(),\n\tlazyImageLoader = require( './lazyImages/lazyImageLoader' ),\n\tView = require( './View' ),\n\tutil = require( './util' ),\n\tPage = require( './Page' ),\n\tDeferred = util.Deferred,\n\ticons = require( './icons' ),\n\tviewport = mw.viewport,\n\tspinner = icons.spinner(),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * Get the id of the section $el belongs to.\n * @param {jQuery.Object} $el\n * @return {string|null} either the anchor (id attribute of the section heading\n *  or null if none found)\n */\nfunction getSectionId( $el ) {\n\tvar id,\n\t\thSelector = Page.HEADING_SELECTOR,\n\t\t$parent = $el.parent(),\n\t\t// e.g. matches Subheading in\n\t\t// <h2>H</h2><div><h3 id=\"subheading\">Subh</h3><a class=\"element\"></a></div>\n\t\t$heading = $el.prevAll( hSelector ).eq( 0 );\n\n\tif ( $heading.length ) {\n\t\tid = $heading.find( '.mw-headline' ).attr( 'id' );\n\t\tif ( id ) {\n\t\t\treturn id;\n\t\t}\n\t}\n\tif ( $parent.length ) {\n\t\t// if we couldnt find a sibling heading, check the sibling of the parents\n\t\t// consider <div><h2 /><div><$el/></div></div>\n\t\treturn getSectionId( $parent );\n\t} else {\n\t\treturn null;\n\t}\n}\n\n/**\n * Representation of the current skin being rendered.\n *\n * @class Skin\n * @extends View\n * @uses Browser\n * @uses Page\n * @fires Skin#click\n * @fires Skin#references-loaded\n * @fires Skin#changed\n * @param {Object} params Configuration options\n * @param {OO.EventEmitter} params.eventBus Object used to listen for\n * before-section-toggled, scroll:throttled, resize:throttled, and\n * section-toggled events\n */\nfunction Skin( params ) {\n\tvar self = this,\n\t\toptions = util.extend( {}, params );\n\n\tthis.page = options.page;\n\tthis.name = options.name;\n\tif ( options.mainMenu ) {\n\t\tthis.mainMenu = options.mainMenu;\n\t\tmw.log.warn( 'Skin: Use of mainMenu is deprecated.' );\n\t}\n\tthis.eventBus = options.eventBus;\n\toptions.isBorderBox = false;\n\tView.call( this, options );\n\tthis.referencesGateway = options.referencesGateway;\n\n\tif (\n\t\tmw.config.get( 'wgMFLazyLoadImages' )\n\t) {\n\t\tutil.docReady( function () {\n\t\t\tself.setupImageLoading();\n\t\t} );\n\t}\n\n\tif ( mw.config.get( 'wgMFLazyLoadReferences' ) ) {\n\t\tthis.eventBus.on( 'before-section-toggled', this.lazyLoadReferences.bind( this ) );\n\t}\n}\n\nmfExtend( Skin, View, {\n\t/**\n\t * @memberof Skin\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {Page} defaults.page page the skin is currently rendering\n\t * @property {ReferencesGateway} defaults.referencesGateway instance of references gateway\n\t */\n\tdefaults: {\n\t\tpage: undefined\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Skin\n\t * @instance\n\t */\n\tevents: {},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Skin\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar $el = this.$el;\n\t\tif ( browser.supportsAnimations() ) {\n\t\t\t$el.addClass( 'animations' );\n\t\t}\n\t\tif ( browser.supportsTouchEvents() ) {\n\t\t\t$el.addClass( 'touch-events' );\n\t\t}\n\t\tutil.parseHTML( '<div class=\"transparent-shield cloaked-element\">' )\n\t\t\t.appendTo( $el.find( '#mw-mf-page-center' ) );\n\t\t/**\n\t\t * Fired when appearance of skin changes.\n\t\t * @event Skin#changed\n\t\t */\n\t\tthis.emit( 'changed' );\n\n\t\t/**\n\t\t * Fired when the skin is clicked.\n\t\t * @event Skin#click\n\t\t */\n\t\tthis.$( '#mw-mf-page-center' ).on( 'click', this.emit.bind( this, 'click' ) );\n\t},\n\t/**\n\t * Get images that have not yet been loaded in the page\n\t * @memberof Skin\n\t * @instance\n\t * @param {jQuery.Object} [$container] The container that should be\n\t *  searched for image placeholders. Defaults to \"#content\".\n\t * @return {Array} of unloaded image placeholders in the page\n\t */\n\tgetUnloadedImages: function ( $container ) {\n\t\t$container = $container || this.$( '#content' );\n\t\treturn $container.find( '.lazy-image-placeholder' ).toArray();\n\t},\n\t/**\n\t * Setup listeners to watch unloaded images and load them into the page\n\t * as and when they are needed.\n\t * @memberof Skin\n\t * @instance\n\t * @param {jQuery.Object} [$container] The container that should be\n\t *  searched for image placeholders. Defaults to \"#content\".\n\t * @return {jQuery.Deferred} which will be resolved when the attempts to\n\t *  load all images subject to loading have been completed.\n\t */\n\tsetupImageLoading: function ( $container ) {\n\t\tvar self = this,\n\t\t\toffset = util.getWindow().height() * 1.5,\n\t\t\timagePlaceholders = this.getUnloadedImages( $container );\n\n\t\t/**\n\t\t * Check whether an image should be loaded based on its proximity to the\n\t\t * viewport; and whether it is displayed to the user.\n\t\t * @param {jQuery.Object} $placeholder\n\t\t * @return {boolean}\n\t\t */\n\t\tfunction shouldLoadImage( $placeholder ) {\n\t\t\treturn viewport.isElementCloseToViewport( $placeholder[0], offset ) &&\n\t\t\t\t// If a placeholder is an inline element without a height attribute set\n\t\t\t\t// it will record as hidden\n\t\t\t\t// to circumvent this we also need to test the height (see T143768).\n\t\t\t\t( $placeholder.is( ':visible' ) || $placeholder.height() === 0 );\n\t\t}\n\n\t\t/**\n\t\t * Load remaining images in viewport\n\t\t * @return {jQuery.Deferred}\n\t\t */\n\t\tfunction _loadImages() {\n\t\t\tvar images = [];\n\t\t\t// Filter unloaded images to only the images that still need to be loaded\n\t\t\timagePlaceholders = util.grep( imagePlaceholders, function ( placeholder ) {\n\t\t\t\tvar $placeholder = self.$( placeholder );\n\t\t\t\t// Check length to ensure the image is still in the DOM.\n\t\t\t\tif ( $placeholder.length && shouldLoadImage( $placeholder ) ) {\n\t\t\t\t\timages.push( placeholder );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t} );\n\n\t\t\t// When no images are left unbind all events\n\t\t\tif ( !imagePlaceholders.length ) {\n\t\t\t\tself.eventBus.off( 'scroll:throttled', _loadImages );\n\t\t\t\tself.eventBus.off( 'resize:throttled', _loadImages );\n\t\t\t\tself.eventBus.off( 'section-toggled', _loadImages );\n\t\t\t\tself.off( 'changed', _loadImages );\n\t\t\t}\n\n\t\t\t// load any remaining images.\n\t\t\treturn lazyImageLoader.loadImages( self.$.bind( self ), images );\n\t\t}\n\n\t\tthis.eventBus.on( 'scroll:throttled', _loadImages );\n\t\tthis.eventBus.on( 'resize:throttled', _loadImages );\n\t\tthis.eventBus.on( 'section-toggled', _loadImages );\n\t\tthis.on( 'changed', _loadImages );\n\n\t\treturn _loadImages();\n\t},\n\t/**\n\t * @deprecated\n\t * Load an image on demand\n\t * @memberof Skin\n\t * @instance\n\t * @param {Array} [images] a list of images that have not been loaded.\n\t *  If none given all will be loaded.\n\t * @return {jQuery.Deferred}\n\t */\n\tloadImagesList: function ( images ) {\n\t\treturn lazyImageLoader.loadImages(\n\t\t\tthis.$.bind( this ), images || this.getUnloadedImages()\n\t\t);\n\t},\n\n\t/**\n\t * Load the references section content from API if it's not already loaded.\n\t *\n\t * All references tags content will be loaded per section.\n\t * @memberof Skin\n\t * @instance\n\t * @param {Object} data Information about the section. It's in the following form:\n\t * {\n\t *     @property {string} page,\n\t *     @property {boolean} wasExpanded,\n\t *     @property {jQuery.Object} $heading,\n\t *     @property {boolean} isReferenceSection\n\t * }\n\t * @return {jQuery.Promise} rejected when not a reference section.\n\t */\n\tlazyLoadReferences: function ( data ) {\n\t\tvar $content, $spinner,\n\t\t\tgateway = this.referencesGateway,\n\t\t\tgetUnloadedImages = this.getUnloadedImages.bind( this ),\n\t\t\tself = this;\n\n\t\t// If the section was expanded before toggling, do not load anything as\n\t\t// section is being collapsed now.\n\t\t// Also return early if lazy loading is not required or the section is\n\t\t// not a reference section\n\t\tif (\n\t\t\tdata.wasExpanded ||\n\t\t\t!data.isReferenceSection\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content = data.$heading.next();\n\n\t\tfunction loadImagesAndSetData() {\n\t\t\t// lazy load images if any\n\t\t\tlazyImageLoader.loadImages( self.$.bind( self ), getUnloadedImages( $content ) );\n\t\t\t// Do not attempt further loading even if we're unable to load this time.\n\t\t\t$content.data( 'are-references-loaded', 1 );\n\t\t}\n\n\t\tif ( !$content.data( 'are-references-loaded' ) ) {\n\t\t\t$content.children().addClass( 'hidden' );\n\t\t\t$spinner = spinner.$el.prependTo( $content );\n\n\t\t\t// First ensure we retrieve all of the possible lists\n\t\t\treturn gateway.getReferencesLists( data.page )\n\t\t\t\t.then( function () {\n\t\t\t\t\tvar lastId;\n\n\t\t\t\t\t$content.find( '.mf-lazy-references-placeholder' ).each( function () {\n\t\t\t\t\t\tvar refListIndex = 0,\n\t\t\t\t\t\t\t$placeholder = $content.find( this ),\n\t\t\t\t\t\t\t// search for id of the collapsible heading\n\t\t\t\t\t\t\tid = getSectionId( $placeholder );\n\n\t\t\t\t\t\tif ( lastId !== id ) {\n\t\t\t\t\t\t\t// If the placeholder belongs to a new section reset index\n\t\t\t\t\t\t\trefListIndex = 0;\n\t\t\t\t\t\t\tlastId = id;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// otherwise increment it\n\t\t\t\t\t\t\trefListIndex++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( id ) {\n\t\t\t\t\t\t\tgateway.getReferencesList( data.page, id )\n\t\t\t\t\t\t\t\t.then( function ( refListElements ) {\n\t\t\t\t\t\t\t\t\t// Note if no section html is provided\n\t\t\t\t\t\t\t\t\t// no substitution will happen\n\t\t\t\t\t\t\t\t\t// so user is forced to rely on placeholder link.\n\t\t\t\t\t\t\t\t\tif ( refListElements && refListElements[refListIndex] ) {\n\t\t\t\t\t\t\t\t\t\t$placeholder.replaceWith(\n\t\t\t\t\t\t\t\t\t\t\trefListElements[refListIndex]\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t\t// Show the section now the references lists have been placed.\n\t\t\t\t\t$spinner.remove();\n\t\t\t\t\t$content.children().removeClass( 'hidden' );\n\t\t\t\t\t/**\n\t\t\t\t\t * Fired when references list is loaded into the HTML\n\t\t\t\t\t * @event references-loaded\n\t\t\t\t\t */\n\t\t\t\t\tself.emit( 'references-loaded', self.page );\n\n\t\t\t\t\tloadImagesAndSetData();\n\t\t\t\t}, function () {\n\t\t\t\t\t$spinner.remove();\n\t\t\t\t\t// unhide on a failure\n\t\t\t\t\t$content.children().removeClass( 'hidden' );\n\n\t\t\t\t\tloadImagesAndSetData();\n\t\t\t\t} );\n\t\t} else {\n\t\t\treturn Deferred().reject().promise();\n\t\t}\n\t},\n\n\t/**\n\t * Returns the appropriate license message including links/name to\n\t * terms of use (if any) and license page\n\t * @memberof Skin\n\t * @instance\n\t * @return {string}\n\t */\n\tgetLicenseMsg: function () {\n\t\tvar licenseMsg,\n\t\t\tmfLicense = mw.config.get( 'wgMFLicense' ),\n\t\t\tlicensePlural = mw.language.convertNumber( mfLicense.plural );\n\n\t\tif ( mfLicense.link ) {\n\t\t\tif ( this.$( '#footer-places-terms-use' ).length > 0 ) {\n\t\t\t\tlicenseMsg = mw.msg(\n\t\t\t\t\t'mobile-frontend-editor-licensing-with-terms',\n\t\t\t\t\tmw.message(\n\t\t\t\t\t\t'mobile-frontend-editor-terms-link',\n\t\t\t\t\t\tthis.$( '#footer-places-terms-use a' ).attr( 'href' )\n\t\t\t\t\t).parse(),\n\t\t\t\t\tmfLicense.link,\n\t\t\t\t\tlicensePlural\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tlicenseMsg = mw.msg(\n\t\t\t\t\t'mobile-frontend-editor-licensing',\n\t\t\t\t\tmfLicense.link,\n\t\t\t\t\tlicensePlural\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn licenseMsg;\n\t}\n} );\n\nSkin.getSectionId = getSectionId;\n\nmodule.exports = Skin;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * Representation of a thumbnail\n *\n * @class Thumbnail\n * @extends View\n * @param {Object} options\n */\nfunction Thumbnail( options ) {\n\tView.call( this,\n\t\tutil.extend( { isBorderBox: false }, options )\n\t);\n}\n\nmfExtend( Thumbnail, View, {\n\t/**\n\t * @memberof Thumbnail\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.filename uri decoded filename including File: prefix\n\t *  associated with thumbnail\n\t */\n\tdefaults: {\n\t\tfilename: undefined\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Thumbnail\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.options.description = this.$el.siblings( '.thumbcaption' ).text();\n\t},\n\t/**\n\t * Obtain description for thumbnail\n\t * @memberof Thumbnail\n\t * @instance\n\t * @return {string}\n\t */\n\tgetDescription: function () {\n\t\treturn this.options.description;\n\t},\n\t/**\n\t * Return the page title for the thumbnail\n\t * @memberof Thumbnail\n\t * @instance\n\t * @return {string}\n\t */\n\tgetFileName: function () {\n\t\treturn this.options.filename;\n\t}\n} );\n\nmodule.exports = Thumbnail;\n","var browser = require( './Browser' ).getSingleton(),\n\tutil = require( './util' ),\n\tescapeHash = util.escapeHash,\n\tarrowOptions = {\n\t\tname: 'arrow',\n\t\tadditionalClassNames: 'indicator'\n\t},\n\tIcon = require( './Icon' );\n\n/**\n * A class for enabling toggling\n *\n * @class Toggler\n * @param {Object} options\n * @param {OO.EventEmitter} options.eventBus Object used to emit before-section-toggled\n * and section-toggled events\n * @param {jQuery.Object} options.$container to apply toggling to\n * @param {string} options.prefix a prefix to use for the id.\n * @param {Page} [options.page] to allow storage of session for future visits\n * @param {Page} [options.isClosed] whether the element should begin closed\n * and section-toggled events\n */\nfunction Toggler( options ) {\n\tthis.eventBus = options.eventBus;\n\tthis._enable( options.$container, options.prefix, options.page, options.isClosed );\n}\n\n/**\n * Using the settings module looks at what sections were previously expanded on\n * existing page.\n *\n * @param {Page} page\n * @return {Object} representing open sections\n */\nfunction getExpandedSections( page ) {\n\tvar expandedSections = JSON.parse(\n\t\tmw.storage.get( 'expandedSections' ) || '{}'\n\t);\n\texpandedSections[page.title] = expandedSections[page.title] || {};\n\treturn expandedSections;\n}\n\n/**\n* @param {Object} expandedSections\n* Save expandedSections to localStorage\n*/\nfunction saveExpandedSections( expandedSections ) {\n\tmw.storage.set(\n\t\t'expandedSections', JSON.stringify( expandedSections )\n\t);\n}\n\n/**\n * Given an expanded heading, store it to localStorage.\n * If the heading is collapsed, remove it from localStorage.\n *\n * @param {jQuery.Object} $heading - A heading belonging to a section\n * @param {Page} page\n */\nfunction storeSectionToggleState( $heading, page ) {\n\tvar headline = $heading.find( 'span' ).attr( 'id' ),\n\t\tisSectionOpen = $heading.hasClass( 'open-block' ),\n\t\texpandedSections = getExpandedSections( page );\n\n\tif ( headline ) {\n\t\tif ( isSectionOpen ) {\n\t\t\texpandedSections[page.title][headline] = ( new Date() ).getTime();\n\t\t} else {\n\t\t\tdelete expandedSections[page.title][headline];\n\t\t}\n\n\t\tsaveExpandedSections( expandedSections );\n\t}\n}\n\n/**\n * Expand sections that were previously expanded before leaving this page.\n * @param {Toggler} toggler\n * @param {jQuery.Object} $container\n * @param {Page} page\n */\nfunction expandStoredSections( toggler, $container, page ) {\n\tvar $sectionHeading, $headline,\n\t\texpandedSections = getExpandedSections( page ),\n\t\t$headlines = $container.find( '.section-heading span' );\n\n\t$headlines.each( function () {\n\t\t$headline = $container.find( this );\n\t\t$sectionHeading = $headline.parents( '.section-heading' );\n\t\t// toggle only if the section is not already expanded\n\t\tif (\n\t\t\texpandedSections[page.title][$headline.attr( 'id' )] &&\n\t\t!$sectionHeading.hasClass( 'open-block' )\n\t\t) {\n\t\t\ttoggler.toggle( $sectionHeading, page );\n\t\t}\n\t} );\n}\n\n/**\n * Clean obsolete (saved more than a day ago) expanded sections from\n * localStorage.\n * @param {Page} page\n */\nfunction cleanObsoleteStoredSections( page ) {\n\tvar now = ( new Date() ).getTime(),\n\t\texpandedSections = getExpandedSections( page ),\n\t\t// the number of days between now and the time a setting was saved\n\t\tdaysDifference;\n\tObject.keys( expandedSections ).forEach( function ( page ) {\n\t\tvar sections = expandedSections[ page ];\n\t\t// clean the setting if it is more than a day old\n\t\tObject.keys( sections ).forEach( function ( section ) {\n\t\t\tvar timestamp = sections[ section ];\n\t\t\tdaysDifference = Math.floor( ( now - timestamp ) / 1000 / 60 / 60 / 24 );\n\t\t\tif ( daysDifference >= 1 ) {\n\t\t\t\tdelete expandedSections[page][section];\n\t\t\t}\n\t\t} );\n\t} );\n\tsaveExpandedSections( expandedSections );\n}\n\n/**\n * Given a heading, toggle it and any of its children\n *\n * @memberof Toggler\n * @instance\n * @param {jQuery.Object} $heading A heading belonging to a section\n */\nToggler.prototype.toggle = function ( $heading ) {\n\tvar indicator,\n\t\twasExpanded = $heading.is( '.open-block' ),\n\t\tpage = $heading.data( 'page' ),\n\t\tsectionNumber = $heading.data( 'section-number' ),\n\t\t$content = $heading.next();\n\n\t$heading.toggleClass( 'open-block' );\n\t$heading.data( 'indicator' ).remove();\n\n\tarrowOptions.rotation = wasExpanded ? 0 : 180;\n\tindicator = new Icon( arrowOptions ).prependTo( $heading );\n\t$heading.data( 'indicator', indicator );\n\n\t/**\n\t * Global event emitted before a section is being toggled\n\t *\n\t * @event section-toggling\n\t * @type {Object}\n\t * @property {Page} page\n\t * @property {bool} wasExpanded\n\t * @property {bool} isReferenceSection\n\t * @property {jQuery.Object} $heading\n\t */\n\tthis.eventBus.emit( 'before-section-toggled', {\n\t\tpage: page,\n\t\twasExpanded: wasExpanded,\n\t\t$heading: $heading,\n\t\tisReferenceSection: Boolean( $content.attr( 'data-is-reference-section' ) )\n\t} );\n\n\t$content\n\t\t.toggleClass( 'open-block' )\n\t\t.attr( {\n\t\t\t'aria-pressed': !wasExpanded,\n\t\t\t'aria-expanded': !wasExpanded\n\t\t} );\n\n\t/**\n\t * Global event emitted after a section has been toggled\n\t * @event section-toggled\n\t * @type {Object}\n\t * @property {bool} wasExpanded\n\t * @property {number} sectionNumber\n\t */\n\tthis.eventBus.emit( 'section-toggled', wasExpanded, sectionNumber );\n\n\tif ( !browser.isWideScreen() ) {\n\t\tstoreSectionToggleState( $heading, page );\n\t}\n};\n\n/**\n * Enables toggling via enter and space keys\n *\n * @param {Toggler} toggler instance.\n * @param {jQuery.Object} $heading\n */\nfunction enableKeyboardActions( toggler, $heading ) {\n\t$heading.on( 'keypress', function ( ev ) {\n\t\tif ( ev.which === 13 || ev.which === 32 ) {\n\t\t\t// Only handle keypresses on the \"Enter\" or \"Space\" keys\n\t\t\ttoggler.toggle( $heading );\n\t\t}\n\t} ).find( 'a' ).on( 'keypress mouseup', function ( ev ) {\n\t\tev.stopPropagation();\n\t} );\n}\n\n/**\n * Reveals an element and its parent section as identified by it's id\n *\n * @memberof Toggler\n * @instance\n * @param {string} selector A css selector that identifies a single element\n * @param {Object} $container jQuery element to search in\n */\nToggler.prototype.reveal = function ( selector, $container ) {\n\tvar $target, $heading;\n\n\t// jQuery will throw for hashes containing certain characters which can break toggling\n\ttry {\n\t\t$target = $container.find( escapeHash( selector ) );\n\t\t$heading = $target.parents( '.collapsible-heading' );\n\t\t// The heading is not a section heading, check if in a content block!\n\t\tif ( !$heading.length ) {\n\t\t\t$heading = $target.parents( '.collapsible-block' ).prev( '.collapsible-heading' );\n\t\t}\n\t\tif ( $heading.length && !$heading.hasClass( 'open-block' ) ) {\n\t\t\tthis.toggle( $heading );\n\t\t}\n\t\tif ( $heading.length ) {\n\t\t\t// scroll again after opening section (opening section makes the page longer)\n\t\t\twindow.scrollTo( 0, $target.offset().top );\n\t\t}\n\t} catch ( e ) {}\n};\n\n/**\n * Enables section toggling in a given container when wgMFCollapseSectionsByDefault\n * is enabled.\n *\n * @memberof Toggler\n * @instance\n * @param {jQuery.Object} $container to apply toggling to\n * @param {string} prefix a prefix to use for the id.\n * @param {Page} [page] to allow storage of session for future visits\n * @param {Page} [isClosed] whether the element should begin closed\n * @private\n */\nToggler.prototype._enable = function ( $container, prefix, page, isClosed ) {\n\tvar tagName, expandSections, indicator, $content,\n\t\t$firstHeading,\n\t\t$link,\n\t\tself = this,\n\t\tcollapseSectionsByDefault = mw.config.get( 'wgMFCollapseSectionsByDefault' );\n\n\t// Also allow .section-heading if some extensions like Wikibase\n\t// want to toggle other headlines than direct descendants of $container.\n\t$firstHeading = $container.find( '> h1,> h2,> h3,> h4,> h5,> h6,.section-heading' ).eq( 0 );\n\ttagName = $firstHeading.prop( 'tagName' ) || 'H1';\n\n\tif ( collapseSectionsByDefault === undefined ) {\n\t\t// Old default behavior if on cached output\n\t\tcollapseSectionsByDefault = true;\n\t}\n\texpandSections = !collapseSectionsByDefault ||\n\t( mw.config.get( 'wgMFExpandAllSectionsUserOption' ) && mw.storage.get( 'expandSections' ) === 'true' );\n\n\t$container.children( tagName ).each( function ( i ) {\n\t\tvar isReferenceSection,\n\t\t\t$heading = $container.find( this ),\n\t\t\t$indicator = $heading.find( '.indicator' ),\n\t\t\tid = prefix + 'collapsible-block-' + i;\n\t\t// Be sure there is a div wrapping the section content.\n\t\t// Otherwise, collapsible sections for this page is not enabled.\n\t\tif ( $heading.next().is( 'div' ) ) {\n\t\t\t$content = $heading.next( 'div' );\n\t\t\tisReferenceSection = Boolean( $content.attr( 'data-is-reference-section' ) );\n\t\t\t$heading\n\t\t\t\t.addClass( 'collapsible-heading ' )\n\t\t\t\t.data( 'section-number', i )\n\t\t\t\t.data( 'page', page )\n\t\t\t\t.attr( {\n\t\t\t\t\ttabindex: 0,\n\t\t\t\t\t'aria-haspopup': 'true',\n\t\t\t\t\t'aria-controls': id\n\t\t\t\t} )\n\t\t\t\t.on( 'click', function ( ev ) {\n\t\t\t\t\t// don't toggle, if the click target was a link\n\t\t\t\t\t// (a link in a section heading)\n\t\t\t\t\t// See T117880\n\t\t\t\t\tif ( !ev.target.href ) {\n\t\t\t\t\t\t// prevent taps/clicks on edit button after toggling (bug 56209)\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\tself.toggle( $heading );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\tarrowOptions.rotation = expandSections ? 180 : 0;\n\t\t\tindicator = new Icon( arrowOptions );\n\t\t\tif ( $indicator.length ) {\n\t\t\t\t// replace the existing indicator\n\t\t\t\t$indicator.replaceWith( indicator.$el );\n\t\t\t} else {\n\t\t\t\tindicator.prependTo( $heading );\n\t\t\t}\n\t\t\t$heading.data( 'indicator', indicator.$el );\n\t\t\t$content\n\t\t\t\t.addClass( 'collapsible-block' )\n\t\t\t\t.eq( 0 )\n\t\t\t\t.attr( {\n\t\t\t\t\t// We need to give each content block a unique id as that's\n\t\t\t\t\t// the only way we can tell screen readers what element we're\n\t\t\t\t\t// referring to (aria-controls)\n\t\t\t\t\tid: id,\n\t\t\t\t\t'aria-pressed': 'false',\n\t\t\t\t\t'aria-expanded': 'false'\n\t\t\t\t} );\n\n\t\t\tenableKeyboardActions( self, $heading );\n\t\t\tif (\n\t\t\t\t!isReferenceSection && (\n\t\t\t\t\t!isClosed && browser.isWideScreen() || expandSections\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// Expand sections by default on wide screen devices\n\t\t\t\t// or if the expand sections setting is set.\n\t\t\t\t// The wide screen logic for determining whether to collapse sections initially\n\t\t\t\t// should be kept in sync with mobileoptions#initLocalStorageElements().\n\t\t\t\tself.toggle( $heading );\n\t\t\t}\n\t\t}\n\t} );\n\n\t/* eslint-disable no-restricted-properties */\n\t/**\n\t * Checks the existing hash and toggles open any section that contains the fragment.\n\t *\n\t * @method\n\t */\n\tfunction checkHash() {\n\t\tvar hash = window.location.hash;\n\t\tif ( hash.indexOf( '#' ) === 0 ) {\n\t\t\tself.reveal( hash, $container );\n\t\t}\n\t}\n\n\t/**\n\t * Checks the value of wgInternalRedirectTargetUrl and reveals the collapsed\n\t * section that contains it if present\n\t *\n\t * @method\n\t */\n\tfunction checkInternalRedirectAndHash() {\n\t\tvar internalRedirect = mw.config.get( 'wgInternalRedirectTargetUrl' ),\n\t\t\tinternalRedirectHash = internalRedirect ? internalRedirect.split( '#' )[1] : false;\n\n\t\tif ( internalRedirectHash ) {\n\t\t\twindow.location.hash = internalRedirectHash;\n\t\t\tself.reveal( internalRedirectHash, $container );\n\t\t}\n\t}\n\t/* eslint-enable no-restricted-properties */\n\n\tcheckInternalRedirectAndHash();\n\tcheckHash();\n\t// Restricted to links created by editors and thus outside our control\n\t// T166544 - don't do this for reference links - they will be handled elsewhere\n\t$link = $container.find( 'a:not(.reference a)' );\n\t$link.on( 'click', function () {\n\t\t// the link might be an internal link with a hash.\n\t\t// if it is check if we need to reveal any sections.\n\t\tif ( $link.attr( 'href' ) !== undefined &&\n\t\t$link.attr( 'href' ).indexOf( '#' ) > -1\n\t\t) {\n\t\t\tcheckHash();\n\t\t}\n\t} );\n\tutil.getWindow().on( 'hashchange', function () {\n\t\tcheckHash();\n\t} );\n\n\tif ( !browser.isWideScreen() && page ) {\n\t\texpandStoredSections( this, $container, page );\n\t\tcleanObsoleteStoredSections( page );\n\t}\n};\n\nToggler._getExpandedSections = getExpandedSections;\nToggler._expandStoredSections = expandStoredSections;\nToggler._cleanObsoleteStoredSections = cleanObsoleteStoredSections;\n\nmodule.exports = Toggler;\n","/* global $ */\nvar util = require( './util' ),\n\tmfExtend = require( './mfExtend' ),\n\tDEPRECATED_PROPERTIES = [ 'events' ],\n\t// Cached regex to split keys for `delegate`.\n\tdelegateEventSplitter = /^(\\S+)\\s*(.*)$/,\n\tidCounter = 0;\n\n/**\n * Generate a unique integer id (unique within the entire client session).\n * Useful for temporary DOM ids.\n * @param {string} prefix Prefix to be used when generating the id.\n * @return {string}\n */\nfunction uniqueId( prefix ) {\n\tvar id = ( ++idCounter ).toString();\n\treturn prefix ? prefix + id : id;\n}\n\n/**\n * Should be extended using extend().\n *\n * When options contains el property, this.$el in the constructed object\n * will be set to the corresponding jQuery object. Otherwise, this.$el\n * will be an empty div.\n *\n * When extended using extend(), if the extended prototype contains\n * template property, this.$el will be filled with rendered template (with\n * options parameter used as template data).\n *\n * template property can be a string which will be passed to mw.template.compile()\n * or an object that has a render() function which accepts an object with\n * template data as its argument (similarly to an object created by\n * mw.template.compile()).\n *\n * You can also define a defaults property which should be an object\n * containing default values for the template (if they're not present in\n * the options parameter).\n *\n * If this.$el is not a jQuery object bound to existing DOM element, the\n * view can be attached to an element using appendTo(), prependTo(),\n * insertBefore(), insertAfter() proxy functions.\n *\n * append(), prepend(), before(), after() can be used to modify $el. on()\n * can be used to bind events.\n *\n * You can also use declarative DOM events binding by specifying an `events`\n * map on the class. The keys will be 'event selector' and the value can be\n * either the name of a method to call, or a function. All methods and\n * functions will be executed on the context of the View.\n *\n * Inspired from Backbone.js\n * https://github.com/jashkenas/backbone/blob/master/backbone.js#L1128\n *\n * Example:\n * ```js\n *     var\n *       MyComponent = View.extend( {\n *         edit: function ( ev ) {\n *           //...\n *         },\n *         save: function ( ev ) {\n *           //...\n *         }\n *       } ),\n *       instance = new MyComponent({\n *         events: {\n *           'mousedown .title': 'edit',\n *           'click .button': 'save',\n *           'click .open': function(e) { ... }\n *         }\n *       });\n * ```\n *\n * Example:\n * ```js\n *     var View, section;\n *     function Section( options ) {\n *       var defaultOptions = {\n *         events: {\n *           // ...\n *         }\n *       }\n *       View.call( this, util.extends( {}, defaultOptions, options ) );\n *     }\n *     View = require( './View' );\n *     require( './mfExtend' )( Section, View, {\n *       template: mw.template.compile( \"&lt;h2&gt;{{title}}&lt;/h2&gt;\" ),\n *     } );\n *     section = new Section( { title: 'Test', text: 'Test section body' } );\n *     section.appendTo( 'body' );\n * ```\n *\n * @class View\n * @mixins OO.EventEmitter\n */\n\nfunction View() {\n\tvar self = this;\n\tDEPRECATED_PROPERTIES.forEach( function ( property ) {\n\t\tif ( self[ property ] !== undefined ) {\n\t\t\tmw.log.deprecate( self, property, self[ property ],\n\t\t\t\t'Setting `' + property + '` on the View is deprecated. Please use options.' );\n\t\t}\n\t} );\n\tthis.initialize.apply( this, arguments );\n}\nOO.mixinClass( View, OO.EventEmitter );\nmfExtend( View, {\n\t/**\n\t * Name of tag that contains the rendered template\n\t * @memberof View\n\t * @instance\n\t * @property {string} tagName\n\t */\n\ttagName: 'div',\n\t/**\n\t * Tells the View to ignore tagName and className when constructing the element\n\t * and to rely solely on the template\n\t * @memberof View\n\t * @instance\n\t * @property {boolean} isTemplateMode\n\t */\n\tisTemplateMode: false,\n\t/**\n\t * @memberof View\n\t * @instance\n\t * @property {Mixed}\n\t * Specifies the template used in render(). Object|string|HoganTemplate\n\t */\n\ttemplate: undefined,\n\n\t/**\n\t * Specifies partials (sub-templates) for the main template. Example:\n\t *\n\t *     @example\n\t *     // example content for the \"some\" template (sub-template will be\n\t *     // inserted where {{>content}} is):\n\t *     // <h1>Heading</h1>\n\t *     // {{>content}}\n\t *\n\t *     oo.mfExtend( SomeView, View, {\n\t *       template: M.template.get( 'some.hogan' ),\n\t *       templatePartials: { content: M.template.get( 'sub.hogan' ) }\n\t *     }\n\t *\n\t * @memberof View\n\t * @instance\n\t * @property {Object}\n\t */\n\ttemplatePartials: {},\n\n\t/**\n\t * A set of default options that are merged with options passed into the initialize\n\t * function.\n\t * @memberof View\n\t * @instance\n\t * @property {Object} defaults Default options hash.\n\t * @property {jQuery.Object|string} [defaults.el] jQuery selector to use for rendering.\n\t * @property {boolean} [defaults.skipTemplateRender] Whether to enhance views already in\n\t * DOM. When enabled, the template is disabled so that it is not rendered in the DOM.\n\t * Use in conjunction with View::defaults.$el to associate the View with an existing\n\t * already rendered element in the DOM.\n\t */\n\tdefaults: {},\n\n\t/**\n\t * Run once during construction to set up the View\n\t * @memberof View\n\t * @instance\n\t * @param {Object} options Object passed to the constructor.\n\t * @param {Object.<string, string>} [options.events]\n\t */\n\tinitialize: function ( options ) {\n\t\tvar self = this;\n\n\t\tOO.EventEmitter.call( this );\n\t\toptions = util.extend( {}, this.defaults, options );\n\t\tthis.options = options;\n\t\t// Assign a unique id for dom events binding/unbinding\n\t\tthis.cid = uniqueId( 'view' );\n\n\t\t// TODO: if template compilation is too slow, don't compile them on a\n\t\t// per object basis, but don't worry about it now (maybe add cache to\n\t\t// M.template.compile())\n\t\tif ( typeof this.template === 'string' ) {\n\t\t\tthis.template = mw.template.compile( this.template );\n\t\t}\n\n\t\tif ( options.el ) {\n\t\t\t// Note the element may not be in the document so must use global jQuery here\n\t\t\tthis.$el = $( options.el );\n\t\t} else {\n\t\t\tthis.$el = this.parseHTML( '<' + this.tagName + '>' );\n\t\t}\n\n\t\t// Make sure the element is ready to be manipulated\n\t\tif ( this.$el.length ) {\n\t\t\tthis._postInitialize( options );\n\t\t} else {\n\t\t\tutil.docReady( function () {\n\t\t\t\t// Note the element may not be in the document so must use global jQuery here\n\t\t\t\tself.$el = $( options.el );\n\t\t\t\tself._postInitialize( options );\n\t\t\t} );\n\t\t}\n\t},\n\n\t/**\n\t * Called when this.$el is ready.\n\t * @memberof View\n\t * @instance\n\t * @private\n\t * @param {Object} props\n\t */\n\t_postInitialize: function ( props ) {\n\t\tvar\n\t\t\tBORDER_BOX_CLASS = 'view-border-box',\n\t\t\tclassName = props.className;\n\n\t\tthis.$el.addClass( className );\n\t\t// border-box will be added provided this flag is not set\n\t\tif ( props.isBorderBox !== false ) {\n\t\t\tthis.$el.addClass( BORDER_BOX_CLASS );\n\t\t}\n\n\t\tthis.render( {} );\n\t},\n\n\t/**\n\t * Function called before the view is rendered. Can be redefined in\n\t * objects that extend View.\n\t * @memberof View\n\t * @instance\n\t */\n\tpreRender: function () {},\n\n\t/**\n\t * Function called after the view is rendered. Can be redefined in\n\t * objects that extend View.\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\tpostRender: function () {},\n\n\t// eslint-disable-next-line valid-jsdoc\n\t/**\n\t * Fill this.$el with template rendered using data if template is set.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} data Template data. Will be merged into the view's\n\t * options\n\t * @chainable\n\t */\n\trender: function ( data ) {\n\t\tvar $el, html;\n\t\tutil.extend( this.options, data );\n\t\tthis.preRender();\n\t\tthis.undelegateEvents();\n\t\tif ( this.template && !this.options.skipTemplateRender ) {\n\t\t\thtml = this.template.render( this.options, this.templatePartials );\n\t\t\tif ( this.isTemplateMode ) {\n\t\t\t\t$el = $( html );\n\t\t\t\tthis.$el.replaceWith( $el );\n\t\t\t\tthis.$el = $el;\n\t\t\t} else {\n\t\t\t\tthis.$el.html( html );\n\t\t\t}\n\t\t}\n\t\tthis.postRender();\n\t\tthis.delegateEvents();\n\t\treturn this;\n\t},\n\n\t/**\n\t * Wraps this.$el.find, so that you can search for elements in the view's\n\t * ($el's) scope.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} query A jQuery CSS selector.\n\t * @return {JQuery.Object} jQuery object containing results of the search.\n\t */\n\t$: function ( query ) {\n\t\treturn this.$el.find( query );\n\t},\n\n\t/**\n\t * Set callbacks, where `this.events` is a hash of\n\t *\n\t * { 'event selector': 'callback' }\n\t *\n\t * {\n\t *   'mousedown .title': 'edit',\n\t *   'click .button': 'save',\n\t *   'click .open': function(e) { ... }\n\t * }\n\t *\n\t * pairs. Callbacks will be bound to the view, with `this` set properly.\n\t * Uses event delegation for efficiency.\n\t * Omitting the selector binds the event to `this.el`.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} events Optionally set this events instead of the ones on this.\n\t */\n\tdelegateEvents: function ( events ) {\n\t\tvar match, key, method;\n\t\t// Take either the events parameter or the this.events to process. this.events is\n\t\t// deprecated. See DEPRECATED_PROPERTIES.\n\t\tevents = events || this.options.events || this.events;\n\t\tif ( events ) {\n\t\t\t// Remove current events before re-binding them\n\t\t\tthis.undelegateEvents();\n\t\t\tfor ( key in events ) {\n\t\t\t\tmethod = events[ key ];\n\t\t\t\t// If the method is a string name of this.method, get it\n\t\t\t\tif ( typeof method !== 'function' ) {\n\t\t\t\t\tmethod = this[ events[ key ] ];\n\t\t\t\t}\n\t\t\t\tif ( method ) {\n\t\t\t\t\t// Extract event and selector from the key\n\t\t\t\t\tmatch = key.match( delegateEventSplitter );\n\t\t\t\t\tthis.delegate( match[ 1 ], match[ 2 ], method.bind( this ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Add a single event listener to the view's element (or a child element\n\t * using `selector`). This only works for delegate-able events: not `focus`,\n\t * `blur`, and not `change`, `submit`, and `reset` in Internet Explorer.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} eventName\n\t * @param {string} selector\n\t * @param {Function} listener\n\t */\n\tdelegate: function ( eventName, selector, listener ) {\n\t\tthis.$el.on( eventName + '.delegateEvents' + this.cid, selector,\n\t\t\tlistener );\n\t},\n\n\t/**\n\t * Clears all callbacks previously bound to the view by `delegateEvents`.\n\t * You usually don't need to use this, but may wish to if you have multiple\n\t * views attached to the same DOM element.\n\t * @memberof View\n\t * @instance\n\t */\n\tundelegateEvents: function () {\n\t\tif ( this.$el ) {\n\t\t\tthis.$el.off( '.delegateEvents' + this.cid );\n\t\t}\n\t},\n\n\t/**\n\t * A finer-grained `undelegateEvents` for removing a single delegated event.\n\t * `selector` and `listener` are both optional.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} eventName\n\t * @param {string} selector\n\t * @param {Function} listener\n\t */\n\tundelegate: function ( eventName, selector, listener ) {\n\t\tthis.$el.off( eventName + '.delegateEvents' + this.cid, selector,\n\t\t\tlistener );\n\t},\n\n\t/**\n\t * See parseHTML method of util singleton\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\tparseHTML: util.parseHTML\n} );\n\n/**\n * @memberof View\n * @instance\n * @func append\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func append\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prepend\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prepend\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func appendTo\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prependTo\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func after\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func after\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func before\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func before\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func insertAfter\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func insertBefore\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func remove\n * @param {string} [selector]\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func detach\n * @param {string} [selector]\n * @return {this}\n */\n\n[\n\t'append',\n\t'prepend',\n\t'appendTo',\n\t'prependTo',\n\t'after',\n\t'before',\n\t'insertAfter',\n\t'insertBefore',\n\t'remove',\n\t'detach'\n].forEach( function ( prop ) {\n\tView.prototype[prop] = function () {\n\t\tthis.$el[prop].apply( this.$el, arguments );\n\t\treturn this;\n\t};\n} );\n\nmodule.exports = View;\n","var util = require( './util' ),\n\tdefaultParams = {\n\t\taction: 'query',\n\t\tformatversion: 2\n\t};\n\n/**\n * Extends the default params for an action query with otherParams\n * @param {Object} otherParams\n * @return {Object}\n */\nfunction actionParams( otherParams ) {\n\tvar scriptPath = mw.config.get( 'wgMFContentProviderScriptPath' );\n\treturn util.extend( {}, defaultParams, {\n\t\torigin: scriptPath ? '*' : undefined\n\t}, otherParams );\n}\n\nmodule.exports = actionParams;\n","/* This module defines several types of cache classes to use in other\n * modules.\n * The interface, that all types use, is kept synchronous driven by current\n * usage patterns, but will need to be revisited in case usage patterns\n * suggest we need asynchronous caches.\n */\n\n/**\n * In memory cache implementation\n *\n * @class MemoryCache\n */\nfunction MemoryCache() {\n\tthis._cache = {};\n}\n\n/**\n * Retrieve a cached value from a key\n * @memberof MemoryCache\n * @instance\n * @param {string} key\n * @return {Mixed}\n */\nMemoryCache.prototype.get = function ( key ) {\n\treturn this._cache[ key ];\n};\n\n/**\n * Cache a value by key\n * @memberof MemoryCache\n * @instance\n * @param {string} key\n * @param {Mixed} value\n */\nMemoryCache.prototype.set = function ( key, value ) {\n\tthis._cache[ key ] = value;\n};\n\n/**\n * Null object cache implementation\n *\n * @class NoCache\n */\nfunction NoCache() { }\n\n/**\n * NoOp\n * @memberof NoCache\n * @instance\n */\nNoCache.prototype.get = function () { };\n\n/**\n * NoOp\n * @memberof NoCache\n * @instance\n */\nNoCache.prototype.set = function () { };\n\nmodule.exports = {\n\tMemoryCache: MemoryCache,\n\tNoCache: NoCache\n};\n","/**\n * Mobile mode helper class\n *\n * @class context\n * @singleton\n */\nmodule.exports = {\n\t/**\n\t * Gets current mobile mode\n\t * @memberof context\n\t * @instance\n\t * @return {string|null} Name of mode - either `stable` or `beta`. It is `null` if desktop.\n\t */\n\tgetMode: function () {\n\t\treturn mw.config.get( 'wgMFMode' );\n\t}\n};\n","var util = require( './util' ),\n\tactionParams = require( './actionParams.js' );\n\n/**\n * Extends the API query parameters to include those parameters required to also fetch Wikibase\n * descriptions and appropriately sized thumbnail images as well as those required to make a query.\n *\n * This function wraps `util.extend` with some Wikibase-specific configuration\n * variable management\n * but, like `util.extend`, is variadic and so can be used as a replacement for it in search\n * gateways, e.g.\n *\n * ```\n * var params = extendSearchParams(\n *   'nearby',\n *   baseParams,\n *   specializedParams,\n *   moreSpecializedParams\n * );\n * ```\n *\n * @param {string} feature The name of the feature\n * @throws {Error} If `feature` isn't one that shows Wikidata descriptions. See the\n *  `wgMFDisplayWikibaseDescriptions` configuration variable for detail\n * @return {Object}\n */\nfunction extendSearchParams( feature ) {\n\tvar displayWikibaseDescriptions = mw.config.get( 'wgMFDisplayWikibaseDescriptions', {} ),\n\t\tscriptPath = mw.config.get( 'wgMFContentProviderScriptPath' ),\n\t\targs,\n\t\tresult;\n\n\tif ( !Object.prototype.hasOwnProperty.call( displayWikibaseDescriptions, feature ) ) {\n\t\tthrow new Error( '\"' + feature + '\" isn\\'t a feature that shows Wikibase descriptions.' );\n\t}\n\n\t// Construct the arguments for a call to `util.extend`\n\t// such that if it were hand-written, then it\n\t// would look like the following:\n\t//\n\t// ```\n\t// var result = util.extend( {\n\t//   prop: []\n\t// }, params, /* ..., */ mw.config.get( 'wgMFSearchAPIParams' ) );\n\t// ```\n\targs = Array.prototype.slice.call( arguments, 1 );\n\targs.unshift( {\n\t\tprop: []\n\t} );\n\targs.push( mw.config.get( 'wgMFSearchAPIParams' ) );\n\n\tresult = util.extend.apply( {}, args );\n\tresult.prop = result.prop.concat( mw.config.get( 'wgMFQueryPropModules' ) );\n\n\tif ( displayWikibaseDescriptions[feature] ) {\n\t\tif ( result.prop.indexOf( 'description' ) === -1 ) {\n\t\t\tresult.prop.push( 'description' );\n\t\t}\n\t}\n\n\tif ( scriptPath ) {\n\t\t// A foreign api is being accessed! Enable anonymous CORS queries!\n\t\tresult.origin = '*';\n\t}\n\treturn actionParams( result );\n}\nmodule.exports = extendSearchParams;\n","var\n\tCANCEL_GLYPH = 'overlay-close',\n\tIcon = require( './Icon' ),\n\tutil = require( './util' );\n\n/**\n * A set of shared icons.\n *\n * Factory methods are used to keep separate features that use the same icons\n * from accidentally manipulating one another's DOM when calling methods like\n * `remove`.\n *\n * @class icons\n * @singleton\n * @uses Icon\n */\nmodule.exports = {\n\tCANCEL_GLYPH: CANCEL_GLYPH,\n\t// Exported to support testing and stubbing\n\tIcon: Icon,\n\t/**\n\t * Gets a cancel icon\n\t *\n\t * The icon should be used to inform the user that the front-end is\n\t * communicating with the back-end.\n\t * @memberof icons\n\t * @instance\n\t * @param {string} variant\n\t * @return {Icon}\n\t */\n\tcancel: function ( variant ) {\n\t\tvar glyph = variant ? CANCEL_GLYPH + '-' + variant : CANCEL_GLYPH;\n\t\treturn new this.Icon( {\n\t\t\ttagName: 'button',\n\t\t\tname: glyph,\n\t\t\tadditionalClassNames: 'cancel',\n\t\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' )\n\t\t} );\n\t},\n\t/**\n\t * Gets a spinner icon.\n\t *\n\t * The icon should be used to inform the user that the front-end is\n\t * communicating with the back-end.\n\t * @memberof icons\n\t * @instance\n\t * @param {Object} [options] See `Icon` for more details\n\t * @return {Icon}\n\t */\n\tspinner: function ( options ) {\n\t\toptions = options || {};\n\n\t\treturn new this.Icon( util.extend( options, {\n\t\t\tname: 'spinner',\n\t\t\tlabel: mw.msg( 'mobile-frontend-loading-message' ),\n\t\t\tadditionalClassNames: 'spinner loading'\n\t\t} ) );\n\t},\n\t/**\n\t * Gets a non-filled watch star icon.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @return {Icon}\n\t */\n\twatchIcon: function () {\n\t\treturn new this.Icon( {\n\t\t\tname: 'watch',\n\t\t\tadditionalClassNames: 'watch-this-article'\n\t\t} );\n\t},\n\t/**\n\t * Gets a filled watch star icon.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @return {Icon}\n\t */\n\twatchedIcon: function () {\n\t\treturn new this.Icon( {\n\t\t\tname: 'watched',\n\t\t\tadditionalClassNames: 'watch-this-article watched'\n\t\t} );\n\t}\n};\n","var\n\tutil = require( '../util' ),\n\tDeferred = util.Deferred,\n\twhen = util.when;\n\n/**\n * Load an image on demand\n * @param {JQuery.find} find\n * @param {Array} images a list of images that have not been loaded.\n * @return {jQuery.Deferred}\n */\nmodule.exports.loadImages = function ( find, images ) {\n\tvar callbacks = images.map( function ( placeholder ) {\n\t\treturn module.exports.loadImage( find( placeholder ) );\n\t} );\n\n\treturn when.apply( null, callbacks );\n};\n\n/**\n * Load an image on demand\n * @param {jQuery.Object} $placeholder\n * @return {jQuery.Deferred}\n */\nmodule.exports.loadImage = function ( $placeholder ) {\n\tvar\n\t\td = Deferred(),\n\t\twidth = $placeholder.attr( 'data-width' ),\n\t\theight = $placeholder.attr( 'data-height' ),\n\t\t// document must be passed to ensure image will start downloading\n\t\t$downloadingImage = util.parseHTML( '<img>', $placeholder[0].ownerDocument );\n\n\t// When the image has loaded\n\t$downloadingImage.on( 'load', function () {\n\t\t// Swap the HTML inside the placeholder (to keep the layout and\n\t\t// dimensions the same and not trigger layouts\n\t\t$downloadingImage.addClass( 'image-lazy-loaded' );\n\t\t$placeholder.replaceWith( $downloadingImage );\n\t\td.resolve();\n\t} );\n\t$downloadingImage.on( 'error', function () {\n\t\td.reject();\n\t} );\n\n\t// Trigger image download after binding the load handler\n\t$downloadingImage.attr( {\n\t\tclass: $placeholder.attr( 'data-class' ),\n\t\twidth: width,\n\t\theight: height,\n\t\tsrc: $placeholder.attr( 'data-src' ),\n\t\talt: $placeholder.attr( 'data-alt' ),\n\t\tstyle: $placeholder.attr( 'style' ),\n\t\tsrcset: $placeholder.attr( 'data-srcset' )\n\t} );\n\treturn d;\n};\n","var\n\ticons = require( './icons' ),\n\tOverlay = require( './Overlay' );\n\n/**\n * Overlay that initially shows loading animation until\n * caller hides it with .hide()\n *\n * @return {Overlay}\n */\nfunction loadingOverlay() {\n\tvar overlay = new Overlay( {\n\t\tclassName: 'overlay overlay-loading',\n\t\tnoHeader: true\n\t} );\n\ticons.spinner().$el.appendTo( overlay.$( '.overlay-content' ) );\n\treturn overlay;\n}\n\nmodule.exports = loadingOverlay;\n","/**\n * Extends a class with new methods and member properties.\n *\n * @param {Function} Child function\n * @param {Object|Function} ParentOrPrototype class to inherit from\n *  OR if no inheriting class a prototype to extend the class with\n * @param {Object} [prototype]\n */\nfunction mfExtend( Child, ParentOrPrototype, prototype ) {\n\tvar key;\n\tif ( prototype ) {\n\t\tOO.inheritClass( Child, ParentOrPrototype );\n\t} else {\n\t\tOO.initClass( Child );\n\t\tprototype = ParentOrPrototype;\n\t}\n\tfor ( key in prototype ) {\n\t\tChild.prototype[key] = prototype[key];\n\t}\n}\n\nmodule.exports = mfExtend;\n","/**\n * Class for managing modules\n *\n * A module in this context is essentially a Javascript class (not to be confused with\n * ResourceLoader modules).\n *\n * @class ModuleLoader\n */\nfunction ModuleLoader() {\n\t/**\n\t * @property {Object} register of defined modules\n\t * @private\n\t */\n\tthis._register = {};\n}\n\nModuleLoader.prototype = {\n\t/**\n\t * Require (import) a module previously defined using define().\n\t * Searches core module registry using mw.loader.require before consulting\n\t * its own local registry. This method is deprecated, please do not use.\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Required module id.\n\t * @return {Object} Required module, can be any JavaScript object.\n\t */\n\trequire: function ( id ) {\n\t\tvar module, args,\n\t\t\tregistry = this._register;\n\n\t\t/**\n\t\t * @return {Object} Module\n\t\t */\n\t\tfunction localRequire() {\n\t\t\tif ( !Object.hasOwnProperty.call( registry, id ) ) {\n\t\t\t\tthrow new Error( 'MobileFrontend Module not found: ' + id );\n\t\t\t}\n\t\t\treturn registry[ id ];\n\t\t}\n\t\targs = id.split( '/' );\n\t\ttry {\n\t\t\tmodule = mw.loader.require( args[0] );\n\t\t\tif ( module[ args[1] ] ) {\n\t\t\t\treturn module[ args[1] ];\n\t\t\t} else {\n\t\t\t\treturn localRequire();\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\treturn localRequire();\n\t\t}\n\t},\n\n\t/**\n\t * Define a module which can be later required (imported) using require().\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Defined module id.\n\t * @param {Object} obj Defined module body, can be any JavaScript object.\n\t * @return {Object}\n\t */\n\tdefine: function ( id, obj ) {\n\t\tvar self = this;\n\n\t\tif ( Object.hasOwnProperty.call( this._register, id ) ) {\n\t\t\tthrow new Error( 'Module already exists: ' + id );\n\t\t}\n\t\tthis._register[ id ] = obj;\n\t\t// return an object of additionally functions to do with the registered module\n\t\treturn {\n\t\t\t/**\n\t\t\t * @see ModuleLoader#deprecate\n\t\t\t * @param {string} deprecatedId Defined module id, which is deprecated.\n\t\t\t * @ignore\n\t\t\t */\n\t\t\tdeprecate: function ( deprecatedId ) {\n\t\t\t\tself.deprecate( deprecatedId, obj, id );\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t * Deprecate a module and give an replacement (if there is any).\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Defined module id, which is deprecated.\n\t * @param {Object} obj Defined module body, can be any JavaScript object.\n\t * @param {string} [replacement] Give an optional replacement for this module (which\n\t * needs to be already defined!)\n\t */\n\tdeprecate: function ( id, obj, replacement ) {\n\t\tvar msg;\n\t\tif ( replacement ) {\n\t\t\t// add an alternative for this module, if any given\n\t\t\tmsg = 'Use ' + replacement + ' instead.';\n\t\t}\n\t\t// register it as a deprecated one\n\t\tmw.log.deprecate( this._register, id, obj, msg );\n\t}\n};\n\nmodule.exports = ModuleLoader;\n","var\n\tloadingOverlay = require( './loadingOverlay' ),\n\tutil = require( './util' );\n\n/**\n * Utility library for looking up details on the current user\n * @class loader\n * @singleton\n */\nmodule.exports = {\n\t// Exported to support testing and stubbing\n\tnewLoadingOverlay: function () {\n\t\treturn loadingOverlay();\n\t},\n\t/**\n\t * Loads a module via ResourceLoader\n\t * and displays a full screen LoadingOverlay during load time.\n\t * @memberof loader\n\t * @instance\n\t * @param {string} name ResourceLoader module name to load asynchronously.\n\t * @param {boolean} delegateHide if true the caller is responsible for hiding\n\t *  the intermediate loader.\n\t * @param {boolean} [showLoadingOverlay] if false a loading overlay will be hidden while\n\t *  loading the module. Defaults to true.\n\t * @return {jQuery.Promise}\n\t */\n\tloadModule: function ( name, delegateHide, showLoadingOverlay ) {\n\t\tvar loadingOverlay = this.newLoadingOverlay();\n\n\t\tshowLoadingOverlay = ( showLoadingOverlay !== undefined ) ? showLoadingOverlay : true;\n\t\tif ( showLoadingOverlay ) {\n\t\t\tloadingOverlay.appendTo( document.body );\n\t\t\tloadingOverlay.show();\n\t\t}\n\n\t\tfunction hideOverlayIfNeeded() {\n\t\t\tif ( !delegateHide && showLoadingOverlay ) {\n\t\t\t\tloadingOverlay.hide();\n\t\t\t}\n\t\t}\n\t\treturn mw.loader.using( name ).then( function () {\n\t\t\thideOverlayIfNeeded();\n\n\t\t\treturn loadingOverlay;\n\t\t}, function () {\n\t\t\thideOverlayIfNeeded();\n\n\t\t\treturn util.Deferred().reject().promise();\n\t\t} );\n\t}\n};\n","var units = [ 'seconds', 'minutes', 'hours', 'days', 'months', 'years' ],\n\tutil = require( './util' ),\n\tlimits = [ 1, 60, 3600, 86400, 2592000, 31536000 ];\n\n/** @class time */\n\n/**\n * Calculate the correct unit of timestamp\n * @memberof time\n * @instance\n * @param {number} timestampDelta\n * @return {{value: number, unit: string}}\n */\nfunction timeAgo( timestampDelta ) {\n\tvar i = 0;\n\twhile ( i < limits.length && timestampDelta > limits[i + 1] ) {\n\t\t++i;\n\t}\n\treturn {\n\t\tvalue: Math.round( timestampDelta / limits[i] ),\n\t\tunit: units[i]\n\t};\n}\n\n/**\n * Calculate the correct unit of timestamp delta\n * @memberof time\n * @instance\n * @param {number} timestamp\n * @return {{value: number, unit: string}}\n */\nfunction getTimeAgoDelta( timestamp ) {\n\tvar currentTimestamp = Math.round( new Date().getTime() / 1000 );\n\n\treturn timeAgo( currentTimestamp - timestamp );\n}\n\n/**\n * Whether timestamp delta is less than a day old\n * @memberof time\n * @instance\n * @param {{value: number, unit: string}} delta Object of timestamp and its label\n * @return {boolean}\n */\nfunction isRecent( delta ) {\n\treturn [ 'seconds', 'minutes', 'hours' ].indexOf( delta.unit ) > -1;\n}\n\n/**\n * Is delta less than 10 seconds?\n * @memberof time\n * @instance\n * @param {{value: number, unit: string}} delta Object of timestamp and its label\n * @return {boolean}\n */\nfunction isNow( delta ) {\n\treturn delta.unit === 'seconds' && delta.value < 10;\n}\n\n/**\n * Return a message relating to the last modified relative time.\n * @memberof time\n * @instance\n * @param {number} ts timestamp\n * @param {string} username of the last user to modify the page\n * @param {string} [gender] of the last user to modify the page\n * @param {string} [historyUrl] url to the history page for the message, if omitted\n *  returns plain text string rather than html\n * @return {string}\n */\nfunction getLastModifiedMessage( ts, username, gender, historyUrl ) {\n\tvar delta, html,\n\t\tkeys = {\n\t\t\tseconds: 'mobile-frontend-last-modified-with-user-seconds',\n\t\t\tminutes: 'mobile-frontend-last-modified-with-user-minutes',\n\t\t\thours: 'mobile-frontend-last-modified-with-user-hours',\n\t\t\tdays: 'mobile-frontend-last-modified-with-user-days',\n\t\t\tmonths: 'mobile-frontend-last-modified-with-user-months',\n\t\t\tyears: 'mobile-frontend-last-modified-with-user-years'\n\t\t},\n\t\targs = [];\n\n\tgender = gender || 'unknown';\n\n\tdelta = getTimeAgoDelta( ts );\n\tif ( isNow( delta ) ) {\n\t\targs.push( 'mobile-frontend-last-modified-with-user-just-now', gender, username );\n\t} else {\n\t\targs.push( keys[ delta.unit ], gender, username,\n\t\t\tmw.language.convertNumber( delta.value )\n\t\t);\n\t}\n\n\targs.push(\n\t\thistoryUrl || '#',\n\t\t// Abuse PLURAL support to determine if the user is anonymous or not\n\t\tmw.language.convertNumber( username ? 1 : 0 ),\n\t\t// Our abuse of PLURAL support means we have to pass the relative URL\n\t\t// rather than construct it from a wikilink\n\t\tusername ? mw.util.getUrl( 'User:' + username ) : ''\n\t);\n\thtml = mw.message.apply( this, args ).parse();\n\tif ( historyUrl ) {\n\t\treturn html;\n\t} else {\n\t\treturn util.parseHTML( '<div>' ).html( html ).text();\n\t}\n}\n\n/**\n * Return a message relating to the registration date of the user\n * @memberof time\n * @instance\n * @param {string} ts timestamp\n * @param {string} [gender] of the last user editing this page\n * @return {string}\n */\nfunction getRegistrationMessage( ts, gender ) {\n\tvar delta, html,\n\t\tkeys = {\n\t\t\tseconds: 'mobile-frontend-joined-seconds',\n\t\t\tminutes: 'mobile-frontend-joined-minutes',\n\t\t\thours: 'mobile-frontend-joined-hours',\n\t\t\tdays: 'mobile-frontend-joined-days',\n\t\t\tmonths: 'mobile-frontend-joined-months',\n\t\t\tyears: 'mobile-frontend-joined-years'\n\t\t},\n\t\targs = [];\n\n\tgender = gender || 'unknown';\n\n\tdelta = getTimeAgoDelta( parseInt( ts, 10 ) );\n\tif ( isNow( delta ) ) {\n\t\targs.push( 'mobile-frontend-joined-just-now', gender );\n\t} else {\n\t\targs.push( keys[ delta.unit ], gender, mw.language.convertNumber( delta.value ) );\n\t}\n\thtml = mw.message.apply( this, args ).parse();\n\treturn html;\n}\n\nmodule.exports = {\n\tgetLastModifiedMessage: getLastModifiedMessage,\n\tgetRegistrationMessage: getRegistrationMessage,\n\ttimeAgo: timeAgo,\n\tgetTimeAgoDelta: getTimeAgoDelta,\n\tisNow: isNow,\n\tisRecent: isRecent\n};\n","var\n\tutil = require( './util' ),\n\tstorageKey = 'mobileFrontend/toast';\n\n/**\n * Wrapper for one global Toast\n * @class Toast\n */\nfunction Toast() {\n\tmw.requestIdleCallback( this._showPending.bind( this ) );\n}\n\n/**\n * Show a message with the given class in a toast.\n * @memberof Toast\n * @instance\n * @param {string} msg Message to show in the toast\n * @param {Object|string} [options]\n *  If a string (deprecated) CSS class to add to the element\n *  If an object, more options for the notification see mw.notification.show.\n *  For backwards compatibility reasons if a string is given it will be\n *  treated as options.type\n */\nToast.prototype.show = function ( msg, options ) {\n\tif ( typeof options === 'string' ) {\n\t\tmw.log.warn( 'The use of the cssClass parameter of Toast.show is deprecated, please convert it to an ' +\n\t\t\t\t'options object.' );\n\t\toptions = {\n\t\t\ttype: options\n\t\t};\n\t}\n\n\toptions = util.extend( {\n\t\ttag: 'toast'\n\t}, options );\n\n\tthis.notification = mw.notify( msg, options );\n};\n\n/**\n * Hide the Toast if it's visible.\n * @memberof Toast\n * @instance\n */\nToast.prototype.hide = function () {\n\tif ( this.notification !== undefined ) {\n\t\tthis.notification.then( function ( notif ) {\n\t\t\tnotif.close();\n\t\t} );\n\t}\n};\n\n/**\n * Save the toast data in storage so that we can show it on page reload.\n * Also check whether there is a pending message that's not shown yet.\n * If yes, output a warning message and discard this message.\n * This is to ensure that the page needs to be reloaded before adding\n * a new message for showing later.\n * @memberof Toast\n * @instance\n * @param {string} content Content to be placed in element\n * @param {string} [className] class to add to element\n */\nToast.prototype.showOnPageReload = function ( content, className ) {\n\tif ( mw.storage.get( storageKey ) ) {\n\t\tmw.log.warn(\n\t\t\t'A pending toast message already exits. ' +\n\t\t\t\t'The page should have been reloaded by now.'\n\t\t);\n\t\treturn;\n\t}\n\tmw.storage.set( storageKey, JSON.stringify( {\n\t\tcontent: content,\n\t\tclassName: className\n\t} ) );\n};\n\n/**\n * Show the previously saved toast data and delete it from storage\n * @memberof Toast\n * @instance\n * @private\n */\nToast.prototype._showPending = function () {\n\tvar data = mw.storage.get( storageKey );\n\tif ( data ) {\n\t\tdata = JSON.parse( data );\n\t\tthis.show( data.content, data.className );\n\t\tmw.storage.remove( storageKey );\n\t}\n};\n\nmodule.exports = new Toast();\n","/* global $ */\n\n/**\n * Utility library\n * @class util\n * @singleton\n */\nmodule.exports = {\n\t/**\n\t * Escape a string for use as a css selector\n\t * @memberof util\n\t * @instance\n\t * @param {string} selector\n\t * @return {string}\n\t */\n\tescapeSelector: function ( selector ) {\n\t\treturn $.escapeSelector( selector );\n\t},\n\t/**\n\t * Wrapper class for the $.grep\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\tgrep: function () {\n\t\treturn $.grep.apply( $, arguments );\n\t},\n\t/**\n\t * Run method when document is ready.\n\t * @memberof util\n\t * @instance\n\t * @param {Function} fn\n\t * @return {jQuery.Object}\n\t */\n\tdocReady: function ( fn ) {\n\t\treturn $( fn );\n\t},\n\t/**\n\t * Wrapper class for the $.when\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\twhen: function () {\n\t\treturn $.when.apply( $, arguments );\n\t},\n\t/**\n\t * Wrapper class for the Deferred method\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\tDeferred: function () {\n\t\tvar d = $.Deferred(),\n\t\t\twarning = 'Use Promise compatible methods `then` and `catch` instead.';\n\n\t\t/* eslint-disable no-restricted-properties */\n\t\tmw.log.deprecate( d, 'fail', d.fail, warning );\n\t\tmw.log.deprecate( d, 'always', d.always, warning );\n\t\tmw.log.deprecate( d, 'done', d.done, warning );\n\t\t/* eslint-enable no-restricted-properties */\n\t\treturn d;\n\t},\n\t/**\n\t * Adds a class to the document\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Object} element representing the documentElement\n\t */\n\tgetDocument: function () {\n\t\treturn $( document.documentElement );\n\t},\n\t/**\n\t * Get the window object\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Object}\n\t */\n\tgetWindow: function () {\n\t\treturn $( window );\n\t},\n\t/**\n\t * Given some html, create new element(s).\n\t * Unlike jQuery.parseHTML this will return a jQuery object\n\t * not an array.\n\t * @memberof util\n\t * @instance\n\t * @param {string} html\n\t * @param {Element} [ctx] Document element to serve as the context\n\t *  in which the HTML fragment will be created\n\t * @return {jQuery.Object}\n\t */\n\tparseHTML: function ( html, ctx ) {\n\t\treturn $( $.parseHTML( html, ctx ) );\n\t},\n\t/**\n\t * wrapper for jQuery util function to check if something is numeric\n\t * @memberof util\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisNumeric: function () {\n\t\treturn $.isNumeric.apply( $, arguments );\n\t},\n\t/**\n\t * Wrapper for jQuery.extend method. In future this can be bound to Object.assign\n\t * when support allows.\n\t *\n\t * Warning: if only one argument is supplied to util.extend(), this means the target argument\n\t * was omitted. In this case, the jQuery object itself is assumed to be the target.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {Object}\n\t */\n\textend: function () {\n\t\treturn $.extend.apply( $, arguments );\n\t},\n\t/**\n\t * Escape dots and colons in a hash, jQuery doesn't like them because they\n\t * look like CSS classes and pseudoclasses. See\n\t * http://bugs.jquery.com/ticket/5241\n\t * http://stackoverflow.com/questions/350292/how-do-i-get-jquery-to-select-elements-with-a-period-in-their-id\n\t * @memberof util\n\t * @instance\n\t * @param {string} hash A hash to escape\n\t * @return {string}\n\t */\n\tescapeHash: function ( hash ) {\n\t\treturn hash.replace( /(:|\\.)/g, '\\\\$1' );\n\t},\n\n\t/**\n\t * Heuristic for determining whether an Event should be handled by\n\t * MobileFrontend or allowed to bubble to the browser.\n\t * @memberof util\n\t * @instance\n\t * @param {Event} ev\n\t * @return {boolean} True if event is modified with control, alt, meta, or\n\t *                   shift keys and should probably be handled by the\n\t *                   browser.\n\t *\n\t * todo: move this function to a ClickUtil file once bundling and code\n\t * splitting is supported.\n\t */\n\tisModifiedEvent: function ( ev ) {\n\t\treturn ev.altKey || ev.ctrlKey || ev.metaKey || ev.shiftKey;\n\t},\n\n\t/**\n\t * Pipe event emitted by source through proxy. Subscribers to proxy will receive the event as\n\t * though proxy was the originator.\n\t *\n\t * @param {OO.EventEmitter} src\n\t * @param {OO.EventEmitter} proxy\n\t * @param {string} event Event type to listen for.\n\t * @param {any[]} [args] Arguments to pass to\n\t *  subscribers, will be prepended to emitted arguments.\n\t * @return {OO.EventEmitter} The source.\n\t */\n\trepeatEvent: function ( src, proxy, event, args ) {\n\t\treturn src.on( event, function ( args ) {\n\t\t\treturn proxy.emit( event, args );\n\t\t}, args );\n\t}\n};\n","var View = require( '../View' ),\n\tWatchstarGateway = require( './WatchstarGateway' ),\n\ticons = require( '../icons' ),\n\tutil = require( '../util' ),\n\tmfExtend = require( '../mfExtend' ),\n\ttoast = require( '../toast' ),\n\tCtaDrawer = require( '../CtaDrawer' );\n\n/**\n * A clickable watchstar\n * @class Watchstar\n * @extends View\n * @uses CtaDrawer\n * @uses Icon\n * @uses WatchstarGateway\n * @uses Toast\n * @fires Watchstar#unwatch\n * @fires Watchstar#watch\n *\n * @param {Object} options Configuration options\n */\nfunction Watchstar( options ) {\n\tView.call( this,\n\t\tutil.extend( {\n\t\t\tclassName: icons.watchIcon().getClassName()\n\t\t}, options )\n\t);\n}\n\nmfExtend( Watchstar, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tevents: {\n\t\t// Disable clicks on original link\n\t\t'click a': 'onLinksClick',\n\t\tclick: 'onStatusToggle'\n\t},\n\t/**\n\t * @memberof Watchstar\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {mw.Api} defaults.api\n\t * @property {Page} defaults.page Current page.\n\t * @property {string} defaults.funnel to log events with\n\t */\n\tdefaults: {\n\t\tpage: undefined,\n\t\tfunnel: 'unknown'\n\t},\n\t/**\n\t * @memberof Watchstar\n\t * @instance\n\t * @property {Object} ctaDrawerOptions Default options hash for the anonymous CtaDrawer.\n\t */\n\tctaDrawerOptions: {\n\t\tcontent: mw.msg( 'mobile-frontend-watchlist-cta' ),\n\t\tqueryParams: {\n\t\t\twarning: 'mobile-frontend-watchlist-purpose',\n\t\t\tcampaign: 'mobile_watchPageActionCta',\n\t\t\treturntoquery: 'article_action=watch'\n\t\t},\n\t\tsignupQueryParams: {\n\t\t\twarning: 'mobile-frontend-watchlist-signup-action'\n\t\t}\n\t},\n\t/**\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\ttemplate: mw.template.compile( '<a role=\"button\">{{tooltip}}</a>', 'hogan' ),\n\t/**\n\t * @inheritdoc\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tinitialize: function ( options ) {\n\t\tvar self = this,\n\t\t\t_super = View.prototype.initialize;\n\n\t\tthis._watched = options.isWatched;\n\t\tthis.gateway = new WatchstarGateway( options.api );\n\n\t\t_super.call( self, options );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tthis.options.tooltip = this._watched ? mw.msg( 'unwatchthispage' ) : mw.msg( 'watchthispage' );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar unwatchedClass = icons.watchIcon().getGlyphClassName(),\n\t\t\twatchedClass = icons.watchedIcon().getGlyphClassName() + ' watched';\n\n\t\t// add tooltip to the div, not the <a> inside\n\t\t// because that <a> has zero width/height so cannot be hovered\n\t\tthis.$el.attr( 'title', this.options.tooltip );\n\n\t\t// Add watched class if necessary\n\t\tif ( !mw.user.isAnon() && this._watched ) {\n\t\t\tthis.$el.addClass( watchedClass ).removeClass( unwatchedClass );\n\t\t} else {\n\t\t\tthis.$el.addClass( unwatchedClass ).removeClass( watchedClass );\n\t\t}\n\t\tthis.$el.removeClass( 'hidden' );\n\t},\n\n\t/**\n\t * Prevent default on incoming events\n\t * @memberof Watchstar\n\t * @instance\n\t * @param {jQuery.Event} ev\n\t */\n\tonLinksClick: function ( ev ) {\n\t\tev.preventDefault();\n\t},\n\n\t/**\n\t * Triggered when a user anonymously clicks on the watchstar.\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tonStatusToggleAnon: function () {\n\t\tif ( !this.drawer ) {\n\t\t\tthis.drawer = new CtaDrawer( this.ctaDrawerOptions );\n\n\t\t}\n\t\tthis.drawer.show();\n\t},\n\n\t/**\n\t * Triggered when a logged in user clicks on the watchstar.\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tonStatusToggleUser: function () {\n\t\tvar\n\t\t\tself = this,\n\t\t\tgateway = this.gateway,\n\t\t\tpage = this.options.page,\n\t\t\tchecker,\n\t\t\tpostWatched = !this._watched;\n\n\t\tchecker = setInterval( function () {\n\t\t\ttoast.show( mw.msg( 'mobile-frontend-watchlist-please-wait' ) );\n\t\t}, 1000 );\n\t\tfunction stopInterval() {\n\t\t\tclearInterval( checker );\n\t\t}\n\t\tgateway.postStatusesByTitle( [ page.getTitle() ], postWatched ).then( function () {\n\t\t\tstopInterval();\n\n\t\t\tself._watched = postWatched;\n\t\t\tif ( postWatched ) {\n\t\t\t\tself.render();\n\t\t\t\t/**\n\t\t\t\t * Fired when the watch star is changed to watched status\n\t\t\t\t * @event Watchstar#watch\n\t\t\t\t */\n\t\t\t\tself.emit( 'watch' );\n\t\t\t\ttoast.show( mw.msg( 'mobile-frontend-watchlist-add', page.title ) );\n\t\t\t} else {\n\t\t\t\t/**\n\t\t\t\t * Fired when the watch star is changed to unwatched status\n\t\t\t\t * @event Watchstar#unwatch\n\t\t\t\t */\n\t\t\t\tself.emit( 'unwatch' );\n\t\t\t\tself.render();\n\t\t\t\ttoast.show( mw.msg( 'mobile-frontend-watchlist-removed', page.title ) );\n\t\t\t}\n\t\t}, function () {\n\t\t\tstopInterval();\n\n\t\t\ttoast.show( mw.msg( 'mobile-frontend-watchlist-error' ), 'error' );\n\t\t} );\n\t},\n\n\t/**\n\t * Event handler for clicking on watch star.\n\t * Make an API request if user is not anonymous.\n\t * @memberof Watchstar\n\t * @instance\n\t */\n\tonStatusToggle: function () {\n\t\tif ( mw.user.isAnon() ) {\n\t\t\tthis.onStatusToggleAnon.apply( this, arguments );\n\t\t} else {\n\t\t\tthis.onStatusToggleUser.apply( this, arguments );\n\t\t}\n\t}\n\n} );\n\nmodule.exports = Watchstar;\n","var util = require( '../util' ),\n\tactionParams = require( '../actionParams' );\n\n/**\n * @typedef {string|number} PageID Page ID. 0 / \"0\" is a special no-ID value.\n * {@link https://www.mediawiki.org/wiki/Manual:Page_table#page_id Page ID}\n *\n * @typedef {string} PageTitle Canonical page title.\n * {@link https://www.mediawiki.org/wiki/Manual:Title.php#Canonical_forms Canonical forms}\n *\n * @typedef {boolean} WatchStatus Page watch status; true if watched, false if\n *                                unwatched.\n * {@link https://www.mediawiki.org/wiki/API:Info API:Info} (see inprop.watched)\n * {@link https://www.mediawiki.org/wiki/API:Watch API:Watch} (see unwatch)\n *\n * @typedef {Object.<PageTitle, WatchStatus>} WatchStatusMap\n */\n\n/**\n * API for retrieving and modifying page watch statuses. This module interacts\n * with two endpoints, API:Info for GETs and API:Watch and for POSTs.\n *\n * @class WatchstarGateway\n * @param {mw.Api} api\n */\nfunction WatchstarGateway( api ) {\n\tthis.api = api;\n}\n\nWatchstarGateway.prototype = {\n\t/**\n\t * Issues zero to two asynchronous HTTP requests for the watch status of\n\t * each page ID and title passed.\n\t *\n\t * Every watch entry has a title but not necessarily a page ID. Entries\n\t * without IDs are missing pages, i.e., pages that do not exist. These\n\t * entries are used to observe when a page with a given title is created.\n\t * Although it is convenient to use titles because they're always present,\n\t * IDs are preferred since they're far less likely to exceed the URL length\n\t * limit.\n\t *\n\t * No request is issued when no IDs and no titles are passed. Given that the\n\t * server state does not change between the two requests, overlapping title\n\t * and ID members will behave as expected but there is no reason to issue\n\t * such a request.\n\t *\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageID[]} ids\n\t * @param {PageTitle[]} titles\n\t * @return {JQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetStatuses: function ( ids, titles ) {\n\t\t// Issue two requests and coalesce the results.\n\t\treturn util.when(\n\t\t\tthis.getStatusesByID( ids ),\n\t\t\tthis.getStatusesByTitle( titles )\n\t\t).then( function () { return util.extend.apply( util, arguments ); } );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageID[]} ids\n\t * @return {JQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetStatusesByID: function ( ids ) {\n\t\tvar self = this;\n\t\tif ( !ids.length ) {\n\t\t\treturn util.Deferred().resolve( {} );\n\t\t}\n\n\t\treturn this.api.get( {\n\t\t\tformatversion: 2,\n\t\t\taction: 'query',\n\t\t\tprop: 'info',\n\t\t\tinprop: 'watched',\n\t\t\tpageids: ids\n\t\t} ).then( function ( rsp ) {\n\t\t\treturn self._unmarshalGetResponse( rsp );\n\t\t} );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageTitle[]} titles\n\t * @return {JQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetStatusesByTitle: function ( titles ) {\n\t\tvar self = this;\n\t\tif ( !titles.length ) {\n\t\t\treturn util.Deferred().resolve( {} );\n\t\t}\n\n\t\treturn this.api.get( actionParams( {\n\t\t\tprop: 'info',\n\t\t\tinprop: 'watched',\n\t\t\ttitles: titles\n\t\t} ) ).then( function ( rsp ) {\n\t\t\treturn self._unmarshalGetResponse( rsp );\n\t\t} );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageTitle[]} titles\n\t * @param {WatchStatus} watched\n\t * @return {JQuery.Deferred}\n\t */\n\tpostStatusesByTitle: function ( titles, watched ) {\n\t\tvar params = {\n\t\t\taction: 'watch',\n\t\t\ttitles: titles\n\t\t};\n\t\tif ( !watched ) {\n\t\t\tparams.unwatch = !watched;\n\t\t}\n\t\treturn this.api.postWithToken( 'watch', params );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {Object} rsp The API:Info response.\n\t * @return {JQuery.Deferred<WatchStatusMap>}\n\t * @see getStatusesByID\n\t * @see getStatusesByTitle\n\t */\n\t_unmarshalGetResponse: function ( rsp ) {\n\t\tvar pages = rsp && rsp.query && rsp.query.pages || [];\n\t\treturn pages.reduce( function ( statuses, page ) {\n\t\t\tstatuses[page.title] = page.watched;\n\t\t\treturn statuses;\n\t\t}, {} );\n\t}\n};\n\nmodule.exports = WatchstarGateway;\n","var PageList = require( '../PageList' ),\n\tWatchstar = require( './Watchstar' ),\n\tuser = mw.user,\n\tutil = require( '../util' ),\n\tPage = require( '../Page' ),\n\tmfExtend = require( '../mfExtend' ),\n\tWatchstarGateway = require( './WatchstarGateway' );\n\n/**\n * @typedef {Object.<PageTitle, PageID>} PageTitleToPageIDMap\n */\n\n/**\n * List of items page view\n * @class WatchstarPageList\n * @uses Page\n * @uses WatchstarGateway\n * @uses Watchstar\n * @extends PageList\n *\n * @fires WatchstarPageList#unwatch\n * @fires WatchstarPageList#watch\n * @param {Object} options Configuration options\n */\nfunction WatchstarPageList( options ) {\n\tthis.wsGateway = new WatchstarGateway( options.api );\n\tPageList.apply( this, arguments );\n}\n\nmfExtend( WatchstarPageList, PageList, {\n\t/**\n\t * @memberof WatchstarPageList\n\t * @instance\n\t * @mixes PageList#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {mw.Api} defaults.api\n\t */\n\n\tpostRender: function () {\n\t\tvar\n\t\t\tself = this,\n\t\t\t$items,\n\t\t\tpages,\n\t\t\tids = [],\n\t\t\ttitles = [];\n\n\t\tPageList.prototype.postRender.apply( this );\n\n\t\t$items = this.queryUnitializedItems();\n\t\tpages = this.parsePagesFromItems( $items );\n\n\t\tObject.keys( pages ).forEach( function ( title ) {\n\t\t\tvar id = pages[title];\n\t\t\t// Favor IDs since they're short and unlikely to exceed URL length\n\t\t\t// limits when batched.\n\t\t\tif ( id && id !== '0' ) {\n\t\t\t\t// ID is present and valid.\n\t\t\t\tids.push( id );\n\t\t\t} else {\n\t\t\t\t// Only titles are available for missing pages.\n\t\t\t\ttitles.push( title );\n\t\t\t}\n\t\t} );\n\n\t\treturn this.getPages( ids, titles ).then( function ( statuses ) {\n\t\t\tself.renderItems( $items, statuses );\n\t\t} );\n\t},\n\n\t/**\n\t * @param {JQuery.Element} $items\n\t * @param {WatchStatusMap} statuses\n\t * @return {void}\n\t */\n\tqueryUnitializedItems: function () {\n\t\treturn this.$( 'li:not(.with-watchstar)' );\n\t},\n\n\t/**\n\t * Retrieve pages\n\t *\n\t * @memberof WatchstarPageList\n\t * @instance\n\t * @param {PageID[]} ids\n\t * @param {PageTitle[]} titles\n\t * @return {JQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetPages: function ( ids, titles ) {\n\t\t// Rendering Watchstars for anonymous users is not useful. Short-circuit\n\t\t// the request.\n\t\tif ( user.isAnon() ) {\n\t\t\treturn util.Deferred().resolve( {} );\n\t\t}\n\n\t\treturn this.wsGateway.getStatuses( ids, titles );\n\t},\n\n\t/**\n\t * @param {JQuery.Element} $items\n\t * @return {PageTitleToPageIDMap}\n\t * @memberof WatchstarPageList\n\t * @instance\n\t */\n\tparsePagesFromItems: function ( $items ) {\n\t\tvar\n\t\t\tself = this,\n\t\t\tpages = {};\n\t\t$items.each( function ( _, item ) {\n\t\t\tvar $item = self.$( item );\n\t\t\tpages[ $item.attr( 'title' ) ] = $item.data( 'id' );\n\t\t} );\n\t\treturn pages;\n\t},\n\n\t/**\n\t * @param {JQuery.Element} $items\n\t * @param {WatchStatusMap} statuses\n\t * @return {void}\n\t */\n\trenderItems: function ( $items, statuses ) {\n\t\tvar self = this;\n\n\t\t// Rendering Watchstars for anonymous users is not useful. Nothing to do.\n\t\tif ( user.isAnon() ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Create watch stars for each entry in list\n\t\t$items.each( function ( _, item ) {\n\t\t\tvar\n\t\t\t\t$item = self.$( item ),\n\t\t\t\tpage = new Page( {\n\t\t\t\t\t// FIXME: Set sections so we don't hit the api (hacky)\n\t\t\t\t\tsections: [],\n\t\t\t\t\ttitle: $item.attr( 'title' ),\n\t\t\t\t\tid: $item.data( 'id' )\n\t\t\t\t} ),\n\t\t\t\tel = self.parseHTML( '<div>' ).appendTo( $item ),\n\t\t\t\twatched = statuses[ page.getTitle() ];\n\n\t\t\tself._appendWatchstar( el, page, watched );\n\t\t\t$item.addClass( 'with-watchstar' );\n\t\t} );\n\t},\n\n\t/**\n\t * @param {HTMLElement} el\n\t * @param {Page} page\n\t * @param {WatchStatus} watched\n\t * @return {Watchstar}\n\t */\n\t_appendWatchstar: function ( el, page, watched ) {\n\t\tvar watchstar = new Watchstar( {\n\t\t\tapi: this.options.api,\n\t\t\tfunnel: this.options.funnel,\n\t\t\tisAnon: user.isAnon(),\n\t\t\t// WatchstarPageList.getPages() already retrieved the status of\n\t\t\t// each page. Explicitly set the watch state so another request\n\t\t\t// will not be issued by the Watchstar.\n\t\t\tisWatched: watched,\n\t\t\tpage: page,\n\t\t\tel: el\n\t\t} );\n\n\t\t/**\n\t\t * @event watch\n\t\t * Fired when an article in the PageList is watched.\n\t\t */\n\t\tutil.repeatEvent( watchstar, this, 'watch' );\n\n\t\t/**\n\t\t * @event unwatch\n\t\t * Fired when an article in the PageList is watched.\n\t\t */\n\t\tutil.repeatEvent( watchstar, this, 'unwatch' );\n\n\t\treturn watchstar;\n\t}\n} );\n\nmodule.exports = WatchstarPageList;\n","var\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tLanguageOverlay,\n\tsandbox,\n\tapiLanguages = [\n\t\t{\n\t\t\tlang: 'ar',\n\t\t\turl: 'https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7',\n\t\t\ttitle: 'باراك أوباما',\n\t\t\tautonym: 'العربية'\n\t\t}, {\n\t\t\tlang: 'be',\n\t\t\turl: 'https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\ttitle: 'Барак Абама',\n\t\t\tautonym: 'беларуская'\n\t\t}, {\n\t\t\tlang: 'be-x-old',\n\t\t\turl: 'https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\ttitle: 'Барак Абама',\n\t\t\tautonym: 'беларуская (тарашкевіца)'\n\t\t}, {\n\t\t\tlang: 'ko',\n\t\t\turl: 'https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88',\n\t\t\ttitle: '버락 오바마',\n\t\t\tautonym: '한국어'\n\t\t}, {\n\t\t\tlang: 'ru',\n\t\t\turl: 'https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA',\n\t\t\ttitle: 'Обама, Барак',\n\t\t\tautonym: 'русский'\n\t\t}, {\n\t\t\tlang: 'uz',\n\t\t\turl: 'https://uz.wikipedia.org/wiki/Barak_Obama',\n\t\t\ttitle: 'Barak Obama',\n\t\t\tautonym: 'oʻzbekcha/ўзбекча'\n\t\t}, {\n\t\t\tlang: 'zh',\n\t\t\turl: 'https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC',\n\t\t\ttitle: '贝拉克·奥巴马',\n\t\t\tautonym: '中文'\n\t\t}, {\n\t\t\tlang: 'zh-min-nan',\n\t\t\turl: 'https://zh-min-nan.wikipedia.org/wiki/Barack_Obama',\n\t\t\ttitle: 'Barack Obama',\n\t\t\tlangname: 'Chinese',\n\t\t\tautonym: 'Bân-lâm-gú'\n\t\t}, {\n\t\t\tlang: 'zh-yue',\n\t\t\turl: 'https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC',\n\t\t\ttitle: '奧巴馬',\n\t\t\tautonym: '粵語'\n\t\t}, {\n\t\t\tlang: 'zu',\n\t\t\turl: 'https://zu.wikipedia.org/wiki/Barack_Obama',\n\t\t\ttitle: 'Barack Obama',\n\t\t\tautonym: 'isiZulu'\n\t\t}\n\t],\n\tdeviceLanguage = 'en-us',\n\tfrequentlyUsedLanguages = {\n\t\t'zh-min-nan': 1,\n\t\tzh: 2,\n\t\ten: 10,\n\t\tko: 1\n\t};\n\nQUnit.module( 'MobileFrontend LanguageOverlay.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\tLanguageOverlay = require( '../../../src/mobile.languages.structured/LanguageOverlay' );\n\n\t\tsandbox.stub( mw.storage, 'get' ).withArgs( 'langMap' )\n\t\t\t.returns( JSON.stringify( frequentlyUsedLanguages ) );\n\n\t\tthis.languageOverlay = new LanguageOverlay( {\n\t\t\tcurrentLanguage: 'en',\n\t\t\tlanguages: apiLanguages,\n\t\t\tvariants: [],\n\t\t\tdeviceLanguage: deviceLanguage\n\t\t} );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'render output', function ( assert ) {\n\tassert.strictEqual(\n\t\tthis.languageOverlay.$( '.site-link-list.suggested-languages a' ).length,\n\t\t3,\n\t\t'There are 3 suggested languages.'\n\t);\n\n\tassert.strictEqual(\n\t\tthis.languageOverlay.$( '.site-link-list.all-languages a' ).length,\n\t\t7,\n\t\t'Seven languages are non-suggested.'\n\t);\n} );\n\nQUnit.test( 'filterLanguages()', function ( assert ) {\n\tthis.languageOverlay.filterLanguages( 'zh' );\n\tassert.strictEqual(\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).length,\n\t\t3,\n\t\t'Three languages match \"zh\" and only those languages are visible.'\n\t);\n\n\tthis.languageOverlay.filterLanguages( 'ol' );\n\tassert.ok(\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).length === 1 &&\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).hasClass( 'be-x-old' ),\n\t\t'One language (be-x-old) matches \"ol\" and only that language is visible.'\n\t);\n\n\tthis.languageOverlay.filterLanguages( 'chin' );\n\tassert.ok(\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).length === 1 &&\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).hasClass( 'zh-min-nan' ),\n\t\t'One language (zh-min-nan) matches \"Chin\" (langname) and only that language is visible.'\n\t);\n\n\tthis.languageOverlay.filterLanguages( '' );\n\tassert.strictEqual(\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).length,\n\t\t10,\n\t\t'The search filter has been cleared. All 10 languages (including variants) are visible.'\n\t);\n\n\tthis.languageOverlay.filterLanguages( 'ўз' );\n\tassert.strictEqual(\n\t\tthis.languageOverlay.$( '.site-link-list a:not(.hidden)' ).length,\n\t\t1,\n\t\t'One language matches \"ўз\" and only that language is visible.'\n\t);\n} );\n","var\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tsinon = require( 'sinon' ),\n\tutil,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend mobile.languages.structured/util.test.js', {\n\tbeforeEach: function () {\n\t\tthis.apiLanguages = [\n\t\t\t{\n\t\t\t\tlang: 'ar',\n\t\t\t\turl: 'https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7',\n\t\t\t\ttitle: 'باراك أوباما',\n\t\t\t\tdir: 'rtl',\n\t\t\t\tautonym: 'العربية'\n\t\t\t}, {\n\t\t\t\tlang: 'be',\n\t\t\t\turl: 'https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\t\ttitle: 'Барак Абама',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'беларуская'\n\t\t\t}, {\n\t\t\t\tlang: 'be-x-old',\n\t\t\t\turl: 'https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\t\ttitle: 'Барак Абама',\n\t\t\t\tautonym: 'беларуская (тарашкевіца)'\n\t\t\t}, {\n\t\t\t\tlang: 'es',\n\t\t\t\turl: 'https://en.wikipedia.org/wiki/Barack_Obama',\n\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'Spanish'\n\t\t\t}, {\n\t\t\t\tlang: 'ko',\n\t\t\t\turl: 'https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88',\n\t\t\t\ttitle: '버락 오바마',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: '한국어'\n\t\t\t}, {\n\t\t\t\tlang: 'ru',\n\t\t\t\turl: 'https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA',\n\t\t\t\ttitle: 'Обама, Барак',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'русский'\n\t\t\t}, {\n\t\t\t\tlang: 'uz',\n\t\t\t\turl: 'https://uz.wikipedia.org/wiki/Barak_Obama',\n\t\t\t\ttitle: 'Barak Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'oʻzbekcha/ўзбекча'\n\t\t\t}, {\n\t\t\t\tlang: 'zh',\n\t\t\t\turl: 'https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC',\n\t\t\t\ttitle: '贝拉克·奥巴马',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: '中文'\n\t\t\t}, {\n\t\t\t\tlang: 'zh-min-nan',\n\t\t\t\turl: 'https://zh-min-nan.wikipedia.org/wiki/Barack_Obama',\n\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'Bân-lâm-gú'\n\t\t\t}, {\n\t\t\t\tlang: 'zh-yue',\n\t\t\t\turl: 'https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC',\n\t\t\t\ttitle: '奧巴馬',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: '粵語'\n\t\t\t}, {\n\t\t\t\tlang: 'zu',\n\t\t\t\turl: 'https://zu.wikipedia.org/wiki/Barack_Obama',\n\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'isiZulu'\n\t\t\t}\n\t\t];\n\t\tthis.apiVariants = [ {\n\t\t\tautonym: '不转换',\n\t\t\tlang: 'zh',\n\t\t\turl: '/~bmansurov/mediawiki/index.php/3?variant=zh'\n\t\t}, {\n\t\t\tautonym: '简体',\n\t\t\tlang: 'zh-hans',\n\t\t\turl: '/~bmansurov/mediawiki/index.php/3?variant=zh-hans'\n\t\t} ];\n\n\t\tthis.deviceLanguage = 'en-us';\n\n\t\tthis.frequentlyUsedLanguages = {\n\t\t\tzh: 2,\n\t\t\tko: 1\n\t\t};\n\n\t\tthis.structuredLanguages = {\n\t\t\tall: [\n\t\t\t\t{\n\t\t\t\t\tlang: 'zh-min-nan',\n\t\t\t\t\tautonym: 'Bân-lâm-gú',\n\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zh-min-nan.wikipedia.org/wiki/Barack_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'zu',\n\t\t\t\t\tautonym: 'isiZulu',\n\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zu.wikipedia.org/wiki/Barack_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'uz',\n\t\t\t\t\tautonym: 'oʻzbekcha/ўзбекча',\n\t\t\t\t\ttitle: 'Barak Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://uz.wikipedia.org/wiki/Barak_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'es',\n\t\t\t\t\tautonym: 'Spanish',\n\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://en.wikipedia.org/wiki/Barack_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'be',\n\t\t\t\t\tautonym: 'беларуская',\n\t\t\t\t\ttitle: 'Барак Абама',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'be-x-old',\n\t\t\t\t\tautonym: 'беларуская (тарашкевіца)',\n\t\t\t\t\ttitle: 'Барак Абама',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'ru',\n\t\t\t\t\tautonym: 'русский',\n\t\t\t\t\ttitle: 'Обама, Барак',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'ar',\n\t\t\t\t\tautonym: 'العربية',\n\t\t\t\t\ttitle: 'باراك أوباما',\n\t\t\t\t\tdir: 'rtl',\n\t\t\t\t\turl: 'https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'zh-yue',\n\t\t\t\t\tautonym: '粵語',\n\t\t\t\t\ttitle: '奧巴馬',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC'\n\t\t\t\t}\n\t\t\t],\n\t\t\tsuggested: [\n\t\t\t\t{\n\t\t\t\t\tfrequency: 2,\n\t\t\t\t\tlang: 'zh',\n\t\t\t\t\tautonym: '中文',\n\t\t\t\t\ttitle: '贝拉克·奥巴马',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfrequency: 1,\n\t\t\t\t\tlang: 'ko',\n\t\t\t\t\tautonym: '한국어',\n\t\t\t\t\ttitle: '버락 오바마',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tsandbox.stub( mw.storage, 'get' ).withArgs( 'langMap' )\n\t\t\t.returns( JSON.stringify( this.frequentlyUsedLanguages ) );\n\n\t\tutil = require( '../../../src/mobile.languages.structured/util' );\n\n\t\tthis.saveSpy = sandbox.stub( util, 'saveFrequentlyUsedLanguages' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getFrequentlyUsedLanguages', function ( assert ) {\n\n\tassert.deepEqual( util.getFrequentlyUsedLanguages(), this.frequentlyUsedLanguages,\n\t\t'Frequently used languages is correct.' );\n} );\n\nQUnit.test( '#saveLanguageUsageCount', function ( assert ) {\n\tutil.saveLanguageUsageCount( 'ko', util.getFrequentlyUsedLanguages() );\n\tassert.ok( this.saveSpy.calledWith( {\n\t\tzh: 2,\n\t\tko: 2\n\t} ), 'Frequently used language is correctly saved.' );\n} );\n\nQUnit.test( '#getStructuredLanguages', function ( assert ) {\n\tvar result = util.getStructuredLanguages(\n\t\tthis.apiLanguages, false, this.frequentlyUsedLanguages, this.deviceLanguage\n\t);\n\n\tassert.deepEqual(\n\t\tresult,\n\t\tthis.structuredLanguages,\n\t\t'Structured languages are correct, including sort order.'\n\t);\n} );\n\nQUnit.test( '#getStructuredLanguages device language', function ( assert ) {\n\tvar result =\n\t\tutil.getStructuredLanguages( this.apiLanguages, false, {}, 'es-lx' ).suggested[0].lang;\n\n\t// device language is a variant and only the parent language is available\n\tassert.strictEqual(\n\t\tresult,\n\t\t'es',\n\t\t'\"es\" is correctly selected as a suggested language even though the device language is \"es-lx\".'\n\t);\n} );\n\nQUnit.test( '#getStructuredLanguages variants', function ( assert ) {\n\tvar suggestedLanguages,\n\t\tvariantsMap = {};\n\n\tsuggestedLanguages = util.getStructuredLanguages(\n\t\tthis.apiLanguages, this.apiVariants, {}, this.deviceLanguage\n\t).suggested;\n\tthis.apiVariants.forEach( function ( variant ) {\n\t\tvariantsMap[ variant.lang ] = variant;\n\t} );\n\tsuggestedLanguages.forEach( function ( suggestedLanguage ) {\n\t\tassert.ok(\n\t\t\tObject.prototype.hasOwnProperty.call( variantsMap, suggestedLanguage.lang ),\n\t\t\t'Variant \"' + suggestedLanguage.lang + '\" is in the list of suggested languages.'\n\t\t);\n\t} );\n} );\n","var sandbox, ImageGateway, findSizeBucket,\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tutil = require( '../../../src/mobile.startup/util' );\n\nQUnit.module( 'MobileFrontend mobile.mediaViewer/ImageGateway', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tImageGateway = require( '../../../src/mobile.mediaViewer/ImageGateway' );\n\t\tfindSizeBucket = ImageGateway._findSizeBucket;\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#findSizeBucket', function ( assert ) {\n\tassert.strictEqual( findSizeBucket( 300 ), 320, 'value lower than bucket' );\n\tassert.strictEqual( findSizeBucket( 800 ), 800, 'exact value' );\n\tassert.strictEqual( findSizeBucket( 9999 ), 2880, 'value greater than last bucket' );\n} );\n\nQUnit.test( 'ImageGateway#getThumb (missing page)', function ( assert ) {\n\tvar gateway,\n\t\tapi = {\n\t\t\tget: function () {\n\t\t\t\treturn util.Deferred().resolve( {\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tpages: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: 'Hello',\n\t\t\t\t\t\t\t\tmissing: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\tgateway = new ImageGateway( { api: api } );\n\tassert.rejects(\n\t\tgateway.getThumb( 'Missing' ),\n\t\tfunction ( err ) {\n\t\t\treturn err.message.indexOf( 'The API failed' ) !== -1;\n\t\t},\n\t\t'A missing page throws an error which the client must handle'\n\t);\n} );\n","var sandbox, ImageOverlay,\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend mobile.mediaViewer/ImageOverlay', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tImageOverlay = require( '../../../src/mobile.mediaViewer/ImageOverlay' );\n\n\t\tthis.image = {\n\t\t\tdescriptionurl: 'https://commons.wikimedia.org/wiki/File:The_Montgomery,_San_Francisco.jpg',\n\t\t\tthumbheight: 1024,\n\t\t\tthumburl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/676px-The_Montgomery%2C_San_Francisco.jpg',\n\t\t\tthumbwidth: 676,\n\t\t\turl: 'https://upload.wikimedia.org/wikipedia/commons/b/b1/The_Montgomery%2C_San_Francisco.jpg'\n\t\t};\n\t\tthis.imageGateway = {\n\t\t\tgetThumb: function () {\n\t\t\t\treturn util.Deferred().resolve( {\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tpages: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\timageinfo: [ this.image ]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t\tthis.router = {\n\t\t\tgetPath: function () {\n\t\t\t\treturn '/media/File%3AA_cursiva.gif';\n\t\t\t}\n\t\t};\n\t\tthis.thumbnails = [\n\t\t\t{\n\t\t\t\tfilename: 'foo',\n\t\t\t\tgetFileName: function () { return ''; },\n\t\t\t\tgetPath: function () { return ''; },\n\t\t\t\tgetDescription: function () { return ''; }\n\t\t\t},\n\t\t\t{\n\t\t\t\tfilename: 'bar',\n\t\t\t\tgetFileName: function () { return ''; },\n\t\t\t\tgetPath: function () { return ''; },\n\t\t\t\tgetDescription: function () { return ''; }\n\t\t\t}\n\t\t];\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Shows details bar and image with successful api response', function ( assert ) {\n\tvar overlay = new ImageOverlay( {\n\t\tgateway: this.imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn this.imageGateway.getThumb().then( function () {\n\t\tassert.strictEqual( overlay.$el.find( 'img' ).length, 1, 'Image is present.' );\n\t\tassert.strictEqual( overlay.$el.find( '.load-fail-msg' ).length, 0, 'Load error msg is not visible' );\n\t\tassert.strictEqual( overlay.$el.find( '.details.is-visible' ).length, 1, 'Details bar present' );\n\t} );\n} );\n\nQUnit.test( 'Shows error message with failed api response', function ( assert ) {\n\tvar overlay, imageGateway = {\n\t\tgetThumb: function () {\n\t\t\treturn util.Deferred().reject( 'Load Error' );\n\t\t}\n\t};\n\n\toverlay = new ImageOverlay( {\n\t\tgateway: imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn imageGateway.getThumb().catch( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.load-fail-msg' ).length, 1, 'Load error msg is visible' );\n\t\tassert.strictEqual( overlay.$el.find( '.details.is-visible' ).length, 0, 'Details bar is hidden' );\n\t} );\n} );\n\nQUnit.test( 'Toggling of details is disabled when overlay has load failure', function ( assert ) {\n\tvar overlay, imageGateway = {\n\t\tgetThumb: function () {\n\t\t\treturn util.Deferred().reject( 'Load Error' );\n\t\t}\n\t};\n\n\toverlay = new ImageOverlay( {\n\t\tgateway: imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\tthumbnails: this.thumbnails,\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn imageGateway.getThumb().catch( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.details.is-visible' ).length, 0, 'Details bar is hidden' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.details' ), 'none', 'Slider buttons are shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.cancel' ), 'none', 'Cancel button is still shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.prev' ), 'none', 'Slider buttons are still shown' );\n\n\t\toverlay.$el.find( '.image-wrapper' ).trigger( 'click' );\n\n\t\t// Assert that toggle didn't occur (would add display: none)\n\t\tassert.notStrictEqual( overlay.$el.find( '.details' ), 'none', 'Slider buttons are shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.cancel' ), 'none', 'Cancel button is still shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.prev' ), 'none', 'Slider buttons are still shown' );\n\t} );\n} );\n\nQUnit.test( 'Toggling of details is enabled when overlay loads successfully', function ( assert ) {\n\tvar overlay = new ImageOverlay( {\n\t\tgateway: this.imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\tthumbnails: this.thumbnails,\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn this.imageGateway.getThumb().then( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.details.is-visible' ).length, 1, 'Details bar is shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.details' ).css( 'display' ), 'none', 'Ensure display none rule is not set' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.cancel' ).css( 'display' ), 'none', 'Cancel button is shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.prev' ).css( 'display' ), 'none', 'Slider buttons are shown' );\n\n\t\toverlay.$el.find( '.image-wrapper' ).trigger( 'click' );\n\n\t\tassert.strictEqual( overlay.$el.find( '.details' ).css( 'display' ), 'none', 'Details bar is hidden' );\n\t\tassert.strictEqual( overlay.$el.find( '.cancel' ).css( 'display' ), 'none', 'Cancel button is hidden' );\n\t\tassert.strictEqual( overlay.$el.find( '.slider-button' ).css( 'display' ), 'none', 'Slider buttons are hidden' );\n\t} );\n} );\n","var\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tWatchList,\n\tIcon,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend WatchList.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\tthis.spy = sandbox.stub( mw.Api.prototype, 'get' );\n\t\tsandbox.stub( mw.user, 'isAnon' ).returns( false );\n\n\t\tWatchList = require( '../../../src/mobile.special.watchlist.scripts/WatchList' );\n\t\tIcon = require( '../../../src/mobile.startup/Icon' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'In watched mode', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tspy = this.spy,\n\t\tpl = new WatchList( {\n\t\t\teventBus: {\n\t\t\t\ton: function () {},\n\t\t\t\toff: function () {}\n\t\t\t},\n\t\t\tapi: new mw.Api(),\n\t\t\tpages: [\n\t\t\t\t{ title: 'Title 30' },\n\t\t\t\t{ title: 'Title 50' },\n\t\t\t\t{\n\t\t\t\t\ttitle: 'Title 60',\n\t\t\t\t\twatched: true\n\t\t\t\t}\n\t\t\t]\n\t\t} ),\n\t\twatchIconName = new Icon( {\n\t\t\tname: 'watched'\n\t\t} ).getGlyphClassName();\n\n\t// Avoid API requests due to scroll events (https://phabricator.wikimedia.org/T116258)\n\tpl.scrollEndEventEmitter.disable();\n\n\t// Wait for an internal API call to happen as a side-effect of construction.\n\twindow.setTimeout( function () {\n\t\tassert.ok( spy.notCalled, 'Callback avoided' );\n\t\tassert.strictEqual( pl.$el.find( '.watch-this-article' ).length, 3, '3 articles have watch stars...' );\n\t\tassert.strictEqual( pl.$el.find( '.' + watchIconName ).length, 3, '...and all are marked as watched.' );\n\t\tdone();\n\t}, 2000 );\n} );\n","var\n\tWatchListGateway,\n\tsandbox,\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tresponse = {\n\t\tcontinue: {\n\t\t\tpageimages: {\n\t\t\t\tpicontinue: 9\n\t\t\t}\n\t\t},\n\t\twarnings: {\n\t\t\tquery: {\n\t\t\t\t'*': 'Formatting of continuation data will be changing soon. To continue using the current formatting, use the \\'rawcontinue\\' parameter. To begin using the new format, pass an empty string for \\'continue\\' in the initial query.'\n\t\t\t}\n\t\t},\n\t\tquery: {\n\t\t\tpages: [\n\t\t\t\t{\n\t\t\t\t\tpageid: 2,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Burrito',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-17T10:06:49Z',\n\t\t\t\t\tlastrevid: 552,\n\t\t\t\t\tlength: 33534\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 3,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Albert Einstein',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-16T17:33:22Z',\n\t\t\t\t\tlastrevid: 4,\n\t\t\t\t\tlength: 19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 9,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Anne Dallas Dudley',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-17T10:00:13Z',\n\t\t\t\t\tlastrevid: 18,\n\t\t\t\t\tlength: 12663\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 10,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-17T10:04:55Z',\n\t\t\t\t\tlastrevid: 546,\n\t\t\t\t\tlength: 373791\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 708,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Functional logic programming',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2015-01-12T13:04:23Z',\n\t\t\t\t\tlastrevid: 1307,\n\t\t\t\t\tlength: 1392,\n\t\t\t\t\tnew: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 720,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Functional programming',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2015-01-12T13:04:35Z',\n\t\t\t\t\tlastrevid: 1319,\n\t\t\t\t\tlength: 54839,\n\t\t\t\t\tnew: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'zzzz',\n\t\t\t\t\tmissing: true,\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en'\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t};\n\nQUnit.module( 'MobileFrontend WatchListGateway.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\t// needed for extendSearchParams to not throw exception about feature not\n\t\t// supporting wikibase descriptions in headless tests\n\t\tsandbox.stub( mw.config, 'get' )\n\t\t\t.withArgs( 'wgMFDisplayWikibaseDescriptions', {} )\n\t\t\t.returns( {\n\t\t\t\twatchlist: true\n\t\t\t} )\n\t\t\t// needed bc Page.js expects this call to return an array\n\t\t\t.withArgs( 'wgMFMobileFormatterHeadings', [ 'h1', 'h2', 'h3', 'h4', 'h5' ] )\n\t\t\t.returns( [ 'h1', 'h2', 'h3', 'h4', 'h5' ] );\n\t\t// needed for browser tests. If not stubbed, Page's newFromJSON() will call\n\t\t// mw.util.getUrl which calls mw.config.get and expects back a value\n\t\tsandbox.stub( mw.util, 'getUrl', function () {} );\n\n\t\tWatchListGateway = require( '../../../src/mobile.special.watchlist.scripts/WatchListGateway' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'loadWatchlist() loads results from the first page', function ( assert ) {\n\tvar gateway = new WatchListGateway( new mw.Api() );\n\n\tsandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( response ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tvar params = mw.Api.prototype.get.firstCall.args[0];\n\n\t\tassert.strictEqual( params.continue, '', 'It should set the continue parameter' );\n\n\t\tassert.strictEqual( pages.length, 7, 'Got all the results' );\n\t\tassert.strictEqual( pages[0].displayTitle, 'Albert Einstein', 'Sorted alphabetically' );\n\t} );\n} );\n\nQUnit.test( 'loadWatchlist() loads results from the second page from last item of first', function ( assert ) {\n\tvar lastTitle = 'Albert Einstein',\n\t\tgateway = new WatchListGateway( new mw.Api(), lastTitle ),\n\t\tresponse1 = util.extend( {}, response, {\n\t\t\tcontinue: {\n\t\t\t\twatchlistraw: {\n\t\t\t\t\tgwrcontinue: '0|Albert Einstein'\n\t\t\t\t}\n\t\t\t}\n\t\t} ),\n\t\tstub;\n\n\t// First time we call the API for the second page\n\tstub = sandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( response1 ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tvar params = mw.Api.prototype.get.firstCall.args[0];\n\n\t\tassert.strictEqual( params.continue, 'gwrcontinue||', 'It should set the continue parameter' );\n\t\tassert.strictEqual( params.gwrcontinue, '0|Albert_Einstein', 'It should set the watchlistraw-specific continue parameter' );\n\n\t\t// Albert Einstein should not be in the results since it was the last\n\t\t// item in the first page.\n\t\tassert.strictEqual( pages.length, 6, 'Should have Albert removed from the results' );\n\t\tassert.strictEqual( pages[0].displayTitle, 'Anne Dallas Dudley', 'First item should be Anne' );\n\n\t\t// Let's call for the next page\n\t\tstub.returns( util.Deferred().resolve( response ) );\n\n\t\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\t\t// Albert Einstein should be the first result of the next page (not removed)\n\t\t\tassert.strictEqual( pages.length, 7, 'Albert should be in the results' );\n\t\t\tassert.strictEqual( pages[0].displayTitle, 'Albert Einstein', 'First item should be Albert' );\n\t\t} );\n\t} );\n} );\n\nQUnit.test( 'loadWatchlist() doesn\\'t throw an error when no pages are returned', function ( assert ) {\n\tvar gateway = new WatchListGateway( new mw.Api() );\n\n\tsandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( {\n\t\t\tbatchcomplete: ''\n\t\t} ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tassert.deepEqual( pages, [] );\n\t} );\n} );\n\nQUnit.test( 'loadWatchlist() marks pages as new if necessary', function ( assert ) {\n\tvar gateway = new WatchListGateway( new mw.Api() );\n\n\tsandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( response ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tassert.strictEqual( pages[0].isMissing, false, 'Albert Einstein page isn\\'t marked as new' );\n\t\tassert.strictEqual( pages[6].isMissing, true, 'zzzz page is marked as new' );\n\t} );\n} );\n","/* global $ */\nvar\n\tBrowser = require( '../../../src/mobile.startup/Browser' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tsinon = require( 'sinon' ),\n\tmediawiki = require( '../utils/mw' ),\n\t$html;\n/** @type {sinon.SinonSandbox} */ var sandbox; // eslint-disable-line one-var\n\nQUnit.module( 'MobileFrontend Browser.js', {\n\tbeforeEach: function () {\n\t\tvar tmpDOM;\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\t// Use an empty html element to avoid calling methods in _fixIosLandscapeBug\n\t\ttmpDOM = window.document.implementation.createHTMLDocument( 'Test' );\n\t\t$html = $( tmpDOM );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'isIos()', function ( assert ) {\n\tvar browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tbrowser4 = new Browser( 'Mozilla/5.0 (iPad; CPU OS 4_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tbrowser5 = new Browser( 'Mozilla/5.0 (iPad; CPU OS 5_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tbrowser2 = new Browser( 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53', $html );\n\n\tassert.strictEqual( browser.isIos(), true );\n\tassert.strictEqual( browser.isIos( 8 ), false );\n\tassert.strictEqual( browser.isIos( 4 ), false );\n\tassert.strictEqual( browser.isIos( 5 ), false );\n\tassert.strictEqual( browser2.isIos(), true );\n\tassert.strictEqual( browser2.isIos( 8 ), true );\n\tassert.strictEqual( browser4.isIos( 4 ), true );\n\tassert.strictEqual( browser5.isIos( 5 ), true );\n} );\n\nQUnit.test( 'Methods are cached', function ( assert ) {\n\tvar ipad = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tiphone = new Browser( 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53', $html ),\n\t\tandroid2 = new Browser( 'Android 2', $html );\n\n\tfunction cache( obj, method ) {\n\t\treturn obj[ '__cache' + obj[ method ].cacheId ];\n\t}\n\n\t// Check that the same methods across different instances have their own\n\t// cache and don't interfere with one another\n\tassert.strictEqual( ipad.isIos(), true );\n\tassert.strictEqual( ipad.isIos( 8 ), false );\n\tassert.strictEqual( android2.isIos( 8 ), false );\n\tassert.strictEqual( iphone.isIos(), true );\n\tassert.strictEqual( iphone.isIos( 8 ), true );\n\n\t// Check that the caches have been filled\n\tassert.strictEqual( Object.keys( cache( ipad, 'isIos' ) ).length, 2, 'isIos on ipad cached as expected' );\n\tassert.strictEqual( Object.keys( cache( android2, 'isIos' ) ).length, 1, 'isIos on android cached as expected' );\n\tassert.strictEqual( Object.keys( cache( iphone, 'isIos' ) ).length, 2, 'isIos on iphone cached as expected' );\n} );\n\nQUnit.test( 'lockViewport()', function ( assert ) {\n\tvar browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tviewportTag,\n\t\tviewportTagVal;\n\tbrowser.$el.find( 'head' ).append( '<meta name=\"viewport\"/>' );\n\tbrowser.lockViewport();\n\tviewportTag = browser.$el.find( 'meta[name=\"viewport\"]' );\n\tviewportTagVal = viewportTag.attr( 'content' );\n\tassert.strictEqual( viewportTagVal, 'initial-scale=1.0, maximum-scale=1.0, user-scalable=no' );\n} );\n\nQUnit.test( 'isWideScreen()', function ( assert ) {\n\tvar browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html );\n\tsandbox.stub( mw.config, 'get', function () {\n\t\treturn '720px';\n\t} );\n\tassert.strictEqual( browser.isWideScreen(), true );\n} );\n\nQUnit.test( 'supportsAnimations() - true', function ( assert ) {\n\tvar\n\t\tbrowser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tstub = sandbox.stub( document, 'createElement', function () {\n\t\t\treturn {\n\t\t\t\tstyle: {\n\t\t\t\t\tanimationName: '',\n\t\t\t\t\ttransform: '',\n\t\t\t\t\ttransition: ''\n\t\t\t\t}\n\t\t\t};\n\t\t} ),\n\t\tresult;\n\n\t// Browser QUnit depends on a non-stubbed version of document.createElement\n\t// when showing the test result in the browser so we need to save the returned\n\t// value in an intermediate variable and manually restore the stub here before\n\t// calling assert.strictEqual\n\tresult = browser.supportsAnimations();\n\tstub.restore();\n\n\tassert.strictEqual( result, true );\n} );\n\nQUnit.test( 'supportsAnimations() - false', function ( assert ) {\n\tvar\n\t\tbrowser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tstub = sandbox.stub( document, 'createElement', function () {\n\t\t\treturn {\n\t\t\t\tstyle: {}\n\t\t\t};\n\t\t} ),\n\t\tresult;\n\n\t// Browser QUnit depends on a non-stubbed version of document.createElement\n\t// when showing the test result in the browser so we need to save the returned\n\t// value in an intermediate variable and manually restore the stub here before\n\t// calling assert.strictEqual\n\tresult = browser.supportsAnimations();\n\tstub.restore();\n\n\tassert.strictEqual( result, false );\n} );\n\nQUnit.test( 'supportsTouchEvents()', function ( assert ) {\n\tvar browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html );\n\twindow.ontouchstart = window.ontouchstart || undefined;\n\tassert.strictEqual( browser.supportsTouchEvents(), true );\n} );\n\nQUnit.test( 'supportsGeoLocation()', function ( assert ) {\n\tvar browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html );\n\twindow.navigator.geolocation = window.navigator.geolocation || undefined;\n\tassert.strictEqual( browser.supportsGeoLocation(), true );\n} );\n","var\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tButton,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend Button.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tButton = require( '../../../src/mobile.startup/Button' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'creates a link if passed href option', function ( assert ) {\n\tvar\n\t\turl = 'https://www.foo.com',\n\t\tbutton = new Button( {\n\t\t\thref: url\n\t\t} );\n\n\tassert.strictEqual( button.$el[0].tagName, 'A' );\n\tassert.strictEqual( button.$el[0].getAttribute( 'href' ), 'https://www.foo.com' );\n} );\n\nQUnit.test( 'does not add href attribute when not a link', function ( assert ) {\n\tvar button = new Button( {\n\t\ttagName: 'div'\n\t} );\n\n\tassert.strictEqual( button.$el[0].tagName, 'DIV' );\n\tassert.strictEqual( button.$el[0].href, undefined );\n} );\n","/* eslint-env es6 */\nmodule.exports = {\n\tdefaultURLs: `\n\t\t<div class=\" drawer position-fixed view-border-box \">\n\t\t\t<div\n\t\t\t\tclass=\" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel \"\n\t\t\t\ttitle=\"\"\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=\" logIn \" class=\" mw-ui-button mw-ui-progressive \">\n\t\t\t\tLog in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=\" signUp \" class=\" mw-ui-anchor mw-ui-progressive \">\n\t\t\t\t\tSign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t`,\n\toverrideURLs: `\n\t\t<div class=\" drawer position-fixed view-border-box \">\n\t\t\t<div\n\t\t\t\tclass=\" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel \"\n\t\t\t\ttitle=\"\"\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=\" customLogIn \" class=\" mw-ui-button mw-ui-progressive \">\n\t\t\t\tcustom log in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=\" customSignUp \" class=\" mw-ui-anchor mw-ui-progressive \">\n\t\t\t\t\tcustom sign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","var\n\t// Imports\n\tCtaDrawer,\n\tdom = require( '../utils/dom' ),\n\tAnchor,\n\tButton,\n\tDrawer,\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsandbox,\n\tsinon = require( 'sinon' ),\n\n\t// Variables\n\tparent;\n\nQUnit.module( 'MobileFrontend CtaDrawer.js', {\n\tbeforeEach: function () {\n\t\tvar parentID = 'ctaDrawerParent';\n\n\t\tsandbox = sinon.sandbox.create();\n\n\t\t// Set up required by all Views.\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\t// Additional CtaDrawer global dependency.\n\t\tmw.setUp( sandbox, global );\n\n\t\t// Force consistent messaging between Special:JavaScriptTest and Node.js.\n\t\tsandbox.stub( global.mw, 'msg', function ( id ) {\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'mobile-frontend-watchlist-cta-button-login': return 'Log in';\n\t\t\t\tcase 'mobile-frontend-watchlist-cta-button-signup': return 'Sign up';\n\t\t\t}\n\t\t\treturn id;\n\t\t} );\n\t\tsandbox.stub( global.mw.util, 'getUrl', function ( pageName, params ) {\n\t\t\treturn params.type ? 'signUp' : 'logIn';\n\t\t} );\n\n\t\t// Dynamically import Views to use fresh sandboxed dependencies.\n\t\tAnchor = require( '../../../src/mobile.startup/Anchor' );\n\t\tButton = require( '../../../src/mobile.startup/Button' );\n\t\tDrawer = require( '../../../src/mobile.startup/Drawer' );\n\t\tCtaDrawer = require( '../../../src/mobile.startup/CtaDrawer' );\n\n\t\t// Rewire the prototype, not the instance, since this property is used during construction.\n\t\tsandbox.stub( Drawer.prototype, 'appendToElement', '#' + parentID );\n\n\t\t// Create a disposable host Element. See T209129.\n\t\tparent = document.createElement( 'div' );\n\t\tparent.id = parentID;\n\t\tdocument.documentElement.appendChild( parent );\n\t},\n\n\tafterEach: function () {\n\t\t// Discard host Element.\n\t\tdocument.documentElement.removeChild( parent );\n\t\tparent = undefined;\n\n\t\tCtaDrawer = undefined;\n\t\tDrawer = undefined;\n\t\tButton = undefined;\n\t\tAnchor = undefined;\n\n\t\tjQuery.tearDown();\n\n\t\tsandbox.restore();\n\t}\n}, function () {\n\tQUnit.module( 'redirectParams()', function () {\n\t\tQUnit.test( 'empty props, default URL', function ( assert ) {\n\t\t\tvar subject = CtaDrawer.prototype.test.redirectParams;\n\t\t\tsandbox.stub( global.mw.config, 'get', function () {\n\t\t\t\treturn 'pageName';\n\t\t\t} );\n\t\t\tassert.propEqual( subject( {} ), { returnto: 'pageName' } );\n\t\t} );\n\n\t\tQUnit.test( 'empty props, nondefault URL', function ( assert ) {\n\t\t\tvar subject = CtaDrawer.prototype.test.redirectParams;\n\t\t\tassert.propEqual( subject( {}, 'url' ), { returnto: 'url' } );\n\t\t} );\n\n\t\tQUnit.test( 'nonempty props', function ( assert ) {\n\t\t\tvar subject = CtaDrawer.prototype.test.redirectParams;\n\t\t\tassert.propEqual( subject( { key: 'val' }, 'url' ), {\n\t\t\t\tkey: 'val',\n\t\t\t\treturnto: 'url'\n\t\t\t} );\n\t\t} );\n\t} );\n\n\tQUnit.module( 'signUpParams()', function () {\n\t\tQUnit.test( 'empty props', function ( assert ) {\n\t\t\tvar subject = CtaDrawer.prototype.test.signUpParams;\n\t\t\tassert.propEqual( subject( {} ), { type: 'signup' } );\n\t\t} );\n\n\t\tQUnit.test( 'nonempty props', function ( assert ) {\n\t\t\tvar subject = CtaDrawer.prototype.test.signUpParams;\n\t\t\tassert.propEqual( subject( { key: 'val' } ), {\n\t\t\t\tkey: 'val',\n\t\t\t\ttype: 'signup'\n\t\t\t} );\n\t\t} );\n\t} );\n\n\tQUnit.module( 'HTML', function () {\n\t\tQUnit.test( 'defaults', function ( assert ) {\n\t\t\tvar\n\t\t\t\tsubject = new CtaDrawer(),\n\t\t\t\t// Import the expected HTML as a string and replace spaces with a \\s*. This allows\n\t\t\t\t// the HTML some flexibility in how it's rendered.\n\t\t\t\thtml = new RegExp( require( './CtaDrawer.test.html' ).defaultURLs.replace( /\\s+/g, '\\\\s*' ) );\n\n\t\t\tsinon.assert.match( subject.$el.get( 0 ).outerHTML, html );\n\t\t\tassert.ok( true );\n\t\t} );\n\n\t\tQUnit.test( 'overrides', function ( assert ) {\n\t\t\tvar\n\t\t\t\tsubject = new CtaDrawer( {\n\t\t\t\t\tprogressiveButton: new Button( {\n\t\t\t\t\t\tprogressive: true,\n\t\t\t\t\t\tlabel: 'custom log in',\n\t\t\t\t\t\thref: 'customLogIn'\n\t\t\t\t\t} ).options,\n\t\t\t\t\tactionAnchor: new Anchor( {\n\t\t\t\t\t\tprogressive: true,\n\t\t\t\t\t\tlabel: 'custom sign up',\n\t\t\t\t\t\thref: 'customSignUp'\n\t\t\t\t\t} ).options\n\t\t\t\t} ),\n\t\t\t\thtml = new RegExp( require( './CtaDrawer.test.html' ).overrideURLs.replace( /\\s+/g, '\\\\s*' ) );\n\n\t\t\tsinon.assert.match( subject.$el.get( 0 ).outerHTML, html );\n\t\t\tassert.ok( true );\n\t\t} );\n\t} );\n} );\n","var\n\t// Imports\n\tdom = require( '../utils/dom' ),\n\tDrawer,\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsandbox,\n\tsinon = require( 'sinon' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\n\t// Variables\n\tparent;\n\n// util.docReady() usage appears to be necessary over\n// `document.addEventListener('DOMContentLoaded', ...)` as the latter fires before the subject's\n// internal usage of the former.\n\nQUnit.module( 'MobileFrontend Drawer.js', {\n\tbeforeEach: function () {\n\t\tvar parentID = 'drawerParent';\n\n\t\tsandbox = sinon.sandbox.create();\n\n\t\t// Set up required by all Views.\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\t// Additional Drawer global dependency.\n\t\tmw.setUp( sandbox, global );\n\n\t\t// Dynamically import Drawer to use fresh sandboxed dependencies.\n\t\tDrawer = require( '../../../src/mobile.startup/Drawer' );\n\n\t\t// Rewire the prototype, not the instance, since this property is used during construction.\n\t\tsandbox.stub( Drawer.prototype, 'appendToElement', '#' + parentID );\n\n\t\t// Create a disposable host Element. See T209129.\n\t\tparent = document.createElement( 'div' );\n\t\tparent.id = parentID;\n\t\tdocument.documentElement.appendChild( parent );\n\t},\n\n\tafterEach: function () {\n\t\t// Discard host Element.\n\t\tdocument.documentElement.removeChild( parent );\n\t\tparent = undefined;\n\n\t\tDrawer = undefined;\n\n\t\tjQuery.tearDown();\n\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'appends self to parent when DOM is loaded', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tsubject = new Drawer();\n\n\tutil.docReady( function () {\n\t\tassert.strictEqual( subject.$el.parent().get( 0 ), parent );\n\t\tdone();\n\t} );\n} );\n\nQUnit.test( 'adds class to parent when DOM is loaded', function ( assert ) {\n\tvar done = assert.async();\n\n\tnew Drawer(); // eslint-disable-line no-new\n\tutil.docReady( function () {\n\t\tassert.strictEqual( parent.className, 'has-drawer' );\n\t\tdone();\n\t} );\n} );\n\nQUnit.test( 'consumes clicks', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tevent = new window.Event( 'click' ),\n\t\tsubject = new Drawer();\n\n\tevent.stopPropagation = function () {\n\t\tassert.ok( true );\n\t\tdone();\n\t};\n\tsubject.$el.get( 0 ).dispatchEvent( event );\n} );\n\nQUnit.test( 'visible on show()', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tsubject = new Drawer();\n\n\tsubject.on( 'show', function () {\n\t\tassertVisible();\n\t\tassert.ok( true );\n\t\tdone();\n\t} );\n\n\tsubject.show();\n} );\n\nQUnit.test( 'hidden on hide()', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tsubject = new Drawer();\n\n\tsubject.on( 'hide', function () {\n\t\tassertHidden();\n\t\tassert.ok( true );\n\t\tdone();\n\t} );\n\n\tsubject.hide();\n} );\n\nQUnit.test( 'hidden on click once presented', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tsubject = new Drawer();\n\n\tsubject.on( 'hide', function () {\n\t\tassertHidden();\n\t\tassert.ok( true );\n\t\tdone();\n\t} );\n\n\tcallOnPresented( subject, function () {\n\t\tparent.click();\n\t} );\n\n\tsubject.show();\n} );\n\nQUnit.test( 'hidden on scroll once presented', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tsubject = new Drawer();\n\n\tsubject.on( 'hide', function () {\n\t\tassertHidden();\n\t\tassert.ok( true );\n\t\tdone();\n\t} );\n\n\tcallOnPresented( subject, function () {\n\t\t// https://github.com/jsdom/jsdom/issues/1422\n\t\tvar event = new window.Event( 'scroll', { bubbles: true } );\n\t\tparent.dispatchEvent( event );\n\t} );\n\n\tsubject.show();\n} );\n\nQUnit.test( 'HTML is valid', function ( assert ) {\n\tvar subject = new Drawer();\n\tassert.strictEqual(\n\t\tsubject.$el.get( 0 ).outerHTML, '<div class=\"drawer position-fixed view-border-box\"></div>'\n\t);\n} );\n\n/**\n * @param {Drawer} subject\n * @param {Function} callback\n * @return {void}\n*/\nfunction callOnPresented( subject, callback ) {\n\t// Wait for appearance.\n\tsubject.on( 'show', function () {\n\t\t// Wait for minimum presentation duration to expire.\n\t\tsetTimeout( callback, subject.minHideDelay );\n\t} );\n}\n\nfunction assertVisible() {\n\tsinon.assert.match( parent.className, /.*\\bdrawer-visible\\b.*/ );\n}\n\nfunction assertHidden() {\n\tsinon.assert.match( parent.className, /^((?!\\bdrawer-visible\\b).)*$/ );\n}\n","var\n\tsinon = require( 'sinon' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmfExtend = require( '../../../src/mobile.startup/mfExtend' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tHogan = require( 'hogan.js' ),\n\tOverlay,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend: Overlay.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tOverlay = require( '../../../src/mobile.startup/Overlay' );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// window.scrollTo\n\t\tsandbox.stub( global.window, 'scrollTo' );\n\n\t\t// Create a dummy mw-mf-viewport if none exists\n\t\tif ( !util.getDocument().find( '#mw-mf-viewport' ).length ) {\n\t\t\tthis.$viewport = util.parseHTML( '<div>' ).attr( 'id', 'mw-mf-viewport' ).appendTo( 'body' );\n\t\t}\n\t},\n\tafterEach: function () {\n\t\tif ( this.$viewport ) {\n\t\t\tthis.$viewport.remove();\n\t\t}\n\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Simple overlay', function ( assert ) {\n\tvar overlay = new Overlay( {\n\t\t\theading: '<h2>Overlay Title</h2>'\n\t\t} ),\n\t\theadingNode;\n\n\theadingNode = overlay.$el.find( 'h2:contains(\"Overlay Title\")' );\n\n\tassert.strictEqual( headingNode.length, 1 );\n} );\n\nQUnit.test( 'HTML overlay', function ( assert ) {\n\tvar overlay;\n\n\tfunction TestOverlay() {\n\t\tOverlay.apply( this, arguments );\n\t}\n\n\tmfExtend( TestOverlay, Overlay, {\n\t\ttemplatePartials: util.extend( Overlay.prototype.templatePartials, {\n\t\t\tcontent: Hogan.compile( '<div class=\"content\">YO</div>' )\n\t\t} )\n\t} );\n\toverlay = new TestOverlay( {\n\t\theading: 'Awesome'\n\t} );\n\n\tassert.strictEqual( overlay.$el.find( 'h2' ).html(), 'Awesome' );\n\tassert.strictEqual( overlay.$el.find( '.content' ).text(), 'YO' );\n} );\n\nQUnit.test( 'Close overlay', function ( assert ) {\n\tvar overlay = new Overlay( {\n\t\theading: '<h2>Title</h2>',\n\t\tcontent: 'Text'\n\t} );\n\n\toverlay.show();\n\toverlay.hide();\n\n\tassert.strictEqual( overlay.$el[ 0 ].parentNode, null, 'No longer in DOM' );\n} );\n","/* global $ */\nvar\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tOverlayManager,\n\tfakeRouter,\n\toverlayManager,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend mobile.startup/OverlayManager', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// window.scrollTo\n\t\tsandbox.stub( global.window, 'scrollTo' );\n\n\t\tOverlayManager = require( '../../../src/mobile.startup/OverlayManager' );\n\n\t\tthis.createFakeOverlay = function ( options ) {\n\t\t\tvar fakeOverlay = new OO.EventEmitter();\n\t\t\tfakeOverlay.hasLoadError = false;\n\t\t\tfakeOverlay.show = sandbox.spy();\n\t\t\tfakeOverlay.hide = function () {\n\t\t\t\tthis.emit( 'hide' );\n\t\t\t\treturn true;\n\t\t\t};\n\t\t\tfakeOverlay.$el = $( 'div' );\n\t\t\tsandbox.spy( fakeOverlay, 'hide' );\n\t\t\tutil.extend( fakeOverlay, options );\n\t\t\treturn fakeOverlay;\n\t\t};\n\n\t\tfakeRouter = new OO.EventEmitter();\n\t\tfakeRouter.getPath = sandbox.stub().returns( '' );\n\t\tfakeRouter.back = sandbox.spy();\n\t\tsandbox.stub( mw.loader, 'require' ).withArgs( 'mediawiki.router' ).returns( fakeRouter );\n\t\toverlayManager = new OverlayManager( fakeRouter, 'body' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getSingleton', function ( assert ) {\n\tvar singleton = OverlayManager.getSingleton();\n\tassert.ok( singleton instanceof OverlayManager, 'singleton exists' );\n\tassert.strictEqual( singleton, OverlayManager.getSingleton(), 'same object returned each time' );\n} );\n\nQUnit.test( '#add', function ( assert ) {\n\tvar fakeOverlay = this.createFakeOverlay();\n\n\toverlayManager.add( /^test$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test'\n\t} );\n\n\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show registered overlay' );\n} );\n\nQUnit.test( '#show', function ( assert ) {\n\tvar fakeOverlay = this.createFakeOverlay(),\n\t\tshowSpy = sandbox.spy( overlayManager, '_show' );\n\n\toverlayManager.add( /^showTest$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'showTest'\n\t} );\n\n\tassert.strictEqual( showSpy.callCount, 1, 'OverlayManager.show called on route change' );\n} );\n\nQUnit.test( '#add, with $.Deferred factory', function ( assert ) {\n\tvar deferred = util.Deferred(),\n\t\tfakeOverlay = this.createFakeOverlay();\n\tdeferred.show = sandbox.spy();\n\n\toverlayManager.add( /^foo$/, function () {\n\t\treturn deferred;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'foo'\n\t} );\n\tdeferred.resolve( fakeOverlay );\n\n\treturn deferred.then( function () {\n\t\tassert.notOk( deferred.show.called, 'don\\'t call show on Deferred' );\n\t\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show registered overlay' );\n\t} );\n} );\n\nQUnit.test( '#add, with current path', function ( assert ) {\n\tvar\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tdeferred = util.Deferred();\n\tfakeRouter.getPath = sandbox.stub().returns( 'baha' );\n\n\toverlayManager.add( /^baha$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\n\t// Wait for $.ready because OverlayManager#add() does\n\tutil.docReady( function () {\n\t\tdeferred.resolve();\n\t} );\n\n\treturn deferred.then( function () {\n\t\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show registered overlay' );\n\t} );\n} );\n\nQUnit.test( '#replaceCurrent', function ( assert ) {\n\tvar fakeOverlay = this.createFakeOverlay(),\n\t\tanotherFakeOverlay = this.createFakeOverlay();\n\n\toverlayManager.add( /^test$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test'\n\t} );\n\toverlayManager.replaceCurrent( anotherFakeOverlay );\n\tassert.strictEqual( fakeOverlay.hide.callCount, 1, 'hide overlay' );\n\tassert.strictEqual( anotherFakeOverlay.show.callCount, 1, 'show another overlay' );\n\tfakeRouter.emit( 'route', {\n\t\tpath: ''\n\t} );\n\tassert.strictEqual( anotherFakeOverlay.hide.callCount, 1, 'hide another overlay' );\n} );\n\nQUnit.test( 'route with params', function ( assert ) {\n\tvar\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^sam\\/(\\d+)$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'sam/123'\n\t} );\n\n\tassert.ok( factoryStub.calledWith( '123' ), 'pass params from the route' );\n} );\n\nQUnit.test( 'hide when route changes', function ( assert ) {\n\tvar\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^jon$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'jon'\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: ''\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'jon'\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'other'\n\t} );\n\n\tassert.strictEqual( fakeOverlay.hide.callCount, 2, 'hide overlay' );\n\tassert.ok( fakeOverlay.hide.getCall( 0 ).notCalledWith( true ), 'don\\'t force hide (first)' );\n\tassert.ok( fakeOverlay.hide.getCall( 1 ).notCalledWith( true ), 'don\\'t force hide (second)' );\n} );\n\nQUnit.test( 'go back (change route) if overlay hidden but not by route change', function ( assert ) {\n\tvar\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^joakino$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'joakino'\n\t} );\n\tfakeOverlay.hide();\n\n\tassert.strictEqual( fakeRouter.back.callCount, 1, 'route back' );\n} );\n\nQUnit.test( 'stacked overlays', function ( assert ) {\n\tvar\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay ),\n\t\tparentFakeOverlay = this.createFakeOverlay(),\n\t\tparentFactoryStub = sandbox.stub().returns( parentFakeOverlay );\n\n\toverlayManager.add( /^parent$/, parentFactoryStub );\n\toverlayManager.add( /^child$/, factoryStub );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'parent'\n\t} );\n\tassert.strictEqual( parentFakeOverlay.show.callCount, 1, 'show parent' );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'child'\n\t} );\n\tassert.strictEqual( parentFakeOverlay.hide.callCount, 1, 'hide parent' );\n\tassert.ok( parentFakeOverlay.hide.calledWith( true ), 'hide parent forcefully (no confirmation)' );\n\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show child' );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'parent'\n\t} );\n\tassert.strictEqual( fakeOverlay.hide.callCount, 1, 'hide child' );\n\tassert.strictEqual( parentFakeOverlay.show.callCount, 2, 'show parent again' );\n\n\tassert.strictEqual( parentFactoryStub.callCount, 1, 'create parent only once' );\n} );\n\nQUnit.test( 'prevent route change', function ( assert ) {\n\tvar\n\t\tfakeOverlay = this.createFakeOverlay( {\n\t\t\thide: sandbox.stub().returns( false )\n\t\t} ),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay ),\n\t\tev = {\n\t\t\tpath: '',\n\t\t\tpreventDefault: sandbox.spy()\n\t\t};\n\n\toverlayManager.add( /^rob$/, factoryStub );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'rob'\n\t} );\n\tfakeRouter.emit( 'route', ev );\n\tassert.ok( ev.preventDefault.calledOnce, 'prevent route change' );\n} );\n\nQUnit.test( 'reload failed overlay when navigating to it again from another overlay', function ( assert ) {\n\tvar\n\t\tfailedOverlay = this.createFakeOverlay(),\n\t\tsuccessfulOverlay = this.createFakeOverlay(),\n\t\tfactoryStub,\n\t\tretryOverlayFn;\n\n\tfailedOverlay.hasLoadError = true;\n\tretryOverlayFn = sandbox.stub();\n\tretryOverlayFn.onCall( 0 ).returns( failedOverlay );\n\tretryOverlayFn.onCall( 1 ).returns( successfulOverlay );\n\tfactoryStub = function ( title ) {\n\t\tif ( title === '0' ) {\n\t\t\treturn retryOverlayFn();\n\t\t}\n\n\t\treturn successfulOverlay;\n\t};\n\n\toverlayManager.add( /^test\\/(\\d+)$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack is correct size' );\n\tassert.ok( overlayManager.stack[0].overlay.hasLoadError, 'first overlay has load error' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/1'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 2, 'stack is correct size' );\n\tassert.notOk( overlayManager.stack[0].overlay.hasLoadError, 'second overlay loads successfully' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack decreases when going back to already visited overlay' );\n\tassert.notOk( overlayManager.stack[0].overlay.hasLoadError, 'Failed attempt is not cached and new overlay is loaded' );\n} );\n\nQUnit.test( 'replace overlay when route event path is equal to current path', function ( assert ) {\n\tvar\n\t\tfailedOverlay = this.createFakeOverlay(),\n\t\tsuccessfulOverlay = this.createFakeOverlay(),\n\t\tretryOverlayFn;\n\n\tfailedOverlay.hasLoadError = true;\n\tretryOverlayFn = sandbox.stub();\n\tretryOverlayFn.onCall( 0 ).returns( failedOverlay );\n\tretryOverlayFn.onCall( 1 ).returns( successfulOverlay );\n\n\toverlayManager.add( /^test\\/(\\d+)$/, retryOverlayFn );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack is correct size' );\n\tassert.ok( overlayManager.stack[0].overlay.hasLoadError, 'overlay has load error' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack is correct size (did not increase upon reload)' );\n\tassert.notOk( overlayManager.stack[0].overlay.hasLoadError, 'overlay retry loads successfully' );\n} );\n","var\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\t// These both have heavy dependencies on jQuery so must be loaded later.\n\tPage, util,\n\tsinon = require( 'sinon' ),\n\tPARSER_OUTPUT = '<div class=\"mw-parser-output\">',\n\tMOBILE_TOC = '<div class=\"toc-mobile view-border-box\"><h2></h2><div></div></div>';\n/* eslint-disable one-var */\n/** @type {sinon.SinonSandbox} */ var sandbox;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ var stubPage;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ var mobileTocPage;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ var desktopPage;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ var sectionPage;\n/* eslint-enable one-var */\n\nQUnit.module( 'MobileFrontend Page', {\n\tbeforeEach: function () {\n\t\tvar ambox = function ( text ) {\n\t\t\t\treturn '<div class=\"ambox\">' + text + '</div>';\n\t\t\t},\n\t\t\tsectionHeading = function ( text ) {\n\t\t\t\treturn '<h2 class=\"section-heading\">' + text + '</h2>';\n\t\t\t},\n\t\t\tsectionSubHeading = function ( text, level ) {\n\t\t\t\tvar l = level || 'h3';\n\t\t\t\treturn '<' + l + '>' + text + '</' + l + '>';\n\t\t\t},\n\t\t\tsectionBody = function ( i, html ) {\n\t\t\t\treturn '<div class=\"mf-section-' + i + '\">' + html + '</div>';\n\t\t\t};\n\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\tPage = require( '../../../src/mobile.startup/Page' );\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\n\t\tstubPage = new Page( {\n\t\t\tel: util.parseHTML( PARSER_OUTPUT ).html(\n\t\t\t\t'<p>lead</p>' + ambox( 'a0' )\n\t\t\t)\n\t\t} );\n\t\tmobileTocPage = new Page( {\n\t\t\tel: util.parseHTML( PARSER_OUTPUT ).html(\n\t\t\t\tsectionBody( 0, ambox( 'a0' ) + '<p>lead</p>' + MOBILE_TOC ) +\n\t\t\t\t// section = 1\n\t\t\t\tsectionHeading( '1' ) +\n\t\t\t\tsectionBody( 1,\n\t\t\t\t\tambox( 'a1' ) +\n\t\t\t\t\t// section = 2\n\t\t\t\t\tsectionSubHeading( '1.1' ) +\n\t\t\t\t\tambox( 'a1.1' )\n\t\t\t\t)\n\t\t\t)\n\t\t} );\n\t\tdesktopPage = new Page( {\n\t\t\tel: util.parseHTML( PARSER_OUTPUT ).html(\n\t\t\t\t'<p>lead</p>' +\n\t\t\t\tambox( 'a0' ) +\n\t\t\t\t// section = 1\n\t\t\t\tsectionSubHeading( '1', 'h2' ) +\n\t\t\t\tambox( 'a1' ) +\n\t\t\t\t// section = 2\n\t\t\t\tsectionSubHeading( '1.1' ) +\n\t\t\t\tambox( 'a1.1' )\n\t\t\t)\n\t\t} );\n\t\tsectionPage = new Page( {\n\t\t\tel: util.parseHTML( PARSER_OUTPUT ).html(\n\t\t\t\tsectionBody( 0, '<p>lead</p>' + ambox( 'a0' ) ) +\n\t\t\t\t// section = 1\n\t\t\t\tsectionHeading( '1' ) +\n\t\t\t\tsectionBody( 1,\n\t\t\t\t\tambox( 'a1' ) +\n\t\t\t\t\t// section = 2\n\t\t\t\t\tsectionSubHeading( '1.1' ) +\n\t\t\t\t\tambox( 'a1.1' ) +\n\t\t\t\t\t// section = 3\n\t\t\t\t\tsectionSubHeading( '1.1.1', 'h4' ) +\n\t\t\t\t\tambox( 'a1.1.1' ) +\n\t\t\t\t\t// section = 4\n\t\t\t\t\tsectionSubHeading( '1.1.2', 'h4' ) +\n\t\t\t\t\tambox( 'a1.1.2' ) +\n\t\t\t\t\t// section = 5\n\t\t\t\t\tsectionSubHeading( '1.2' ) +\n\t\t\t\t\tambox( 'a1.1' )\n\t\t\t\t) +\n\t\t\t\t// section = 6\n\t\t\t\tsectionHeading( '2' ) +\n\t\t\t\tsectionBody( 6,\n\t\t\t\t\tambox( 'a2' )\n\t\t\t\t) +\n\t\t\t\t// section 7\n\t\t\t\tsectionHeading( '3' ) +\n\t\t\t\tsectionBody( 7, ambox( 'a3' ) ) +\n\t\t\t\t// section 8\n\t\t\t\tsectionHeading( 'Section with nested Ambox' ) +\n\t\t\t\tsectionBody( 8,\n\t\t\t\t\tambox(\n\t\t\t\t\t\t'<p>nested-ambox-parent,</p>' +\n\t\t\t\t\t\tambox( 'nested-ambox-1,' ) +\n\t\t\t\t\t\tambox( 'nested-ambox-2' )\n\t\t\t\t\t) ) +\n\t\t\t\t// section 9\n\t\t\t\tsectionHeading( 'Sub-section with nested Ambox' ) +\n\t\t\t\t\tsectionBody( 9,\n\t\t\t\t\t\tambox(\n\t\t\t\t\t\t\t'<p>nested-ambox-parent,</p>' +\n\t\t\t\t\t\t\tambox( 'nested-ambox-1,' ) +\n\t\t\t\t\t\t\tambox( 'nested-ambox-2' )\n\t\t\t\t\t\t) +\n\t\t\t\t\t\t// section 10\n\t\t\t\t\t\tsectionSubHeading( 'subsection heading' ) +\n\t\t\t\t\t\t// section 11\n\t\t\t\t\t\tsectionSubHeading( 'Another subsection heading' )\n\t\t\t\t\t)\n\t\t\t) // end .html()\n\t\t} ); // end new Page();\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#findInSectionLead', function ( assert ) {\n\t// check desktop page\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 1, 'a1', 'h2' ],\n\t\t[ 2, 'a1.1', 'h3' ],\n\t\t[ 3, '', 'h4', 'selector does not match', '.foo' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( params, i ) {\n\t\tvar\n\t\t\tsection = params[0],\n\t\t\texpect = params[1],\n\t\t\ttest = params[2],\n\t\t\tselector = params[3] || '.ambox';\n\t\tassert.strictEqual(\n\t\t\tdesktopPage.findChildInSectionLead( section, selector ).text(),\n\t\t\texpect,\n\t\t\t'Found correct text in desktop test ' + i + ' case: ' + test\n\t\t);\n\t} );\n\t// check stub\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 3, '', 'h4', 'selector does not match', '.foo' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( testcase ) {\n\t\tassert.strictEqual(\n\t\t\tstubPage.findChildInSectionLead( testcase[0], testcase[3] || '.ambox' ).text(),\n\t\t\ttestcase[1],\n\t\t\t'Stub: Found correct text in desktop test case:' + testcase[2]\n\t\t);\n\t} );\n\t// check mobile pages with section wrapping\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 1, 'a1', 'h2' ],\n\t\t[ 2, 'a1.1', 'h3' ],\n\t\t[ 3, 'a1.1.1', 'h4' ],\n\t\t[ 3, '', 'h4', 'selector does not match', '.foo' ],\n\t\t[ 7, 'a3', 'h2 later' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( testcase ) {\n\t\tassert.strictEqual(\n\t\t\tsectionPage.findChildInSectionLead( testcase[0], testcase[3] || '.ambox' ).text(),\n\t\t\ttestcase[1],\n\t\t\t'Mobile: Found correct text in test case:' + testcase[2]\n\t\t);\n\t} );\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 1, 'a1', 'h2' ],\n\t\t[ 2, 'a1.1', 'h3' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( testcase ) {\n\t\tassert.strictEqual(\n\t\t\tmobileTocPage.findChildInSectionLead( testcase[0], testcase[3] || '.ambox' ).text(),\n\t\t\ttestcase[1],\n\t\t\t'Mobile with table of contents: Found correct text in test case:' + testcase[2]\n\t\t);\n\t} );\n\n\t[\n\t\t[ 8, '.ambox', 'nested-ambox-parent,nested-ambox-1,nested-ambox-2', 'Nested elements in section' ],\n\t\t[ 9, '.ambox', 'nested-ambox-parent,nested-ambox-1,nested-ambox-2', 'Nested elements in subsection' ]\n\t].forEach( function ( testcase ) {\n\t\tvar result = sectionPage.findChildInSectionLead( testcase[0], testcase[1] );\n\t\tassert.strictEqual(\n\t\t\tresult.not( result.children() ).text(),\n\t\t\ttestcase[2],\n\t\t\t'Mobile: Found correct text in test case:' + testcase[3]\n\t\t);\n\t} );\n\n} );\n\nQUnit.test( '#isMainPage', function ( assert ) {\n\tvar p = new Page( {\n\t\t\ttitle: 'Main Page',\n\t\t\tisMainPage: true\n\t\t} ),\n\t\tp2 = new Page( {\n\t\t\ttitle: 'Foo'\n\t\t} );\n\tassert.strictEqual( p.isMainPage(), true, 'check main page flag is updated' );\n\tassert.strictEqual( p2.isMainPage(), false, 'check not marked as main page' );\n} );\n\nQUnit.test( '#getThumbnails', function ( assert ) {\n\tvar p, textPage, pLegacyUrls, thumbs, pNoViewer, pMetadata, pLazyImages, metadataTable,\n\t\tpLazyImagesTypo, pMetadataNested;\n\n\tp = new Page( {\n\t\tel: util.parseHTML( '<div><a href=\"/wiki/File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t} );\n\ttextPage = new Page( {\n\t\tel: util.parseHTML( '<div></div>' )\n\t} );\n\tpLegacyUrls = new Page( {\n\t\tel: util.parseHTML( '<div><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t} );\n\tthumbs = p.getThumbnails();\n\tpNoViewer = new Page( {\n\t\tel: util.parseHTML( '<div><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box noviewer\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t} );\n\tpMetadata = new Page( {\n\t\tel: util.parseHTML( '<div><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" class=\"metadata\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t} );\n\tpMetadataNested = new Page( {\n\t\tel: util.parseHTML( '<div class=\"noviewer\"><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t} );\n\tpLazyImages = new Page( {\n\t\tel: util.parseHTML( '<div><a href=\"/wiki/File:Design_portal_logo.jpg\" class=\"image\"><span class=\"lazy-image-placeholder\" style=\"width: 28px;height: 28px;\" data-src=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg\" data-alt=\"icon\" data-width=\"28\" data-height=\"28\" data-class=\"noviewer\">&nbsp;</span></a></div>' )\n\t} );\n\tpLazyImagesTypo = new Page( {\n\t\tel: util.parseHTML( '<div><a href=\"/wiki/File:Design_portal_logo.jpg\" class=\"image\"><span class=\"lazy-image-placeholder\" style=\"width: 28px;height: 28px;\" data-src=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg\" data-alt=\"icon\" data-width=\"28\" data-height=\"28\" data-class=\"wot noviewerz bar\">&nbsp;</span></a></div>' )\n\t} );\n\tmetadataTable = new Page( {\n\t\tel: util.parseHTML( '<div><table class=\"plainlinks metadata ambox ambox-content ambox-Unreferenced\" role=\"presentation\"><tr><td class=\"mbox-image\"><div style=\"width:52px\"><a href=\"/wiki/File:Question_book-new.svg\" class=\"image\"><span class=\"lazy-image-placeholder\" style=\"width: 50px;height: 39px;\" data-src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/50px-Question_book-new.svg.png\" data-alt=\"\" data-width=\"50\" data-height=\"39\" data-srcset=\"https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/75px-Question_book-new.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/100px-Question_book-new.svg.png 2x\"> </span></a></div></td></tr></table>' )\n\t} );\n\n\tassert.strictEqual( thumbs.length, 1, 'Found expected number of thumbnails.' );\n\tassert.strictEqual( thumbs[0].getFileName(), 'File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg',\n\t\t'Found expected filename.' );\n\n\tthumbs = textPage.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0, 'This page has no thumbnails.' );\n\n\tthumbs = pLegacyUrls.getThumbnails();\n\tassert.strictEqual( thumbs.length, 1, 'Found expected number of thumbnails.' );\n\tassert.strictEqual( thumbs[0].getFileName(), 'File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg',\n\t\t'Found expected filename.' );\n\n\tthumbs = pNoViewer.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0, 'This page has no thumbnails.' );\n\n\tthumbs = pMetadata.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0, 'This page has no thumbnails.' );\n\n\tthumbs = pMetadataNested.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0,\n\t\t'Images inside a container with the class are not included. Images inside tables for example.' );\n\n\tthumbs = pLazyImages.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0,\n\t\t'Consider whether the class is on an image which has not been lazy loaded.' );\n\n\tthumbs = metadataTable.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0,\n\t\t'Consider whether the lazy loaded image is inside a .metadata container.' );\n\n\tthumbs = pLazyImagesTypo.getThumbnails();\n\tassert.strictEqual( thumbs.length, 1,\n\t\t'Thumbnail found if there is a typo.' );\n} );\n\nQUnit.test( '#getNamespaceId', function ( assert ) {\n\tvar testCases = [\n\t\t[ 'Main Page', 0 ],\n\t\t[ 'San Francisco', 0 ],\n\t\t[ 'San Francisco: Talk:2', 0 ],\n\t\t[ 'San Francisco: The Sequel', 0 ],\n\t\t[ 'Talk:Foo', 1 ],\n\t\t[ 'Project:Bar', 4 ],\n\t\t[ 'User talk:Jon', 3 ],\n\t\t[ 'Special:Nearby', -1 ]\n\t];\n\ttestCases.forEach( function ( tc ) {\n\t\tvar p = new Page( {\n\t\t\ttitle: tc[ 0 ]\n\t\t} );\n\t\tassert.strictEqual( p.getNamespaceId(), tc[ 1 ], 'Check namespace is as expected' );\n\t} );\n} );\n\nQUnit.test( '#isTalkPage', function ( assert ) {\n\tvar testCases = [\n\t\t[ 'Main Page', false ],\n\t\t[ 'San Francisco', false ],\n\t\t[ 'San Francisco: Talk:2', false ],\n\t\t[ 'San Francisco: The Sequel', false ],\n\t\t[ 'Talk:Foo', true ],\n\t\t[ 'Project talk:Bar', true ],\n\t\t[ 'User talk:Jon', true ],\n\t\t[ 'Special:Nearby', false ]\n\t];\n\ttestCases.forEach( function ( tc ) {\n\t\tvar p = new Page( {\n\t\t\ttitle: tc[ 0 ]\n\t\t} );\n\t\tassert.strictEqual( p.isTalkPage(), tc[ 1 ], 'Check test is as expected' );\n\t} );\n} );\n\nQUnit.test( '#isMissing', function ( assert ) {\n\tvar missing, notMissing;\n\tmissing = [\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tid: 0\n\t\t} ),\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tid: 5,\n\t\t\tisMissing: true\n\t\t} ),\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tisMissing: true\n\t\t} )\n\t];\n\tnotMissing = [\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tid: 4\n\t\t} ),\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tid: 4,\n\t\t\tisMissing: false\n\t\t} ),\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tisMissing: false\n\t\t} ),\n\t\tnew Page( {\n\t\t\ttitle: 'Hello',\n\t\t\tid: 0,\n\t\t\tisMissing: false\n\t\t} )\n\t];\n\tmissing.forEach( function ( page, i ) {\n\t\tassert.strictEqual( page.isMissing, true, 'page ' + i + ' is missing' );\n\t} );\n\tnotMissing.forEach( function ( page, i ) {\n\t\tassert.strictEqual( page.isMissing, false, 'page ' + i + ' is not missing' );\n\t} );\n} );\n\nQUnit.test( '#allowsXSS', function ( assert ) {\n\tvar p = new Page( {\n\t\t\ttitle: '<script>alert(\"oops, XSS possible!\");</script>'\n\t\t} ),\n\t\ttitleJSON = [\n\t\t\t{\n\t\t\t\tthumbnail: false,\n\t\t\t\ttitle: '<script>alert(\"oops, XSS possible!\");</script>',\n\t\t\t\tterms: false,\n\t\t\t\ttestDesc: 'Check against XSS in Page.newFromJSON displaytitle (when title set)'\n\t\t\t},\n\t\t\t{\n\t\t\t\tthumbnail: false,\n\t\t\t\tpageprops: [],\n\t\t\t\tterms: {\n\t\t\t\t\tlabel: [\n\t\t\t\t\t\t'<script>alert(\"oops, XSS possible!\");</script>'\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ttestDesc: 'Check against XSS in Page.newFromJSON displaytitle (when Wikibase label set)'\n\t\t\t}\n\t\t];\n\n\tassert.strictEqual(\n\t\tp.getDisplayTitle(),\n\t\t'&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;',\n\t\t'Check against XSS in Page.js constructor displaytitle (when title set)'\n\t);\n\n\ttitleJSON.forEach( function ( json ) {\n\t\tp = Page.newFromJSON( json );\n\n\t\tassert.strictEqual(\n\t\t\tp.getDisplayTitle(),\n\t\t\t'&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;',\n\t\t\tjson.testDesc\n\t\t);\n\t} );\n} );\n","var util,\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tmediawiki = require( '../utils/mw' ),\n\tjQuery = require( '../utils/jQuery' ),\n\texamples = require( './../utils/PageInputs.html' ),\n\tpage = examples.page,\n\tpage2 = examples.page2,\n\ttestData = require( '../utils/PageGateway.responses' ),\n\tPageGateway,\n\tpageGateway,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend PageGateway', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\t\tPageGateway = require( '../../../src/mobile.startup/PageGateway' );\n\t\tthis.api = new mw.Api();\n\t\tpageGateway = new PageGateway( this.api );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getPage (h1s)', function ( assert ) {\n\n\tsandbox.stub( this.api, 'get' ).returns( util.Deferred().resolve( testData.getPageHeadings.input ) );\n\tpageGateway.invalidatePage( 'Test' );\n\n\tsandbox.stub( mw.util, 'getUrl' ).returns( 'Test:History' );\n\n\treturn pageGateway.getPage( 'Test' ).then( function ( resp ) {\n\t\tassert.propEqual( resp, testData.getPageHeadings.output, 'return lead and sections test 1' );\n\t} );\n} );\n\nQUnit.test( '#getPage', function ( assert ) {\n\tvar api = sandbox.stub( this.api, 'get' ).returns( util.Deferred().resolve( testData.getPage.input ) );\n\n\tsandbox.stub( mw.util, 'getUrl' ).returns( 'Test:History' );\n\n\tpageGateway.invalidatePage( 'Test' );\n\treturn pageGateway.getPage( 'Test' ).then( function ( resp ) {\n\t\tassert.deepEqual( resp, testData.getPage.output, 'return lead and sections test 2' );\n\n\t\treturn pageGateway.getPage( 'Test' );\n\t} ).then( function () {\n\t\tassert.strictEqual( api.callCount, 1, 'cache page' );\n\t} );\n} );\n\nQUnit.test( '#getPageLanguages (response)', function ( assert ) {\n\tsandbox.stub( this.api, 'get' ).returns( util.Deferred().resolve( testData.getPageLanguagesResponse.input ) );\n\n\treturn pageGateway.getPageLanguages( 'Test' ).then( function ( resp ) {\n\t\tassert.deepEqual( resp.languages,\n\t\t\ttestData.getPageLanguagesResponse.output.languages,\n\t\t\t'return augmented language links' );\n\n\t\tassert.deepEqual( resp.variants,\n\t\t\ttestData.getPageLanguagesResponse.output.variants,\n\t\t\t'return augmented language variant links' );\n\t} );\n} );\n\nQUnit.test( '#getPageLanguages (call)', function ( assert ) {\n\tvar spy = sandbox.stub( this.api, 'get' ).returns( util.Deferred().reject() );\n\t// prevent rogue ajax request\n\t// eslint-disable-next-line no-undef\n\tsandbox.stub( $, 'ajax' ).returns( util.Deferred().resolve() );\n\tpageGateway.getPageLanguages( 'Title', 'fr' );\n\tassert.ok(\n\t\tspy.calledWith( testData.getPageLanguagesCall.output )\n\t);\n} );\n\nQUnit.test( '#_getAPIResponseFromHTML', function ( assert ) {\n\tvar resp = pageGateway._getAPIResponseFromHTML(\n\t\tutil.parseHTML( page )\n\t);\n\tassert.deepEqual( testData.getAPIResponseFromHTML.input, resp );\n} );\n\nQUnit.test( '#getSectionsFromHTML malformed (h2 before h1)', function ( assert ) {\n\tvar resp = pageGateway.getSectionsFromHTML(\n\t\tutil.parseHTML( page2 )\n\t);\n\tassert.propEqual( resp, [\n\t\t{\n\t\t\tline: 'A1',\n\t\t\tlevel: '2',\n\t\t\tanchor: '1.0',\n\t\t\ttext: '<h3 id=\"\">A2.1</h3>\\n\\n',\n\t\t\tsubsections: [ {\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '3',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: '',\n\t\t\t\tsubsections: []\n\t\t\t} ]\n\t\t},\n\t\t{\n\t\t\tline: 'A2.2',\n\t\t\tlevel: '2',\n\t\t\tanchor: '',\n\t\t\ttext: '',\n\t\t\tsubsections: []\n\t\t},\n\t\t{\n\t\t\tline: 'A2',\n\t\t\tlevel: '1',\n\t\t\tanchor: '',\n\t\t\ttext: '<h2 id=\"\">A2.1</h2>\\n\\n',\n\t\t\tsubsections: [ {\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: '',\n\t\t\t\tsubsections: []\n\t\t\t} ]\n\t\t}\n\t] );\n} );\n\nQUnit.test( '#getPage (forwards api errors)', function ( assert ) {\n\tsandbox.stub( this.api, 'get' ).returns( util.Deferred().reject( 'missingtitle' ) );\n\treturn pageGateway.getPage( 'Err' ).catch( function ( msg ) {\n\t\tassert.strictEqual( msg, 'missingtitle' );\n\t} );\n} );\n\nQUnit.test( '#getPage (move protected page)', function ( assert ) {\n\tvar expected = {\n\t\tedit: [ '*' ],\n\t\tmove: [ 'sysop' ]\n\t};\n\tsandbox.stub( this.api, 'get' ).returns( util.Deferred().resolve( {\n\t\tmobileview: {\n\t\t\tid: -1,\n\t\t\tdisplaytitle: 'Test',\n\t\t\trevId: 42,\n\t\t\tlastmodifiedby: {\n\t\t\t\tname: 'bob',\n\t\t\t\tgender: 'unknown'\n\t\t\t},\n\t\t\tprotection: {\n\t\t\t\tmove: [ 'sysop' ]\n\t\t\t},\n\t\t\tlastmodified: '2013-10-28T18:49:56Z',\n\t\t\tlanguagecount: 10,\n\t\t\tsections: [\n\t\t\t\t{\n\t\t\t\t\tid: 0,\n\t\t\t\t\ttext: ''\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t} ) );\n\n\tpageGateway.invalidatePage( 'Test' );\n\treturn pageGateway.getPage( 'Test' ).then( function ( resp ) {\n\t\tassert.deepEqual( resp.protection, expected );\n\t} );\n} );\n","var\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tPanel,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend Panel.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tPanel = require( '../../../src/mobile.startup/Panel' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'show() when not visible', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tpanel = new Panel();\n\n\tpanel.on( 'show', function () {\n\t\tassert.ok( panel.$el.hasClass( 'visible' ), 'Visible class is set' );\n\t\tassert.ok( panel.$el.hasClass( 'animated' ), 'Animated class is set' );\n\t\tdone();\n\t} );\n\n\tpanel.show();\n} );\n\nQUnit.test( 'hide() when visible', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tpanel = new Panel();\n\n\tpanel.on( 'hide', function () {\n\t\tassert.notOk( panel.$el.hasClass( 'visible', 'Visible class is removed' ) );\n\t\tdone();\n\t} );\n\n\tpanel.show();\n\tpanel.hide();\n} );\n\nQUnit.test( 'isVisible() when visible', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tpanel = new Panel();\n\n\tpanel.on( 'show', function () {\n\t\tassert.ok( panel.isVisible(), 'Returns true when visible' );\n\t\tdone();\n\t} );\n\n\tpanel.show();\n} );\n\nQUnit.test( 'isVisible() when not visible', function ( assert ) {\n\tvar panel = new Panel();\n\n\tassert.notOk( panel.isVisible(), 'Returns false when not visible' );\n} );\n\nQUnit.test( 'onCancel()', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tpanel = new Panel();\n\n\tpanel.on( 'hide', function () {\n\t\tassert.notOk( panel.$el.hasClass( 'visible' ), 'Removes visible class' );\n\t\tdone();\n\t} );\n\n\tpanel.show();\n\tpanel.onCancel( {\n\t\tpreventDefault: function () {}\n\t} );\n} );\n\nQUnit.test( 'toggle()', function ( assert ) {\n\tvar\n\t\tdone = assert.async(),\n\t\tpanel = new Panel();\n\n\tpanel.on( 'show', function () {\n\t\tassert.ok( panel.isVisible(), 'Shows panel when not visible' );\n\t\tpanel.toggle();\n\t} );\n\n\tpanel.on( 'hide', function () {\n\t\tassert.notOk( panel.isVisible(), 'Hides panel when visible' );\n\t\tdone();\n\t} );\n\n\tpanel.toggle();\n} );\n","var\n\tsinon = require( 'sinon' ),\n\too = require( '../utils/oo' ),\n\tsandbox,\n\tScrollEndEventEmitter;\n\nQUnit.module( 'MobileFrontend ScrollEndEventEmitter.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\too.setUp( sandbox, global );\n\n\t\tScrollEndEventEmitter = require( '../../../src/mobile.startup/ScrollEndEventEmitter' );\n\t},\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'initializes properly', function ( assert ) {\n\tvar\n\t\teventBus = {\n\t\t\ton: sinon.spy()\n\t\t},\n\t\tis = new ScrollEndEventEmitter( eventBus, 500 ),\n\t\tis2 = new ScrollEndEventEmitter( eventBus );\n\n\tassert.strictEqual( is.enabled, true,\n\t\t'Emission is enabled by default' );\n\tassert.strictEqual( is.threshold, 500, 'Threshold is saved' );\n\tassert.strictEqual( is2.threshold, 100,\n\t\t'Without a threshold we get a default' );\n\tassert.strictEqual( eventBus.on.withArgs( 'scroll:throttled',\n\t\tis._scrollHandler ).calledOnce, true, 'Scrolling handler is bound' );\n} );\n\nQUnit.test( 'emits scroll end event', function ( assert ) {\n\tvar\n\t\teventBus = {\n\t\t\ton: function ( _, handler ) {\n\t\t\t\tthis.handler = handler;\n\t\t\t},\n\t\t\toff: function () {}\n\t\t},\n\t\tis = new ScrollEndEventEmitter( eventBus );\n\n\t// stub scrollNearEnd method because headless tests don't support scrolling\n\tsandbox.stub( is, 'scrollNearEnd' ).returns( true );\n\tis.setElement( {} );\n\n\tis.on( ScrollEndEventEmitter.EVENT_SCROLL_END, function () {\n\t\tassert.ok( true, 'scroll end event emitted' );\n\t} );\n\t// trigger stubbed 'scroll:throttled' event\n\teventBus.handler();\n} );\n\nQUnit.test( 'doesn\\'t emit when disabled', function ( assert ) {\n\tvar\n\t\temitSpy = sandbox.spy( ScrollEndEventEmitter.prototype, 'emit' ),\n\t\teventBus = {\n\t\t\ton: function ( _, handler ) {\n\t\t\t\tthis.handler = handler;\n\t\t\t},\n\t\t\toff: function () {}\n\t\t},\n\t\tis = new ScrollEndEventEmitter( eventBus );\n\tis.setElement( {} );\n\tis.disable();\n\n\t// trigger stubbed 'scroll:throttled' event\n\teventBus.handler();\n\tassert.strictEqual( emitSpy.called, false, 'emit should not be called' );\n} );\n","var\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tSection,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend Section.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tSection = require( '../../../src/mobile.startup/Section' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'initialize with options', function ( assert ) {\n\tvar section = new Section( {\n\t\tlevel: '1',\n\t\tline: 'Line',\n\t\ttext: 'Text',\n\t\thasReferences: true,\n\t\tid: 'ID',\n\t\tanchor: 'Anchor'\n\t} );\n\n\tassert.strictEqual( section.line, 'Line', 'line is set' );\n\tassert.strictEqual( section.text, 'Text', 'text is set' );\n\tassert.strictEqual( section.hasReferences, true, 'hasReferences is set' );\n\tassert.strictEqual( section.id, 'ID', 'id is set' );\n\tassert.strictEqual( section.anchor, 'Anchor', 'anchor is set' );\n\tassert.strictEqual( section.subsections.length, 0, 'Subsections are empty' );\n} );\n\nQUnit.test( 'initialize with subsections', function ( assert ) {\n\tvar\n\t\tsection = new Section( {\n\t\t\tsubsections: [ {\n\t\t\t\tlevel: '',\n\t\t\t\tline: 'Line',\n\t\t\t\ttext: 'Text',\n\t\t\t\thasReferences: true,\n\t\t\t\tid: 'ID',\n\t\t\t\tanchor: 'Anchor'\n\t\t\t} ]\n\t\t} ),\n\t\tsubsection = section.subsections[ 0 ];\n\n\tassert.strictEqual( section.subsections.length, 1, 'Subsection is added to array' );\n\tassert.ok( subsection instanceof Section, 'Subsections are instances of Section' );\n\n\tassert.strictEqual( subsection.line, 'Line', 'line is set' );\n\tassert.strictEqual( subsection.text, 'Text', 'text is set' );\n\tassert.strictEqual( subsection.hasReferences, true, 'hasReferences is set' );\n\tassert.strictEqual( subsection.id, 'ID', 'id is set' );\n\tassert.strictEqual( subsection.anchor, 'Anchor', 'anchor is set' );\n\tassert.strictEqual( subsection.subsections.length, 0, 'Subsection children are empty' );\n} );\n","var\n\tpages = require( './../utils/PageInputs.html' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tsandbox,\n\tSkin,\n\tPage;\n\nQUnit.module( 'MobileFrontend Skin.js', {\n\tbeforeEach: function () {\n\t\tvar stub = {\n\t\t\t\tgetReferencesLists: function () {},\n\t\t\t\tgetReferencesList: function () {}\n\t\t\t},\n\t\t\tpage;\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\tSkin = require( '../../../src/mobile.startup/Skin' );\n\t\tPage = require( '../../../src/mobile.startup/Page' );\n\n\t\tpage = new Page( {\n\t\t\ttitle: 'Foo'\n\t\t} );\n\n\t\t// Skin will request tablet modules - avoid this\n\t\tsandbox.stub( mw.loader, 'using' ).returns( util.Deferred().resolve() );\n\t\tsandbox.stub( stub, 'getReferencesLists' ).returns( util.Deferred().resolve( {} ) );\n\t\tsandbox.stub( stub, 'getReferencesList' )\n\t\t\t.withArgs( page, 'Notes_and_references' ).returns( util.Deferred().resolve( util.parseHTML( '<p>' ).text( 'P' ) ) )\n\t\t\t.withArgs( page, 'Notes' ).returns( util.Deferred().resolve( util.parseHTML( '<p>' ).text( 'A' ) ) )\n\t\t\t.withArgs( page, 'Refs' ).returns( util.Deferred().resolve( util.parseHTML( '<p>' ).text( 'B' ) ) )\n\t\t\t.withArgs( page, 'More_refs' ).returns( util.Deferred().resolve( util.parseHTML( '<p>' ).html( '<p>E</p><p>F</p>' ).children() ) );\n\t\tthis.skin = new Skin( {\n\t\t\treferencesGateway: stub,\n\t\t\tpage: page,\n\t\t\teventBus: {\n\t\t\t\ton: function () {},\n\t\t\t\toff: function () {}\n\t\t\t}\n\t\t} );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#lazyLoadReferences', function ( assert ) {\n\tvar $content = util.parseHTML( '<div>' ).append( pages.skinPage );\n\n\treturn this.skin.lazyLoadReferences( {\n\t\twasExpanded: false,\n\t\tpage: this.skin.page,\n\t\tisReferenceSection: true,\n\t\t$heading: $content.find( '#Notes_and_references' ).parent()\n\t} ).then( function () {\n\t\tassert.strictEqual( $content.find( '.mf-section-2' ).text().replace( /[\\t\\n]/g, '' ),\n\t\t\t'TextPNotesARefsBno forgetMore refs1E2F3',\n\t\t\t'Check all the references section is populated correctly.' );\n\t} );\n} );\n\nQUnit.test( '#getSectionId', function ( assert ) {\n\tvar\n\t\t$el = util.parseHTML(\n\t\t\t[\n\t\t\t\t'<div>',\n\t\t\t\t'<h2><span class=\"mw-headline\" id=\"heading\">H</span></h2>',\n\t\t\t\t'<div>',\n\t\t\t\t'<h3><span class=\"mw-headline\" id=\"subheading\">Subh</span></h3>',\n\t\t\t\t'<a class=\"element\"></a>',\n\t\t\t\t'</div>',\n\t\t\t\t'</div>'\n\t\t\t].join( '' )\n\t\t),\n\t\t$elTwo = util.parseHTML(\n\t\t\t[\n\t\t\t\t'<div>',\n\t\t\t\t'<h2><span class=\"mw-headline\" id=\"Notes_and_references\">Notes and references</span></h2>',\n\t\t\t\t'<div>',\n\t\t\t\t'<h3 class=\"in-block\"><span class=\"mw-headline\" id=\"Notes\">Notes</span></h3>',\n\t\t\t\t'<div class=\"reflist\"><a class=\"element\"></a></div>',\n\t\t\t\t'</div>',\n\t\t\t\t'</div>'\n\t\t\t].join( '' )\n\t\t),\n\t\t$elThree = util.parseHTML(\n\t\t\t[\n\t\t\t\t'<div id=\"mw-content-text\">',\n\t\t\t\t'<h2><span class=\"mw-headline\" id=\"heading\">Heading</span></h2>',\n\t\t\t\t'<div><a class=\"element\"></a></div>',\n\t\t\t\t'</div>'\n\t\t\t].join( '' )\n\t\t),\n\t\t$elFour = util.parseHTML(\n\t\t\t[\n\t\t\t\t'<div id=\"mw-content-text\">',\n\t\t\t\t'<div><a class=\"element\"></a></div>'\n\t\t\t].join( '' )\n\t\t),\n\t\t$elFive = util.parseHTML(\n\t\t\t[\n\t\t\t\t'<div id=\"mw-content-text\">',\n\t\t\t\t'<h2><span class=\"mw-headline\" id=\"Foo\">Foo</span></h2>',\n\t\t\t\t'<div>',\n\t\t\t\t'<p>Foo content.</p>',\n\t\t\t\t'</div>',\n\t\t\t\t'<h2><span class=\"mw-headline\" id=\"Bar\">Bar</span></h2>',\n\t\t\t\t'<div class=\"reflist\"><a class=\"element\"></a></div>',\n\t\t\t\t'</div>',\n\t\t\t\t'</div>'\n\t\t\t].join( '' )\n\t\t);\n\n\tassert.strictEqual(\n\t\tSkin.getSectionId( $el.find( '.element' ) ),\n\t\t'subheading'\n\t);\n\tassert.strictEqual(\n\t\tSkin.getSectionId( $elTwo.find( '.element' ) ),\n\t\t'Notes',\n\t\t'https://phabricator.wikimedia.org/T146394'\n\t);\n\tassert.strictEqual(\n\t\tSkin.getSectionId( $elThree.find( '.element' ) ),\n\t\t'heading'\n\t);\n\tassert.strictEqual(\n\t\tSkin.getSectionId( $elFour.find( '.element' ) ),\n\t\tnull\n\t);\n\tassert.strictEqual(\n\t\tSkin.getSectionId( $elFive.find( '.element' ) ),\n\t\t'Bar'\n\t);\n} );\n","/* eslint-env es6 */\n/* global $ */\nvar\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tmediawiki = require( '../utils/mw' ),\n\tsandbox,\n\tbrowser,\n\tToggler,\n\tsectionTemplate = `\n\t\t<h2>\n\t\t<span id=\"First_Section\">First Section</span>\n\t\t</h2>\n\t\t<div>\n\t\t\t<p>Text</p>\n\t\t</div>\n\t\t<h2 id=\"section_1\">\n\t\t\t<a href=\"#foo\">Dummy Link</a>\n\t\t</h2>\n\t\t<div></div>\n\t\t<h2>References</h2>\n\t\t<div data-is-reference-section=\"1\">\n\t\t\t<ol class=\"references\">\n\t\t\t\t<li id=\"cite_note-1\">\n\t\t\t\t\t<span class=\"mw-cite-backlink\">\n\t\t\t\t\t\t<a href=\"#cite_ref-1\">↑</a>\n\t\t\t\t\t</span> <span class=\"reference-text\">hello</span>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</div>\n`;\n\n/**\n * Mobile toggling\n */\nQUnit.module( 'MobileFrontend Toggler.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\n\t\tbrowser = require( '../../../src/mobile.startup/Browser' ).getSingleton();\n\t\tToggler = require( '../../../src/mobile.startup/Toggler' );\n\n\t\tsandbox.stub( mw.config, 'get' ).withArgs( 'wgMFCollapseSectionsByDefault' ).returns( true );\n\t\tsandbox.stub( browser, 'isWideScreen' ).returns( false );\n\n\t\tthis.page = { title: 'Toggle test' };\n\t\tthis.$container = $( '<div>' ).html( sectionTemplate );\n\t\tthis.$section0 = this.$container.find( 'h2' ).eq( 0 );\n\t\tthis.title = this.page.title;\n\t\tthis.headline = this.$section0.find( 'span' ).attr( 'id' );\n\t},\n\tafterEach: function () {\n\t\tmw.storage.remove( 'expandSections' );\n\t\tmw.storage.remove( 'expandedSections' );\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Mobile mode - Toggle section', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$section0,\n\t\t$content = this.$container.find( '.collapsible-block' ).eq( 0 );\n\n\ttoggle.toggle( $section );\n\n\tassert.strictEqual( $section.hasClass( 'open-block' ), true, 'open-block class present' );\n\n\ttoggle.toggle( $section );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content gets closed on a toggle' );\n\tassert.strictEqual( $section.hasClass( 'open-block' ), false, 'check section is closed' );\n\t// Perform second toggle\n\ttoggle.toggle( $section );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content reopened' );\n\tassert.strictEqual( $section.hasClass( 'open-block' ), true, 'check section has reopened' );\n} );\n\nQUnit.test( 'Mobile mode - Clicking a hash link to reveal an already open section', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} );\n\n\ttoggle.toggle( this.$section0 );\n\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is open' );\n\ttoggle.reveal( 'First_Section', this.$container );\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is still open' );\n} );\n\nQUnit.test( 'Mobile mode - Reveal element', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} );\n\n\ttoggle.toggle( this.$section0 );\n\n\ttoggle.reveal( 'First_Section' );\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 0 ).hasClass( 'open-block' ), true, 'check content is visible' );\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is open' );\n} );\n\nQUnit.test( 'Mobile mode - Clicking hash links', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} );\n\n\ttoggle.toggle( this.$section0 );\n\n\tthis.$container.find( '[href=\"#First_Section\"]' ).trigger( 'click' );\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 0 ).hasClass( 'open-block' ), true, 'check content is visible' );\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is open' );\n} );\n\nQUnit.test( 'Mobile mode - Tap event toggles section', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$content = this.$container.find( '.collapsible-block' ).eq( 1 );\n\n\ttoggle.toggle( this.$section0 );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\n\tthis.$container.find( '#section_1' ).trigger( 'click' );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content is shown on a toggle' );\n} );\n\nQUnit.test( 'Accessibility - Verify aria attributes', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$container.find( '#section_1' ),\n\t\t$content = this.$container.find( '.collapsible-block' ).eq( 1 );\n\n\ttoggle.toggle( this.$section0 );\n\n\t// Test the initial state produced by the init function\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\tassert.strictEqual( $content.attr( 'aria-pressed' ), 'false', 'check aria-pressed is false at start' );\n\tassert.strictEqual( $content.attr( 'aria-expanded' ), 'false', 'check aria-expanded is false at start' );\n\n\t// Test what the toggle() function gives us when hiding the section\n\t$section.trigger( 'click' );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content is visible after toggling' );\n\tassert.strictEqual( $content.attr( 'aria-pressed' ), 'true', 'check aria-pressed is true after toggling' );\n\tassert.strictEqual( $content.attr( 'aria-expanded' ), 'true', 'check aria-expanded is true after toggling' );\n\n\t// Test what the toggle() function gives us when showing the section\n\t$section.trigger( 'click' );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden after toggling' );\n\tassert.strictEqual( $content.attr( 'aria-pressed' ), 'false', 'check aria-pressed is false after toggling' );\n\tassert.strictEqual( $content.attr( 'aria-expanded' ), 'false', 'check aria-expanded is false after toggling' );\n} );\n\n/**\n * Tablet toggling\n */\nQUnit.test( 'Tablet mode - Open by default', function ( assert ) {\n\tbrowser.isWideScreen.returns( true );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 1 ).hasClass( 'open-block' ),\n\t\ttrue, 'check section is visible at start' );\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 2 ).hasClass( 'open-block' ),\n\t\tfalse, 'check reference section is hidden at start' );\n} );\n\n/**\n * Expand sections user setting\n */\nQUnit.test( 'Tablet mode - Open by default 2', function ( assert ) {\n\n\tmw.config.get.withArgs( 'wgMFCollapseSectionsByDefault' ).returns( false );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 1 ).hasClass( 'open-block' ), true, 'check section is visible at start' );\n} );\n\n/**\n * Accessibility\n */\nQUnit.test( 'Accessibility - Pressing space/ enter toggles a heading', function ( assert ) {\n\tvar $section = this.$container.find( '#section_1' ),\n\t\t$content,\n\t\tev = $.Event( 'keypress' );\n\n\tbrowser.isWideScreen.returns( false );\n\tmw.config.get.withArgs( 'wgMFCollapseSectionsByDefault' ).returns( true );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\t$content = this.$container.find( '.collapsible-block' ).eq( 1 );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\n\t// Open the section with pressing space\n\tev.which = 32;\n\t$section.trigger( ev );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content is shown after pressing space' );\n\n\t// Enter should close the section again\n\tev.which = 13;\n\t$section.trigger( ev );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden after pressing enter' );\n} );\n\nQUnit.test( 'Clicking a link within a heading isn\\'t triggering a toggle', function ( assert ) {\n\n\tvar $section = $( '#section_1' ),\n\t\t$content = $( '.collapsible-block' ).eq( 1 );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\n\t$section.find( '> a' ).eq( 0 ).trigger( 'mouseup' );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is still being hidden after clicking on the link' );\n} );\n\nQUnit.test( 'Toggling a section stores its state.', function ( assert ) {\n\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$container.find( 'h2' ),\n\t\texpandedSections = Toggler._getExpandedSections( this.page ),\n\t\tmwStorageSetSpy = sandbox.spy( mw.storage, 'set' ),\n\t\tmwStorageSetCall,\n\t\tmwStorageSetCall2;\n\n\tassert.strictEqual( $.isEmptyObject( expandedSections[ this.title ] ),\n\t\ttrue,\n\t\t'no user setting about an expanded section exists already'\n\t);\n\n\ttoggle.toggle( $section );\n\tmwStorageSetCall = JSON.parse( mwStorageSetSpy.getCall( 0 ).args[1] );\n\n\tassert.strictEqual( typeof mwStorageSetCall[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'the just toggled section state has been saved'\n\t);\n\n\ttoggle.toggle( $section );\n\tmwStorageSetCall2 = JSON.parse( mwStorageSetSpy.getCall( 1 ).args[1] );\n\n\tassert.strictEqual( mwStorageSetCall2[ this.title ][ this.headline ],\n\t\tundefined,\n\t\t'the just toggled section state has been removed'\n\t);\n\n} );\n\nQUnit.test( 'Check for and remove obsolete stored sections.', function ( assert ) {\n\tvar\n\t\texpandedSections,\n\t\tmwStorageSetSpy,\n\t\tlocalStorageValue,\n\t\tlocalStorageRemovalValue;\n\n\tlocalStorageValue = {};\n\tlocalStorageValue[ this.title ] = {};\n\tlocalStorageValue[ this.title ][ this.headline ] = ( new Date( 1990, 1, 1 ) ).getTime();\n\n\tsandbox.stub( mw.storage, 'get', function () {\n\t\treturn JSON.stringify( localStorageValue );\n\t} );\n\n\texpandedSections = Toggler._getExpandedSections( this.page );\n\tassert.strictEqual( typeof expandedSections[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'manually created section state has been saved correctly'\n\t);\n\n\tmwStorageSetSpy = sandbox.spy( mw.storage, 'set' );\n\n\tToggler._cleanObsoleteStoredSections( this.page );\n\tlocalStorageRemovalValue = JSON.stringify( [ 'expandedSections', '{\"Toggle test\":{}}' ] );\n\tassert.strictEqual(\n\t\tJSON.stringify( mwStorageSetSpy.getCall( 0 ).args ),\n\t\tlocalStorageRemovalValue,\n\t\t'section, whose store time is manually changed to an older date,' +\n\t\t\t'has been removed from storage correctly'\n\t);\n} );\n\nQUnit.test( 'Expanding already expanded section does not toggle it.', function ( assert ) {\n\tvar\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$container.find( 'h2' ),\n\t\texpandedSections = Toggler._getExpandedSections( this.page ),\n\t\tmwStorageSetSpy,\n\t\tmwStorageSetCall;\n\n\tassert.strictEqual( $.isEmptyObject( expandedSections[ this.title ] ),\n\t\ttrue,\n\t\t'no expanded sections are stored in localStorage yet'\n\t);\n\n\tassert.strictEqual(\n\t\t$section.hasClass( 'open-block' ),\n\t\tfalse,\n\t\t'section does not have open-block class'\n\t);\n\n\tmwStorageSetSpy = sandbox.spy( mw.storage, 'set' );\n\n\t// manually toggle the second section\n\ttoggle.toggle( $section );\n\n\tassert.strictEqual(\n\t\t$section.hasClass( 'open-block' ),\n\t\ttrue,\n\t\t'revealed section has open-block class'\n\t);\n\n\texpandedSections = Toggler._getExpandedSections( this.page );\n\tmwStorageSetCall = JSON.parse( mwStorageSetSpy.getCall( 0 ).args[1] );\n\n\tassert.strictEqual( typeof mwStorageSetCall[this.title][ this.headline ],\n\t\t'number',\n\t\t'manually revealed section state has been correctly saved in localStorage'\n\t);\n\n\tToggler._expandStoredSections( toggle, this.$container, this.page );\n\n\tassert.strictEqual(\n\t\t$section.hasClass( 'open-block' ),\n\t\ttrue,\n\t\t'already revealed section still has open-block class after expanding sections'\n\t);\n} );\n\nQUnit.test( 'MobileFrontend toggle.js - Expand stored sections.', function ( assert ) {\n\n\tvar\n\t\t$section = this.$container.find( 'h2' ).eq( 0 ),\n\t\texpandedSections = Toggler._getExpandedSections( this.page ),\n\t\texpandedSectionsFromToggle;\n\n\t// Restore expanded sections only works on headings that are also section headings\n\tthis.$container.find( 'h2' ).addClass( 'section-heading' );\n\n\tassert.strictEqual( $section.hasClass( 'open-block' ), false, 'Section is collapsed.' );\n\n\tassert.strictEqual( $.isEmptyObject( expandedSections[ this.title ] ),\n\t\ttrue,\n\t\t'no user setting about an expanded section exists already'\n\t);\n\n\t// save a toggle state manually\n\texpandedSections[ this.title ][ this.headline ] = ( new Date() ).getTime();\n\n\tsandbox.stub( mw.storage, 'get', function () {\n\t\treturn JSON.stringify( expandedSections );\n\t} );\n\texpandedSectionsFromToggle = Toggler._getExpandedSections( this.page );\n\tassert.strictEqual( typeof expandedSectionsFromToggle[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'manually created section state has been saved correctly'\n\t);\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\texpandedSections = Toggler._getExpandedSections( this.page );\n\tassert.strictEqual( typeof expandedSections[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'manually created section state is still active after toggle.init()'\n\t);\n\tassert.strictEqual( $section.hasClass( 'open-block' ), true,\n\t\t'Saved section has been auto expanded.' );\n\n} );\n","/* global $ */\nvar\n\tHogan = require( 'hogan.js' ),\n\tmw = require( '../utils/mw' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmfExtend = require( '../../../src/mobile.startup/mfExtend' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tView;\n/** @type {sinon.SinonSandbox} */ var sandbox; // eslint-disable-line one-var\n\nQUnit.module( 'MobileFrontend mobile.startup/View', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\n\t\tView = require( '../../../src/mobile.startup/View' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'View', function ( assert ) {\n\tvar view = new View( {\n\t\tel: 'body'\n\t} );\n\tassert.ok( view.$el instanceof $, 'assign jQuery object to $el' );\n\tassert.strictEqual( view.$el[ 0 ].tagName.toUpperCase(), 'BODY', 'assign proper jQuery object to $el' );\n} );\n\nQUnit.test( 'View, jQuery proxy functions', function ( assert ) {\n\tvar view = new View( {\n\t\tel: 'body'\n\t} );\n\t[\n\t\t'append',\n\t\t'prepend',\n\t\t'appendTo',\n\t\t'prependTo',\n\t\t'after',\n\t\t'before',\n\t\t'insertAfter',\n\t\t'insertBefore',\n\t\t'remove',\n\t\t'detach'\n\t].forEach( function ( prop ) {\n\t\tvar stub = sandbox.stub( view.$el, prop );\n\t\tview[ prop ]( 'test', 1 );\n\t\tassert.ok( stub.calledWith( 'test', 1 ) );\n\t\tstub.restore();\n\t} );\n} );\n\nQUnit.test( 'View#preRender', function ( assert ) {\n\tvar view;\n\tfunction ChildView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( ChildView, View, {\n\t\ttemplate: Hogan.compile( '<p>{{text}}</p>' ),\n\t\tpreRender: function () {\n\t\t\tthis.options.text = 'hello';\n\t\t}\n\t} );\n\n\tview = new ChildView();\n\tassert.strictEqual( view.$el.html(), '<p>hello</p>', 'manipulate template data' );\n} );\n\nQUnit.test( 'View#postRender', function ( assert ) {\n\tvar spy = sandbox.spy();\n\tfunction ChildView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( ChildView, View, {\n\t\tpostRender: function () {\n\t\t\tspy();\n\t\t}\n\t} );\n\n\t// eslint-disable-next-line no-new\n\tnew ChildView();\n\tassert.strictEqual( spy.callCount, 1, 'invoke postRender' );\n} );\n\nQUnit.test( 'View#delegateEvents', function ( assert ) {\n\n\tvar view;\n\tfunction EventsView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( EventsView, View, {\n\t\ttemplate: Hogan.compile( '<p><span>test</span></p>' ),\n\t\tevents: {\n\t\t\t'click p span': function ( ev ) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tassert.ok( true, 'Span was clicked and handled' );\n\t\t\t},\n\t\t\t'click p': 'onParagraphClick',\n\t\t\tclick: 'onClick'\n\t\t},\n\t\tonParagraphClick: function ( ev ) {\n\t\t\tev.preventDefault();\n\t\t\tassert.ok( true, 'Paragraph was clicked and handled' );\n\t\t},\n\t\tonClick: function ( ev ) {\n\t\t\tev.preventDefault();\n\t\t\tassert.ok( true, 'View was clicked and handled' );\n\t\t}\n\t} );\n\n\tview = new EventsView();\n\tview.appendTo( 'body' );\n\t// Check if events are set and handlers called\n\tview.$el.find( 'span' ).trigger( 'click' );\n\tview.$el.find( 'p' ).trigger( 'click' );\n\tview.$el.trigger( 'click' );\n\t// Check if events can be unset and handlers are not called\n\tview.undelegateEvents();\n\tview.$el.find( 'span' ).trigger( 'click' );\n\tview.$el.find( 'p' ).trigger( 'click' );\n\tview.$el.trigger( 'click' );\n} );\n\nQUnit.test( 'View#render (with isTemplateMode)', function ( assert ) {\n\tvar view, view2, textFirstRun,\n\t\t$parent = $( '<div>' );\n\tfunction TemplateModeView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( TemplateModeView, View, {\n\t\ttemplate: Hogan.compile( '<p class=\"foo\"><span>{{text}}</span></p>' ),\n\t\tisTemplateMode: true\n\t} );\n\n\tfunction ContainerView() {\n\t\tView.call( this, { className: 'bar' } );\n\t}\n\n\tmfExtend( ContainerView, View, {\n\t\ttemplate: Hogan.compile( '<p class=\"foo\"><span>test</span></p>' )\n\t} );\n\n\tview = new TemplateModeView();\n\ttextFirstRun = view.$el.text();\n\tview2 = new ContainerView();\n\tview.render();\n\tview2.render();\n\t// attach to the DOM\n\tview.$el.appendTo( $parent );\n\t// and then do a second render...\n\tview.render( { text: 'hello' } );\n\tassert.ok( view.$el.hasClass( 'foo' ) );\n\tassert.ok( view2.$el.hasClass( 'bar' ) );\n\tassert.strictEqual( textFirstRun, '', 'first run, no text defined' );\n\tassert.strictEqual( view.$el.text(), 'hello', 'second run, text has been defined' );\n\tassert.strictEqual( view.$el.parent( $parent ).length, 1,\n\t\t'A re-rendered view thats attached to the DOM remains attached to the DOM' );\n} );\n\nQUnit.test( 'View#render events (with isTemplateMode)', function ( assert ) {\n\tvar view;\n\tfunction TemplateModeView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( TemplateModeView, View, {\n\t\tevents: {\n\t\t\t'click span': 'onClick'\n\t\t},\n\t\tonClick: function () {\n\t\t\tthis.$el.empty().text( 'hello world' );\n\t\t},\n\t\ttemplate: Hogan.compile( '<p class=\"foo\"><span>test</span></p>' ),\n\t\tisTemplateMode: true\n\t} );\n\n\tview = new TemplateModeView();\n\t// trigger event\n\tview.$( 'span' ).trigger( 'click' );\n\tassert.strictEqual( view.$el.text(), 'hello world', 'event was called' );\n\tassert.strictEqual( view.$( 'span' ).length, 0, 'span disappeared' );\n\n\t// do same again but call render twice\n\tview = new TemplateModeView();\n\t// force a re-render\n\tview.render();\n\t// trigger event to show events didn't get lost\n\tview.$( 'span' ).trigger( 'click' );\n\tassert.strictEqual( view.$el.text(), 'hello world', 'event was called' );\n\tassert.strictEqual( view.$( 'span' ).length, 0, 'span disappeared' );\n} );\n\nQUnit.test( 'View with className option', function ( assert ) {\n\t[\n\t\t[\n\t\t\tnew View(),\n\t\t\t'view-border-box',\n\t\t\t'className not defined on a normal View without options and isBorderBox is default'\n\t\t],\n\t\t[\n\t\t\tnew View( {} ),\n\t\t\t'view-border-box',\n\t\t\t'className not defined on a normal View with empty options and isBorderBox is default'\n\t\t],\n\t\t[\n\t\t\tnew View( {\n\t\t\t\tclassName: 'banana'\n\t\t\t} ),\n\t\t\t'banana view-border-box',\n\t\t\t'option is passed to View (along with default isBorderBox property)'\n\t\t],\n\t\t[\n\t\t\tnew View( { isBorderBox: false } ),\n\t\t\tundefined,\n\t\t\t'Passing isBorderBox option removes default view-border-box class'\n\t\t],\n\t\t[\n\t\t\tnew View( { isBorderBox: true } ),\n\t\t\t'view-border-box',\n\t\t\t'Passing isBorderBox option as true retains default view-border-box class'\n\t\t]\n\t].forEach( function ( test ) {\n\t\tassert.strictEqual( test[0].$el.attr( 'class' ), test[1], test[2] );\n\t} );\n} );\n","var cache = require( '../../../src/mobile.startup/cache' ),\n\tMemoryCache = cache.MemoryCache,\n\tmemoryCache = new MemoryCache();\n\nQUnit.module( 'MobileFrontend cache.js' );\n\nQUnit.test( 'cache set() and get()', function ( assert ) {\n\tmemoryCache.set( 'key', 'value' );\n\tassert.strictEqual( memoryCache.get( 'key' ), 'value' );\n} );\n","var sandbox,\n\tsinon = require( 'sinon' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tcontext = require( '../../../src/mobile.startup/context' );\n\nQUnit.module( 'MobileFrontend context.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tmediaWiki.setUp( sandbox, global );\n\t},\n\tafterEach: function () { sandbox.restore(); }\n} );\n\nQUnit.test( 'getMode()', function ( assert ) {\n\tsandbox.stub( mw.config, 'get' ).withArgs( 'wgMFMode' )\n\t\t.returns( 'stable' );\n\tassert.strictEqual( context.getMode(), 'stable', 'Value comes straight from config' );\n} );\n","var sandbox, extendSearchParams,\n\tjQuery = require( '../utils/jQuery' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tdom = require( '../utils/dom' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend extendSearchParams.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tsandbox.stub( mw.config, 'get' )\n\t\t\t.withArgs( 'wgMFSearchAPIParams' ).returns(\n\t\t\t\t{\n\t\t\t\t\tfoo: 'bar'\n\t\t\t\t}\n\t\t\t)\n\t\t\t.withArgs( 'wgMFDisplayWikibaseDescriptions' ).returns(\n\t\t\t\t{\n\t\t\t\t\tsearch: true,\n\t\t\t\t\tnearby: false\n\t\t\t\t}\n\t\t\t)\n\t\t\t.withArgs( 'wgMFQueryPropModules' ).returns( [ 'baz' ] );\n\t\textendSearchParams = require( '../../../src/mobile.startup/extendSearchParams' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'it throws if the feature is invalid', function ( assert ) {\n\tvar expectedError = new Error( '\"foo\" isn\\'t a feature that shows Wikibase descriptions.' );\n\n\tassert.throws( function () {\n\t\textendSearchParams( 'foo', {} );\n\t}, expectedError );\n} );\n\nQUnit.test( 'it extends the parameters', function ( assert ) {\n\tvar params = extendSearchParams( 'search', {\n\t\t\tqux: 'quux',\n\t\t\tprop: [ 'corge' ]\n\t\t} ),\n\t\texpectedParams = {\n\t\t\taction: 'query',\n\t\t\tformatversion: 2,\n\t\t\tqux: 'quux',\n\t\t\tfoo: 'bar', // from wgMFSearchAPIParams\n\t\t\tprop: [ 'corge', 'baz', 'description' ] // from wgMFQueryPropModules and Wikibase-specific\n\t\t};\n\n\tassert.deepEqual( params, expectedParams );\n} );\n\nQUnit.test( 'it doesn\\'t include Wikibase-specific parameters if the feature is disabled', function ( assert ) {\n\tvar params = extendSearchParams( 'nearby', {\n\t\tqux: 'quux'\n\t} );\n\n\tassert.strictEqual( params.prop.indexOf( 'description' ), -1 );\n\tassert.strictEqual( params.wbptterms, undefined );\n} );\n\nQUnit.test( 'it adds the MobileFrontend configuration to given terms types', function ( assert ) {\n\tvar params = extendSearchParams( 'search', {\n\t\twbptterms: 'grault'\n\t} );\n\n\tassert.strictEqual(\n\t\tparams.wbptterms,\n\t\t'grault',\n\t\t'The given \"wbptterms\" is added to the default.'\n\t);\n} );\n\nQUnit.test( 'it prioritizes MobileFrontend configuration', function ( assert ) {\n\tvar params = extendSearchParams( 'search', {\n\t\t\tfoo: 'quux'\n\t\t} ),\n\t\texpectedParams = {\n\t\t\taction: 'query',\n\t\t\tformatversion: 2,\n\t\t\tfoo: 'bar',\n\t\t\tprop: [ 'baz', 'description' ]\n\t\t};\n\n\tassert.deepEqual(\n\t\tparams,\n\t\texpectedParams,\n\t\t'The value of \"foo\" is overridden by the configuration.'\n\t);\n} );\n\nQUnit.test( 'it is variadic', function ( assert ) {\n\tvar params = extendSearchParams(\n\t\t\t'search',\n\t\t\t{\n\t\t\t\tbaz: 'qux'\n\t\t\t},\n\t\t\t{\n\t\t\t\tquux: 'corge'\n\t\t\t}\n\t\t),\n\t\texpectedParams = {\n\t\t\taction: 'query',\n\t\t\tformatversion: 2,\n\t\t\tfoo: 'bar',\n\t\t\tbaz: 'qux',\n\t\t\tquux: 'corge',\n\t\t\tprop: [ 'baz', 'description' ]\n\t\t};\n\n\tassert.deepEqual( params, expectedParams );\n} );\n","var sandbox, icons, spy,\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' );\n\nQUnit.module( 'MobileFrontend icons.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\ticons = require( '../../../src/mobile.startup/icons' );\n\t\tspy = sandbox.spy( icons, 'Icon' );\n\t},\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t\tjQuery.tearDown();\n\t}\n} );\n\nQUnit.test( '#cancel()', function ( assert ) {\n\ticons.cancel();\n\tassert.deepEqual( spy.getCall( 0 ).args[ 0 ], {\n\t\ttagName: 'button',\n\t\tname: icons.CANCEL_GLYPH,\n\t\tadditionalClassNames: 'cancel',\n\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' )\n\t}, 'Options are passed down' );\n} );\n\nQUnit.test( '#cancel(variant)', function ( assert ) {\n\ticons.cancel( 'gray' );\n\tassert.deepEqual( spy.getCall( 0 ).args[ 0 ], {\n\t\ttagName: 'button',\n\t\tname: icons.CANCEL_GLYPH + '-gray',\n\t\tadditionalClassNames: 'cancel',\n\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' )\n\t}, 'Options are passed down' );\n} );\n\nQUnit.test( '#spinner()', function ( assert ) {\n\ticons.spinner( {\n\t\tfoo: 'will be passed down',\n\t\tadditionalClassNames: 'will-be-ignored'\n\t} );\n\tassert.deepEqual( spy.getCall( 0 ).args[ 0 ], {\n\t\tfoo: 'will be passed down',\n\t\tadditionalClassNames: 'spinner loading',\n\t\tname: 'spinner',\n\t\tlabel: mw.msg( 'mobile-frontend-loading-message' )\n\t}, 'Options are passed down' );\n} );\n","var mfExtend,\n\tsinon = require( 'sinon' ),\n\too = require( '../utils/oo' );\n\n/** @type {sinon.SinonSandbox} */ var sandbox; // eslint-disable-line one-var\n\nQUnit.module( 'MobileFrontend mfExtend.test.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\too.setUp( sandbox, global );\n\t\tmfExtend = require( '../../../src/mobile.startup/mfExtend' );\n\t},\n\tafterEach: function () { sandbox.restore(); }\n} );\n\nQUnit.test( 'mfExtend() - extending from constructor', function ( assert ) {\n\tfunction TestChild() {}\n\tfunction TestPrototype() {}\n\tmfExtend( TestChild, TestPrototype, {} );\n\tassert.strictEqual( TestChild.prototype instanceof TestPrototype, true );\n} );\n\nQUnit.test( 'mfExtend() - extending from object', function ( assert ) {\n\tvar testPrototype = new TestPrototype(),\n\t\ttestChild;\n\tfunction TestChild() {}\n\tfunction TestPrototype() {\n\t\tthis.protoMethod = function () {\n\t\t\treturn true;\n\t\t};\n\t}\n\tmfExtend( TestChild, testPrototype );\n\ttestChild = new TestChild();\n\tassert.strictEqual( testChild.protoMethod(), true );\n} );\n\nQUnit.test( 'mfExtend() - extending from constructor with overrides', function ( assert ) {\n\tvar testChild;\n\tfunction TestChild() {}\n\tfunction TestPrototype() {\n\t\tthis.protoMethod = function () {\n\t\t\treturn true;\n\t\t};\n\t}\n\tmfExtend( TestChild, TestPrototype, {\n\t\tprotoMethod: function () {\n\t\t\treturn false;\n\t\t}\n\t} );\n\ttestChild = new TestChild();\n\tassert.strictEqual( testChild.protoMethod(), false );\n} );\n","var\n\tModuleLoader,\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n/** @type {sinon.SinonSandbox} */ var sandbox; // eslint-disable-line one-var\n\nQUnit.module( 'MobileFrontend ModuleLoader', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\too.setUp( sandbox, global );\n\n\t\tModuleLoader = require( '../../../src/mobile.startup/moduleLoader' );\n\t\tthis.loader = new ModuleLoader();\n\t},\n\tafterEach: function () { sandbox.restore(); }\n} );\n\nQUnit.test( '#require', function ( assert ) {\n\tthis.loader.define( 'foo', 1 );\n\tthis.loader.define( 'bar', 5 );\n\n\tassert.strictEqual( this.loader.require( 'foo' ), 1, 'Returns appropriate module' );\n\tassert.strictEqual( this.loader.require( 'bar' ), 5, 'Returns appropriate module' );\n\n\tassert.throws( function () {\n\t\tthis.loader.require( 'undefinedmodule' );\n\t}, 'Cannot require an undefined module.' );\n\tassert.throws( function () {\n\t\tthis.loader.require( 'mobile.modules/Foo' );\n\t}, 'Cannot require an undefined export on a known module.' );\n} );\n\nQUnit.test( '#define', function ( assert ) {\n\tvar loader = this.loader;\n\tloader.define( 'foo', 1 );\n\tloader.define( 'bar', 5 );\n\tassert.throws( function () {\n\t\tloader.define( 'bar', 50 );\n\t}, 'Cannot define two modules with the same name' );\n\tassert.strictEqual( this.loader.require( 'bar' ), 5, 'Returns first definition of module.' );\n} );\n","var\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\trlModuleLoader,\n\tsandbox;\n\nfunction assertShowHideWorksWhenSuccessful( assert, firstArg, secondArg, thirdArg ) {\n\tvar\n\t\tself = this,\n\t\tresult;\n\n\tsandbox.stub( rlModuleLoader, 'newLoadingOverlay' ).returns( this.stub );\n\n\tresult = rlModuleLoader.loadModule( firstArg, secondArg, thirdArg );\n\n\tassert.strictEqual( this.stub.show.callCount, 1, 'LoadingOverlay show() called once' );\n\tassert.strictEqual( this.stub.show.getCall( 0 ).args.length, 0, 'LoadingOverlay show() called with no args' );\n\tassert.strictEqual( this.stub.hide.callCount, 0, 'LoadingOverlay hide not called' );\n\n\tthis.deferred.resolve();\n\n\treturn result.then( function ( overlay ) {\n\t\tassert.strictEqual( overlay, self.stub, 'Promise resolves to overlay instance' );\n\t\tassert.strictEqual( self.stub.show.callCount, 1, 'LoadingOverlay show() called once' );\n\t\tassert.strictEqual( self.stub.hide.callCount, 1, 'LoadingOverlay hide() called once' );\n\t\tassert.strictEqual( self.stub.hide.getCall( 0 ).args.length, 0, 'LoadingOverlay hide() called with no args' );\n\t} );\n}\n\nQUnit.module( 'MobileFrontend rlModuleLoader.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\trlModuleLoader = require( '../../../src/mobile.startup/rlModuleLoader' );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// window.scrollTo\n\t\tsandbox.stub( global.window, 'scrollTo' );\n\n\t\tthis.stub = {\n\t\t\tappendTo: sandbox.spy(),\n\t\t\tshow: sandbox.spy(),\n\t\t\thide: sandbox.spy()\n\t\t};\n\t\tthis.deferred = util.Deferred();\n\n\t\tsandbox.stub( mw.loader, 'using' )\n\t\t\t.withArgs( 'mobile.mediaViewer' )\n\t\t\t.returns( this.deferred );\n\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#newLoadingOverlay does not blow up', function ( assert ) {\n\tassert.expect( 0 );\n\n\trlModuleLoader.newLoadingOverlay();\n} );\n\nQUnit.test( '#loadModule when instructed to show/hide overlay and successful', function ( assert ) {\n\treturn assertShowHideWorksWhenSuccessful.apply( this, [ assert, 'mobile.mediaViewer', false, true ] );\n} );\n\nQUnit.test( '#loadModule when instructed to show/hide overlay (default args) and successful', function ( assert ) {\n\treturn assertShowHideWorksWhenSuccessful.apply( this, [ assert, 'mobile.mediaViewer', false ] );\n} );\n\nQUnit.test( '#loadModule when instructed to show/hide overlay and not successful', function ( assert ) {\n\tvar\n\t\tself = this,\n\t\tresult;\n\n\tsandbox.stub( rlModuleLoader, 'newLoadingOverlay' ).returns( this.stub );\n\n\tresult = rlModuleLoader.loadModule( 'mobile.mediaViewer', false, true );\n\n\tthis.deferred.reject();\n\n\tassert.rejects( result, 'returned promise rejects' );\n\treturn result.catch( function () {\n\t\tassert.strictEqual( self.stub.show.callCount, 1, 'LoadingOverlay show() called once' );\n\t\tassert.strictEqual( self.stub.appendTo.callCount, 1, 'LoadingOverlay appendTo() called once' );\n\t\tassert.strictEqual( self.stub.hide.callCount, 1, 'LoadingOverlay hide() called once' );\n\t\tassert.strictEqual( self.stub.hide.getCall( 0 ).args.length, 0, 'LoadingOverlay hide() called with no args' );\n\t} );\n} );\n\nQUnit.test( '#loadModule when instructed to show/not hide overlay and successful', function ( assert ) {\n\tvar\n\t\tself = this,\n\t\tresult;\n\n\tsandbox.stub( rlModuleLoader, 'newLoadingOverlay' ).returns( this.stub );\n\n\tresult = rlModuleLoader.loadModule( 'mobile.mediaViewer', true, true );\n\n\tassert.strictEqual( this.stub.show.callCount, 1, 'LoadingOverlay show() called once' );\n\tassert.strictEqual( this.stub.show.getCall( 0 ).args.length, 0, 'LoadingOverlay show() called with no args' );\n\tassert.strictEqual( this.stub.hide.callCount, 0, 'LoadingOverlay hide() not called' );\n\n\tthis.deferred.resolve();\n\n\treturn result.then( function ( overlay ) {\n\t\tassert.strictEqual( overlay, self.stub, 'Promise resolves to overlay instance' );\n\t\tassert.strictEqual( self.stub.show.callCount, 1, 'LoadingOverlay show() called once' );\n\t\tassert.strictEqual( self.stub.hide.callCount, 0, 'LoadingOverlay hide() not called' );\n\t} );\n} );\n\nQUnit.test( '#loadModule when instructed to show/not hide overlay and not successful', function ( assert ) {\n\tvar\n\t\tself = this,\n\t\tresult;\n\n\tsandbox.stub( rlModuleLoader, 'newLoadingOverlay' ).returns( this.stub );\n\n\tresult = rlModuleLoader.loadModule( 'mobile.mediaViewer', true, true );\n\n\tthis.deferred.reject();\n\n\tassert.rejects( result, 'returned promise rejects' );\n\treturn result.catch( function () {\n\t\tassert.strictEqual( self.stub.show.callCount, 1, 'LoadingOverlay show() called once' );\n\t\tassert.strictEqual( self.stub.hide.callCount, 0, 'LoadingOverlay hide() not called' );\n\t} );\n} );\n\nQUnit.test( '#loadModule when instructed to not show overlay and successful', function ( assert ) {\n\tvar\n\t\tself = this,\n\t\tresult;\n\n\tsandbox.stub( rlModuleLoader, 'newLoadingOverlay' ).returns( this.stub );\n\n\tresult = rlModuleLoader.loadModule( 'mobile.mediaViewer', false, false );\n\n\tassert.strictEqual( this.stub.show.callCount, 0, 'LoadingOverlay show() not called' );\n\tassert.strictEqual( this.stub.hide.callCount, 0, 'LoadingOverlay hide() not called' );\n\n\tthis.deferred.resolve();\n\n\treturn result.then( function ( overlay ) {\n\t\tassert.strictEqual( overlay, self.stub, 'Promise resolves to overlay instance' );\n\t\tassert.strictEqual( self.stub.show.callCount, 0, 'LoadingOverlay show() not called' );\n\t\tassert.strictEqual( self.stub.hide.callCount, 0, 'LoadingOverlay hide() not called' );\n\t} );\n} );\n\nQUnit.test( '#loadModule when instructed to not show overlay and not successful', function ( assert ) {\n\tvar\n\t\tself = this,\n\t\tresult;\n\n\tsandbox.stub( rlModuleLoader, 'newLoadingOverlay' ).returns( this.stub );\n\n\tresult = rlModuleLoader.loadModule( 'mobile.mediaViewer', false, false );\n\n\tthis.deferred.reject();\n\n\tassert.rejects( result, 'returned promise rejects' );\n\treturn result.catch( function () {\n\t\tassert.strictEqual( self.stub.show.callCount, 0, 'LoadingOverlay show() not called' );\n\t\tassert.strictEqual( self.stub.hide.callCount, 0, 'LoadingOverlay hide() not called' );\n\t} );\n} );\n","var time = require( '../../../src/mobile.startup/time' );\n\nQUnit.module( 'MobileFrontend time.js' );\n\nQUnit.test( 'timeAgo()', function ( assert ) {\n\tassert.deepEqual( time.timeAgo( 40 ), {\n\t\tvalue: 40,\n\t\tunit: 'seconds'\n\t} );\n\tassert.deepEqual( time.timeAgo( 149 ), {\n\t\tvalue: 2,\n\t\tunit: 'minutes'\n\t} );\n\tassert.deepEqual( time.timeAgo( 150 ), {\n\t\tvalue: 3,\n\t\tunit: 'minutes'\n\t} );\n\tassert.deepEqual( time.timeAgo( 7500 ), {\n\t\tvalue: 2,\n\t\tunit: 'hours'\n\t} );\n\tassert.deepEqual( time.timeAgo( 90000 ), {\n\t\tvalue: 1,\n\t\tunit: 'days'\n\t} );\n\tassert.deepEqual( time.timeAgo( 9000000 ), {\n\t\tvalue: 3,\n\t\tunit: 'months'\n\t} );\n\tassert.deepEqual( time.timeAgo( 32000000 ), {\n\t\tvalue: 1,\n\t\tunit: 'years'\n\t} );\n\tassert.deepEqual( time.timeAgo( 102000000 ), {\n\t\tvalue: 3,\n\t\tunit: 'years'\n\t} );\n} );\n","/* global $ */\nvar util,\n\tdom = require( '../utils/dom' ),\n\tmw = require( '../utils/mw' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\n/** @type {sinon.SinonSandbox} */ var sandbox; // eslint-disable-line one-var\n\nQUnit.module( 'MobileFrontend util.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'escapeSelector()', function ( assert ) {\n\tassert.strictEqual(\n\t\tutil.escapeSelector( '#selector-starts-with-hash' ),\n\t\t'\\\\#selector-starts-with-hash'\n\t);\n} );\n\nQUnit.test( 'grep()', function ( assert ) {\n\tassert.deepEqual(\n\t\tutil.grep( [ 1, 2 ], function ( n ) {\n\t\t\treturn n > 1;\n\t\t} ),\n\t\t[ 2 ]\n\t);\n} );\n\nQUnit.test( 'docReady()', function ( assert ) {\n\tvar docReady = util.docReady();\n\tassert.strictEqual(\n\t\tdocReady instanceof $,\n\t\ttrue\n\t);\n} );\n\nQUnit.test( 'when()', function ( assert ) {\n\treturn util.when( { resolved: true } ).then( function ( res ) {\n\t\tassert.strictEqual(\n\t\t\tres.resolved,\n\t\t\ttrue\n\t\t);\n\t} );\n} );\n\nQUnit.test( 'Deferred() - resolve', function ( assert ) {\n\tvar deferred = new util.Deferred(),\n\t\tresponse = 'response';\n\tdeferred.resolve( response );\n\treturn deferred.then( function ( res ) {\n\t\tassert.strictEqual( res, response );\n\t} );\n} );\n\nQUnit.test( 'Deferred() - reject', function ( assert ) {\n\tvar deferred = new util.Deferred(),\n\t\tresponse = 'response';\n\tdeferred.reject( response );\n\treturn deferred.catch( function ( error ) {\n\t\tassert.strictEqual( error, response );\n\t} );\n} );\nQUnit.test( 'getDocument()', function ( assert ) {\n\tassert.strictEqual( util.getDocument().length, 1 );\n} );\n\nQUnit.test( 'getWindow()', function ( assert ) {\n\tassert.strictEqual( util.getWindow().length, 1 );\n} );\n\nQUnit.test( 'parseHTML()', function ( assert ) {\n\tvar htmlFragment = util.parseHTML( '<p>element content</p>', document );\n\tassert.strictEqual( typeof htmlFragment === 'object', true );\n\tassert.strictEqual( htmlFragment[ 0 ].innerHTML, 'element content' );\n} );\n\nQUnit.test( 'isNumeric()', function ( assert ) {\n\tassert.strictEqual( util.isNumeric( 123 ), true );\n\tassert.strictEqual( util.isNumeric( '123' ), true );\n\tassert.strictEqual( util.isNumeric( 'The string 123 is true? I don\\'t like it.' ), false );\n\tassert.strictEqual( util.isNumeric( NaN ), false );\n} );\n\nQUnit.test( 'extend()', function ( assert ) {\n\tvar a = { a: 'apple' },\n\t\tb = { b: 'banana' };\n\tutil.extend( a, b );\n\tassert.strictEqual( JSON.stringify( a ), '{\"a\":\"apple\",\"b\":\"banana\"}' );\n} );\n\nQUnit.test( 'escapeHash()', function ( assert ) {\n\tassert.strictEqual( util.escapeHash( '#escape:...hash' ), '#escape\\\\:\\\\.\\\\.\\\\.hash' );\n} );\n\nQUnit.test( 'isModifiedEvent() - true', function ( assert ) {\n\tvar testEl = document.createElement( 'div' );\n\n\ttestEl.addEventListener( 'click', function ( ev ) {\n\t\tassert.strictEqual( util.isModifiedEvent( ev ), true );\n\t} );\n\n\ttestEl.dispatchEvent( new window.MouseEvent( 'click', { ctrlKey: true } ) );\n} );\n\nQUnit.test( 'isModifiedEvent() - false', function ( assert ) {\n\tvar testEl = document.createElement( 'div' );\n\n\ttestEl.addEventListener( 'click', function ( ev ) {\n\t\tassert.strictEqual( util.isModifiedEvent( ev ), false );\n\t} );\n\n\ttestEl.dispatchEvent( new window.MouseEvent( 'click' ) );\n} );\n\nQUnit.test( 'repeatEvent', function ( assert ) {\n\tvar proxy = new OO.EventEmitter(),\n\t\tsrc = new OO.EventEmitter(),\n\t\tsrcEventData = 'test data';\n\n\tutil.repeatEvent( src, proxy, 'test' );\n\n\tproxy.on( 'test', function ( data ) {\n\t\tassert.strictEqual(\n\t\t\tdata,\n\t\t\tsrcEventData,\n\t\t\t'proxy responds to source events correctly' );\n\t} );\n\tsrc.emit( 'test', srcEventData );\n} );\n","module.exports = {\n\tgetPageHeadings: {\n\t\tinput: {\n\t\t\tmobileview: {\n\t\t\t\tid: -1,\n\t\t\t\tdisplaytitle: 'Test',\n\t\t\t\trevId: 42,\n\t\t\t\tlastmodifiedby: {\n\t\t\t\t\tname: 'bob',\n\t\t\t\t\tgender: 'unknown'\n\t\t\t\t},\n\t\t\t\tprotection: [],\n\t\t\t\tlastmodified: '2013-10-28T18:49:56Z',\n\t\t\t\tlanguagecount: 10,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 0,\n\t\t\t\t\t\ttext: ''\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '1',\n\t\t\t\t\t\tline: '1',\n\t\t\t\t\t\tanchor: '1',\n\t\t\t\t\t\tid: 1,\n\t\t\t\t\t\ttext: '<p>Text of 1\\n</p>'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: '<i>1.1</i>',\n\t\t\t\t\t\tanchor: '1.1',\n\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\ttext: '<p>Text of 1.1\\n</p>'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '1',\n\t\t\t\t\t\tline: '2',\n\t\t\t\t\t\tanchor: '2',\n\t\t\t\t\t\tid: 3,\n\t\t\t\t\t\ttext: '<p>Text of 2\\n</p>'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: '2.1',\n\t\t\t\t\t\tanchor: '2.1',\n\t\t\t\t\t\tid: 4,\n\t\t\t\t\t\ttext: '<p>Text of 2.1\\n</p>'\n\t\t\t\t\t} ]\n\t\t\t}\n\t\t},\n\t\toutput: {\n\t\t\thistoryUrl: 'Test:History',\n\t\t\tlastModifiedUserName: 'bob',\n\t\t\tlastModifiedUserGender: 'unknown',\n\t\t\tlastModifiedTimestamp: 1382986196,\n\t\t\ttitle: 'Test',\n\t\t\trevId: 42,\n\t\t\tdisplayTitle: 'Test',\n\t\t\tid: -1,\n\t\t\tprotection: {\n\t\t\t\tedit: [ '*' ]\n\t\t\t},\n\t\t\tisMainPage: false,\n\t\t\tlanguageCount: 10,\n\t\t\thasVariants: false,\n\t\t\tlead: '',\n\t\t\tsections: [\n\t\t\t\t{\n\t\t\t\t\tlevel: '1',\n\t\t\t\t\tline: '1',\n\t\t\t\t\tanchor: '1',\n\t\t\t\t\tid: 1,\n\t\t\t\t\ttext: '<p>Text of 1\\n</p><h2 id=\"1.1\"><i>1.1</i></h2>\\n<p>Text of 1.1\\n</p>\\n',\n\t\t\t\t\tsubsections: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\t\tline: '<i>1.1</i>',\n\t\t\t\t\t\t\tanchor: '1.1',\n\t\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\t\ttext: '<p>Text of 1.1\\n</p>',\n\t\t\t\t\t\t\tsubsections: []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlevel: '1',\n\t\t\t\t\tline: '2',\n\t\t\t\t\tanchor: '2',\n\t\t\t\t\tid: 3,\n\t\t\t\t\ttext: '<p>Text of 2\\n</p><h2 id=\"2.1\">2.1</h2>\\n<p>Text of 2.1\\n</p>\\n',\n\t\t\t\t\tsubsections: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\t\tline: '2.1',\n\t\t\t\t\t\t\tanchor: '2.1',\n\t\t\t\t\t\t\tid: 4,\n\t\t\t\t\t\t\ttext: '<p>Text of 2.1\\n</p>',\n\t\t\t\t\t\t\tsubsections: []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t},\n\tgetPage: {\n\t\tinput: {\n\t\t\tmobileview: {\n\t\t\t\tid: -1,\n\t\t\t\tprotection: {\n\t\t\t\t\tedit: [ 'sysop' ]\n\t\t\t\t},\n\t\t\t\tlastmodifiedby: {\n\t\t\t\t\tname: 'Melissa',\n\t\t\t\t\tgender: 'female'\n\t\t\t\t},\n\t\t\t\trevId: 42,\n\t\t\t\tdisplaytitle: 'Test',\n\t\t\t\tlastmodified: '2013-10-28T18:49:56Z',\n\t\t\t\tlanguagecount: 10,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 0,\n\t\t\t\t\t\ttext: 'lead content'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: 'Aaa section',\n\t\t\t\t\t\tanchor: 'Aaa_section',\n\t\t\t\t\t\tid: 1,\n\t\t\t\t\t\ttext: 'aaa content'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '3',\n\t\t\t\t\t\tline: 'Subaaa section',\n\t\t\t\t\t\tanchor: 'Subaaa_section',\n\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\ttext: 'subaaa content'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: 'Bbb section',\n\t\t\t\t\t\tanchor: 'Bbb_section',\n\t\t\t\t\t\tid: 3,\n\t\t\t\t\t\ttext: 'bbb content'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: 'References',\n\t\t\t\t\t\treferences: '',\n\t\t\t\t\t\tanchor: 'References',\n\t\t\t\t\t\tid: 4,\n\t\t\t\t\t\ttext: 'references'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\t\toutput: {\n\t\t\thistoryUrl: 'Test:History',\n\t\t\tlastModifiedUserName: 'Melissa',\n\t\t\tlastModifiedUserGender: 'female',\n\t\t\tlastModifiedTimestamp: 1382986196,\n\t\t\tprotection: {\n\t\t\t\tedit: [ 'sysop' ]\n\t\t\t},\n\t\t\ttitle: 'Test',\n\t\t\tdisplayTitle: 'Test',\n\t\t\tid: -1,\n\t\t\tisMainPage: false,\n\t\t\trevId: 42,\n\t\t\tlanguageCount: 10,\n\t\t\thasVariants: false,\n\t\t\tlead: 'lead content',\n\t\t\tsections: [\n\t\t\t\t{\n\t\t\t\t\tlevel: '2',\n\t\t\t\t\tline: 'Aaa section',\n\t\t\t\t\tanchor: 'Aaa_section',\n\t\t\t\t\tid: 1,\n\t\t\t\t\ttext: 'aaa content<h3 id=\"Subaaa_section\">Subaaa section</h3>\\nsubaaa content\\n',\n\t\t\t\t\tsubsections: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlevel: '3',\n\t\t\t\t\t\t\tline: 'Subaaa section',\n\t\t\t\t\t\t\tanchor: 'Subaaa_section',\n\t\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\t\ttext: 'subaaa content',\n\t\t\t\t\t\t\tsubsections: []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlevel: '2',\n\t\t\t\t\tline: 'Bbb section',\n\t\t\t\t\tanchor: 'Bbb_section',\n\t\t\t\t\tid: 3,\n\t\t\t\t\ttext: 'bbb content',\n\t\t\t\t\tsubsections: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlevel: '2',\n\t\t\t\t\tline: 'References',\n\t\t\t\t\treferences: '',\n\t\t\t\t\tanchor: 'References',\n\t\t\t\t\tid: 4,\n\t\t\t\t\ttext: 'references',\n\t\t\t\t\tsubsections: []\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t},\n\tgetPageLanguagesResponse: {\n\t\tinput: {\n\t\t\tquery: {\n\t\t\t\tpages: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpageid: 94,\n\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\t\tlanglinks: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlang: 'es',\n\t\t\t\t\t\t\t\turl: 'http://es.wikipedia.org/wiki/San_Francisco_(California)',\n\t\t\t\t\t\t\t\ttitle: 'San Francisco (California)',\n\t\t\t\t\t\t\t\tautonym: 'espa\\u00f1ol'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlang: 'pl',\n\t\t\t\t\t\t\t\turl: 'http://pl.wikipedia.org/wiki/San_Francisco',\n\t\t\t\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\t\t\t\tautonym: 'polski'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlang: 'sr',\n\t\t\t\t\t\t\t\turl: 'http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE',\n\t\t\t\t\t\t\t\ttitle: '\\u0421\\u0430\\u043d \\u0424\\u0440\\u0430\\u043d\\u0446\\u0438\\u0441\\u043a\\u043e',\n\t\t\t\t\t\t\t\tautonym: '\\u0441\\u0440\\u043f\\u0441\\u043a\\u0438 / srpski'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tgeneral: {\n\t\t\t\t\tvariants: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: 'sr',\n\t\t\t\t\t\t\tname: 'sr'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: 'sr-ec',\n\t\t\t\t\t\t\tname: '\\u040b\\u0438\\u0440\\u0438\\u043b\\u0438\\u0446\\u0430'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: 'sr-el',\n\t\t\t\t\t\t\tname: 'Latinica'\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tvariantarticlepath: '/$2/$1'\n\t\t\t\t},\n\t\t\t\tlanguages: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'sr',\n\t\t\t\t\t\tname: 'српски / srpski'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'sr-ec',\n\t\t\t\t\t\tname: 'српски (ћирилица)'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'sr-el',\n\t\t\t\t\t\tname: 'srpski (latinica)‎'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'es',\n\t\t\t\t\t\tname: 'español'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'pl',\n\t\t\t\t\t\tname: 'polski'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tlimits: {\n\t\t\t\tlanglinks: 500\n\t\t\t}\n\t\t},\n\t\toutput: {\n\t\t\tlanguages: [\n\t\t\t\t{\n\t\t\t\t\tlang: 'es',\n\t\t\t\t\turl: 'http://es.wikipedia.org/wiki/San_Francisco_(California)',\n\t\t\t\t\ttitle: 'San Francisco (California)',\n\t\t\t\t\tautonym: 'espa\\u00f1ol'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'pl',\n\t\t\t\t\turl: 'http://pl.wikipedia.org/wiki/San_Francisco',\n\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\tautonym: 'polski'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr',\n\t\t\t\t\turl: 'http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE',\n\t\t\t\t\ttitle: '\\u0421\\u0430\\u043d \\u0424\\u0440\\u0430\\u043d\\u0446\\u0438\\u0441\\u043a\\u043e',\n\t\t\t\t\tautonym: '\\u0441\\u0440\\u043f\\u0441\\u043a\\u0438 / srpski'\n\t\t\t\t}\n\t\t\t],\n\t\t\tvariants: [\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr',\n\t\t\t\t\tautonym: 'sr',\n\t\t\t\t\turl: '/sr/Test'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr-ec',\n\t\t\t\t\tautonym: '\\u040b\\u0438\\u0440\\u0438\\u043b\\u0438\\u0446\\u0430',\n\t\t\t\t\turl: '/sr-ec/Test'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr-el',\n\t\t\t\t\tautonym: 'Latinica',\n\t\t\t\t\turl: '/sr-el/Test'\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t},\n\tgetPageLanguagesCall: {\n\t\toutput: {\n\t\t\taction: 'query',\n\t\t\tmeta: 'siteinfo',\n\t\t\tsiprop: 'general',\n\t\t\tprop: 'langlinks',\n\t\t\tllprop: 'url|autonym|langname',\n\t\t\tllinlanguagecode: 'fr',\n\t\t\tlllimit: 'max',\n\t\t\ttitles: 'Title',\n\t\t\tformatversion: 2\n\t\t}\n\t},\n\tgetAPIResponseFromHTML: {\n\t\tinput: [\n\t\t\t{\n\t\t\t\tline: 'A1',\n\t\t\t\tlevel: '1',\n\t\t\t\tanchor: '1.0',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2.2',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2',\n\t\t\t\tlevel: '1',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t}\n\t\t]\n\t}\n\n};\n","/* eslint-env es6 */\nvar page, page2, skinPage, referencesPage, lazyLoadedReferencesPage;\n\n/**\n * Important..\n * Even though this page supports ES6, it is still compiled to ES5\n * friendly JavaScript.\n * It is thus imperative you do not use substitution in these templates\n * or any other ES6 functions.\n * It is expected to run in Special:JavaScript/qunit/test.\n * A linter will bark at you if you break this.\n */\n\npage = `<div>\n\t<h1><span class=\"mw-headline\" id=\"1.0\">A1</span></h1>\n\t<h2><span class=\"mw-headline\">A2.1</span></h2>\n\t<h2><span class=\"mw-headline\">A2.2</span></h2>\n\t<h1><span class=\"mw-headline\">A2</span></h1>\n\t<h2><span class=\"mw-headline\">A2.1</span><span>[<a href=\"#\">edit</a>]</span></h2>\n\t<h1>Not to be shown in the TOC<span class=\"placeholder\"></span></h1>\n</div>`;\n\npage2 = `<div>\n<h2><span class=\"mw-headline\" id=\"1.0\">A1</span></h2>\n<h3><span class=\"mw-headline\">A2.1</span></h3>\n<h2><span class=\"mw-headline\">A2.2</span></h2>\n<h1><span class=\"mw-headline\">A2</span></h1>\n<h2><span class=\"mw-headline\">A2.1</span></h2>\n</div>`;\n\nskinPage = `<div id=\"mw-content-text\">\n\t<h2 class=\"section-heading collapsible-heading open-block\">\n\t\t<span class=\"mw-headline\" id=\"Notes_and_references\">Notes and references</span>\n\t</h2>\n\t<div class=\"mf-section-2 collapsible-block open-block\" data-is-reference-section=\"1\">\n\t\t<p>Text</p>\n\t\t<a class=\"mf-lazy-references-placeholder\"></a>\n\t\t<h3><span class=\"mw-headline\" id=\"Notes\">Notes</span></h3>\n\t\t<a class=\"mf-lazy-references-placeholder\"></a>\n\t\t<h4 class=\"in-block\"><span class=\"mw-headline\" id=\"Refs\">Refs</span></h4>\n\t\t<a class=\"mf-lazy-references-placeholder\"></a>\n\t\t<p>no forget</p>\n\t\t<h5 class=\"in-block\"><span class=\"mw-headline\" id=\"More_refs\">More refs</span></h5>\n\t\t<p>1</p>\n\t\t<a class=\"mf-lazy-references-placeholder\"></a>\n\t\t<p>2</p>\n\t\t<a class=\"mf-lazy-references-placeholder\"></a>\n\t\t<p>3</p>\n\t</div>\n</div>`;\n\nreferencesPage = `<div id=\"mfe-test-references\">\n<sup id=\"cite_ref-1\" class=\"reference\">\n\t<a href=\"#cite_note-1\">[1]</a>\n</sup>\n<p>\n\tsup with encoded href attribute\n\t<sup id=\"cite_ref-Obama_1995,_2004,_pp._9–10_11-0\" class=\"reference\">\n\t\t<a href=\"#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11\">[11]</a>\n\t</sup>\n</p>\n<ol class=\"references\">\n\t<li id=\"cite_note-1\">\n\t\t<span class=\"mw-cite-backlink\">\n\t\t\t<a href=\"#cite_ref-1\">↑</a>\n\t\t</span> <span class=\"reference-text\">hello</span>\n\t</li>\n\t<li id=\"cite_note-Obama_1995,_2004,_pp._9–10-11\">\n\t\t<span class=\"mw-cite-backlink\">\n\t\t\t<a href=\"#cite_ref-1\">↑</a>\n\t\t</span> <span class=\"reference-text\">found</span>\n\t</li>\n</ol>\n</div>`;\n\nlazyLoadedReferencesPage = `<div>\n<h2><span class=\"mw-headline\" id=\"1.0\">A1</span></h1>\n<div>text</div>\n<h2>references</h2>\n<div>\n\t<a class=\"mf-lazy-references-placeholder\">View citations</a>\n</div>\n</div>`;\n\nmodule.exports = {\n\tlazyLoadedReferencesPage: lazyLoadedReferencesPage,\n\treferencesPage: referencesPage,\n\tskinPage: skinPage,\n\tpage: page,\n\tpage2: page2\n};\n","var\n\theadless = typeof window !== 'object',\n\tjsdom = headless && require( 'jsdom' );\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tglobal.window = global.window || undefined;\n\t\t\tglobal.document = global.document || undefined;\n\t\t\tsandbox.stub( global, 'window', new jsdom.JSDOM().window );\n\t\t\tsandbox.stub( global, 'document', window.document );\n\t\t}\n\t}\n};\n","var headless = typeof window !== 'object';\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tglobal.$ = global.$ || undefined;\n\t\t\tsandbox.stub( global, '$', require( 'jquery' ) );\n\t\t}\n\t},\n\ttearDown: function () {\n\t\tif ( headless ) {\n\t\t\t// prevent jQuery from caching the global window object.\n\t\t\tdelete require.cache[require.resolve( 'jquery' )];\n\t\t}\n\t}\n};\n","var\n\theadless = typeof window !== 'object',\n\tnewMockMediaWiki = require( './mockMediaWiki' );\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tglobal.mw = global.mw || undefined;\n\t\t\tsandbox.stub( global, 'mw', newMockMediaWiki() );\n\t\t}\n\t}\n};\n","var headless = typeof window !== 'object';\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tglobal.OO = global.OO || undefined;\n\t\t\tsandbox.stub( global, 'OO', require( 'oojs' ) );\n\t\t}\n\t}\n};\n","(function() { module.exports = this[\"jquery\"]; }());","(function() { module.exports = this[\"jsdom\"]; }());","(function() { module.exports = this[\"oojs\"]; }());","(function() { module.exports = this[\"sinon\"]; }());"],"sourceRoot":""}