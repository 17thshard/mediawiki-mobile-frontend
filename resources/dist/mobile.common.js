(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./src/mobile.editor.overlay/parseSaveError.js":function(e,t){e.exports=function(e,t){var i;if(t)switch(t){case"readonly":return{type:"readonly",details:e.error};case"editconflict":return{type:"editconflict",details:e.error};default:return{type:"error",details:"http"}}if(e){if(e.error)return{type:"error",details:e.error.code};if(e.edit&&e.edit.captcha)return{type:"captcha",details:e.edit.captcha};if(e.edit&&e.edit.code)return t=e.edit.code,i=e.edit.warning,/^abusefilter-warning/.test(t)?{type:"abusefilter",details:{type:"warning",message:i}}:/^abusefilter-disallow/.test(t)?{type:"abusefilter",details:{type:"disallow",message:i}}:/^abusefilter/.test(t)?{type:"abusefilter",details:{type:"other",message:i}}:{type:"error",details:t}}return{type:"error",details:"unknown"}}},"./src/mobile.startup/Anchor.js":function(e,t,i){var s=i("./src/mobile.startup/View.js");function n(){s.apply(this,arguments)}i("./src/mobile.startup/mfExtend.js")(n,s,{isTemplateMode:!0,defaults:{progressive:void 0,destructive:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","anchor.hogan")}),e.exports=n},"./src/mobile.startup/Browser.js":function(e,t,i){var s,n=i("./src/mobile.startup/util.js");function r(e){var t=function t(){var i=this["__cache"+t.cacheId]||(this["__cache"+t.cacheId]={}),s=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(i,s)?i[s]:i[s]=e.apply(this,arguments)};return t.cacheId=Date.now().toString()+Math.random().toString(),t}function o(e,t){this.userAgent=e,this.$el=t,this._fixIosLandscapeBug()}o.prototype={_fixIosLandscapeBug:function(){var e=this;this.$el.find('meta[name="viewport"]')[0]&&(this.isIos(4)||this.isIos(5))&&(this.lockViewport(),document.addEventListener("gesturestart",function(){e.lockViewport()},!1))},isIos:r(function(e){var t=this.userAgent,i=/ipad|iphone|ipod/i.test(t);if(!i||!e)return i;switch(e){case 8:return/OS 8_/.test(t)||/Version\/8/.test(t);case 4:return/OS 4_/.test(t);case 5:return/OS 5_/.test(t);default:return!1}}),lockViewport:function(){this.$el&&this.$el.find('meta[name="viewport"]').attr("content","initial-scale=1.0, maximum-scale=1.0, user-scalable=no")},isWideScreen:r(function(){var e=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=e||window.innerHeight>=e}),supportsAnimations:r(function(){var e=document.createElement("foo").style;function t(t){return t in e||"webkit"+t[0].toUpperCase()+t.slice(1)in e}return t("animationName")&&t("transform")&&t("transition")}),supportsTouchEvents:r(function(){return"ontouchstart"in window}),supportsGeoLocation:r(function(){return"geolocation"in window.navigator})},o.getSingleton=function(){var e;return s||(e=n.getDocument(),s=new o(window.navigator.userAgent,e)),s},e.exports=o},"./src/mobile.startup/Button.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/View.js");function r(e){e.href&&(e.tagName="a"),n.call(this,e)}s(r,n,{isTemplateMode:!0,defaults:{tagName:"a",block:void 0,progressive:void 0,destructive:void 0,quiet:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","button.hogan")}),e.exports=r},"./src/mobile.startup/CtaDrawer.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/Drawer.js"),r=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/Button.js"),a=i("./src/mobile.startup/Anchor.js");function l(e){n.call(this,r.extend({},n.prototype.defaults,{progressiveButton:new o({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,actionAnchor:new a({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options},e))}function c(e,t){return r.extend({returnto:t||mw.config.get("wgPageName")},e)}function u(){return[].push.call(arguments,{type:"signup"}),r.extend.apply(r,arguments)}s(l,n,{templatePartials:r.extend({},n.prototype.templatePartials,{button:o.prototype.template,anchor:a.prototype.template}),template:mw.template.get("mobile.startup","CtaDrawer.hogan"),preRender:function(){var e=c(this.options.queryParams,this.options.returnTo);this.options.progressiveButton.href||(this.options.progressiveButton.href=mw.util.getUrl("Special:UserLogin",e)),this.options.actionAnchor.href||(this.options.actionAnchor.href=mw.util.getUrl("Special:UserLogin",u(e,this.options.signupQueryParams)))}}),l.prototype.test={redirectParams:c,signUpParams:u},e.exports=l},"./src/mobile.startup/Drawer.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/Panel.js"),r=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/Icon.js");function a(e){n.call(this,r.extend({className:"drawer position-fixed"},e,{events:r.extend({click:"stopPropagation"},(e||{}).events)}))}s(a,n,{defaults:r.extend({},n.prototype.defaults,{collapseIcon:new o({name:"arrow",additionalClassNames:"cancel"}).options}),templatePartials:r.extend({},n.prototype.templatePartials,{icon:o.prototype.template}),appendToElement:"body",closeOnScroll:!0,postRender:function(){var e=this;r.docReady(function(){e.appendTo(e.appendToElement),e.$el.parent().addClass("has-drawer")}),this.on("show",this.onShowDrawer.bind(this)),this.on("hide",this.onHideDrawer.bind(this))},stopPropagation:function(e){e.stopPropagation()},onShowDrawer:function(){var e=this;this.$el.parent().addClass("drawer-visible"),setTimeout(function(){var t=r.getWindow();t.one("click.drawer",e.hide.bind(e)),e.closeOnScroll&&t.one("scroll.drawer",e.hide.bind(e))},e.minHideDelay)},onHideDrawer:function(){this.$el.parent().removeClass("drawer-visible"),r.getWindow().off(".drawer")}}),e.exports=a},"./src/mobile.startup/Icon.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/View.js");function r(e){e.hasText&&(e.modifier="mw-ui-icon-before"),e.href&&(e.tagName="a"),n.call(this,e)}s(r,n,{preRender:function(){this.setRotationClass()},setRotationClass:function(){var e=this.options;if(e.rotation)switch(e.rotation){case-180:case 180:e._rotationClass="mf-mw-ui-icon-rotate-flip";break;case-90:e._rotationClass="mf-mw-ui-icon-rotate-anti-clockwise";break;case 90:e._rotationClass="mf-mw-ui-icon-rotate-clockwise";break;case 0:break;default:throw new Error("Bad value for rotation given. Must be ±90, 0 or ±180.")}},isTemplateMode:!0,defaults:{rotation:0,hasText:!1,href:void 0,glyphPrefix:"mf",tagName:"div",isSmall:!1,base:"mw-ui-icon",name:"",modifier:"mw-ui-icon-element",title:""},getClassName:function(){return this.$el.attr("class")},getGlyphClassName:function(){return this.options.base+"-"+this.options.glyphPrefix+"-"+this.options.name},toHtmlString:function(){return this.parseHTML("<div>").append(this.$el).html()},template:mw.template.get("mobile.startup","icon.hogan")}),e.exports=r},"./src/mobile.startup/MessageBox.js":function(e,t,i){var s=i("./src/mobile.startup/View.js");function n(){s.apply(this,arguments)}i("./src/mobile.startup/mfExtend.js")(n,s,{isTemplateMode:!0,defaults:{},template:mw.template.get("mobile.startup","MessageBox.hogan")}),e.exports=n},"./src/mobile.startup/Overlay.js":function(e,t,i){var s=i("./src/mobile.startup/View.js"),n=i("./src/mobile.startup/Icon.js"),r=i("./src/mobile.startup/Button.js"),o=i("./src/mobile.startup/Anchor.js"),a=i("./src/mobile.startup/icons.js"),l=i("./src/mobile.startup/util.js"),c=i("./src/mobile.startup/Browser.js").getSingleton();function u(e){this.isIos=c.isIos(),this.hasLoadError=!1,s.call(this,l.extend({className:"overlay"},e,{events:l.extend({"click .cancel, .confirm, .initial-header .back":"onExitClick",click:"stopPropagation"},e.events)}))}i("./src/mobile.startup/mfExtend.js")(u,s,{hasFixedHeader:!0,fullScreen:!0,hideOnExitClick:!0,templatePartials:{header:mw.template.get("mobile.startup","header.hogan"),anchor:o.prototype.template,button:r.prototype.template},template:mw.template.get("mobile.startup","Overlay.hogan"),defaults:{saveMsg:mw.msg("mobile-frontend-editor-save"),cancelButton:a.cancel().toHtmlString(),backButton:new n({tagName:"button",name:"back",additionalClassNames:"back",label:mw.msg("mobile-frontend-overlay-close")}).toHtmlString(),headerButtonsListClassName:"",headerChrome:!1,spinner:a.spinner().toHtmlString()},closeOnContentTap:!1,showSpinner:function(){this.$spinner.removeClass("hidden")},hideSpinner:function(){this.$spinner.addClass("hidden")},postRender:function(){this.$overlayContent=this.$(".overlay-content"),this.$spinner=this.$(".spinner"),this.isIos&&this.$el.addClass("overlay-ios"),this.$(".overlay-header h2 span").addClass("truncated-text"),this.setupEmulatedIosOverlayScrolling()},setupEmulatedIosOverlayScrolling:function(){var e=this;this.isIos&&this.hasFixedHeader&&(this.$(".overlay-content").on("touchstart",this.onTouchStart.bind(this)).on("touchmove",this.onTouchMove.bind(this)),setTimeout(function(){var t=l.getWindow();e._resizeContent(t.height())},0))},onExitClick:function(e){e.preventDefault(),e.stopPropagation(),this.hideOnExitClick&&this.hide(),this.emit(u.EVENT_EXIT)},onTouchStart:function(e){this.startY=e.originalEvent.touches[0].pageY},onTouchMove:function(e){var t=e.originalEvent.touches[0].pageY,i=this.$overlayContent.outerHeight(),s=this.$overlayContent.prop("scrollHeight")-i;e.stopPropagation(),(0===this.$overlayContent.scrollTop()&&this.startY<t||this.$overlayContent.scrollTop()===s&&this.startY>t)&&e.preventDefault()},stopPropagation:function(e){e.stopPropagation()},show:function(){var e=this,t=l.getDocument(),i=l.getWindow();this.scrollTop=window.pageYOffset,this.fullScreen&&(t.addClass("overlay-enabled"),window.scrollTo(0,1)),this.closeOnContentTap&&t.find("#mw-mf-page-center").one("click",this.hide.bind(this)),this.isIos&&this.hasFixedHeader&&i.on("touchmove.ios",function(e){e.preventDefault()}).on("resize.ios",function(){e._resizeContent(i.height())}),this.$el.addClass("visible")},hide:function(){var e=l.getWindow(),t=l.getDocument();return this.fullScreen&&(t.removeClass("overlay-enabled"),window.scrollTo(window.pageXOffset,this.scrollTop)),this.$el.detach(),this.isIos&&e.off(".ios"),this.emit("hide"),!0},_resizeContent:function(e){this.$overlayContent.height(e-this.$(".overlay-header-container").outerHeight()-this.$(".overlay-footer-container").outerHeight())},showHidden:function(e){this.$(".hideable").addClass("hidden"),this.$(e).removeClass("hidden")}}),u.EVENT_EXIT="Overlay-exit",e.exports=u},"./src/mobile.startup/OverlayManager.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n=null;function r(e,t){e.on("route",this._checkRoute.bind(this)),this.router=e,this.entries={},this.stack=[],this.hideCurrent=!0,t||mw.log.warn("appendToSelector will soon be a required parameter to OverlayManager"),this.appendToSelector=t||"body"}function o(e){e.on("hide",function(){e.emit("_om_hide")})}i("./src/mobile.startup/mfExtend.js")(r,{_onHideOverlay:function(){this.hideCurrent=!1,this.router.back()},_attachOverlay:function(e){e.$el.parents().length||$(this.appendToSelector).append(e.$el)},_show:function(e){e.once("_om_hide",this._onHideOverlay.bind(this)),this._attachOverlay(e),e.show()},_hideOverlay:function(e){var t;return e.off("_om_hide"),(t=e.hide(this.stack.length>1))||e.once("_om_hide",this._onHideOverlay.bind(this)),t},_processMatch:function(e){var t,i=this;e&&(e.overlay?i._show(e.overlay):"function"==typeof(t=e.factoryResult).promise?t.then(function(t){e.overlay=t,o(t),i._show(t)}):(e.overlay=t,o(e.overlay),i._show(t)))},_checkRoute:function(e){var t,i=this.stack[0];i||(this.scrollTop=window.pageYOffset),t=Object.keys(this.entries).reduce(function(t,i){return t||this._matchRoute(e.path,this.entries[i])}.bind(this),null),i&&void 0!==i.overlay&&this.hideCurrent&&!this._hideOverlay(i.overlay)?e.preventDefault():t||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(t)},_matchRoute:function(e,t){var i,s=e.match(t.route),n=this.stack[1],r=this;function o(){return{path:e,factoryResult:t.factory.apply(r,s.slice(1))}}return s?n&&n.path===e?n.overlay&&n.overlay.hasLoadError?(r.stack.shift(),r.stack[0]=o(),r.stack[0]):(r.stack.shift(),n):(i=o(),this.stack[0]&&i.path===this.stack[0].path?r.stack[0]=i:r.stack.unshift(i),i):null},add:function(e,t){var i=this,n={route:e,factory:t};this.entries[e]=n,s.docReady(function(){i._processMatch(i._matchRoute(i.router.getPath(),n))})},replaceCurrent:function(e){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");this._hideOverlay(this.stack[0].overlay),this.stack[0].overlay=e,o(e),this._show(e)}}),r.getSingleton=function(){return n||(n=new r(mw.loader.require("mediawiki.router"),"body")),n},e.exports=r},"./src/mobile.startup/Page.js":function(e,t,i){var s=mw.html,n=i("./src/mobile.startup/mfExtend.js"),r=i("./src/mobile.startup/time.js"),o=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/Section.js"),l=i("./src/mobile.startup/Thumbnail.js"),c=i("./src/mobile.startup/View.js"),u=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),h=["noviewer","metadata"];function p(e){o.extend(this,{options:e,title:e.title,displayTitle:e.displayTitle,url:e.url||mw.util.getUrl(e.title),id:e.id,wikidataDescription:e.wikidataDescription,thumbnail:!!Object.prototype.hasOwnProperty.call(e,"thumbnail")&&e.thumbnail,isMissing:void 0!==e.isMissing?e.isMissing:0===e.id}),this.options.isBorderBox=!1,this.options.languageUrl=mw.util.getUrl("Special:MobileLanguages/"+this.title),c.call(this,this.options),this.displayTitle||(this.displayTitle=this.getDisplayTitle()),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}n(p,c,{defaults:{id:0,title:"",displayTitle:"",namespaceNumber:0,protection:{edit:["*"]},sections:[],isMissing:!1,isMainPage:!1,url:void 0,thumbnail:{isLandscape:void 0,source:void 0,width:void 0,height:void 0}},getDisplayTitle:function(){return this.options.displayTitle||s.escape(this.options.title)},inNamespace:function(e){return this.options.namespaceNumber===mw.config.get("wgNamespaceIds")[e]},findSectionHeadingByIndex:function(e){return e<1?this.$():this.$(u).filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(e-1)},findChildInSectionLead:function(e,t){var i,s,n,r,o=u;function a(e){return e.find(t).addBack()}return 0===e?(r=this.getLeadSectionElement())&&r.length?a(r.children(t)):(i=this.findSectionHeadingByIndex(1)).length?a(i.prevAll(t)):this.$(t):(i=this.findSectionHeadingByIndex(e)).hasClass("section-heading")?(s=(n=i.next()).find(o).eq(0)).length?a(s.prevAll(t)):a(n.children(t)):(s=i.eq(0).nextAll(o).eq(0),i.nextUntil(s,t))},getLeadSectionElement:function(){return this.$(".mf-section-0").length?this.$(".mf-section-0"):null},isWikiText:function(){return"wikitext"===mw.config.get("wgPageContentModel")},isMainPage:function(){return this.options.isMainPage},isWatched:function(){return this.options.isWatched},getRevisionId:function(){return this.options.revId},getTitle:function(){return this.options.title},getId:function(){return this.options.id},getNamespaceId:function(){var e=this.options.title.split(":");return e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0},isTalkPage:function(){var e=this.getNamespaceId();return e>0&&e%2==1},preRender:function(){this.sections=[],this._sectionLookup={},this.title=this.options.title,this.options.sections.forEach(function(e){var t=new a(e);this.sections.push(t),this._sectionLookup[t.id]=t}.bind(this))},getThumbnails:function(){var e=this.$el,t="."+h.join(",."),i=[];return this._thumbs||(e.find("a.image, a.thumbimage").not(t).each(function(){var s=e.find(this),n=s.find(".lazy-image-placeholder"),r=0===s.parents(t).length&&0===s.find(t).length,o=s.attr("href").match(/title=([^/&]+)/),a=s.attr("href").match(/[^/]+$/);n.length&&r&&(r=!new RegExp("\\b("+h.join("|")+")\\b").test(n.data("class"))),r&&(o||a)&&i.push(new l({el:s,filename:decodeURIComponent(o?o[1]:a[0])}))}),this._thumbs=i),this._thumbs},getSection:function(e){return this._sectionLookup[e]},getSections:function(){return this.sections},getRedLinks:function(){return this.$(".new")}}),p.newFromJSON=function(e){var t,i,n=e.thumbnail,a=e.pageprops||{displaytitle:s.escape(e.title)},l=e.terms;return(a||l)&&(i=l&&l.label?s.escape(l.label[0]):a.displaytitle),e.wikidataDescription=e.description||void 0,n&&(e.thumbnail.isLandscape=n.width>n.height),e.revisions&&e.revisions[0]&&(t=e.revisions[0],e.lastModified=r.getLastModifiedMessage(new Date(t.timestamp).getTime()/1e3,t.user)),new p(o.extend(e,{id:e.pageid,isMissing:!!e.missing,url:mw.util.getUrl(e.title),displayTitle:i}))},p.HEADING_SELECTOR=u,e.exports=p},"./src/mobile.startup/PageGateway.js":function(e,t,i){var s=mw.template.get("mobile.startup","Section.hogan"),n=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/actionParams.js"),o={};function a(e){var t,i=e.map(function(e){return e.level}).filter(function(e){return!!e}),n=Math.min.apply(this,i).toString(),r=[];return e.forEach(function(e){void 0!==e.line&&(e.line=e.line.replace(/<\/?a\b[^>]*>/g,"")),e.subsections=[],!t||!e.level||e.level===n||t.subsections.length&&t.subsections[0].level>e.level||t.level&&t.level>=e.level?(r.push(e),t=e):(!function e(t,i){var s;0===t.length?t.push(i):(s=t[t.length-1],parseInt(s.level,10)===parseInt(i.level,10)?t.push(i):e(s.subsections,i))}(t.subsections,e),t.text+=s.render(e))}),r}function l(e){this.api=e}l.prototype={getPage:function(e,t,i){var s,l=n.Deferred(),c=t?{url:t,dataType:"jsonp"}:{},u={edit:["*"]};return n.extend(c,r({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:i?0:"all"})),o[e]||(o[e]=this.api.get(c).then(function(t){var i,r,o,c;return t.error?l.reject(t.error):t.mobileview.sections?(i=a((c=t.mobileview).sections),s=new Date(c.lastmodified).getTime()/1e3,r=c.lastmodifiedby,u=Array.isArray(c.protection)?u:n.extend(u,c.protection),o={title:e,id:c.id,revId:c.revId,protection:u,lead:i[0].text,sections:i.slice(1),isMainPage:void 0!==c.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:s,languageCount:c.languagecount,hasVariants:void 0!==c.hasvariants,displayTitle:c.displaytitle},r&&n.extend(o,{lastModifiedUserName:r.name,lastModifiedUserGender:r.gender}),o):l.reject("No sections")},function(e){return l.reject(e)})),o[e]},invalidatePage:function(e){delete o[e]},_getLanguageVariantsFromApiResponse:function(e,t){var i=t.query.general,s=i.variantarticlepath,n=[];return!!i.variants&&(Object.keys(i.variants).forEach(function(t){var r=i.variants[t],o={autonym:r.name,lang:r.code};o.url=s?s.replace("$1",e).replace("$2",r.code):mw.util.getUrl(e,{variant:r.code}),n.push(o)}),n)},getPageLanguages:function(e,t){var i=this,s=r({meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e});return t?(s.llprop="url|autonym|langname",s.llinlanguagecode=t):s.llprop="url|autonym",this.api.get(s).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:i._getLanguageVariantsFromApiResponse(e,t)}},function(){return n.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var i=this.tagName.substr(1),s=e.find(this).find(".mw-headline");s.length&&t.push({level:i,line:s.html(),anchor:s.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return a(this._getAPIResponseFromHTML(e))}},e.exports=l},"./src/mobile.startup/PageList.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/View.js"),r=i("./src/mobile.startup/Browser.js").getSingleton();function o(){n.apply(this,arguments)}s(o,n,{defaults:{pages:[]},renderPageImages:function(){var e=this;setTimeout(function(){e.$(".list-thumb").each(function(){var t=e.$(this).data("style");e.$(this).attr("style",t)})},r.isWideScreen()?0:1e3)},postRender:function(){this.renderPageImages()},template:mw.template.get("mobile.startup","PageList.hogan"),templatePartials:{item:mw.template.get("mobile.startup","PageListItem.hogan")}}),e.exports=o},"./src/mobile.startup/Panel.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/View.js");function o(e){r.call(this,n.extend({className:"panel"},e,{events:n.extend({"click .cancel":"onCancel"},(e||{}).events)}))}s(o,r,{minHideDelay:10,onCancel:function(e){e.preventDefault(),this.hide()},show:function(){var e=this;e.isVisible()||setTimeout(function(){e.$el.addClass("visible animated"),e.emit("show")},e.minHideDelay)},hide:function(){var e=this;setTimeout(function(){e.$el.removeClass("visible"),e.emit("hide")},e.minHideDelay)},isVisible:function(){return this.$el.hasClass("visible")},toggle:function(){this.isVisible()?this.hide():this.show()}}),e.exports=o},"./src/mobile.startup/ScrollEndEventEmitter.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n=i("./src/mobile.startup/mfExtend.js");function r(e,t){this.threshold=t||100,this.eventBus=e,this.enable(),OO.EventEmitter.call(this)}OO.mixinClass(r,OO.EventEmitter),r.EVENT_SCROLL_END="ScrollEndEventEmitter-scrollEnd",n(r,{_bindScroll:function(){this._scrollHandler||(this._scrollHandler=this._onScroll.bind(this),this.eventBus.on("scroll:throttled",this._scrollHandler))},_unbindScroll:function(){this._scrollHandler&&(this.eventBus.off("scroll:throttled",this._scrollHandler),this._scrollHandler=null)},_onScroll:function(){this.$el&&this.enabled&&this.scrollNearEnd()&&(this.disable(),this.emit(r.EVENT_SCROLL_END))},scrollNearEnd:function(){var e=s.getWindow(),t=e.scrollTop()+e.height(),i=this.$el.offset().top+this.$el.outerHeight();return t+this.threshold>i},enable:function(){this.enabled=!0,this._bindScroll()},disable:function(){this.enabled=!1,this._unbindScroll()},setElement:function(e){this.$el=e}}),e.exports=r},"./src/mobile.startup/Section.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/icons.js"),r=i("./src/mobile.startup/View.js");function o(e){var t=this;e.tag="h"+e.level,this.line=e.line,this.text=e.text,this.hasReferences=e.hasReferences||!1,this.id=e.id||null,this.anchor=e.anchor,this.subsections=[],(e.subsections||[]).forEach(function(e){t.subsections.push(new o(e))}),r.call(this,e)}s(o,r,{template:mw.template.get("mobile.startup","Section.hogan"),defaults:{line:void 0,text:"",spinner:n.spinner().toHtmlString()}}),e.exports=o},"./src/mobile.startup/Skin.js":function(e,t,i){var s=i("./src/mobile.startup/Browser.js").getSingleton(),n=i("./src/mobile.startup/lazyImages/lazyImageLoader.js"),r=i("./src/mobile.startup/lazyImages/lazyImageTransformer.js"),o=i("./src/mobile.startup/lazyReferencesLoader.js"),a=i("./src/mobile.startup/View.js"),l=i("./src/mobile.startup/util.js");function c(e){var t=this,i=l.extend({},e);this.page=i.page,this.name=i.name,i.mainMenu&&(this.mainMenu=i.mainMenu,mw.log.warn("Skin: Use of mainMenu is deprecated.")),this.eventBus=i.eventBus,i.isBorderBox=!1,a.call(this,i),this.referencesGateway=i.referencesGateway,mw.config.get("wgMFLazyLoadImages")&&l.docReady(function(){var e=document.getElementById("content"),i=e&&n.queryPlaceholders(e)||[];t.lazyImageTransformer=r.newLazyImageTransformer(t.eventBus,t.$.bind(t),1.5*l.getWindow().height(),i),t.lazyImageTransformer.loadImages()}),mw.config.get("wgMFLazyLoadReferences")&&this.eventBus.on("section-toggled",function(e){o.loadReferences(t.eventBus,e,t.referencesGateway,t.page)})}i("./src/mobile.startup/mfExtend.js")(c,a,{defaults:{page:void 0},postRender:function(){var e=this.$el;s.supportsAnimations()&&e.addClass("animations"),s.supportsTouchEvents()&&e.addClass("touch-events"),l.parseHTML('<div class="transparent-shield cloaked-element">').appendTo(e.find("#mw-mf-page-center")),this.lazyImageTransformer&&this.lazyImageTransformer.loadImages(),this.$("#mw-mf-page-center").on("click",this.emit.bind(this,"click"))},getLicenseMsg:function(){var e,t=mw.config.get("wgMFLicense"),i=mw.language.convertNumber(t.plural);return t.link&&(e=this.$("#footer-places-terms-use").length>0?mw.msg("mobile-frontend-editor-licensing-with-terms",mw.message("mobile-frontend-editor-terms-link",this.$("#footer-places-terms-use a").attr("href")).parse(),t.link,i):mw.msg("mobile-frontend-editor-licensing",t.link,i)),e}}),e.exports=c},"./src/mobile.startup/Thumbnail.js":function(e,t,i){var s=i("./src/mobile.startup/mfExtend.js"),n=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/View.js");function o(e){r.call(this,n.extend({isBorderBox:!1},e))}s(o,r,{defaults:{filename:void 0},postRender:function(){this.options.description=this.$el.siblings(".thumbcaption").text()},getDescription:function(){return this.options.description},getFileName:function(){return this.options.filename}}),e.exports=o},"./src/mobile.startup/View.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n=i("./src/mobile.startup/mfExtend.js"),r=/^(\S+)\s*(.*)$/,o=0;function a(){this.initialize.apply(this,arguments)}OO.mixinClass(a,OO.EventEmitter),n(a,{tagName:"div",isTemplateMode:!1,template:void 0,templatePartials:{},defaults:{},initialize:function(e){var t=this;OO.EventEmitter.call(this),e=s.extend({},this.defaults,e),this.options=e,this.cid=function(e){var t=(++o).toString();return e?e+t:t}("view"),"string"==typeof this.template&&(this.template=mw.template.compile(this.template)),e.el?this.$el=$(e.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize(e):s.docReady(function(){t.$el=$(e.el),t._postInitialize(e)})},_postInitialize:function(e){var t=e.className;this.$el.addClass(t),!1!==e.isBorderBox&&this.$el.addClass("view-border-box"),this.render({})},preRender:function(){},postRender:function(){},render:function(e){var t,i;return s.extend(this.options,e),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(i=this.template.render(this.options,this.templatePartials),this.isTemplateMode?(t=$(i),this.$el.replaceWith(t),this.$el=t):this.$el.html(i)),this.postRender(),this.delegateEvents(),this},$:function(e){return this.$el.find(e)},delegateEvents:function(e){var t,i,s;if(e=e||this.options.events)for(i in this.undelegateEvents(),e)"function"!=typeof(s=e[i])&&(s=this[e[i]]),s&&(t=i.match(r),this.delegate(t[1],t[2],s.bind(this)))},delegate:function(e,t,i){this.$el.on(e+".delegateEvents"+this.cid,t,i)},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid)},undelegate:function(e,t,i){this.$el.off(e+".delegateEvents"+this.cid,t,i)},parseHTML:function(e){return s.parseHTML(e,document)}}),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(e){a.prototype[e]=function(){return this.$el[e].apply(this.$el,arguments),this}}),e.exports=a},"./src/mobile.startup/actionParams.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n={action:"query",formatversion:2};e.exports=function(e){var t=mw.config.get("wgMFContentProviderScriptPath");return s.extend({},n,{origin:t?"*":void 0},e)}},"./src/mobile.startup/cache.js":function(e,t){function i(){this._cache={}}function s(){}i.prototype.get=function(e){return this._cache[e]},i.prototype.set=function(e,t){this._cache[e]=t},s.prototype.get=function(){},s.prototype.set=function(){},e.exports={MemoryCache:i,NoCache:s}},"./src/mobile.startup/context.js":function(e,t){e.exports={getMode:function(){return mw.config.get("wgMFMode")}}},"./src/mobile.startup/eventBusSingleton.js":function(e,t){e.exports=new OO.EventEmitter},"./src/mobile.startup/extendSearchParams.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n=i("./src/mobile.startup/actionParams.js");e.exports=function(e){var t,i,r=mw.config.get("wgMFDisplayWikibaseDescriptions",{}),o=mw.config.get("wgMFContentProviderScriptPath");if(!Object.prototype.hasOwnProperty.call(r,e))throw new Error('"'+e+"\" isn't a feature that shows Wikibase descriptions.");return(t=Array.prototype.slice.call(arguments,1)).unshift({prop:[]}),t.push(mw.config.get("wgMFSearchAPIParams")),(i=s.extend.apply({},t)).prop=i.prop.concat(mw.config.get("wgMFQueryPropModules")),r[e]&&-1===i.prop.indexOf("description")&&i.prop.push("description"),o&&(i.origin="*"),n(i)}},"./src/mobile.startup/icons.js":function(e,t,i){var s=i("./src/mobile.startup/Icon.js"),n=i("./src/mobile.startup/util.js");e.exports={CANCEL_GLYPH:"overlay-close",Icon:s,cancel:function(e){var t=e?"overlay-close-"+e:"overlay-close";return new this.Icon({tagName:"button",name:t,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")})},spinner:function(e){return e=e||{},new this.Icon(n.extend(e,{name:"spinner",label:mw.msg("mobile-frontend-loading-message"),additionalClassNames:"spinner loading"}))},watchIcon:function(){return new this.Icon({name:"watch",additionalClassNames:"watch-this-article"})},watchedIcon:function(){return new this.Icon({name:"watched",additionalClassNames:"watch-this-article watched"})}}},"./src/mobile.startup/lazyImages/lazyImageLoader.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n="lazy-image-placeholder";e.exports={queryPlaceholders:function(e){return Array.prototype.slice.call(e.getElementsByClassName(n))},loadImages:function(t){return s.when.apply(s,t.map(function(t){return e.exports.loadImage(t).promise}))},loadImage:function(e){var t=s.Deferred(),i=e.dataset.width||"0",n=e.dataset.height||"0",r=new Image(parseInt(i,10),parseInt(n,10));return r.className=e.dataset.class||"",r.alt=e.dataset.alt||"",r.style.cssText=e.style.cssText||"",r.addEventListener("load",function(){r.classList.add("image-lazy-loaded"),e.parentNode&&e.parentNode.replaceChild(r,e),t.resolve("load")},{once:!0}),r.addEventListener("error",function(){t.resolve("error")},{once:!0}),r.src=e.dataset.src||"",r.srcset=e.dataset.srcset||"",{promise:t,image:r}},test:{placeholderClass:n}}},"./src/mobile.startup/lazyImages/lazyImageTransformer.js":function(e,t,i){var s=i("./src/mobile.startup/lazyImages/lazyImageLoader.js"),n=i("./src/mobile.startup/util.js");e.exports={newLazyImageTransformer:function(e,t,i,r){function o(){var a=[];return(r=n.grep(r,function(e){var s=t(e);return!s.length||!function(e,t){return mw.viewport.isElementCloseToViewport(e[0],t)&&(e.is(":visible")||0===e.height())}(s,i)||(a.push(e),!1)})).length||(e.off("scroll:throttled",o),e.off("resize:throttled",o),e.off("section-toggled",o)),s.loadImages(a)}return e.on("scroll:throttled",o),e.on("resize:throttled",o),e.on("section-toggled",o),{loadImages:o}}}},"./src/mobile.startup/lazyReferencesLoader.js":function(e,t,i){var s=i("./src/mobile.startup/lazyImages/lazyImageLoader.js"),n=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/Page.js"),o=n.Deferred,a=i("./src/mobile.startup/icons.js").spinner();function l(e){var t,i=r.HEADING_SELECTOR,s=e.parent(),n=e.prevAll(i).eq(0);return n.length&&(t=n.find(".mw-headline").attr("id"))?t:s.length?l(s):null}e.exports={loadReferences:function(e,t,i,n){var r,c;if(!t.expanded&&t.isReferenceSection)return(r=t.$heading.next()).data("are-references-loaded")?o().reject().promise():(r.children().addClass("hidden"),c=a.$el.prependTo(r),i.getReferencesLists(t.page).then(function(){var s;r.find(".mf-lazy-references-placeholder").each(function(){var e=0,n=r.find(this),o=l(n);s!==o?(e=0,s=o):e++,o&&i.getReferencesList(t.page,o).then(function(t){t&&t[e]&&n.replaceWith(t[e])})}),c.remove(),r.children().removeClass("hidden"),e.emit("references-loaded",n),u()},function(){c.remove(),r.children().removeClass("hidden"),u()}));function u(){s.loadImages(s.queryPlaceholders(r[0])),r.data("are-references-loaded",1)}},test:{getSectionId:l}}},"./src/mobile.startup/loadingOverlay.js":function(e,t,i){var s=i("./src/mobile.startup/icons.js"),n=i("./src/mobile.startup/Overlay.js");e.exports=function(){var e=new n({className:"overlay overlay-loading",noHeader:!0});return s.spinner().$el.appendTo(e.$(".overlay-content")),e}},"./src/mobile.startup/mfExtend.js":function(e,t){e.exports=function(e,t,i){var s;for(s in i?OO.inheritClass(e,t):(OO.initClass(e),i=t),i)e.prototype[s]=i[s]}},"./src/mobile.startup/moduleLoader.js":function(e,t){function i(){this._register={}}i.prototype={require:function(e){var t,i,s=this._register;function n(){if(!Object.hasOwnProperty.call(s,e))throw new Error("MobileFrontend Module not found: "+e);return s[e]}i=e.split("/");try{return(t=mw.loader.require(i[0]))[i[1]]?t[i[1]]:n()}catch(e){return n()}},define:function(e,t){var i=this;if(Object.hasOwnProperty.call(this._register,e))throw new Error("Module already exists: "+e);return this._register[e]=t,{deprecate:function(s){i.deprecate(s,t,e)}}},deprecate:function(e,t,i){var s;i&&(s="Use "+i+" instead."),mw.log.deprecate(this._register,e,t,s)}},e.exports=i},"./src/mobile.startup/moduleLoaderSingleton.js":function(e,t,i){var s=i("./src/mobile.startup/moduleLoader.js");e.exports=new s},"./src/mobile.startup/references/ReferencesGateway.js":function(e,t){function i(e){this.api=e}i.prototype.getReference=null,i.ERROR_NOT_EXIST="NOT_EXIST_ERROR",i.ERROR_OTHER="OTHER_ERROR",e.exports=i},"./src/mobile.startup/references/ReferencesHtmlScraperGateway.js":function(e,t,i){var s=i("./src/mobile.startup/references/ReferencesGateway.js"),n=i("./src/mobile.startup/mfExtend.js"),r=i("./src/mobile.startup/util.js");function o(){s.apply(this,arguments)}n(o,s,{getReferenceFromContainer:function(e,t){var i,n=r.Deferred();return(i=t.find("#"+r.escapeSelector(e.substr(1)))).length?n.resolve({text:i.html()}):n.reject(s.ERROR_NOT_EXIST),n.promise()},getReference:function(e,t){return this.getReferenceFromContainer(decodeURIComponent(e),t.$("ol.references"))}}),e.exports=o},"./src/mobile.startup/references/ReferencesMobileViewGateway.js":function(e,t,i){var s=i("./src/mobile.startup/references/ReferencesHtmlScraperGateway.js"),n=i("./src/mobile.startup/cache.js"),r=i("./src/mobile.startup/references/ReferencesGateway.js"),o=n.MemoryCache,a=i("./src/mobile.startup/util.js"),l=i("./src/mobile.startup/mfExtend.js"),c=n.NoCache,u=null;function h(e,t){s.call(this,e),this.cache=t||new c}l(h,s,{getReferencesLists:function(e){var t=this,i=a.Deferred(),s=this.cache.get(e.id);return s?i.resolve(s).promise():(this.api.get({action:"mobileview",page:e.getTitle(),sections:"references",prop:"text",revision:e.getRevisionId()}).then(function(s){var n={};s.mobileview.sections.forEach(function(e){var t=a.parseHTML("<div>").html(e.text);n[t.find(".mw-headline").attr("id")]=t.find(".references")}),t.cache.set(e.id,n),i.resolve(n)},function(){i.reject(r.ERROR_OTHER)}),i.promise())},getReferencesList:function(e,t){return this.getReferencesLists(e).then(function(e){return!!Object.prototype.hasOwnProperty.call(e,t)&&e[t]})},getReference:function(e,t){var i=this;return this.getReferencesLists(t).then(function(t){var s=a.parseHTML("<div>");return Object.keys(t).forEach(function(e){s.append(t[e])}),i.getReferenceFromContainer(e,s)})}}),h.getSingleton=function(){return u||(u=new h(new mw.Api,new o)),u},e.exports=h},"./src/mobile.startup/rlModuleLoader.js":function(e,t,i){var s=i("./src/mobile.startup/loadingOverlay.js"),n=i("./src/mobile.startup/util.js");e.exports={newLoadingOverlay:function(){return s()},loadModule:function(e,t,i){var s=this.newLoadingOverlay();function r(){!t&&i&&s.hide()}return(i=void 0===i||i)&&(s.appendTo(document.body),s.show()),mw.loader.using(e).then(function(){return r(),s},function(){return r(),n.Deferred().reject().promise()})}}},"./src/mobile.startup/search/SearchGateway.js":function(e,t,i){var s=i("./src/mobile.startup/Page.js"),n=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/extendSearchParams.js");function o(e){this.api=e,this.searchCache={},this.generator=mw.config.get("wgMFSearchGenerator")}o.prototype={searchNamespace:0,getApiData:function(e){var t=this.generator.prefix,i=r("search",{generator:this.generator.name});return i.redirects="",i["g"+t+"search"]=e,i["g"+t+"namespace"]=this.searchNamespace,i["g"+t+"limit"]=15,i.pilimit&&(i.pilimit=15,i.pithumbsize=mw.config.get("wgMFThumbnailSizes").tiny),i},_createSearchRegEx:function(e){return e=e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),new RegExp("^("+e+")","ig")},_highlightSearchTerm:function(e,t){return e=n.parseHTML("<span>").text(e).html(),t=n.parseHTML("<span>").text(t).html(),e.replace(this._createSearchRegEx(t),"<strong>$1</strong>")},_getPage:function(e,t){var i=s.newFromJSON(t);return i.displayTitle=this._highlightSearchTerm(t.displaytext?t.displaytext:i.title,e),i.index=t.index,i},_processData:function(e,t){var i=this,s=[];return t.query&&(s=t.query.pages||{},(s=Object.keys(s).map(function(t){return i._getPage(e,s[t])})).sort(function(e,t){return e.index<t.index?-1:1})),s},search:function(e){var t,i,s=this;return this.isCached(e)||(i=(t=this.api.get(this.getApiData(e))).then(function(t){return{query:e,results:s._processData(e,t)}},function(){s.searchCache[e]=void 0}),this.searchCache[e]=i.promise({abort:function(){t.abort()}})),this.searchCache[e]},isCached:function(e){return Boolean(this.searchCache[e])}},e.exports=o},"./src/mobile.startup/time.js":function(e,t,i){var s=["seconds","minutes","hours","days","months","years"],n=i("./src/mobile.startup/util.js"),r=[1,60,3600,86400,2592e3,31536e3];function o(e){for(var t=0;t<r.length&&e>r[t+1];)++t;return{value:Math.round(e/r[t]),unit:s[t]}}function a(e){return o(Math.round((new Date).getTime()/1e3)-e)}function l(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,i,s){var r,o,c=[];return i=i||"unknown",l(r=a(e))?c.push("mobile-frontend-last-modified-with-user-just-now",i,t):c.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[r.unit],i,t,mw.language.convertNumber(r.value)),c.push(s||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),o=mw.message.apply(this,c).parse(),s?o:n.parseHTML("<div>").html(o).text()},getRegistrationMessage:function(e,t){var i,s=[];return t=t||"unknown",l(i=a(parseInt(e,10)))?s.push("mobile-frontend-joined-just-now",t):s.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[i.unit],t,mw.language.convertNumber(i.value)),mw.message.apply(this,s).parse()},timeAgo:o,getTimeAgoDelta:a,isNow:l,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},"./src/mobile.startup/toast.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n="mobileFrontend/toast";function r(){mw.requestIdleCallback(this._showPending.bind(this))}r.prototype.show=function(e,t){"string"==typeof t&&(mw.log.warn("The use of the cssClass parameter of Toast.show is deprecated, please convert it to an options object."),t={type:t}),t=s.extend({tag:"toast"},t),this.notification=mw.notify(e,t)},r.prototype.hide=function(){void 0!==this.notification&&this.notification.then(function(e){e.close()})},r.prototype.showOnPageReload=function(e,t){mw.storage.get(n)?mw.log.warn("A pending toast message already exits. The page should have been reloaded by now."):mw.storage.set(n,JSON.stringify({content:e,className:t}))},r.prototype._showPending=function(){var e=mw.storage.get(n);e&&(e=JSON.parse(e),this.show(e.content,e.className),mw.storage.remove(n))},e.exports=new r},"./src/mobile.startup/util.js":function(e,t){e.exports={escapeSelector:function(e){return $.escapeSelector(e)},grep:function(){return $.grep.apply($,arguments)},docReady:function(e){return $(e)},when:function(){return $.when.apply($,arguments)},Deferred:function(){return $.Deferred()},getDocument:function(){return $(document.documentElement)},getWindow:function(){return $(window)},parseHTML:function(e,t){return t=t||document,$($.parseHTML(e,t))},isNumeric:function(){return $.isNumeric.apply($,arguments)},extend:function(){return $.extend.apply($,arguments)},escapeHash:function(e){return e.replace(/(:|\.)/g,"\\$1")},isModifiedEvent:function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},repeatEvent:function(e,t,i,s){return e.on(i,function(e){return t.emit(i,e)},s)}}},"./src/mobile.startup/watchstar/Watchstar.js":function(e,t,i){var s=i("./src/mobile.startup/View.js"),n=i("./src/mobile.startup/watchstar/WatchstarGateway.js"),r=i("./src/mobile.startup/icons.js"),o=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/mfExtend.js"),l=i("./src/mobile.startup/toast.js"),c=i("./src/mobile.startup/CtaDrawer.js");function u(e){s.call(this,o.extend({className:r.watchIcon().getClassName(),events:{"click a":"onLinksClick",click:"onStatusToggle"}},e))}a(u,s,{defaults:{page:void 0,funnel:"unknown"},ctaDrawerOptions:{content:mw.msg("mobile-frontend-watchlist-cta"),queryParams:{warning:"mobile-frontend-watchlist-purpose",campaign:"mobile_watchPageActionCta",returntoquery:"article_action=watch"},signupQueryParams:{warning:"mobile-frontend-watchlist-signup-action"}},template:mw.template.compile('<a role="button">{{tooltip}}</a>',"hogan"),initialize:function(e){var t=s.prototype.initialize;this._watched=e.isWatched,this.gateway=new n(e.api),t.call(this,e)},preRender:function(){this.options.tooltip=this._watched?mw.msg("unwatchthispage"):mw.msg("watchthispage")},postRender:function(){var e=r.watchIcon().getGlyphClassName(),t=r.watchedIcon().getGlyphClassName()+" watched";this.$el.attr("title",this.options.tooltip),!mw.user.isAnon()&&this._watched?this.$el.addClass(t).removeClass(e):this.$el.addClass(e).removeClass(t),this.$el.removeClass("hidden")},onLinksClick:function(e){e.preventDefault()},onStatusToggleAnon:function(){this.drawer||(this.drawer=new c(this.ctaDrawerOptions)),this.drawer.show()},onStatusToggleUser:function(){var e,t=this,i=this.gateway,s=this.options.page,n=!this._watched;function r(){clearInterval(e)}e=setInterval(function(){l.show(mw.msg("mobile-frontend-watchlist-please-wait"))},1e3),i.postStatusesByTitle([s.getTitle()],n).then(function(){r(),t._watched=n,n?(t.render(),t.emit("watch"),l.show(mw.msg("mobile-frontend-watchlist-add",s.title))):(t.emit("unwatch"),t.render(),l.show(mw.msg("mobile-frontend-watchlist-removed",s.title)))},function(){r(),l.show(mw.msg("mobile-frontend-watchlist-error"),"error")})},onStatusToggle:function(){mw.user.isAnon()?this.onStatusToggleAnon.apply(this,arguments):this.onStatusToggleUser.apply(this,arguments)}}),e.exports=u},"./src/mobile.startup/watchstar/WatchstarGateway.js":function(e,t,i){var s=i("./src/mobile.startup/util.js"),n=i("./src/mobile.startup/actionParams.js");function r(e){this.api=e}r.prototype={getStatuses:function(e,t){return s.when(this.getStatusesByID(e),this.getStatusesByTitle(t)).then(function(){return s.extend.apply(s,arguments)})},getStatusesByID:function(e){var t=this;return e.length?this.api.get({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:e}).then(function(e){return t._unmarshalGetResponse(e)}):s.Deferred().resolve({})},getStatusesByTitle:function(e){var t=this;return e.length?this.api.get(n({prop:"info",inprop:"watched",titles:e})).then(function(e){return t._unmarshalGetResponse(e)}):s.Deferred().resolve({})},postStatusesByTitle:function(e,t){var i={action:"watch",titles:e};return t||(i.unwatch=!t),this.api.postWithToken("watch",i)},_unmarshalGetResponse:function(e){return(e&&e.query&&e.query.pages||[]).reduce(function(e,t){return e[t.title]=t.watched,e},{})}},e.exports=r},"./src/mobile.startup/watchstar/WatchstarPageList.js":function(e,t,i){var s=i("./src/mobile.startup/PageList.js"),n=i("./src/mobile.startup/watchstar/Watchstar.js"),r=mw.user,o=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/Page.js"),l=i("./src/mobile.startup/mfExtend.js"),c=i("./src/mobile.startup/watchstar/WatchstarGateway.js");function u(e){this.wsGateway=new c(e.api),s.apply(this,arguments)}l(u,s,{postRender:function(){var e,t,i=this,n=[],r=[];return s.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=this.parsePagesFromItems(e),Object.keys(t).forEach(function(e){var i=t[e];i&&"0"!==i?n.push(i):r.push(e)}),this.getPages(n,r).then(function(t){i.renderItems(e,t)})},queryUnitializedItems:function(){return this.$("li:not(.with-watchstar)")},getPages:function(e,t){return r.isAnon()?o.Deferred().resolve({}):this.wsGateway.getStatuses(e,t)},parsePagesFromItems:function(e){var t=this,i={};return e.each(function(e,s){var n=t.$(s);i[n.attr("title")]=n.data("id")}),i},renderItems:function(e,t){var i=this;r.isAnon()||e.each(function(e,s){var n=i.$(s),r=new a({sections:[],title:n.attr("title"),id:n.data("id")}),o=i.parseHTML("<div>").appendTo(n),l=t[r.getTitle()];i._appendWatchstar(o,r,l),n.addClass("with-watchstar")})},_appendWatchstar:function(e,t,i){var s=new n({api:this.options.api,funnel:this.options.funnel,isAnon:r.isAnon(),isWatched:i,page:t,el:e});return o.repeatEvent(s,this,"watch"),o.repeatEvent(s,this,"unwatch"),s}}),e.exports=u}}]);
//# sourceMappingURL=mobile.common.js.map.json