this.mfModules=this.mfModules||{},this.mfModules["mobile.startup"]=(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[function(e,t){var n,i=mw.log;n={escapeSelector:function(e){return $.escapeSelector(e)},grep:function(){return $.grep.apply($,arguments)},docReady:function(e){return $(e)},when:function(){return $.when.apply($,arguments)},Deferred:function(){var e=$.Deferred(),t="Use Promise compatible methods `then` and `catch` instead.";return i.deprecate(e,"fail",e.fail,t),i.deprecate(e,"always",e.always,t),i.deprecate(e,"done",e.done,t),e},getDocument:function(){return $(document.documentElement)},getWindow:function(){return $(window)},parseHTML:function(e,t){return $($.parseHTML(e,t))},noop:$.noop,isNumeric:function(){return $.isNumeric.apply($,arguments)},extend:function(){return $.extend.apply($,arguments)},escapeHash:function(e){return e.replace(/(:|\.)/g,"\\$1")},isModifiedEvent:function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},repeatEvent:function(e,t,n,i){return e.on(n,function(e){return t.emit(n,e)},i)}},e.exports=n},,,function(e,t,n){var i,r=n(0).getDocument();function o(e){var t=function(){var n=this["__cache"+t.cacheId]||(this["__cache"+t.cacheId]={}),i=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(n,i)?n[i]:n[i]=e.apply(this,arguments)};return t.cacheId=Date.now().toString()+Math.random().toString(),t}function s(e,t){this.userAgent=e,this.$el=t,this._fixIosLandscapeBug()}s.prototype={_fixIosLandscapeBug:function(){var e=this;this.$el.find('meta[name="viewport"]')[0]&&(this.isIos(4)||this.isIos(5))&&(this.lockViewport(),document.addEventListener("gesturestart",function(){e.lockViewport()},!1))},isIos:o(function(e){var t=this.userAgent,n=/ipad|iphone|ipod/i.test(t);if(!n||!e)return n;switch(e){case 8:return/OS 8_/.test(t)||/Version\/8/.test(t);case 4:return/OS 4_/.test(t);case 5:return/OS 5_/.test(t);default:return!1}}),lockViewport:function(){this.$el&&this.$el.find('meta[name="viewport"]').attr("content","initial-scale=1.0, maximum-scale=1.0, user-scalable=no")},isWideScreen:o(function(){var e=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=e||window.innerHeight>=e}),supportsAnimations:o(function(){var e=document.createElement("foo").style;function t(t){return t in e||"webkit"+t[0].toUpperCase()+t.slice(1)in e}return t("animationName")&&t("transform")&&t("transition")}),supportsTouchEvents:o(function(){return"ontouchstart"in window}),supportsGeoLocation:o(function(){return"geolocation"in navigator})},s.getSingleton=function(){return i||(i=new s(window.navigator.userAgent,r)),i},e.exports=s},function(e,t){function n(){this._cache={}}function i(){}n.prototype.get=function(e){return this._cache[e]},n.prototype.set=function(e,t){this._cache[e]=t},i.prototype.get=function(){},i.prototype.set=function(){},e.exports={MemoryCache:n,NoCache:i}},function(e,t){function n(){this._register={},OO.EventEmitter.call(this)}n.prototype={require:function(e){var t,n,i=this._register;function r(){if(!Object.hasOwnProperty.call(i,e))throw new Error("MobileFrontend Module not found: "+e);return i[e]}n=e.split("/");try{return(t=mw.loader.require(n[0]))[n[1]]?t[n[1]]:r()}catch(e){return r()}},define:function(e,t){var n=this;if(Object.hasOwnProperty.call(this._register,e))throw new Error("Module already exists: "+e);return this._register[e]=t,{deprecate:function(i){n.deprecate(i,t,e)}}},deprecate:function(e,t,n){var i;n&&(i="Use "+n+" instead."),mw.log.deprecate(this._register,e,t,i)}},OO.mixinClass(n,OO.EventEmitter),e.exports=n},function(e,t,n){var i=["seconds","minutes","hours","days","months","years"],r=n(0),o=[1,60,3600,86400,2592e3,31536e3];function s(e){for(var t=0;t<o.length&&e>o[t+1];)++t;return{value:Math.round(e/o[t]),unit:i[t]}}function a(e){return s(Math.round((new Date).getTime()/1e3)-e)}function u(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,n,i){var o,s,l=[];return n=n||"unknown",u(o=a(parseInt(e,10)))?l.push("mobile-frontend-last-modified-with-user-just-now",n,t):l.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[o.unit],n,t,mw.language.convertNumber(o.value)),l.push(i||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),s=mw.message.apply(this,l).parse(),i?s:r.parseHTML("<div>").html(s).text()},getRegistrationMessage:function(e,t){var n,i=[];return t=t||"unknown",u(n=a(parseInt(e,10)))?i.push("mobile-frontend-joined-just-now",t):i.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[n.unit],t,mw.language.convertNumber(n.value)),mw.message.apply(this,i).parse()},timeAgo:s,getTimeAgoDelta:a,isNow:u,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},,function(e,t){e.exports=function(e,t,n){var i;for(i in n?OO.inheritClass(e,t):(OO.initClass(e),n=t),n)e.prototype[i]=n[i]}},,,,,,,,,,,,,function(e,t,n){var i=new(n(5)),r=n(8),o=n(22),s=n(6),a=n(23),u=n(0),l=n(24),c=n(25),d=n(3),p=n(4);mw.mobileFrontend=i,mw.log.deprecate(i,"on",i.on,"The global EventEmitter should not be used (T156186)."),OO.mfExtend=r,mw.mobileFrontend.define("mobile.startup/util",u),mw.mobileFrontend.define("mobile.startup/View",l),mw.mobileFrontend.define("mobile.startup/Browser",d),mw.mobileFrontend.define("mobile.startup/cache",p),mw.mobileFrontend.define("mobile.startup/time",s),mw.mobileFrontend.define("mobile.startup/context",o),mw.mobileFrontend.define("mobile.startup/user",a),mw.mobileFrontend.define("mobile.startup/PageGateway",c),e.exports={moduleLoader:i,time:s,util:u,View:l,Browser:d,context:o,cache:p}},function(e,t){var n={getMode:function(){return mw.config.get("wgMFMode")}};e.exports=n},function(e,t,n){var i,r=mw.user,o=n(0);i={tokens:r.tokens,isAnon:r.isAnon,getName:r.getName,getId:r.getId,getEditCount:function(){return mw.config.get("wgUserEditCount")},getGroups:function(){return o.Deferred().resolve(mw.config.get("wgUserGroups"))},getSessionId:function(){return r.sessionId()},inUserBucketA:function(){return mw.config.get("wgUserId")%2==0}},e.exports=i},function(e,t,n){var i=n(0),r=n(8),o=window.OO,s=/^(\S+)\s*(.*)$/,a=0;function u(){this.initialize.apply(this,arguments)}o.mixinClass(u,o.EventEmitter),r(u,{className:void 0,tagName:"div",isTemplateMode:!1,isBorderBox:!0,template:void 0,templatePartials:{},defaults:{},events:null,initialize:function(e){var t=this;o.EventEmitter.call(this),e=i.extend({},this.defaults,e),this.options=e,this.cid=function(e){var t=(++a).toString();return e?e+t:t}("view"),"string"==typeof this.template&&(this.template=mw.template.compile(this.template)),e.el?this.$el=$(e.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize():i.docReady(function(){t.$el=$(e.el),t._postInitialize()})},_postInitialize:function(){this.$el.addClass(this.className),this.isBorderBox&&this.$el.addClass("view-border-box"),this.render(this.options)},preRender:i.noop,postRender:i.noop,render:function(e){var t;return i.extend(this.options,e),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(t=this.template.render(this.options,this.templatePartials),this.isTemplateMode?this.$el=$(t):this.$el.html(t)),this.postRender(),this.delegateEvents(),this},$:function(e){return this.$el.find(e)},delegateEvents:function(e){var t,n,i;if(e=e||this.events)for(n in this.undelegateEvents(),e)"function"!=typeof(i=e[n])&&(i=this[e[n]]),i&&(t=n.match(s),this.delegate(t[1],t[2],i.bind(this)))},delegate:function(e,t,n){this.$el.on(e+".delegateEvents"+this.cid,t,n)},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid)},undelegate:function(e,t,n){this.$el.off(e+".delegateEvents"+this.cid,t,n)},parseHTML:i.parseHTML}),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(e){u.prototype[e]=function(){return this.$el[e].apply(this.$el,arguments),this}}),e.exports=u},function(e,t,n){var i=mw.template.get("mobile.startup","Section.hogan"),r=n(0),o={};function s(e){var t,n=e.map(function(e){return e.level}).filter(function(e){return!!e}),r=Math.min.apply(this,n).toString(),o=[];return e.forEach(function(e){void 0!==e.line&&(e.line=e.line.replace(/<\/?a\b[^>]*>/g,"")),e.children=[],!t||!e.level||e.level===r||t.children.length&&t.children[0].level>e.level||t.level&&t.level>=e.level?(o.push(e),t=e):(!function e(t,n){var i;0===t.length?t.push(n):(i=t[t.length-1],parseInt(i.level,10)===parseInt(n.level,10)?t.push(n):e(i.children,n))}(t.children,e),t.text+=i.render(e))}),o}function a(e){this.api=e}a.prototype={getPage:function(e,t,n){var i,a=r.Deferred(),u=t?{url:t,dataType:"jsonp"}:{},l={edit:["*"]};return o[e]||(o[e]=this.api.get({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:n?0:"all"},u).then(function(t){var n,o,u,c;return t.error?a.reject(t.error):t.mobileview.sections?(n=s((c=t.mobileview).sections),i=new Date(c.lastmodified).getTime()/1e3,o=c.lastmodifiedby,l=Array.isArray(c.protection)?l:r.extend(l,c.protection),u={title:e,id:c.id,revId:c.revId,protection:l,lead:n[0].text,sections:n.slice(1),isMainPage:void 0!==c.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:i,languageCount:c.languagecount,hasVariants:void 0!==c.hasvariants,displayTitle:c.displaytitle},o&&r.extend(u,{lastModifiedUserName:o.name,lastModifiedUserGender:o.gender}),u):a.reject("No sections")},function(e){return a.reject(e)})),o[e]},invalidatePage:function(e){delete o[e]},_getLanguageVariantsFromApiResponse:function(e,t){var n=t.query.general,i=n.variantarticlepath,r=[];return!!n.variants&&(Object.keys(n.variants).forEach(function(t){var o=n.variants[t],s={autonym:o.name,lang:o.code};s.url=i?i.replace("$1",e).replace("$2",o.code):mw.util.getUrl(e,{variant:o.code}),r.push(s)}),r)},getPageLanguages:function(e,t){var n=this,i={action:"query",meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e,formatversion:2};return t?(i.llprop="url|autonym|langname",i.llinlanguagecode=t):i.llprop="url|autonym",this.api.get(i).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:n._getLanguageVariantsFromApiResponse(e,t)}},function(){return r.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var n=this.tagName.substr(1),i=e.find(this).find(".mw-headline");i.length&&t.push({level:n,line:i.html(),anchor:i.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return s(this._getAPIResponseFromHTML(e))}},e.exports=a}],[[21,0]]]);
//# sourceMappingURL=mobile.startup.js.map.json