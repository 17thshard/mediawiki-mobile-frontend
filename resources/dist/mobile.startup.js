this.mfModules=this.mfModules||{},this.mfModules["mobile.startup"]=(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./src/mobile.startup/CtaDrawer.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/Drawer.js"),r=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/Button.js"),o=s("./src/mobile.startup/Anchor.js");function l(e){n.call(this,r.extend({},n.prototype.defaults,{progressiveButton:new a({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,actionAnchor:new o({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options},e))}function c(e,t){return r.extend({returnto:t||mw.config.get("wgPageName")},e)}function u(){return[].push.call(arguments,{type:"signup"}),r.extend.apply(r,arguments)}i(l,n,{templatePartials:r.extend({},n.prototype.templatePartials,{button:a.prototype.template,anchor:o.prototype.template}),template:mw.template.get("mobile.startup","CtaDrawer.hogan"),preRender:function(){var e=c(this.options.queryParams,this.options.returnTo);this.options.progressiveButton.href||(this.options.progressiveButton.href=mw.util.getUrl("Special:UserLogin",e)),this.options.actionAnchor.href||(this.options.actionAnchor.href=mw.util.getUrl("Special:UserLogin",u(e,this.options.signupQueryParams)))}}),l.prototype.test={redirectParams:c,signUpParams:u},e.exports=l},"./src/mobile.startup/Drawer.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/Panel.js"),r=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/Icon.js");function o(e){n.call(this,r.extend({className:"drawer position-fixed"},e))}i(o,n,{defaults:r.extend({},n.prototype.defaults,{collapseIcon:new a({name:"arrow",additionalClassNames:"cancel"}).options}),templatePartials:r.extend({},n.prototype.templatePartials,{icon:a.prototype.template}),appendToElement:"body",closeOnScroll:!0,events:r.extend({},n.prototype.events,{click:"stopPropagation"}),postRender:function(){var e=this;r.docReady(function(){e.appendTo(e.appendToElement),e.$el.parent().addClass("has-drawer")}),this.on("show",this.onShowDrawer.bind(this)),this.on("hide",this.onHideDrawer.bind(this))},stopPropagation:function(e){e.stopPropagation()},onShowDrawer:function(){var e=this;this.$el.parent().addClass("drawer-visible"),setTimeout(function(){var t=r.getWindow();t.one("click.drawer",e.hide.bind(e)),e.closeOnScroll&&t.one("scroll.drawer",e.hide.bind(e))},e.minHideDelay)},onHideDrawer:function(){this.$el.parent().removeClass("drawer-visible"),r.getWindow().off(".drawer")}}),e.exports=o},"./src/mobile.startup/OverlayManager.js":function(e,t,s){var i=s("./src/mobile.startup/util.js"),n=null;function r(e,t){e.on("route",this._checkRoute.bind(this)),this.router=e,this.entries={},this.stack=[],this.hideCurrent=!0,t||mw.log.warn("appendToSelector will soon be a required parameter to OverlayManager"),this.appendToSelector=t||"body"}s("./src/mobile.startup/mfExtend.js")(r,{_onHideOverlay:function(){this.hideCurrent=!1,this.router.back()},_attachOverlay:function(e){e.$el.parents().length||$(this.appendToSelector).append(e.$el)},_show:function(e){e.once("_om_hide",this._onHideOverlay.bind(this)),this._attachOverlay(e),e.show()},_hideOverlay:function(e){var t;return e.off("_om_hide"),(t=e.hide(this.stack.length>1))||e.once("_om_hide",this._onHideOverlay.bind(this)),t},_processMatch:function(e){var t,s=this;function i(e){e.on("hide",function(){e.emit("_om_hide")})}e&&(e.overlay?s._show(e.overlay):"function"==typeof(t=e.factoryResult).promise?t.then(function(t){e.overlay=t,i(t),s._show(t)}):(e.overlay=t,i(e.overlay),s._show(t)))},_checkRoute:function(e){var t,s=this.stack[0];s||(this.scrollTop=window.pageYOffset),t=Object.keys(this.entries).reduce(function(t,s){return t||this._matchRoute(e.path,this.entries[s])}.bind(this),null),s&&void 0!==s.overlay&&this.hideCurrent&&!this._hideOverlay(s.overlay)?e.preventDefault():t||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(t)},_matchRoute:function(e,t){var s,i=e.match(t.route),n=this.stack[1],r=this;function a(){return{path:e,factoryResult:t.factory.apply(r,i.slice(1))}}return i?n&&n.path===e?n.overlay&&n.overlay.hasLoadError?(r.stack.shift(),r.stack[0]=a(),r.stack[0]):(r.stack.shift(),n):(s=a(),this.stack[0]&&s.path===this.stack[0].path?r.stack[0]=s:r.stack.unshift(s),s):null},add:function(e,t){var s=this,n={route:e,factory:t};this.entries[e]=n,i.docReady(function(){s._processMatch(s._matchRoute(s.router.getPath(),n))})},replaceCurrent:function(e){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");this._hideOverlay(this.stack[0].overlay),this.stack[0].overlay=e,this._show(e)}}),r.getSingleton=function(){return n||(n=new r(mw.loader.require("mediawiki.router"),"body")),n},e.exports=r},"./src/mobile.startup/Page.js":function(e,t,s){var i=mw.html,n=s("./src/mobile.startup/mfExtend.js"),r=s("./src/mobile.startup/time.js"),a=s("./src/mobile.startup/util.js"),o=s("./src/mobile.startup/Section.js"),l=s("./src/mobile.startup/Thumbnail.js"),c=s("./src/mobile.startup/View.js"),u=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),h=["noviewer","metadata"];function p(e){a.extend(this,{options:e,title:e.title,displayTitle:e.displayTitle,url:e.url||mw.util.getUrl(e.title),id:e.id,wikidataDescription:e.wikidataDescription,thumbnail:!!Object.prototype.hasOwnProperty.call(e,"thumbnail")&&e.thumbnail,isMissing:void 0!==e.isMissing?e.isMissing:0===e.id}),this.options.isBorderBox=!1,this.options.languageUrl=mw.util.getUrl("Special:MobileLanguages/"+this.title),c.call(this,this.options),this.displayTitle||(this.displayTitle=this.getDisplayTitle()),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}n(p,c,{defaults:{id:0,title:"",displayTitle:"",namespaceNumber:0,protection:{edit:["*"]},sections:[],isMissing:!1,isMainPage:!1,url:void 0,thumbnail:{isLandscape:void 0,source:void 0,width:void 0,height:void 0}},getDisplayTitle:function(){return this.options.displayTitle||i.escape(this.options.title)},inNamespace:function(e){return this.options.namespaceNumber===mw.config.get("wgNamespaceIds")[e]},findSectionHeadingByIndex:function(e){return e<1?this.$():this.$(u).filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(e-1)},findChildInSectionLead:function(e,t){var s,i,n,r,a=u;function o(e){return e.find(t).addBack()}return 0===e?(r=this.getLeadSectionElement())&&r.length?o(r.children(t)):(s=this.findSectionHeadingByIndex(1)).length?o(s.prevAll(t)):this.$(t):(s=this.findSectionHeadingByIndex(e)).hasClass("section-heading")?(i=(n=s.next()).find(a).eq(0)).length?o(i.prevAll(t)):o(n.children(t)):(i=s.eq(0).nextAll(a).eq(0),s.nextUntil(i,t))},getLeadSectionElement:function(){return this.$(".mf-section-0").length?this.$(".mf-section-0"):null},isWikiText:function(){return"wikitext"===mw.config.get("wgPageContentModel")},isMainPage:function(){return this.options.isMainPage},isWatched:function(){return this.options.isWatched},getRevisionId:function(){return this.options.revId},getTitle:function(){return this.options.title},getId:function(){return this.options.id},getNamespaceId:function(){var e=this.options.title.split(":");return e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0},isTalkPage:function(){var e=this.getNamespaceId();return e>0&&e%2==1},preRender:function(){this.sections=[],this._sectionLookup={},this.title=this.options.title,this.options.sections.forEach(function(e){var t=new o(e);this.sections.push(t),this._sectionLookup[t.id]=t}.bind(this))},getThumbnails:function(){var e=this.$el,t="."+h.join(",."),s=[];return this._thumbs||(e.find("a.image, a.thumbimage").not(t).each(function(){var i=e.find(this),n=i.find(".lazy-image-placeholder"),r=0===i.parents(t).length&&0===i.find(t).length,a=i.attr("href").match(/title=([^/&]+)/),o=i.attr("href").match(/[^/]+$/);n.length&&r&&(r=!new RegExp("\\b("+h.join("|")+")\\b").test(n.data("class"))),r&&(a||o)&&s.push(new l({el:i,filename:decodeURIComponent(a?a[1]:o[0])}))}),this._thumbs=s),this._thumbs},getSection:function(e){return this._sectionLookup[e]},getSections:function(){return this.sections},getRedLinks:function(){return this.$(".new")}}),p.newFromJSON=function(e){var t,s,n=e.thumbnail,o=e.pageprops||{displaytitle:i.escape(e.title)},l=e.terms;return(o||l)&&(s=l&&l.label?i.escape(l.label[0]):o.displaytitle),e.wikidataDescription=e.description||void 0,n&&(e.thumbnail.isLandscape=n.width>n.height),e.revisions&&e.revisions[0]&&(t=e.revisions[0],e.lastModified=r.getLastModifiedMessage(new Date(t.timestamp).getTime()/1e3,t.user)),new p(a.extend(e,{id:e.pageid,isMissing:!!e.missing,url:mw.util.getUrl(e.title),displayTitle:s}))},p.HEADING_SELECTOR=u,e.exports=p},"./src/mobile.startup/PageGateway.js":function(e,t,s){var i=mw.template.get("mobile.startup","Section.hogan"),n=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/actionParams.js"),a={};function o(e){var t,s=e.map(function(e){return e.level}).filter(function(e){return!!e}),n=Math.min.apply(this,s).toString(),r=[];return e.forEach(function(e){void 0!==e.line&&(e.line=e.line.replace(/<\/?a\b[^>]*>/g,"")),e.subsections=[],!t||!e.level||e.level===n||t.subsections.length&&t.subsections[0].level>e.level||t.level&&t.level>=e.level?(r.push(e),t=e):(!function e(t,s){var i;0===t.length?t.push(s):(i=t[t.length-1],parseInt(i.level,10)===parseInt(s.level,10)?t.push(s):e(i.subsections,s))}(t.subsections,e),t.text+=i.render(e))}),r}function l(e){this.api=e}l.prototype={getPage:function(e,t,s){var i,l=n.Deferred(),c=t?{url:t,dataType:"jsonp"}:{},u={edit:["*"]};return n.extend(c,r({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:s?0:"all"})),a[e]||(a[e]=this.api.get(c).then(function(t){var s,r,a,c;return t.error?l.reject(t.error):t.mobileview.sections?(s=o((c=t.mobileview).sections),i=new Date(c.lastmodified).getTime()/1e3,r=c.lastmodifiedby,u=Array.isArray(c.protection)?u:n.extend(u,c.protection),a={title:e,id:c.id,revId:c.revId,protection:u,lead:s[0].text,sections:s.slice(1),isMainPage:void 0!==c.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:i,languageCount:c.languagecount,hasVariants:void 0!==c.hasvariants,displayTitle:c.displaytitle},r&&n.extend(a,{lastModifiedUserName:r.name,lastModifiedUserGender:r.gender}),a):l.reject("No sections")},function(e){return l.reject(e)})),a[e]},invalidatePage:function(e){delete a[e]},_getLanguageVariantsFromApiResponse:function(e,t){var s=t.query.general,i=s.variantarticlepath,n=[];return!!s.variants&&(Object.keys(s.variants).forEach(function(t){var r=s.variants[t],a={autonym:r.name,lang:r.code};a.url=i?i.replace("$1",e).replace("$2",r.code):mw.util.getUrl(e,{variant:r.code}),n.push(a)}),n)},getPageLanguages:function(e,t){var s=this,i=r({meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e});return t?(i.llprop="url|autonym|langname",i.llinlanguagecode=t):i.llprop="url|autonym",this.api.get(i).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:s._getLanguageVariantsFromApiResponse(e,t)}},function(){return n.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var s=this.tagName.substr(1),i=e.find(this).find(".mw-headline");i.length&&t.push({level:s,line:i.html(),anchor:i.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return o(this._getAPIResponseFromHTML(e))}},e.exports=l},"./src/mobile.startup/PageList.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/View.js"),r=s("./src/mobile.startup/Browser.js").getSingleton();function a(){n.apply(this,arguments)}i(a,n,{defaults:{pages:[]},renderPageImages:function(){var e=this;setTimeout(function(){e.$(".list-thumb").each(function(){var t=e.$(this).data("style");e.$(this).attr("style",t)})},r.isWideScreen()?0:1e3)},postRender:function(){this.renderPageImages()},template:mw.template.get("mobile.startup","PageList.hogan"),templatePartials:{item:mw.template.get("mobile.startup","PageListItem.hogan")}}),e.exports=a},"./src/mobile.startup/Panel.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/View.js");function a(e){var t=n.extend({},{className:"panel"},e);r.call(this,t)}i(a,r,{minHideDelay:10,events:{"click .cancel":"onCancel"},onCancel:function(e){e.preventDefault(),this.hide()},show:function(){var e=this;e.isVisible()||setTimeout(function(){e.$el.addClass("visible animated"),e.emit("show")},e.minHideDelay)},hide:function(){var e=this;setTimeout(function(){e.$el.removeClass("visible"),e.emit("hide")},e.minHideDelay)},isVisible:function(){return this.$el.hasClass("visible")},toggle:function(){this.isVisible()?this.hide():this.show()}}),e.exports=a},"./src/mobile.startup/ScrollEndEventEmitter.js":function(e,t,s){var i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/mfExtend.js");function r(e,t){this.threshold=t||100,this.eventBus=e,this.enable(),OO.EventEmitter.call(this)}OO.mixinClass(r,OO.EventEmitter),r.EVENT_SCROLL_END="ScrollEndEventEmitter-scrollEnd",n(r,{_bindScroll:function(){this._scrollHandler||(this._scrollHandler=this._onScroll.bind(this),this.eventBus.on("scroll:throttled",this._scrollHandler))},_unbindScroll:function(){this._scrollHandler&&(this.eventBus.off("scroll:throttled",this._scrollHandler),this._scrollHandler=null)},_onScroll:function(){this.$el&&this.enabled&&this.scrollNearEnd()&&(this.disable(),this.emit(r.EVENT_SCROLL_END))},scrollNearEnd:function(){var e=i.getWindow(),t=e.scrollTop()+e.height(),s=this.$el.offset().top+this.$el.outerHeight();return t+this.threshold>s},enable:function(){this.enabled=!0,this._bindScroll()},disable:function(){this.enabled=!1,this._unbindScroll()},setElement:function(e){this.$el=e}}),e.exports=r},"./src/mobile.startup/Section.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/icons.js"),r=s("./src/mobile.startup/View.js");function a(e){var t=this;e.tag="h"+e.level,this.line=e.line,this.text=e.text,this.hasReferences=e.hasReferences||!1,this.id=e.id||null,this.anchor=e.anchor,this.subsections=[],(e.subsections||[]).forEach(function(e){t.subsections.push(new a(e))}),r.call(this,e)}i(a,r,{template:mw.template.get("mobile.startup","Section.hogan"),defaults:{line:void 0,text:"",spinner:n.spinner().toHtmlString()}}),e.exports=a},"./src/mobile.startup/Skin.js":function(e,t,s){var i=s("./src/mobile.startup/Browser.js").getSingleton(),n=s("./src/mobile.startup/View.js"),r=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/Page.js"),o=r.Deferred,l=r.when,c=s("./src/mobile.startup/icons.js"),u=mw.viewport,h=c.spinner();function p(e){var t,s=a.HEADING_SELECTOR,i=e.parent(),n=e.prevAll(s).eq(0);return n.length&&(t=n.find(".mw-headline").attr("id"))?t:i.length?p(i):null}function m(e){var t=this,s=r.extend({},e);this.page=s.page,this.name=s.name,s.mainMenu&&(this.mainMenu=s.mainMenu,mw.log.warn("Skin: Use of mainMenu is deprecated.")),this.eventBus=s.eventBus,s.isBorderBox=!1,n.call(this,s),this.referencesGateway=s.referencesGateway,mw.config.get("wgMFLazyLoadImages")&&r.docReady(function(){t.setupImageLoading()}),mw.config.get("wgMFLazyLoadReferences")&&this.eventBus.on("before-section-toggled",this.lazyLoadReferences.bind(this))}s("./src/mobile.startup/mfExtend.js")(m,n,{defaults:{page:void 0},events:{},postRender:function(){var e=this.$el;i.supportsAnimations()&&e.addClass("animations"),i.supportsTouchEvents()&&e.addClass("touch-events"),r.parseHTML('<div class="transparent-shield cloaked-element">').appendTo(e.find("#mw-mf-page-center")),this.emit("changed"),this.$("#mw-mf-page-center").on("click",this.emit.bind(this,"click"))},getUnloadedImages:function(e){return(e=e||this.$("#content")).find(".lazy-image-placeholder").toArray()},setupImageLoading:function(e){var t=this,s=1.5*r.getWindow().height(),i=this.loadImagesList.bind(this),n=this.getUnloadedImages(e);function a(){var e=[];return(n=r.grep(n,function(i){var n=t.$(i);return!n.length||!function(e){return u.isElementCloseToViewport(e[0],s)&&(e.is(":visible")||0===e.height())}(n)||(e.push(i),!1)})).length||(t.eventBus.off("scroll:throttled",a),t.eventBus.off("resize:throttled",a),t.eventBus.off("section-toggled",a),t.off("changed",a)),i(e)}return this.eventBus.on("scroll:throttled",a),this.eventBus.on("resize:throttled",a),this.eventBus.on("section-toggled",a),this.on("changed",a),a()},loadImagesList:function(e){var t,s=this.$.bind(this),i=this.loadImage.bind(this);return t=(e=e||this.getUnloadedImages()).map(function(e){return i(s(e))}),l.apply(null,t)},loadImage:function(e){var t=o(),s=e.attr("data-width"),i=e.attr("data-height"),n=r.parseHTML("<img>",this.$el[0].ownerDocument);return n.on("load",function(){n.addClass("image-lazy-loaded"),e.replaceWith(n),t.resolve()}),n.on("error",function(){t.reject()}),n.attr({class:e.attr("data-class"),width:s,height:i,src:e.attr("data-src"),alt:e.attr("data-alt"),style:e.attr("style"),srcset:e.attr("data-srcset")}),t},lazyLoadReferences:function(e){var t,s,i=this.referencesGateway,n=this.getUnloadedImages.bind(this),r=this.loadImagesList.bind(this),a=this;if(!e.wasExpanded&&e.isReferenceSection)return(t=e.$heading.next()).data("are-references-loaded")?o().reject().promise():(t.children().addClass("hidden"),s=h.$el.prependTo(t),i.getReferencesLists(e.page).then(function(){var n;t.find(".mf-lazy-references-placeholder").each(function(){var s=0,r=t.find(this),a=p(r);n!==a?(s=0,n=a):s++,a&&i.getReferencesList(e.page,a).then(function(e){e&&e[s]&&r.replaceWith(e[s])})}),s.remove(),t.children().removeClass("hidden"),a.emit("references-loaded",a.page),l()},function(){s.remove(),t.children().removeClass("hidden"),l()}));function l(){r(n(t)),t.data("are-references-loaded",1)}},getLicenseMsg:function(){var e,t=mw.config.get("wgMFLicense"),s=mw.language.convertNumber(t.plural);return t.link&&(e=this.$("#footer-places-terms-use").length>0?mw.msg("mobile-frontend-editor-licensing-with-terms",mw.message("mobile-frontend-editor-terms-link",this.$("#footer-places-terms-use a").attr("href")).parse(),t.link,s):mw.msg("mobile-frontend-editor-licensing",t.link,s)),e}}),m.getSectionId=p,e.exports=m},"./src/mobile.startup/Thumbnail.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/View.js");function a(e){r.call(this,n.extend({isBorderBox:!1},e))}i(a,r,{defaults:{filename:void 0},postRender:function(){this.options.description=this.$el.siblings(".thumbcaption").text()},getDescription:function(){return this.options.description},getFileName:function(){return this.options.filename}}),e.exports=a},"./src/mobile.startup/Toggler.js":function(e,t,s){var i=s("./src/mobile.startup/Browser.js").getSingleton(),n=s("./src/mobile.startup/util.js"),r=n.escapeHash,a={name:"arrow",additionalClassNames:"indicator"},o=s("./src/mobile.startup/Icon.js");function l(e){this.eventBus=e.eventBus,this._enable(e.$container,e.prefix,e.page,e.isClosed)}function c(e){var t=JSON.parse(mw.storage.get("expandedSections")||"{}");return t[e.title]=t[e.title]||{},t}function u(e){mw.storage.set("expandedSections",JSON.stringify(e))}function h(e,t,s){var i,n,r=c(s);t.find(".section-heading span").each(function(){n=t.find(this),i=n.parents(".section-heading"),r[s.title][n.attr("id")]&&!i.hasClass("open-block")&&e.toggle(i,s)})}function p(e){var t=(new Date).getTime(),s=c(e);Object.keys(s).forEach(function(e){var i=s[e];Object.keys(i).forEach(function(n){var r=i[n];Math.floor((t-r)/1e3/60/60/24)>=1&&delete s[e][n]})}),u(s)}l.prototype.toggle=function(e){var t,s=e.is(".open-block"),n=e.data("page"),r=e.data("section-number"),l=e.next();e.toggleClass("open-block"),e.data("indicator").remove(),a.rotation=s?0:180,t=new o(a).prependTo(e),e.data("indicator",t),this.eventBus.emit("before-section-toggled",{page:n,wasExpanded:s,$heading:e,isReferenceSection:Boolean(l.attr("data-is-reference-section"))}),l.toggleClass("open-block").attr({"aria-pressed":!s,"aria-expanded":!s}),this.eventBus.emit("section-toggled",s,r),i.isWideScreen()||function(e,t){var s=e.find("span").attr("id"),i=e.hasClass("open-block"),n=c(t);s&&(i?n[t.title][s]=(new Date).getTime():delete n[t.title][s],u(n))}(e,n)},l.prototype.reveal=function(e,t){var s,i;try{(i=(s=t.find(r(e))).parents(".collapsible-heading")).length||(i=s.parents(".collapsible-block").prev(".collapsible-heading")),i.length&&!i.hasClass("open-block")&&this.toggle(i),i.length&&window.scrollTo(0,s.offset().top)}catch(e){}},l.prototype._enable=function(e,t,s,r){var l,c,u,m,d,f=this,g=mw.config.get("wgMFCollapseSectionsByDefault");function b(){var t=window.location.hash;0===t.indexOf("#")&&f.reveal(t,e)}l=e.find("> h1,> h2,> h3,> h4,> h5,> h6,.section-heading").eq(0).prop("tagName")||"H1",void 0===g&&(g=!0),c=!g||mw.config.get("wgMFExpandAllSectionsUserOption")&&"true"===mw.storage.get("expandSections"),e.children(l).each(function(n){var l,h=e.find(this),p=h.find(".indicator"),d=t+"collapsible-block-"+n;h.next().is("div")&&(m=h.next("div"),l=Boolean(m.attr("data-is-reference-section")),h.addClass("collapsible-heading ").data("section-number",n).data("page",s).attr({tabindex:0,"aria-haspopup":"true","aria-controls":d}).on("click",function(e){e.target.href||(e.preventDefault(),f.toggle(h))}),a.rotation=c?180:0,u=new o(a),p.length?p.replaceWith(u.$el):u.prependTo(h),h.data("indicator",u.$el),m.addClass("collapsible-block").eq(0).attr({id:d,"aria-pressed":"false","aria-expanded":"false"}),function(e,t){t.on("keypress",function(s){13!==s.which&&32!==s.which||e.toggle(t)}).find("a").on("keypress mouseup",function(e){e.stopPropagation()})}(f,h),!l&&(!r&&i.isWideScreen()||c)&&f.toggle(h))}),function(){var t=mw.config.get("wgInternalRedirectTargetUrl"),s=!!t&&t.split("#")[1];s&&(window.location.hash=s,f.reveal(s,e))}(),b(),(d=e.find("a:not(.reference a)")).on("click",function(){void 0!==d.attr("href")&&d.attr("href").indexOf("#")>-1&&b()}),n.getWindow().on("hashchange",function(){b()}),!i.isWideScreen()&&s&&(h(this,e,s),p(s))},l._getExpandedSections=c,l._expandStoredSections=h,l._cleanObsoleteStoredSections=p,e.exports=l},"./src/mobile.startup/cache.js":function(e,t){function s(){this._cache={}}function i(){}s.prototype.get=function(e){return this._cache[e]},s.prototype.set=function(e,t){this._cache[e]=t},i.prototype.get=function(){},i.prototype.set=function(){},e.exports={MemoryCache:s,NoCache:i}},"./src/mobile.startup/context.js":function(e,t){e.exports={getMode:function(){return mw.config.get("wgMFMode")}}},"./src/mobile.startup/eventBusSingleton.js":function(e,t){e.exports=new OO.EventEmitter},"./src/mobile.startup/extendSearchParams.js":function(e,t,s){var i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/actionParams.js");e.exports=function(e){var t,s,r=mw.config.get("wgMFDisplayWikibaseDescriptions",{}),a=mw.config.get("wgMFContentProviderScriptPath");if(!Object.prototype.hasOwnProperty.call(r,e))throw new Error('"'+e+"\" isn't a feature that shows Wikibase descriptions.");return(t=Array.prototype.slice.call(arguments,1)).unshift({prop:[]}),t.push(mw.config.get("wgMFSearchAPIParams")),(s=i.extend.apply({},t)).prop=s.prop.concat(mw.config.get("wgMFQueryPropModules")),r[e]&&-1===s.prop.indexOf("description")&&s.prop.push("description"),a&&(s.origin="*"),n(s)}},"./src/mobile.startup/loadingOverlay.js":function(e,t,s){var i=s("./src/mobile.startup/icons.js"),n=s("./src/mobile.startup/Overlay.js");e.exports=function(){var e=new n({className:"overlay overlay-loading",noHeader:!0});return i.spinner().$el.appendTo(e.$(".overlay-content")),e}},"./src/mobile.startup/mobile.startup.js":function(e,t,s){var i=s("./src/mobile.startup/moduleLoaderSingleton.js"),n=s("./src/mobile.startup/mfExtend.js"),r=s("./src/mobile.startup/context.js"),a=s("./src/mobile.startup/time.js"),o=s("./src/mobile.startup/actionParams.js"),l=s("./src/mobile.startup/util.js"),c=s("./src/mobile.startup/View.js"),u=s("./src/mobile.startup/PageGateway.js"),h=s("./src/mobile.startup/Browser.js"),p=s("./src/mobile.startup/cache.js"),m=s("./src/mobile.startup/Button.js"),d=s("./src/mobile.startup/Icon.js"),f=s("./src/mobile.startup/references/ReferencesDrawer.js"),g=s("./src/mobile.startup/references/ReferencesGateway.js"),b=s("./src/mobile.startup/references/ReferencesHtmlScraperGateway.js"),w=s("./src/mobile.startup/references/ReferencesMobileViewGateway.js"),v=s("./src/mobile.startup/icons.js"),y=s("./src/mobile.startup/Panel.js"),S=s("./src/mobile.startup/Section.js"),j=s("./src/mobile.startup/Thumbnail.js"),x=s("./src/mobile.startup/Page.js"),k=s("./src/mobile.startup/Anchor.js"),T=s("./src/mobile.startup/Skin.js"),R=s("./src/mobile.startup/OverlayManager.js"),C=s("./src/mobile.startup/Overlay.js"),_=s("./src/mobile.startup/loadingOverlay.js"),O=s("./src/mobile.startup/Drawer.js"),M=s("./src/mobile.startup/CtaDrawer.js"),$=s("./src/mobile.startup/PageList.js"),E=s("./src/mobile.startup/toast.js"),P=s("./src/mobile.startup/extendSearchParams.js"),L=s("./src/mobile.startup/watchstar/Watchstar.js"),I=s("./src/mobile.startup/watchstar/WatchstarPageList.js"),D=s("./src/mobile.startup/rlModuleLoader.js"),F=s("./src/mobile.startup/eventBusSingleton.js"),N=s("./src/mobile.startup/Toggler.js"),B=s("./src/mobile.startup/search/SearchOverlay.js"),H=s("./src/mobile.startup/search/schemaMobileWebSearch.js"),W=s("./src/mobile.startup/search/MobileWebSearchLogger.js"),A=s("./src/mobile.startup/search/SearchGateway.js"),G=s("./src/mobile.startup/ScrollEndEventEmitter.js");mw.mobileFrontend=i,OO.mfExtend=n,mw.mobileFrontend.define("mobile.startup/util",l),mw.mobileFrontend.define("mobile.startup/View",c),mw.mobileFrontend.define("mobile.startup/Browser",h),mw.mobileFrontend.define("mobile.startup/cache",p),mw.mobileFrontend.define("mobile.startup/time",a),mw.mobileFrontend.define("mobile.startup/context",r),mw.mobileFrontend.define("mobile.startup/PageGateway",u),mw.mobileFrontend.define("mobile.startup/Button",m),mw.mobileFrontend.define("mobile.startup/Icon",d),mw.mobileFrontend.define("mobile.startup/icons",v),mw.mobileFrontend.define("mobile.startup/Panel",y),mw.mobileFrontend.define("mobile.startup/Section",S),mw.mobileFrontend.define("mobile.startup/Thumbnail",j),mw.mobileFrontend.define("mobile.startup/Page",x),mw.mobileFrontend.define("mobile.startup/Anchor",k),mw.mobileFrontend.define("mobile.startup/Skin",T),mw.mobileFrontend.define("mobile.startup/OverlayManager",R),mw.mobileFrontend.define("mobile.startup/Overlay",C),mw.mobileFrontend.define("mobile.startup/Drawer",O),mw.mobileFrontend.define("mobile.startup/CtaDrawer",M),mw.mobileFrontend.define("mobile.startup/PageList",$),mw.mobileFrontend.define("mobile.startup/toast",E),mw.mobileFrontend.define("mobile.startup/rlModuleLoader",D),mw.mobileFrontend.define("mobile.startup/eventBusSingleton",F),mw.mobileFrontend.deprecate("mobile.startup/LoadingOverlay",_,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.search.util/extendSearchParams",P,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.references/ReferencesDrawer",f,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.references.gateway/ReferencesGateway",g,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.references.gateway/ReferencesHtmlScraperGateway",b,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.references.gateway/ReferencesMobileViewGateway",w,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.watchstar/Watchstar",L,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.pagelist.scripts/WatchstarPageList",I,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.toggle/Toggler",N,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.search/SearchOverlay",B,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.search/MobileWebSearchLogger",W,"mobile.startup"),mw.mobileFrontend.deprecate("mobile.search.api/SearchGateway",A,"mobile.startup"),e.exports={extendSearchParams:P,ReferencesDrawer:f,ReferencesGateway:g,ReferencesHtmlScraperGateway:b,ReferencesMobileViewGateway:w,moduleLoader:i,time:a,util:l,actionParams:o,View:c,Browser:h,context:r,cache:p,Button:m,Icon:d,icons:v,Panel:y,Section:S,Page:x,Anchor:k,Skin:T,OverlayManager:R,Overlay:C,loadingOverlay:_,Drawer:O,CtaDrawer:M,PageList:$,toast:E,Watchstar:L,WatchstarPageList:I,rlModuleLoader:D,eventBusSingleton:F,Toggler:N,search:{SearchOverlay:B,MobileWebSearchLogger:W,SearchGateway:A},ScrollEndEventEmitter:G},mw.mobileFrontend.define("mobile.startup",e.exports),H.subscribeMobileWebSearchSchema()},"./src/mobile.startup/references/ReferencesDrawer.js":function(e,t,s){var i=s("./src/mobile.startup/Drawer.js"),n=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/icons.js"),a=s("./src/mobile.startup/mfExtend.js"),o=s("./src/mobile.startup/references/ReferencesGateway.js"),l=s("./src/mobile.startup/Icon.js");function c(e){i.call(this,n.extend({className:"drawer position-fixed text references"},e))}a(c,i,{defaults:n.extend({},i.prototype.defaults,{spinner:r.spinner().toHtmlString(),cancelButton:r.cancel("gray").toHtmlString(),citation:new l({isSmall:!0,name:"citation",additionalClassNames:"text",hasText:!0,label:mw.msg("mobile-frontend-references-citation")}).toHtmlString(),errorClassName:new l({name:"error",hasText:!0,isSmall:!0}).getClassName()}),events:{"click sup a":"showNestedReference"},show:function(){return i.prototype.show.apply(this,arguments)},template:mw.template.get("mobile.startup","ReferencesDrawer.hogan"),closeOnScroll:!1,postRender:function(){var e=n.getWindow().height();i.prototype.postRender.apply(this),e/2<400&&this.$el.css("max-height",e/2),this.on("show",this.onShow.bind(this)),this.on("hide",this.onHide.bind(this))},onShow:function(){n.getDocument().find("body").addClass("drawer-enabled")},onHide:function(){n.getDocument().find("body").removeClass("drawer-enabled")},showReference:function(e,t,s){var i=this,n=this.options.gateway;return this.options.page=t,i.show(),n.getReference(e,t).then(function(e){i.render({title:s,text:e.text})},function(e){e===o.ERROR_NOT_EXIST?i.hide():i.render({error:!0,title:s,text:mw.msg("mobile-frontend-references-citation-error")})})},showNestedReference:function(e){var t=this.$(e.target);return this.showReference(t.attr("href"),this.options.page,t.text()),!1}}),e.exports=c},"./src/mobile.startup/references/ReferencesGateway.js":function(e,t){function s(e){this.api=e}s.prototype.getReference=null,s.ERROR_NOT_EXIST="NOT_EXIST_ERROR",s.ERROR_OTHER="OTHER_ERROR",e.exports=s},"./src/mobile.startup/references/ReferencesHtmlScraperGateway.js":function(e,t,s){var i=s("./src/mobile.startup/references/ReferencesGateway.js"),n=s("./src/mobile.startup/mfExtend.js"),r=s("./src/mobile.startup/util.js");function a(){i.apply(this,arguments)}n(a,i,{getReferenceFromContainer:function(e,t){var s,n=r.Deferred();return(s=t.find("#"+r.escapeSelector(e.substr(1)))).length?n.resolve({text:s.html()}):n.reject(i.ERROR_NOT_EXIST),n.promise()},getReference:function(e,t){return this.getReferenceFromContainer(decodeURIComponent(e),t.$("ol.references"))}}),e.exports=a},"./src/mobile.startup/references/ReferencesMobileViewGateway.js":function(e,t,s){var i=s("./src/mobile.startup/references/ReferencesHtmlScraperGateway.js"),n=s("./src/mobile.startup/cache.js"),r=s("./src/mobile.startup/references/ReferencesGateway.js"),a=n.MemoryCache,o=s("./src/mobile.startup/util.js"),l=s("./src/mobile.startup/mfExtend.js"),c=n.NoCache,u=null;function h(e,t){i.call(this,e),this.cache=t||new c}l(h,i,{getReferencesLists:function(e){var t=this,s=o.Deferred(),i=this.cache.get(e.id);return i?s.resolve(i).promise():(this.api.get({action:"mobileview",page:e.getTitle(),sections:"references",prop:"text",revision:e.getRevisionId()}).then(function(i){var n={};i.mobileview.sections.forEach(function(e){var t=o.parseHTML("<div>").html(e.text);n[t.find(".mw-headline").attr("id")]=t.find(".references")}),t.cache.set(e.id,n),s.resolve(n)},function(){s.reject(r.ERROR_OTHER)}),s.promise())},getReferencesList:function(e,t){return this.getReferencesLists(e).then(function(e){return!!Object.prototype.hasOwnProperty.call(e,t)&&e[t]})},getReference:function(e,t){var s=this;return this.getReferencesLists(t).then(function(t){var i=o.parseHTML("<div>");return Object.keys(t).forEach(function(e){i.append(t[e])}),s.getReferenceFromContainer(e,i)})}}),h.getSingleton=function(){return u||(u=new h(new mw.Api,new a)),u},e.exports=h},"./src/mobile.startup/rlModuleLoader.js":function(e,t,s){var i=s("./src/mobile.startup/loadingOverlay.js"),n=s("./src/mobile.startup/util.js");e.exports={newLoadingOverlay:function(){return i()},loadModule:function(e,t,s){var i=this.newLoadingOverlay();function r(){!t&&s&&i.hide()}return(s=void 0===s||s)&&i.show(),mw.loader.using(e).then(function(){return r(),i},function(){return r(),n.Deferred().reject().promise()})}}},"./src/mobile.startup/search/MobileWebSearchLogger.js":function(e,t){function s(){this.userSessionToken=null,this.searchSessionToken=null}s.prototype={_newUserSession:function(){this.userSessionToken=mw.user.generateRandomSessionId()},_newSearchSession:function(){this.searchSessionToken=mw.user.generateRandomSessionId(),this.searchSessionCreatedAt=(new Date).getTime()},onSearchShow:function(){this._newUserSession()},onSearchStart:function(){this._newSearchSession(),mw.track("mf.schemaMobileWebSearch",{action:"session-start",userSessionToken:this.userSessionToken,searchSessionToken:this.searchSessionToken,timeOffsetSinceStart:0})},onSearchResults:function(e){var t=(new Date).getTime()-this.searchSessionCreatedAt;mw.track("mf.schemaMobileWebSearch",{action:"impression-results",resultSetType:"prefix",numberOfResults:e.results.length,userSessionToken:this.userSessionToken,searchSessionToken:this.searchSessionToken,timeToDisplayResults:t,timeOffsetSinceStart:t})},onSearchResultClick:function(e){var t=(new Date).getTime()-this.searchSessionCreatedAt;mw.track("mf.schemaMobileWebSearch",{action:"click-result",clickIndex:e.resultIndex+1,userSessionToken:this.userSessionToken,searchSessionToken:this.searchSessionToken,timeOffsetSinceStart:t})}},s.register=function(e){var t=new s;e.on("search-show",t.onSearchShow.bind(t)),e.on("search-start",t.onSearchStart.bind(t)),e.on("search-results",t.onSearchResults.bind(t)),e.on("search-result-click",t.onSearchResultClick.bind(t))},e.exports=s},"./src/mobile.startup/search/SearchGateway.js":function(e,t,s){var i=s("./src/mobile.startup/Page.js"),n=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/extendSearchParams.js");function a(e){this.api=e,this.searchCache={},this.generator=mw.config.get("wgMFSearchGenerator")}a.prototype={searchNamespace:0,getApiData:function(e){var t=this.generator.prefix,s=r("search",{generator:this.generator.name});return s.redirects="",s["g"+t+"search"]=e,s["g"+t+"namespace"]=this.searchNamespace,s["g"+t+"limit"]=15,s.pilimit&&(s.pilimit=15,s.pithumbsize=mw.config.get("wgMFThumbnailSizes").tiny),s},_createSearchRegEx:function(e){return e=e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),new RegExp("^("+e+")","ig")},_highlightSearchTerm:function(e,t){return e=n.parseHTML("<span>").text(e).html(),t=n.parseHTML("<span>").text(t).html(),e.replace(this._createSearchRegEx(t),"<strong>$1</strong>")},_getPage:function(e,t){var s=i.newFromJSON(t);return s.displayTitle=this._highlightSearchTerm(t.displaytext?t.displaytext:s.title,e),s.index=t.index,s},_processData:function(e,t){var s=this,i=[];return t.query&&(i=t.query.pages||{},(i=Object.keys(i).map(function(t){return s._getPage(e,i[t])})).sort(function(e,t){return e.index<t.index?-1:1})),i},search:function(e){var t,s,i=this;return this.isCached(e)||(s=(t=this.api.get(this.getApiData(e))).then(function(t){return{query:e,results:i._processData(e,t)}},function(){i.searchCache[e]=void 0}),this.searchCache[e]=s.promise({abort:function(){t.abort()}})),this.searchCache[e]},isCached:function(e){return Boolean(this.searchCache[e])}},e.exports=a},"./src/mobile.startup/search/SearchOverlay.js":function(e,t,s){var i=s("./src/mobile.startup/mfExtend.js"),n=s("./src/mobile.startup/Overlay.js"),r=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/Anchor.js"),o=s("./src/mobile.startup/Icon.js"),l=s("./src/mobile.startup/watchstar/WatchstarPageList.js"),c=mw.config.get("wgCirrusSearchFeedbackLink");function u(e){var t=r.extend({},{isBorderBox:!1,className:"overlay search-overlay"},e);n.call(this,t),this.api=t.api,this.gateway=new t.gatewayClass(this.api),this.router=t.router}i(u,n,{templatePartials:r.extend({},n.prototype.templatePartials,{header:mw.template.get("mobile.startup","search/SearchHeader.hogan"),content:mw.template.get("mobile.startup","search/SearchContent.hogan"),icon:o.prototype.template}),defaults:r.extend({},n.prototype.defaults,{headerChrome:!0,clearIcon:new o({tagName:"button",name:"search-clear",isSmall:!0,label:mw.msg("mobile-frontend-clear-search"),additionalClassNames:"clear"}).options,searchContentIcon:new o({tagName:"a",href:"#",name:"search-content",label:mw.msg("mobile-frontend-search-content")}).options,searchTerm:"",placeholderMsg:"",noResultsMsg:mw.msg("mobile-frontend-search-no-results"),searchContentNoResultsMsg:mw.message("mobile-frontend-search-content-no-results").parse(),action:mw.config.get("wgScript"),feedback:!!c&&{feedback:new a({label:mw.msg("mobile-frontend-search-feedback-link-text"),href:c}).options,prompt:mw.msg("mobile-frontend-search-feedback-prompt")}}),events:r.extend({},n.prototype.events,{"input input":"onInputInput","click .clear":"onClickClear","click .search-content":"onClickSearchContent","click .overlay-content":"onClickOverlayContent","click .overlay-content > div":"onClickOverlayContentDiv","touchstart .results":"hideKeyboardOnScroll","mousedown .results":"hideKeyboardOnScroll","click .results a":"onClickResult"}),onInputInput:function(){this.performSearch(),this.$clear.toggle(""!==this.$input.val())},onClickClear:function(){return this.$input.val("").focus(),this.performSearch(),this.$clear.hide(),!1},onClickSearchContent:function(){var e=r.getDocument().find("body"),t=this.$("form");this.parseHTML("<input>").attr({type:"hidden",name:"fulltext",value:"search"}).appendTo(t),setTimeout(function(){t.appendTo(e),t.submit()},0)},onClickOverlayContent:function(){this.$(".cancel").trigger("click")},onClickOverlayContentDiv:function(e){e.stopPropagation()},hideKeyboardOnScroll:function(){this.$input.blur()},onClickResult:function(e){var t=this.$(e.currentTarget),s=t.closest("li");this.emit("search-result-click",{result:s,resultIndex:this.$results.index(s),originalEvent:e}),e.preventDefault(),this.router.back().then(function(){window.location.href=t.attr("href")})},postRender:function(){var e,t=this;function s(){t.$spinner.hide(),clearTimeout(e)}n.prototype.postRender.call(this),this.$input=this.$("input"),this.$clear=this.$(".clear"),this.$searchContent=this.$(".search-content").hide(),this.$searchFeedback=this.$(".search-feedback").hide(),this.$resultContainer=this.$(".results-list-container"),this.$spinner=this.$(".spinner-container"),this.on("search-start",function(i){e&&s(),e=setTimeout(function(){t.$spinner.show()},2e3-i.delay)}),this.on("search-results",s),""===t.$input.val()&&this.$clear.hide()},showKeyboard:function(){var e=this.$input.val().length;this.$input.focus(),this.$input[0].setSelectionRange&&this.$input[0].setSelectionRange(e,e)},show:function(){n.prototype.show.apply(this,arguments),this.showKeyboard(),this.emit("search-show")},hide:function(){var e=this;return r.getDocument().hasClass("animations")?(e.$el.addClass("fade-out"),setTimeout(function(){n.prototype.hide.apply(e,arguments)},500)):n.prototype.hide.apply(e,arguments),!0},performSearch:function(){var e=this,t=this.api,s=this.$input.val(),i=this.gateway.isCached(s)?0:300;s!==this.lastQuery&&(e._pendingQuery&&e._pendingQuery.abort(),clearTimeout(this.timer),s.length?this.timer=setTimeout(function(){var n;e.emit("search-start",{query:s,delay:i}),n=e.gateway.search(s),e._pendingQuery=n.then(function(s){s&&s.query===e.$input.val()&&(e.$el.toggleClass("no-results",0===s.results.length),e.$searchContent.show().find("p").hide().filter(s.results.length?".with-results":".without-results").show(),new l({api:t,funnel:"search",pages:s.results,el:e.$resultContainer}),e.$results=e.$resultContainer.find("li"),e.emit("search-results",{results:s.results}))}).promise({abort:function(){n.abort()}})},i):e.resetSearch(),this.lastQuery=s)},resetSearch:function(){this.$spinner.hide(),this.$searchContent.hide(),this.$searchFeedback.hide(),this.$resultContainer.empty()}}),e.exports=u},"./src/mobile.startup/search/schemaMobileWebSearch.js":function(e,t){e.exports={subscribeMobileWebSearchSchema:function(){mw.loader.using(["ext.eventLogging.subscriber"]).then(function(){var e=mw.mobileFrontend.require("mobile.startup/context"),t=new(0,mw.eventLog.Schema)("MobileWebSearch",mw.config.get("wgMFSchemaSearchSampleRate",.001),{platform:"mobileweb",platformVersion:e.getMode()});mw.trackSubscribe("mf.schemaMobileWebSearch",function(e,s){t.log(s)})})}}},"./src/mobile.startup/time.js":function(e,t,s){var i=["seconds","minutes","hours","days","months","years"],n=s("./src/mobile.startup/util.js"),r=[1,60,3600,86400,2592e3,31536e3];function a(e){for(var t=0;t<r.length&&e>r[t+1];)++t;return{value:Math.round(e/r[t]),unit:i[t]}}function o(e){return a(Math.round((new Date).getTime()/1e3)-e)}function l(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,s,i){var r,a,c=[];return s=s||"unknown",l(r=o(e))?c.push("mobile-frontend-last-modified-with-user-just-now",s,t):c.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[r.unit],s,t,mw.language.convertNumber(r.value)),c.push(i||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),a=mw.message.apply(this,c).parse(),i?a:n.parseHTML("<div>").html(a).text()},getRegistrationMessage:function(e,t){var s,i=[];return t=t||"unknown",l(s=o(parseInt(e,10)))?i.push("mobile-frontend-joined-just-now",t):i.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[s.unit],t,mw.language.convertNumber(s.value)),mw.message.apply(this,i).parse()},timeAgo:a,getTimeAgoDelta:o,isNow:l,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},"./src/mobile.startup/toast.js":function(e,t,s){var i=s("./src/mobile.startup/util.js"),n="mobileFrontend/toast";function r(){mw.requestIdleCallback(this._showPending.bind(this))}r.prototype.show=function(e,t){"string"==typeof t&&(mw.log.warn("The use of the cssClass parameter of Toast.show is deprecated, please convert it to an options object."),t={type:t}),t=i.extend({tag:"toast"},t),this.notification=mw.notify(e,t)},r.prototype.hide=function(){void 0!==this.notification&&this.notification.then(function(e){e.close()})},r.prototype.showOnPageReload=function(e,t){mw.storage.get(n)?mw.log.warn("A pending toast message already exits. The page should have been reloaded by now."):mw.storage.set(n,JSON.stringify({content:e,className:t}))},r.prototype._showPending=function(){var e=mw.storage.get(n);e&&(e=JSON.parse(e),this.show(e.content,e.className),mw.storage.remove(n))},e.exports=new r},"./src/mobile.startup/watchstar/Watchstar.js":function(e,t,s){var i=s("./src/mobile.startup/View.js"),n=s("./src/mobile.startup/watchstar/WatchstarGateway.js"),r=s("./src/mobile.startup/icons.js"),a=s("./src/mobile.startup/util.js"),o=s("./src/mobile.startup/mfExtend.js"),l=s("./src/mobile.startup/toast.js"),c=s("./src/mobile.startup/CtaDrawer.js");function u(e){i.call(this,a.extend({className:r.watchIcon().getClassName()},e))}o(u,i,{events:{"click a":"onLinksClick",click:"onStatusToggle"},defaults:{page:void 0,funnel:"unknown"},ctaDrawerOptions:{content:mw.msg("mobile-frontend-watchlist-cta"),queryParams:{warning:"mobile-frontend-watchlist-purpose",campaign:"mobile_watchPageActionCta",returntoquery:"article_action=watch"},signupQueryParams:{warning:"mobile-frontend-watchlist-signup-action"}},template:mw.template.compile('<a role="button">{{tooltip}}</a>',"hogan"),initialize:function(e){var t=i.prototype.initialize;this._watched=e.isWatched,this.gateway=new n(e.api),t.call(this,e)},preRender:function(){this.options.tooltip=this._watched?mw.msg("unwatchthispage"):mw.msg("watchthispage")},postRender:function(){var e=r.watchIcon().getGlyphClassName(),t=r.watchedIcon().getGlyphClassName()+" watched";this.$el.attr("title",this.options.tooltip),!mw.user.isAnon()&&this._watched?this.$el.addClass(t).removeClass(e):this.$el.addClass(e).removeClass(t),this.$el.removeClass("hidden")},onLinksClick:function(e){e.preventDefault()},onStatusToggleAnon:function(){this.drawer||(this.drawer=new c(this.ctaDrawerOptions)),this.drawer.show()},onStatusToggleUser:function(){var e,t=this,s=this.gateway,i=this.options.page,n=!this._watched;function r(){clearInterval(e)}e=setInterval(function(){l.show(mw.msg("mobile-frontend-watchlist-please-wait"))},1e3),s.postStatusesByTitle([i.getTitle()],n).then(function(){r(),t._watched=n,n?(t.render(),t.emit("watch"),l.show(mw.msg("mobile-frontend-watchlist-add",i.title))):(t.emit("unwatch"),t.render(),l.show(mw.msg("mobile-frontend-watchlist-removed",i.title)))},function(){r(),l.show(mw.msg("mobile-frontend-watchlist-error"),"error")})},onStatusToggle:function(){mw.user.isAnon()?this.onStatusToggleAnon.apply(this,arguments):this.onStatusToggleUser.apply(this,arguments)}}),e.exports=u},"./src/mobile.startup/watchstar/WatchstarGateway.js":function(e,t,s){var i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/actionParams.js");function r(e){this.api=e}r.prototype={getStatuses:function(e,t){return i.when(this.getStatusesByID(e),this.getStatusesByTitle(t)).then(function(){return i.extend.apply(i,arguments)})},getStatusesByID:function(e){var t=this;return e.length?this.api.get({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:e}).then(function(e){return t._unmarshalGetResponse(e)}):i.Deferred().resolve({})},getStatusesByTitle:function(e){var t=this;return e.length?this.api.get(n({prop:"info",inprop:"watched",titles:e})).then(function(e){return t._unmarshalGetResponse(e)}):i.Deferred().resolve({})},postStatusesByTitle:function(e,t){var s={action:"watch",titles:e};return t||(s.unwatch=!t),this.api.postWithToken("watch",s)},_unmarshalGetResponse:function(e){return(e&&e.query&&e.query.pages||[]).reduce(function(e,t){return e[t.title]=t.watched,e},{})}},e.exports=r},"./src/mobile.startup/watchstar/WatchstarPageList.js":function(e,t,s){var i=s("./src/mobile.startup/PageList.js"),n=s("./src/mobile.startup/watchstar/Watchstar.js"),r=mw.user,a=s("./src/mobile.startup/util.js"),o=s("./src/mobile.startup/Page.js"),l=s("./src/mobile.startup/mfExtend.js"),c=s("./src/mobile.startup/watchstar/WatchstarGateway.js");function u(e){this.wsGateway=new c(e.api),i.apply(this,arguments)}l(u,i,{postRender:function(){var e,t,s=this,n=[],r=[];return i.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=this.parsePagesFromItems(e),Object.keys(t).forEach(function(e){var s=t[e];s&&"0"!==s?n.push(s):r.push(e)}),this.getPages(n,r).then(function(t){s.renderItems(e,t)})},queryUnitializedItems:function(){return this.$("li:not(.with-watchstar)")},getPages:function(e,t){return r.isAnon()?a.Deferred().resolve({}):this.wsGateway.getStatuses(e,t)},parsePagesFromItems:function(e){var t=this,s={};return e.each(function(e,i){var n=t.$(i);s[n.attr("title")]=n.data("id")}),s},renderItems:function(e,t){var s=this;r.isAnon()||e.each(function(e,i){var n=s.$(i),r=new o({sections:[],title:n.attr("title"),id:n.data("id")}),a=s.parseHTML("<div>").appendTo(n),l=t[r.getTitle()];s._appendWatchstar(a,r,l),n.addClass("with-watchstar")})},_appendWatchstar:function(e,t,s){var i=new n({api:this.options.api,funnel:this.options.funnel,isAnon:r.isAnon(),isWatched:s,page:t,el:e});return a.repeatEvent(i,this,"watch"),a.repeatEvent(i,this,"unwatch"),i}}),e.exports=u}},[["./src/mobile.startup/mobile.startup.js",0,1]]]);
//# sourceMappingURL=mobile.startup.js.map.json